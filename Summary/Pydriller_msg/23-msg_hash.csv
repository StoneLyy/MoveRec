commit_id,msg
9d4c5e1b6471b3d8003908f87b9bda0efd115970,"New repository initialized by cvs2svn.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333117 13f79535-47bb-0310-9956-ffa450edef68"
d45120c1c360726d699d836f0a996bf32e2e09ac,"New KEYS file; hopefully in the correct format


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333118 13f79535-47bb-0310-9956-ffa450edef68"
308da1a98ecc4de8302dbec2bb60cb77244d7bf5,"Xalan 2.0.0d1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333126 13f79535-47bb-0310-9956-ffa450edef68"
088fcfe2fd1150306dd5248ff40b7124c6186574,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333127 13f79535-47bb-0310-9956-ffa450edef68"
b30c4a88f0a2071eae1afdae6b0655a3d7d899f7,"Removed some methods.  See TRaX list for details.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333128 13f79535-47bb-0310-9956-ffa450edef68"
1f8e4d6d97e25de84d9840fadc6abb134513dbab,"Fixed some stuff pertaining to xsl:import.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333129 13f79535-47bb-0310-9956-ffa450edef68"
86527113695dc225dd86bd2b480cbc614d8fe714,"Fixed some stuff mainly pertaining to xsl:import, but also the document() function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333130 13f79535-47bb-0310-9956-ffa450edef68"
0f12a5a17a4ed99f28e82cf15d0976a2f1a750f4,"Needed to support whitespace lists with xsl:import.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333131 13f79535-47bb-0310-9956-ffa450edef68"
40b46309c8ed3a888fb8663f21da6ca7faf883af,"Use getParent instead of getXMLReader, as per comments on TRaX list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333132 13f79535-47bb-0310-9956-ffa450edef68"
4d32212e66ae217cd6f3ec671ff3be7a713ebfbb,"Use Xerces URI class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333133 13f79535-47bb-0310-9956-ffa450edef68"
274f9e6759e1b2f2467a856a01d107e0c05b931d,"Remove references to java URL class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333134 13f79535-47bb-0310-9956-ffa450edef68"
b6c773bb70e331d34b73f43eae478952f41ef5e8,"Use getAbsoluteURI instead of getURLFromString.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333135 13f79535-47bb-0310-9956-ffa450edef68"
c0bee98d91700cdbe3f9d8bed471b2d596b9d538,"Use Strings instead of URL objects.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333136 13f79535-47bb-0310-9956-ffa450edef68"
a985b608653a0d0de7f8de8549c759a5a0aa4147,"Use SystemIDResolver instead of duplicated code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333137 13f79535-47bb-0310-9956-ffa450edef68"
83814b31ca2a9588a565e3a44a566e9cb2a4a210,"Use Strings instead of URLs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333138 13f79535-47bb-0310-9956-ffa450edef68"
e7e2b362beca795efec8d524c42b9e86d823b398,"Make extension functions basically work.  I haven't yet tried extension elements.  Implementation of LiveConnect style of Java method resolution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333139 13f79535-47bb-0310-9956-ffa450edef68"
7c2662c8df38fb855df6512aedbc8e17aca8c154,"Addition of MethodResolver.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333140 13f79535-47bb-0310-9956-ffa450edef68"
9ce28d6391e1401e5fa0d22770c7487f0c8ad249,"Moved XPath up a package to become a sibling of Xalan package.  XPath no longer directly uses the opcodes, but is 'compiled' into a fast expression tree.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333141 13f79535-47bb-0310-9956-ffa450edef68"
99c87d2e6a02fab4a7cd44bf6ace4df6ce6862a9,"Fixed <xsl:output indent=""yes""/>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333142 13f79535-47bb-0310-9956-ffa450edef68"
6a0453203ee4e0275d72294cc2f6aeaad2c9547c,"Removed <p/> at beginning so it shows up in the package summeries.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333143 13f79535-47bb-0310-9956-ffa450edef68"
bec2e07a1120df7dd555dd961e305ee3a546fae7,"Added package.html files, mainly for package summeries, also added a few missing stree files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333144 13f79535-47bb-0310-9956-ffa450edef68"
9b542b9637338dfa89c3420f03f8d35f77a4d7df,"Moved.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333145 13f79535-47bb-0310-9956-ffa450edef68"
ddce49cf60d9d5eef637d46bf6ea66bab9117d79,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333146 13f79535-47bb-0310-9956-ffa450edef68"
258683846e9cc451854cadd2f04af3c1f4c11398,"Ant build file with support for compile, jar, and javadoc targets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333147 13f79535-47bb-0310-9956-ffa450edef68"
476aa9caf3f00233dce4bb0f51b7c97d82211e4e,"Support for using Ant to build Xalan-J 2.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333148 13f79535-47bb-0310-9956-ffa450edef68"
cc1933bc0cc3614381c33505db20dbda076306a1,"Javadoc doclet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333149 13f79535-47bb-0310-9956-ffa450edef68"
3532652c02252d2c07e29f58f1100cf7938a1f7d,"Only allow for one context marker in the global space.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333150 13f79535-47bb-0310-9956-ffa450edef68"
5019ee7eb8864b3f235260f9d550db04299e5e34,"Load properties file


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333151 13f79535-47bb-0310-9956-ffa450edef68"
a6229243a6ef48576c2e3e3c1fdffd6feca19bd6,"Make methods getStylesheetRoot and getLocator public


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333152 13f79535-47bb-0310-9956-ffa450edef68"
f99a9b2449c285c26ec7898b93cfb2cc3b26aea5,"All examples except exampleUseAssociated now work in Xalan.  (Except the current examples use the Xerces serializers, instead of the TrAX API.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333153 13f79535-47bb-0310-9956-ffa450edef68"
bd1fd8623991292bfaf4db37ced7d960bf69cb8d,"Added loadPropertyFileToSystem(String file) for auto loading of properties file.  Need to come up with non-xalan location for file default location.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333154 13f79535-47bb-0310-9956-ffa450edef68"
a4e522b6a2e86221bb61f84ce4e96ebd6a7cd338,"Added loadPropertyFileToSystem(String file) for auto loading of properties file.  Need to come up with non-xalan location for file default location.  Began support for getAssociatedStylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333155 13f79535-47bb-0310-9956-ffa450edef68"
3f17f9462faba176f624817eabb9bd84c5dcbfa3,"For support of xml-stylesheet PI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333156 13f79535-47bb-0310-9956-ffa450edef68"
493236406aac145caaa2953f010832c4e4556e9c,"Moved setPreserveSpace(false); in setIndent(boolean) to setPreserveSpace(!on); in setIndenting( boolean on ).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333157 13f79535-47bb-0310-9956-ffa450edef68"
e4c7982a0c9ecfb2c96e28cb11d35c1141414674,"For cloned OutputFormat in getOutputFormat, use OutputFormatExtended so I can deal with that silly preserve space stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333158 13f79535-47bb-0310-9956-ffa450edef68"
df0bfff157f386003a67171bbc50e98fd3f9332f,"If a start element is found when no start document has occured, force a start document.  This is needed, for the moment, for those cases of chaining transforms when a start document event is not fired.  This should be fixed so that the transform creates the startDocument() event.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333159 13f79535-47bb-0310-9956-ffa450edef68"
f776010626b7e6c34142fde6a8aa82da93b50aa6,"Support getFeature for the TrAX features.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333160 13f79535-47bb-0310-9956-ffa450edef68"
e17e2bc2f6bca369a7cf07eff464b126a9096de6,"loadPropertyFileToSystem moved to TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333161 13f79535-47bb-0310-9956-ffa450edef68"
9eec023778e1f37d0e2dd9d02809df22f014bac3,"Added StylesheetPIHandler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333162 13f79535-47bb-0310-9956-ffa450edef68"
e92067aa68386653fd9ac626e614a835fc8ce4d4,"Begin cleaning up Xalan-J 2.x Ant makefile
Attempt to separate compile targets; up -mx memory temporarily
since we're compiling the whole tree at once...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333163 13f79535-47bb-0310-9956-ffa450edef68"
282ebe4cba02e1fba8178b49ffc7d483fc98be20,"More infrastructure for Xalan-J 2.0 doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333164 13f79535-47bb-0310-9956-ffa450edef68"
5f752c4bcf6bfa2afd6af2da3f308f671cd26c09,"Enable multi-threading of processor and transformer


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333165 13f79535-47bb-0310-9956-ffa450edef68"
4aff486417d3a0c4f325e2eae40630faf7822783,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333166 13f79535-47bb-0310-9956-ffa450edef68"
020bfc33648233e64d540d736897827dc6d9c9bd,"Derive from UnImplNode, delete read-only methods.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333167 13f79535-47bb-0310-9956-ffa450edef68"
4208f11582e93afddcdffc4f829f05ad8c4ab63f,"Add some Attr methods so DTMProxy can derive.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333168 13f79535-47bb-0310-9956-ffa450edef68"
a60b76f7f877eed6e08387080eb5c3e61e1af294,"Push and pop the template for TransformerClient support.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333169 13f79535-47bb-0310-9956-ffa450edef68"
bd2f06c9efd72007d2da6e6446ed1becc980093a,"Implement TransformerClient interface.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333170 13f79535-47bb-0310-9956-ffa450edef68"
7cf0f10a08ad11c6fd719ed55c8db88ee19a6969,"Test for TransformerClient, and call setTransformState if so.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333171 13f79535-47bb-0310-9956-ffa450edef68"
4e121e1299afc6363558fb975f7341fd70cf5df6,"Add TransformerClient and TransformState.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333172 13f79535-47bb-0310-9956-ffa450edef68"
4a3fad6f308e936c785436929932e5c7cb406e81,"Check in compatibility layer to xalan 1.x.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333173 13f79535-47bb-0310-9956-ffa450edef68"
ec70bfd3129e986009ceb04244e3da615e5e1e18,"Add an entry for whitespace in schema and fix extensionElementPrefixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333174 13f79535-47bb-0310-9956-ffa450edef68"
31d2605c37cf1380b1e69935b785923c6ca7ca0e,"xalan-j 2.0 sample app.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333175 13f79535-47bb-0310-9956-ffa450edef68"
803a6260174666f67f9b8c9124a699da1828deee,"xalan-j 2.0 sample app.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333176 13f79535-47bb-0310-9956-ffa450edef68"
d165f15ecfc0e169c73af4ceecebb164d1b16e8b,"xalan-j 2.0 sample app.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333177 13f79535-47bb-0310-9956-ffa450edef68"
94a9e97498ad965cd4221b25ee593cb01eb4d4b5,"xalan-j 2.0 sample app.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333178 13f79535-47bb-0310-9956-ffa450edef68"
7d46ec1c4d58b93d2c6b0de21c05258b859cf4a1,"Begin using Ant 1.1 released version; need excludesfile functionality


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333179 13f79535-47bb-0310-9956-ffa450edef68"
c89300a3341ed7a804c7eac5084f07a69331bd9c,"Fix test for number of parameters


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333180 13f79535-47bb-0310-9956-ffa450edef68"
2ca6b2202b886c68234bbcf0401a739232651c82,"Fix problem with the stylesheet locator stack. Was not being popped.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333181 13f79535-47bb-0310-9956-ffa450edef68"
80f1e249b9ae77ccdc6ee79121666d952596c3cf,"Add an entry in XSLTSchema for xsl attributes to be ignored in LRE output


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333182 13f79535-47bb-0310-9956-ffa450edef68"
7ade160a421f746803f5774fe89c221d53d57fab,"Checked in by accident!!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333183 13f79535-47bb-0310-9956-ffa450edef68"
62c02cd489e56ac8cae10742631de3595baa2927,"Fix exclude-result-prefixes for LREs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333184 13f79535-47bb-0310-9956-ffa450edef68"
ecc5bd2f46995f5c885092a118ae0a2dac4f7373,"In progress...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333185 13f79535-47bb-0310-9956-ffa450edef68"
3b31e21d50959ba575b5c5d66ef34b57add2892f,"No real changes, I think.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333186 13f79535-47bb-0310-9956-ffa450edef68"
6cf36eb32755ca84c796a5c552f5359b86fc1869,"Fixed bug where the argNum was not correctly passed to the extended class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333187 13f79535-47bb-0310-9956-ffa450edef68"
3f6806158711a5d9504a85dd8ba24c509f285eeb,"In progress... working on function overloading, and integration with ExtensionContext object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333188 13f79535-47bb-0310-9956-ffa450edef68"
3d6c8029a93b3f579537d0857f761dd77c007f7c,"Added constructor so Locator would be set.  Also, fix error handling bug.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333189 13f79535-47bb-0310-9956-ffa450edef68"
973c6f53e3c1b8b4b35b2d5c90e2dd78635c9c92,"Coment out LOCATIONPATHEX stuff, so no one will use it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333190 13f79535-47bb-0310-9956-ffa450edef68"
0ef3633b40a2353b99942e61506b1c5f1d757fa7,"Add getArgLength method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333191 13f79535-47bb-0310-9956-ffa450edef68"
e2c57fcdf61fe6c340a65f8f1a4308c21e2774cd,"Fix problem with variable not being handled right.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333192 13f79535-47bb-0310-9956-ffa450edef68"
020cf83022b4445be827d308dc78179ff02fdb25,"No real change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333193 13f79535-47bb-0310-9956-ffa450edef68"
d3f8d453b4d6c6542d9a2ba4d6cddd10d834473a,"Fixed error handling bugs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333194 13f79535-47bb-0310-9956-ffa450edef68"
87c7974d6f6ff57b43901b557fabc3c614398168,"Fixed javadoc comment.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333195 13f79535-47bb-0310-9956-ffa450edef68"
eece366da59e02d25ef3ff1752cc029f1f33c974,"Implement ExpressionContext.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333196 13f79535-47bb-0310-9956-ffa450edef68"
58305d6f471ae877c9e31df77ad0a4a9dd386a9f,"In progress.  Working on function overloading stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333197 13f79535-47bb-0310-9956-ffa450edef68"
a8ce318222985f1d028e0d0e4bdd3394f645ba4e,"Add to parent stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333198 13f79535-47bb-0310-9956-ffa450edef68"
7ebdf0b76a78004c39de68ce3aba67bb689beeb4,"No real changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333199 13f79535-47bb-0310-9956-ffa450edef68"
32e306cf774ed37b78c414ce3d0d4e848f4ea62d,"Try to make it possible to handle unparented nodes, at least to a point.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333200 13f79535-47bb-0310-9956-ffa450edef68"
7d6042b7ba044e401f60a60b315c42913ab43145,"Check for parent being null before getting the public and system ids.  Needed because they may be accessed before construction is complete.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333201 13f79535-47bb-0310-9956-ffa450edef68"
59f2fdf96ce9a7c30a3e1bb5091db512ccc91300,"Changed JavaDoc comment.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333202 13f79535-47bb-0310-9956-ffa450edef68"
e296bbadc807444e544bb5aa5b6bc91568f2b6fc,"Fixed error handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333203 13f79535-47bb-0310-9956-ffa450edef68"
4d334baae190b434b196fd97ef9644ae0d254b20,"Added ExpressionContext.java


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333204 13f79535-47bb-0310-9956-ffa450edef68"
1aa541562ba66a63a977d6e9a161bb0e42677a59,"Patch attributed to Gary L Peskin <garyp@firstech.com>, two DTMProxy objects compare equal if they
refer to the same node number in different documents (as can happen when
using the document() function).  This code corrects that problem.return


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333205 13f79535-47bb-0310-9956-ffa450edef68"
c6870e872a332eb70c8fc0d23fd58c7b8104ac7b,"Tweaked stuff enough so that function extensions seem to basicaly work.  Needs lots more work, and then testing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333206 13f79535-47bb-0310-9956-ffa450edef68"
2afca18e6883fcd6b62979cfb5d2ea7aaa8c3e59,"Put getLength method back! should not have been renamed!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333207 13f79535-47bb-0310-9956-ffa450edef68"
939429146e0815529b36f72dc83530caed9a2b40,"Back out the previous change


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333208 13f79535-47bb-0310-9956-ffa450edef68"
a76ebaf50dc5e759dce1868eb5949d75a255f4d2,"Allow one or two arguments in function document


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333209 13f79535-47bb-0310-9956-ffa450edef68"
67c963747f350bd0c1ef9f46c3acab8ed3cf22dd,"Use instruction template to create the xpath.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333210 13f79535-47bb-0310-9956-ffa450edef68"
8063f2d600eaa8a35d59f335ae25e6df1b04f60a,"Derive from UnImplNode, which fixes problem with missing hasAttributes method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333211 13f79535-47bb-0310-9956-ffa450edef68"
f97012fc35c5fca5273607c4d80d5d5408e80c8a,"Process xsl:extension-element-prefixes to create ElemExtensionCall instead of LRE.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333212 13f79535-47bb-0310-9956-ffa450edef68"
ec5b505eb40fc29ac90d71a7797e637b85124c62,"Add proper xsl:extension-element-prefixes property, same as in Stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333213 13f79535-47bb-0310-9956-ffa450edef68"
988acf2f6496611b1480e471b3b2cdb88029cb20,"Lazy processing of extension props.  More needed, I think.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333214 13f79535-47bb-0310-9956-ffa450edef68"
2c5491711ef2f695b5ac6c9eef79f1a986c5f99d,"Fix problems with calling extension elements, method overloading.  More work to come...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333215 13f79535-47bb-0310-9956-ffa450edef68"
b0345bd959b56ce9894c91d18e616278dc612da0,"Check for null locator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333216 13f79535-47bb-0310-9956-ffa450edef68"
ac8b7e32c75a7dcb93349168748ea1cab6ad527c,"Fixed bug with result fragments compare to string.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333217 13f79535-47bb-0310-9956-ffa450edef68"
16f92d1d021ef603ed9a9bcbf1b0462292b37a9e,"Fixed * handling so it matches namespaced elements and attributes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333218 13f79535-47bb-0310-9956-ffa450edef68"
c413410cf3c6d42638b65f3f728d71c454a9c451,"Pass qname to setAttributeNS instead of local name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333219 13f79535-47bb-0310-9956-ffa450edef68"
07df4a7f13ddbf0ed042b992d72f64ecb9732b13,"Add getOutputFormat, add executeChildTemplates varient that accepts a ContentHandler, for extension support.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333220 13f79535-47bb-0310-9956-ffa450edef68"
062a24feb05771333ae84c42933feebe740c66c4,"Check is attribute is null in getAttribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333221 13f79535-47bb-0310-9956-ffa450edef68"
74053dc26772244fdc8f08c872f9b84fc78950d7,"No real changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333222 13f79535-47bb-0310-9956-ffa450edef68"
7b85320f152c0ae99947be6776712599b6990042,"Fix bug when extension elements are non-static methods, by not setting isClass to true if class: is not present.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333223 13f79535-47bb-0310-9956-ffa450edef68"
6542ddba1188e43f7318403f21e7f2bab920695b,"Allow passing of RTFs as DocumentFragments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333224 13f79535-47bb-0310-9956-ffa450edef68"
b8e934416312d2ed3c55e0c3fad2a7cf9475ec83,"Implement what was commented out.  Should work OK now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333225 13f79535-47bb-0310-9956-ffa450edef68"
4211aadad0c689395651bfe1ad9eb7c221086037,"Fix generate-id() so that it works with DTM an so it uses hex string for negative values (attribution to ""Sergei S. Ivanov"" <ivanoff@aha.ru>).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333226 13f79535-47bb-0310-9956-ffa450edef68"
18cc6d334b624222c004a8caae381b1fb91d91a4,"Allow for default decimal-format declaration


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333227 13f79535-47bb-0310-9956-ffa450edef68"
69a06250723c1b7c3de518d29e96f8e12f6537d0,"Minor updates for Xalan-J 2.0- Ant build.xml
Added excludes files for compat.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333228 13f79535-47bb-0310-9956-ffa450edef68"
768f82738763555d0fb016a6a195618b8dcc4c2b,"Removed setProps, which is no longer needed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333229 13f79535-47bb-0310-9956-ffa450edef68"
3b07501b5b4b1cf39cb134c2315b5bcffdc249b9,"Xalan-J 2.0- Ant build.sh for UNIX-land


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333230 13f79535-47bb-0310-9956-ffa450edef68"
fe20381f0c7f54b43e558d6a4199fe4b668e18ba,"xalan-j 2.0 sample app.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333231 13f79535-47bb-0310-9956-ffa450edef68"
2583bb52cab3ae431459439cf742120ee38c258d,"Added workarounds for inability of applet to get trax, sax, and serializer system properties.
See newProcessorInstance() and transform().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333232 13f79535-47bb-0310-9956-ffa450edef68"
f6c84fa82ad9b4d94731d9a94a44aab2f0ccba54,"Turn on validation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333233 13f79535-47bb-0310-9956-ffa450edef68"
745f5f43c3a6a6347753d0967300ae833b1df6af,"1. Repackaged sample servlet as ""servlet"": makes build process
a lot more sensible.
2. samples/Servlet seems to have disappeared from repository,
so whatever has happened, have put into a new directory
named samples/servlet (lowercase) to match package name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333234 13f79535-47bb-0310-9956-ffa450edef68"
61c7f66a30cd174513c0b527de71910d633cb9b4,"1. Added support for building samples (xalansamples.jar and xalanservlet.jar)
2. Added preliminary support for building distribution.
3. Modified javadocs target to include private and protected API.
Will change back to public after alpha.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333235 13f79535-47bb-0310-9956-ffa450edef68"
0c3dc6e462a7a925face287923e40d74264b6c5a,"Xalan-j 2.0  sample extensions. not all working yet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333236 13f79535-47bb-0310-9956-ffa450edef68"
774eeea46fc6676e2cec8462ff95008845146914,"Added extensions to samples target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333237 13f79535-47bb-0310-9956-ffa450edef68"
8a95aeece885b0561f43482b44fdd954548241dd,"Fix construction of a URI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333238 13f79535-47bb-0310-9956-ffa450edef68"
15bfb5ac8fc4937d6d6333704a911d498c3148ad,"Back out the previous fix. The bug is somewhere else...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333239 13f79535-47bb-0310-9956-ffa450edef68"
b0e81bac004d67fef3d7202e613243673c53b885,"Major fixes for source tree caching, and fix for URL resolution.  Still a work in progress


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333240 13f79535-47bb-0310-9956-ffa450edef68"
e65dca916a9b07b85b9fb5a8bd85175987bf5aee,"Comment out debug diagnostics.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333241 13f79535-47bb-0310-9956-ffa450edef68"
170bd3306e935926bdd510fc47d86b062a67aae1,"Add the document to the cache... may be a temporary solution to the larger issue about which thread the parse should be on.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333242 13f79535-47bb-0310-9956-ffa450edef68"
6d3fb6b230e6f990258088fd65dff98780c57d88,"Make to work with new source tree manager stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333243 13f79535-47bb-0310-9956-ffa450edef68"
386282d2f8d09a690e766bbf27d9bbbed808dd0e,"Another take on URIResolver


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333244 13f79535-47bb-0310-9956-ffa450edef68"
921740f311900578f8ef8223ff040dd6ef1cfcfe,"Miscellaneous fixes for ID and key.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333245 13f79535-47bb-0310-9956-ffa450edef68"
9becf0eb5d835ab14e81b396da2baf748c547112,"Add StreeDOMBuilder


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333246 13f79535-47bb-0310-9956-ffa450edef68"
c37c60c8fdf3990eec32bbdc744beda14f7119ee,"Xalan SQL Library.  A work in progress, with limited ability.  Heavily under-commented.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333247 13f79535-47bb-0310-9956-ffa450edef68"
4dd95b85b8c49d98030d259ec6baeb1039efa958,"Minor changes for SQL extension library support... namely the addition of support of the NodeSetFilter interface.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333248 13f79535-47bb-0310-9956-ffa450edef68"
dbdeb0f995af077a77136e1e7d6bcbaa64907c67,"Change the order in which return values are processed, so that NodeIterators take precidence over Nodes, if the same object implements both interfaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333249 13f79535-47bb-0310-9956-ffa450edef68"
887711e0080353460c79d895b90128dd50d2837e,"Handle case (badly) when NodeIterator is not a ContextNodeList.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333250 13f79535-47bb-0310-9956-ffa450edef68"
315b7698ff4528ac26fc94e69c4b54063abe39b7,"Add accessors for namespace and local name, for support of extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333251 13f79535-47bb-0310-9956-ffa450edef68"
f66cd735063d51034c345bdded9c7ba23e7dfb49,"New interface allows a node to know the nodetest before getFirstChild and getNextSibling are called.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333252 13f79535-47bb-0310-9956-ffa450edef68"
a13876f42017ed299bb10074d70cc0b078ed0212,"Spit out some diagnostics to System.out for right now... better than nothing for the moment.  Needs to be fixed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333253 13f79535-47bb-0310-9956-ffa450edef68"
35fef5763fd73005602973bf2858b503b37b1472,"Add setEntityResolver.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333254 13f79535-47bb-0310-9956-ffa450edef68"
55ff33dc001bfbcf89a88aed52a8416b493b90d2,"Check for ClassCastExceptions, and delegate to superclass if they occur.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333255 13f79535-47bb-0310-9956-ffa450edef68"
33d4eb7b1b3b02229a809429f40c7a48b88a3053,"Check for EmptyStackException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333256 13f79535-47bb-0310-9956-ffa450edef68"
947537fd96fde02673cdb1aa0c919ee72cf1a8d7,"Check for zero args.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333257 13f79535-47bb-0310-9956-ffa450edef68"
35879d6ee45ff3d1b5774dfa719d879401049625,"Added files for sql extension.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333258 13f79535-47bb-0310-9956-ffa450edef68"
5f6fc043eb4984d4fce7b64bf5e260c8ef007cab,"Segregated samples and servlet so can build samples without worrying
about additional classpath requirements for servlet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333259 13f79535-47bb-0310-9956-ffa450edef68"
a3950323646f1668ed3f11c5ac90a6b7fda7e003,"Fixes that bring this example closer to working.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333260 13f79535-47bb-0310-9956-ffa450edef68"
fd4de70927c14b46307c07bfdd17afe3b6e19923,"Fix ancestor match pattern processing


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333261 13f79535-47bb-0310-9956-ffa450edef68"
77025dfad08f61b277358662811295ebc1f8919f,"Don't do URL absolutization... wait to see if the EntityResolver wants to do it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333262 13f79535-47bb-0310-9956-ffa450edef68"
8b684d40764b78e9e844b6ce6e46326162a13379,"Add processFromNode(Node node, String systemID) function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333263 13f79535-47bb-0310-9956-ffa450edef68"
8c0e6d8c6613be2d2f89b81f666d8130ca61d48b,"If we're processing from a DOM tree, the Locator will be null... so create a dummy locator to make folks happy.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333264 13f79535-47bb-0310-9956-ffa450edef68"
2d092162c40ca04ebc3758ec449bd2be6ad13fd7,"Use URLResolver and Entity resolver in parse.  Bottleneck parsing for both xsl:import and xsl:include.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333265 13f79535-47bb-0310-9956-ffa450edef68"
9487a31bc48b94ecd2dcb036135ec949b5fe85d5,"Defensive check for null locator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333266 13f79535-47bb-0310-9956-ffa450edef68"
3dc1f365ebc72d900690c4be10b57f9aafc56504,"Use DOMHelper to process namespaced attributes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333267 13f79535-47bb-0310-9956-ffa450edef68"
87377ffc58e095744c890ab7d9f753a3316f5f68,"Use DOMHelper to process namespaced elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333268 13f79535-47bb-0310-9956-ffa450edef68"
359027e6645762ef98b9bd6086422388dbf92ee6,"Get rid of duplicate xml source used for 2 examples


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333269 13f79535-47bb-0310-9956-ffa450edef68"
751ed339efeecaa32545976b01997b2ebbf56b39,"Add processFromNode(Node node, String systemID)
, also set/getEntityResolver.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333270 13f79535-47bb-0310-9956-ffa450edef68"
7673e0037d6a9ebd39b712fc85646a05410bc189,"For exampleDOM2DOM, use processFromNode to create stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333271 13f79535-47bb-0310-9956-ffa450edef68"
8a9992f4739c341c14384cb6aabc92ed30536af8,"Changed 2nd arg for sample extension elements to generic
ogr.w3c.dom.Element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333272 13f79535-47bb-0310-9956-ffa450edef68"
8fecd1b15a8f3cde39396da918ca585802ea9e32,"Initialize character array if necessary


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333273 13f79535-47bb-0310-9956-ffa450edef68"
0d98fc3858aca12d997d00fecbe09222eb8f7d2b,"This is as a result of previous fix. They should be checked out together.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333274 13f79535-47bb-0310-9956-ffa450edef68"
f4387a6595d7874004dda3d1700999c3ea552aa4,"Added the ability to get the originating node from a ElemTemplateElement, if the stylesheet was created via a DOM.  For tooling support.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333275 13f79535-47bb-0310-9956-ffa450edef68"
cb14ff5b5c5e9182e05e7c2e9f20662e5bbc58f9,"Some editorial cleanup.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333276 13f79535-47bb-0310-9956-ffa450edef68"
61d237c5027e3a7e29ca2add46245081d422aaa3,"Reversed the incorrect isAssignableFrom expressions -- left/right problem, probably caused by dyslexia.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333277 13f79535-47bb-0310-9956-ffa450edef68"
6126331c051c41a7b5111478d231bc49b453c1d9,"Fix for getAttribute in ElemExtensionCall.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333278 13f79535-47bb-0310-9956-ffa450edef68"
7a9699d1799beb8f47065959da76d3fa87054678,"Fixed servlet target to create destination dir before trying to put
output there.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333279 13f79535-47bb-0310-9956-ffa450edef68"
4bb7cd5917e811f85b30f56de9c09019ba7a0c23,"1. Modified DefaultApplyXSLTProperties to use 1.1 API
  ( i.e.,  not the require 1.2)
2. Updated ApplyXSLTListener to extend xalan 2 DefaultErrorHandler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333280 13f79535-47bb-0310-9956-ffa450edef68"
538acb2373c30b1571af799e79c97c4d3dce3b81,"Fix misc. typos, fix warning, fix misc stuff related with recomposing imported and included stylesheets, fix getting URI for imported/included stylesheets


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333281 13f79535-47bb-0310-9956-ffa450edef68"
353463bf27b784f5fd62b26f29392fbb56624c08,"Implement NamedNodeMap and getAttributes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333282 13f79535-47bb-0310-9956-ffa450edef68"
49964a2f7f1974582a48cb19c55a2c05b36a36db,"Use transform() instead of transformNode() to perform transformation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333283 13f79535-47bb-0310-9956-ffa450edef68"
4991d67b4e7693681bc87b0c6a7e82e7ca3c3b6f,"Reverse the order of the parse thread vs. the transform thread... the transform thread needs to be the main thread, and the parse needs to be the child thread.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333284 13f79535-47bb-0310-9956-ffa450edef68"
5a2a1dac1c20ef2692ed37f656f9afa453ecd20c,"If getContentType)( returns null, set ContentType to ""text/html""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333285 13f79535-47bb-0310-9956-ffa450edef68"
1a354f84461c274ab532456bb4f48e959ea0bf73,"improved getContentType() to use output method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333286 13f79535-47bb-0310-9956-ffa450edef68"
0862fbbe4230f2890e91ac08d39c600d939773c5,"For ""text"" output method, set ContentType to ""text/plain""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333287 13f79535-47bb-0310-9956-ffa450edef68"
4997f42cce0ddea6d8f0225a48d55beba0b66368,"Miscellaneous fixes for imported and included stylesheets, xsl-applyImport and xsl-applyTemplate


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333288 13f79535-47bb-0310-9956-ffa450edef68"
825641ecff844b2bcf4ea9e12af6bdf4b53d8e10,"Fixed incremental rendering for the sql extension.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333289 13f79535-47bb-0310-9956-ffa450edef68"
714d309d634242d1dab12d61c5dac9ce364efbda,"Implement method getLocalName()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333290 13f79535-47bb-0310-9956-ffa450edef68"
384235c0f2116498ad852ca18b9a6f9d79a89419,"Added DOMOrder and NodeConsumer


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333291 13f79535-47bb-0310-9956-ffa450edef68"
128bc6a6c9c6b7f9ac62b95aa09a3a3796d9d931,"Fixed problems with ResultTreeFragment traversal, ResultTreeFrag is now derived from StreeDOMHelper.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333292 13f79535-47bb-0310-9956-ffa450edef68"
1172fcbd6ab377a7b3317237592d84d1cbf0f785,"Create a vector for namespace aliases.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333293 13f79535-47bb-0310-9956-ffa450edef68"
8515621c41ee52730c59a6f3118274a4261a1606,"Set context node before sorting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333294 13f79535-47bb-0310-9956-ffa450edef68"
ea104356eb37751ed326fe3c0d7e2fd1d74dabbf,"I am actually checking in code to check for a null array of iterators. But found some other code that Scott must have written on my machine, I don't remember what it was for, but I'll check it in as well.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333295 13f79535-47bb-0310-9956-ffa450edef68"
a97e2d91969df4bc84b0f5c64e90729a64a263f3,"When primary sort key fails, do not sort on secondary


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333296 13f79535-47bb-0310-9956-ffa450edef68"
0384af4b507b8a7b659e5d833bd076ced413ce2e,"Checking this in for Joe Kesselman: Fix for EntityRefs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333297 13f79535-47bb-0310-9956-ffa450edef68"
4c312f2e1ce91336ecb4f803e0fed660a467b1d6,"Fix ant.home property (bindir should be below it)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333298 13f79535-47bb-0310-9956-ffa450edef68"
c5694f385eae0a23be3c2ac757579eff3114e3cf,"Added autodist target for use by automated build processes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333299 13f79535-47bb-0310-9956-ffa450edef68"
dc80c0faf1dc550139e1739498171f00bbcef2fe,"Need to handle nodes from different documents differently


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333300 13f79535-47bb-0310-9956-ffa450edef68"
16d50142e59f5ae0c477bff3720c2b478d011c50,"Error message for empty nodeset


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333301 13f79535-47bb-0310-9956-ffa450edef68"
8e47e8b7114ea04778e80d2b90b984d9f1826777,"Handle empty nodeset as second argument of document function


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333302 13f79535-47bb-0310-9956-ffa450edef68"
e1ebad64df79c5eaae116acf1b841a9e0c8a3cec,"Error if have an AVT in select attribute of xsl:sort.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333303 13f79535-47bb-0310-9956-ffa450edef68"
ebea3f69dce3fe4c59a90e8cd02a88586b3422a6,"writeslot addressing


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333304 13f79535-47bb-0310-9956-ffa450edef68"
d6ae126fabc53625a4616fd54184c8b087edaa5f,"Catch invalid attribute values for xsl:sort


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333305 13f79535-47bb-0310-9956-ffa450edef68"
ce607318f09da058f0e2004688d90e2e2700de07,"Now works without requiring DOM input.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333306 13f79535-47bb-0310-9956-ffa450edef68"
989327349604f1d7efe65e5015fee5a06ed3af16,"SAX2SAX sample


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333307 13f79535-47bb-0310-9956-ffa450edef68"
7762c9053474b28a1424218e686043f5bffb7e6b,"Added compiling of SAX2SAX sample


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333308 13f79535-47bb-0310-9956-ffa450edef68"
3deaca5a451feee399508218d8b26fcbd992e66e,"1st draft


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333309 13f79535-47bb-0310-9956-ffa450edef68"
a4cfbccbb92b1a68a592cb61fc7a76770dfdaea0,"doc infrastructure files


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333310 13f79535-47bb-0310-9956-ffa450edef68"
705f412e06088ae30814677e4d9458a9e25a4b9c,"doc infrastructure dtds and stylesheets from xml-site.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333311 13f79535-47bb-0310-9956-ffa450edef68"
4e9cec40d71c74e76bfe2cd818f3f87effd4307a,"Set default values for Infinity and NaN for formatNumber


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333312 13f79535-47bb-0310-9956-ffa450edef68"
cee0229a3e1d7123cc316ddfe624308a51a584fe,"Apply attribute sets from imported stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333313 13f79535-47bb-0310-9956-ffa450edef68"
a9b908399411afeec46169a1f7afb22a7a807caf,"partial 1st drafts


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333314 13f79535-47bb-0310-9956-ffa450edef68"
b7c3416596b3a694a8abfd46f8d29525bf5a4db7,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333315 13f79535-47bb-0310-9956-ffa450edef68"
6642fc80c1649bb839ac1eab9806fa7797ded55c,"Don't ignore invalid xsl elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333316 13f79535-47bb-0310-9956-ffa450edef68"
73470b53d200c39971383f63f94c38fd4ffe716e,"Make sure required attributes are defined


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333317 13f79535-47bb-0310-9956-ffa450edef68"
65350833590df2e3d61be1fd63185c9b66be6f64,"Error if have two templates with same name and import precedence


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333318 13f79535-47bb-0310-9956-ffa450edef68"
2281d3246b947a1f4bcb0e7b29347e0b37c3ab55,"Allow LREs in a stylesheet element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333319 13f79535-47bb-0310-9956-ffa450edef68"
f439aad44b2a137d7c7b4a6dd719e99bc83f8153,"Always call getSourceTreeHandler.Characters(...)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333320 13f79535-47bb-0310-9956-ffa450edef68"
facbec58f42993734e25d5612c3aa36d312f2fb4,"Check for null attribute and improve performance


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333321 13f79535-47bb-0310-9956-ffa450edef68"
473404da2ef60a9a82b75c79dd821dc7b28d2b5f,"Error if have two templates with same name and import precedence


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333322 13f79535-47bb-0310-9956-ffa450edef68"
d638ff6bc8c94bad7f752e958fd05fb9897afbc1,"Check for null stylesheet root


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333323 13f79535-47bb-0310-9956-ffa450edef68"
3025c70aafecbc9cca98d799e83ea78efab606b5,"Update/create all targets needed for basic Xalan-J 2.x builds


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333324 13f79535-47bb-0310-9956-ffa450edef68"
3d2830d8ebe02f95bd6804e415dcf6a8ce38b565,"allow xsl:param in LREs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333325 13f79535-47bb-0310-9956-ffa450edef68"
ee4264e83b37a9b7dcf285324521f9449e6005fd,"Initialize m_firstWalker


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333326 13f79535-47bb-0310-9956-ffa450edef68"
6744e23782656a573401aa1ee0841ab00511f635,"Typo: wrong class name


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333327 13f79535-47bb-0310-9956-ffa450edef68"
73ac42a3379b6c1b5122ec998692cd0f45efcf6c,"Editorial updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333328 13f79535-47bb-0310-9956-ffa450edef68"
ce9eb74f504b76744c241f8e26244b3ac4b96fa9,"Added support for including Scott's TRaX ""Patterns Design"" in
the Javadoc (transform patterns.xml and copy trax.gif).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333329 13f79535-47bb-0310-9956-ffa450edef68"
cdd1cecdd3d4009c580d6e6546d3116cae98a99b,"Added support for including Scott's TRaX ""Patterns Design"" in
the Javadoc (transform patterns.xml and copy trax.gif).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333330 13f79535-47bb-0310-9956-ffa450edef68"
0842a490cd25b84734b3acaa258099652b7acbd1,"Updated contents of xalanonly-styledocs (not to be purged in a ""clean"").


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333331 13f79535-47bb-0310-9956-ffa450edef68"
678b7aa6aed42b98a172e456ad19d4fdc890d00a,"Editorial updates for javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333332 13f79535-47bb-0310-9956-ffa450edef68"
371e5a22513237a9933140ac1dc6cf2992de26e7,"Editorial updates for javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333333 13f79535-47bb-0310-9956-ffa450edef68"
8ea097fd197390cd5fce68a828de9b74ce7863f9,"Editorial updates for javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333334 13f79535-47bb-0310-9956-ffa450edef68"
01aed3820b915eeae4010e9fa62fe5262f85f2f1,"In createDocument, use the JAVA API for XML Parsing 1.0 to
create a DOM Document node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333335 13f79535-47bb-0310-9956-ffa450edef68"
e5732bea306788de1d2ae283fd938bfd54e4adc6,"Don't implement StreeDOMHelper.createDocument, use super's method instead (experemental).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333336 13f79535-47bb-0310-9956-ffa450edef68"
f0182e671eead41c272f862cbc9eca5188be558c,"Implement getOwnerDocument.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333337 13f79535-47bb-0310-9956-ffa450edef68"
f6586b52a28a27725df649d96de4003bca1c9f2a,"Use DocumentBuilder and plain old DocumentFragment for the RTF, in transformToRTF.  I don't think ResultTreeFrag is used anymore...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333338 13f79535-47bb-0310-9956-ffa450edef68"
d7da1fd5002f6ad7028041aa6a14bf2080970d0e,"Stylebook that works with Xalan-J 2.
Only change: Xalan2Processor replaces XalanProcessor in the
org.apache.stylebook.processor package.
Compiled with Xalan-J-2 (including TRaX) and current Xerces-J
(including javax.xml.parsers) on the classpath.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333339 13f79535-47bb-0310-9956-ffa450edef68"
ced16c212667a0473dded779f5d221cd7d0102e6,"Revised build docs to work with a new version of Stylebook
that uses Xalan-J 2. The new Stylebook jar is
stylebook-1.0-b3_xalan-2.jar
and it is in xml-xalan/java/bin.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333340 13f79535-47bb-0310-9956-ffa450edef68"
4a9116a3ee3b3ed15ed6d14862105be1d66b6942,"Fix problem with a match pattern like id()//node() and for document('a',/)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333341 13f79535-47bb-0310-9956-ffa450edef68"
0ecd54e5fa7abf3c45631ca70f55164cb43cd4e1,"Editorial updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333342 13f79535-47bb-0310-9956-ffa450edef68"
87cd1bd8ee18d6fe970550da1f982c3058f21657,"May need to wait for endDocument before we can get element by id


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333343 13f79535-47bb-0310-9956-ffa450edef68"
de6531f0a028c6e70c43389d34fe23489380f350,"Fix wild card matches and scores of match patterns with a predicate


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333344 13f79535-47bb-0310-9956-ffa450edef68"
6c799a51e54a94b40fb3c289e31b5b230554563e,"docs target -- look for xalan.jar in ./build


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333345 13f79535-47bb-0310-9956-ffa450edef68"
58a26d0bcb0fa5512b8e5db40314bd2d7fc603c3,"Make sure attribute nodes are not matching node() for match patterns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333346 13f79535-47bb-0310-9956-ffa450edef68"
73f668bbbccf326ca16ea9eb907e5d77e6bd75eb,"Back out last change. Checked in by accident...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333347 13f79535-47bb-0310-9956-ffa450edef68"
46d318c62087d3caed1194a6bdb8d0d37bf1e051,"rellatively complete 1st draft for xalan-j 2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333348 13f79535-47bb-0310-9956-ffa450edef68"
d8ed43988ae3b0353a3b46128d89714e65977a26,"Editorial updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333349 13f79535-47bb-0310-9956-ffa450edef68"
f5569b33d850262fe1b77c6b8c1d91e8befad646,"Make resource bundle thread safe.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333350 13f79535-47bb-0310-9956-ffa450edef68"
cdf39aeb4f7163646145ac6e75e196e9bf2bd147,"Make resource bundle thread safe.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333351 13f79535-47bb-0310-9956-ffa450edef68"
b1a0ba7201cb095709201e2fcb5805ff20129bfb,"ApplyXPath ported from Xalan-Java 1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333352 13f79535-47bb-0310-9956-ffa450edef68"
5814ba3314fe75fb6c2bbdd77ffbd8e4e4ad1129,"conditionaly serialize XPath result.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333353 13f79535-47bb-0310-9956-ffa450edef68"
5d8eae514f43e66b1ff6a10402e46208adb09423,"Added apache license


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333354 13f79535-47bb-0310-9956-ffa450edef68"
a2d0a03e729d0b7d5b5fae20e002514275ec0097,"Added AppplyXPath sample to samples target


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333355 13f79535-47bb-0310-9956-ffa450edef68"
4e758ed8318aede9f33cbfadf2aef428b62345f2,"Added introductory info on XPathAPI and the ApplyXPath sample.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333356 13f79535-47bb-0310-9956-ffa450edef68"
73ab4e7780fa23dc412b43419e97bc863bd103b3,"synthetic.Class: IBM-developed ""reverse reflection"" wrappers,
used in the compiled-Template experiment. These are
also experimental and are known to have some holes, and
for the simple compilations now being attempted they don't
have huge advantages over generating directly into a stringbuffer,
but I had 'em on hand and we've been planning to publish 'em anyway.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333357 13f79535-47bb-0310-9956-ffa450edef68"
6e483cd1dcc9113989cfacbb9994c8158f35eade,"synthetic.Class: IBM-developed reverse-reflection experiment, used in the compiled-Template experiment.
Incomplete but I had 'em on hand and have been meaning to publish anyway.
Arguably overkill for current compilation code, but may simplify later work.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333358 13f79535-47bb-0310-9956-ffa450edef68"
e5abcdb795d9015fbd13a181b0936014f098c609,"Just the start of an experiment in compiling stylesheets to Java.
Only handles ElemTemplate and ElemLiteralElement at this time;
other nodes continue to run interpreted. Generated code is
not yet efficient, nor serializable, nor (sigh) reeentrant; working
on all those issues. Currently relies on a routine in BSF to invoke
the Java compiler; we should probably adopt that into
synthetic.Class.

To try it out, change the trax.processor.xslt to
org.apache.xalan.processor.CompiledStylesheetProcessor

It does pass our regression tests; the only known differences are
in attribute order.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333359 13f79535-47bb-0310-9956-ffa450edef68"
0f57c9713ed827ec1bd216de89080c15e075ea16,"Fixed known reentrancy problem; CompiledTemplates should now be runnable in multiple threads.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333360 13f79535-47bb-0310-9956-ffa450edef68"
48356793cfcbec8a217aa5cc4b1818cf21759e6d,"(Minor cleanup)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333361 13f79535-47bb-0310-9956-ffa450edef68"
12edccf30d0b1d2a55b1f423eb5495b329b3e601,"1. Added XConnection constructors so can use any of DriverManager
getConnection() methods: just a dbURL, dbURL with protocol,
dbURL with userID and password.
2. Updated the Javadoc comments and added a package-level doc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333362 13f79535-47bb-0310-9956-ffa450edef68"
b6cb97d4572f767d0eeb96efe2d138c19fa9e758,"New bsf.jar replaces old bsf.jar and bsfengine.jar -- and works
with Rhino 1.5 js.jar for Javascript extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333363 13f79535-47bb-0310-9956-ffa450edef68"
60e1be0634257c79248073de93e5c4002ac3c021,"Make getStringType method protected to make it visible for biuilding error messages


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333364 13f79535-47bb-0310-9956-ffa450edef68"
de426240b6dbe00cecd27f231d94d11e68478fb4,"Try to fix problem with text nodes being output on the root


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333365 13f79535-47bb-0310-9956-ffa450edef68"
0b70ecec7060a2f49f7cc5a92a362ca13ebbe0d2,"New processor version


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333366 13f79535-47bb-0310-9956-ffa450edef68"
d9b76dc7d43df53fb34f10ffa371da12df029ecf,"Submitted by: Gary L Peskin <garyp@firstech.com>
Reviewed by: Scott Boag
Gary cleaned up the code a bit and added
some short comments to explain the various fields.  Also, he renamed
m_mustFlushStartDoc, which made no sense to him, to m_haveDocContent.  He
ended up pulling out the newly added code which wasn't necessary and
moved some code around to where it made more sense and also worked
correctly in all cases.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333367 13f79535-47bb-0310-9956-ffa450edef68"
0c4b3037efaa95ef8b6eeb02b6c066248d0f8432,"Fixed bad headers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333368 13f79535-47bb-0310-9956-ffa450edef68"
3a4ae5504ac4608bebffe09c492b7863e21eec05,"Use hasChildNode instead of getChildCount in getFirstChild. Better for MultiThreading.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333369 13f79535-47bb-0310-9956-ffa450edef68"
f5576eb04905dedd1bb2ae756a59d559e2e0b91d,"Allow processing of all key declarations at once.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333370 13f79535-47bb-0310-9956-ffa450edef68"
848cedfd423f8e4b93d1c736b93f50bca86106fb,"Disallow recursive key calls


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333371 13f79535-47bb-0310-9956-ffa450edef68"
2e729e4b9dc5a131ef9e823cd37f179a6fa53c8b,"Make sure we math nodes on wildcard pattern


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333372 13f79535-47bb-0310-9956-ffa450edef68"
b5fad850a8039613a1e3070d1f973108a078397e,"Rewrote Pipe to show series of transformations with each
Transformer functioning as ContentHandler for previous
Transformer in the series. Moved what was Pipe to
Use XMLFilters


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333373 13f79535-47bb-0310-9956-ffa450edef68"
ee40408e194e2734e69b6998261a2521a2a13b7c,"What used to be ""Pipe."" Rewrote Pipe to show series of transformations with each
Transformer functioning as ContentHandler for previous
Transformer in the series.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333374 13f79535-47bb-0310-9956-ffa450edef68"
bb338bac9ea59f546f75fce37a09059e9981814a,"Fix references to old packagename


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333375 13f79535-47bb-0310-9956-ffa450edef68"
86832dc010cbb216ad0c24a79add5845dad8b1b4,"Latest BSF jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333376 13f79535-47bb-0310-9956-ffa450edef68"
632acebc4486c6265fe89e30ca62b847f3cb2b87,"Changed com.ibm.bsf to com.ibm.cs for latest BSF jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333377 13f79535-47bb-0310-9956-ffa450edef68"
ec0ef3b40a2474ef12c916f95ddec2879cfcb58e,"Added Joe's compiler and synthetic classes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333378 13f79535-47bb-0310-9956-ffa450edef68"
a9eb26ca729eceef74baee34abdfd4af951c99ca,"Node-set extension functions: intersection, difference, distinct,
and hasSameNodes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333379 13f79535-47bb-0310-9956-ffa450edef68"
403d05e3a5696c2205daae1562647b66950ac9d5,"Fix threading problem for elements with attributes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333380 13f79535-47bb-0310-9956-ffa450edef68"
6e2efa8ba40a368231fda8238c8a7f81bdbccc1e,"OOps! Forgot to change this back!!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333381 13f79535-47bb-0310-9956-ffa450edef68"
d19b24a6707277ed4b054d28b433b07c69ba772e,"Work in progress for Xalan-J 2 alpha release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333382 13f79535-47bb-0310-9956-ffa450edef68"
4ea466c96a4d578cc9dc865ce5d4724b71701972,"Changing this to avoid calling getAttrCount recursively


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333383 13f79535-47bb-0310-9956-ffa450edef68"
fa30f99bf462cf703b83d4c1f78b932e2bf70226,"Make sure we don't match root and attribute nodes for wildcard match patterns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333384 13f79535-47bb-0310-9956-ffa450edef68"
b7f24883e1de3e9d9d34849a7dcb6a87c1ac97d1,"A root match has a score of 0.5


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333385 13f79535-47bb-0310-9956-ffa450edef68"
04bf4d8f766aebb4453a4c8b2d49be9f659c70fe,"Ignore invalid attributes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333386 13f79535-47bb-0310-9956-ffa450edef68"
60028fda8b652dffaf08b392f32909f3538d3a0a,"Removed white space nodes to get around a problem Stylebook
is having. When it scans ""book"" for ""external"" elements, once
to generate .jpg files, the other time to generate img refs, it counts
the whitespace nodes differently (position() retrurns a different
value).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333387 13f79535-47bb-0310-9956-ffa450edef68"
0a59c863c802607a229820e928e851db21b9d055,"Removed Xerces dependencies, in prep for Xerces2.
    Use JAXP for DOM parser.
    For now, duplicated Xerces URI code.
    Created org.apache.xml.serialize.transition package
       (See note to xalan-dev list.  This involves serialize.* interfaceing, whitespace handling mods, more...)
Fixed tracking of whitespace stripping.
Fixed interfacing to serializers for bypassing escaping.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333388 13f79535-47bb-0310-9956-ffa450edef68"
20a9893b1b9e58fa9f1d69ec914a473de1f88f2c,"Check for ""key("" as opposed to just ""key""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333389 13f79535-47bb-0310-9956-ffa450edef68"
4866d1c0b9c0d42a87cf0629f3e7df011dcbadfb,"Use full name when creating element


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333390 13f79535-47bb-0310-9956-ffa450edef68"
5434a032f1e32cc644e3a3332eb8ba843ad786f9,"start element before processing namespace attribute


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333391 13f79535-47bb-0310-9956-ffa450edef68"
e647bd2b80d9c1b1d85873dc937d4d9e4ca33064,"Make sure waiting queue of walkers is cleared during a reset


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333392 13f79535-47bb-0310-9956-ffa450edef68"
c6403f44eaaf5913b764b3b92ed84cf7eb2c36cc,"Return the actual prefix, not xmlns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333393 13f79535-47bb-0310-9956-ffa450edef68"
be80b57ab3ac37623c5f6fe5d35619c9638d14d2,"Removed DTM refs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333394 13f79535-47bb-0310-9956-ffa450edef68"
ee0e0563699e9a4b4ef3d36d403125d65bce4f38,"Needed for HTML serialization.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333395 13f79535-47bb-0310-9956-ffa450edef68"
1d0ccff9e5a446a37e2e0c4c49eac0cf3b4f21ce,"Useful comment


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333396 13f79535-47bb-0310-9956-ffa450edef68"
0ec7831a94b9b54be95a95ce433babf5860ec483,"Added serializer, sax, dom, jaxp to javadoc and added targets for
compiling those packages.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333397 13f79535-47bb-0310-9956-ffa450edef68"
22db08a791282a023f3a80761e638e54e2b03f0a,"Hmm... this should have been in last night...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333398 13f79535-47bb-0310-9956-ffa450edef68"
4abbba20b660ff2735deb4acd354dcef9fe9544d,"Added a (non-xslt) property for the indent amount.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333399 13f79535-47bb-0310-9956-ffa450edef68"
0e0c911e2e8b49f6906ffe1b13c826590b873369,"Added accessors for the Writer and OutputStream.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333400 13f79535-47bb-0310-9956-ffa450edef68"
1c5a063156ba0be1866111318306213e713cc490,"jview doesn't seem to like SerializerFactory.class.getClassLoader().loadClass, so I just do Class.forName instead.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333401 13f79535-47bb-0310-9956-ffa450edef68"
3bfa920b2b0fc523e6858fb8af68d6bb5f6d2a76,"Mainly changes for linefeed normalization.  Pretty ugly... I need to come back and revisit these, and probably put them at a higher level.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333402 13f79535-47bb-0310-9956-ffa450edef68"
5038856d72c048b903afb528d674b6a96d272a8a,"Fixes for Literal Result Element as Stylesheet, and for general HTML handling and defaults.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333403 13f79535-47bb-0310-9956-ffa450edef68"
5647fbfd838f32fa3c8a3630ab2651ac905e20b0,"Ongoing work for extensions, esp. the component/script elements.  Not done yet.  Also, fixed problem with class loading in jview in the serialize package.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333404 13f79535-47bb-0310-9956-ffa450edef68"
24cdc4ca0cdbc7cffcd01146b31c4bd94ab409b0,"Addition of classes to process extension decls.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333405 13f79535-47bb-0310-9956-ffa450edef68"
294431132e51fddd9c6080e896e5942e1f8bd7b1,"remove final object


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333406 13f79535-47bb-0310-9956-ffa450edef68"
0c058987e29ae61ea9a7a0aa06842912235d42f8,"Added org.apache.xml.serialize.transition to compile.serialize and javadocs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333407 13f79535-47bb-0310-9956-ffa450edef68"
eb7e384bd0653c66414a890a5caf84aaec61ee85,"Added org.apache.xml.serializeRemoved target using xalan-j 1 for docs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333408 13f79535-47bb-0310-9956-ffa450edef68"
df3ee740fc8ddd5e50eaffc1600a18f0c5fb4dae,"Java extension functions and elements, including component\script, should now have basic functionality... more to do.  Also, put defensive code in ResultTreeHandler flush pending, when switching serializers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333409 13f79535-47bb-0310-9956-ffa450edef68"
eed0cd16b8b393f64e0b78c2c7aed86639a17ae3,"Added additional defensive code in flushPending for null outputStream.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333410 13f79535-47bb-0310-9956-ffa450edef68"
dc51fcf27500136dc610e31fa49a716f442fc41b,"Updated to use new serializer packages in xml-xalan tree.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333411 13f79535-47bb-0310-9956-ffa450edef68"
42f6106c15fc76938d5d8bc73179405f34baa8a7,"Fix namespace processing. Make sure parents are processed first and that an element's namespace is ouput.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333412 13f79535-47bb-0310-9956-ffa450edef68"
253d72678e9a32248db91b05d2a7face9e154a30,"Fix namespace processing. Make sure parents' prefixes are processed first


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333413 13f79535-47bb-0310-9956-ffa450edef68"
96da06b45f153e36d591eedcfebdd2e0bb9830a6,"Make sure default namespace is recognized in excluded prefixes list


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333414 13f79535-47bb-0310-9956-ffa450edef68"
3149432278161735484fc6eb862e64c2bfbf6a0a,"Do number formatting here instead of using java.text.DecimalFormat


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333415 13f79535-47bb-0310-9956-ffa450edef68"
21710a24f90d8e8e81024320a9ac2e163ebdf6c0,"Removed some options that don't make sense for Xalan2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333416 13f79535-47bb-0310-9956-ffa450edef68"
84e82a5f6f43736e9c779552b991101945eca792,"Removed org.apache.xalan.xslt and org.apache.xalan.xpath
from javadocs target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333417 13f79535-47bb-0310-9956-ffa450edef68"
e1f8e2f7ab9f898fa828f4dd619288a8d940d9db,"Make sure we issue error messages!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333418 13f79535-47bb-0310-9956-ffa450edef68"
93873bd8335b92274a2536cabf09d3d801ba5c13,"The extension mechanism should be working relativly OK now.  Also provide NodeSet conversion for iterators and RTFs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333419 13f79535-47bb-0310-9956-ffa450edef68"
1510487417c97546aebf08b58a783d243391d387,"C;leanup -- removed SimpleRedirect since makes more sense to run
with org.apache.xalan.xslt.Process (like the other extension samples).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333420 13f79535-47bb-0310-9956-ffa450edef68"
6cab5b5bc9c9e743cd31f6343f11522b2d81511c,"Cleanup


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333421 13f79535-47bb-0310-9956-ffa450edef68"
34f4d184e7e423ca56414b4e23eee5e4862bc03c,"Removed the stack trace in loadPropertyFileToSystem.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333422 13f79535-47bb-0310-9956-ffa450edef68"
cc7b0f4531b85441e1da6b8ffcb82d939c55647f,"Account for buffer flush with linefeeds of two chars.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333423 13f79535-47bb-0310-9956-ffa450edef68"
99932cb54628df42c62e995578f40199ff595fb0,"Check for duplicate nodes when adding elements


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333424 13f79535-47bb-0310-9956-ffa450edef68"
224ddf650826899b672cd92973982ba185a1ed50,"Make sure we use resolved URI when looking for documents


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333425 13f79535-47bb-0310-9956-ffa450edef68"
0025a8570a79556c92f438972d75a3b9e59cdd40,"Submitted by: Davanum Srinivas <dims@yahoo.com>
Reviewed by: Scott Boag <scott_boag@lotus.com>

Class.forName() has to be called only if isClass flag is on in
ExtensionFunctionHandler.java


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333426 13f79535-47bb-0310-9956-ffa450edef68"
693897703bbfedff69d7e51a93b1bc103d05b805,"Submitted by: Sebastien Sahuc <ssahuc@imediation.com>
Reviewed by: Scott Boag <scott_boag@lotus.com>

Override SetParent so that the parent's content handler is set to the source tree handler, for XMLFilter usage.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333427 13f79535-47bb-0310-9956-ffa450edef68"
c0c8388c7b3a92510df00999ea1562f267a1b9f9,"Oops, forgot to remove the class.forName above the check for isClass.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333428 13f79535-47bb-0310-9956-ffa450edef68"
1a16d8d4468d9d738ca9e834b2c9667de0fac121,"Handle xsl elements from an unsupported XSL version.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333429 13f79535-47bb-0310-9956-ffa450edef68"
a86bf80c6ea102966181e660ad8265243591bdaa,"Fixed problem with resolving namespaces for DOM transformations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333430 13f79535-47bb-0310-9956-ffa450edef68"
8186008397c707849e2878c7a5847d4bc13e206a,"Submitted by: Davanum Srinivas <dims@yahoo.com>
Reviewed by: Scott Boag

Make explicit selectNodeIterator and selectNodeList functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333431 13f79535-47bb-0310-9956-ffa450edef68"
a8507fde492065416453ddc01b885e4d604d283f,"Call selectNodeIterator instead of selectNodeList function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333432 13f79535-47bb-0310-9956-ffa450edef68"
db76ce519c65ba56f1f4b4fdc9047035e03a78cd,"replaced dom.reldir with w3c.reldir whic includesprg.w3c.xslt
as well as org.w3c.dom.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333433 13f79535-47bb-0310-9956-ffa450edef68"
fc3bae581582dd118e58f8150722ed1451eb12ca,"replaced dom.reldir with w3c.reldir whic includesprg.w3c.xslt
as well as org.w3c.dom.
Also replaced compile.dom with compile.w3c which now includes
org.w3c.dom and org.w3c.xslt.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333434 13f79535-47bb-0310-9956-ffa450edef68"
792e47959ea9cdf26c139f97a6d1500a604042b7,"Removed merge error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333435 13f79535-47bb-0310-9956-ffa450edef68"
c511467fa32b29f99a7a8c06d6bdabab3e00ad8b,"Added UseXMLFilters to samples target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333436 13f79535-47bb-0310-9956-ffa450edef68"
2443d6bc4cb1aa6ab3694b31de348eb991fa7800,"Factoring out boilerplate


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333437 13f79535-47bb-0310-9956-ffa450edef68"
841e2f44024cc45caa03a57df7d5f0dd1a568b6c,"Fixed extension handling for redirect.  Also, added encodings.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333438 13f79535-47bb-0310-9956-ffa450edef68"
8621e76fd39ec4a4a3c1046b059248baa4082f44,"Oops, let a println in.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333439 13f79535-47bb-0310-9956-ffa450edef68"
7653f2e8395943f6333686e817f11696c9060183,"Call superclass's getLocalNameOfNode if n.getLocalName() returns null.  There seem to be legit cases where this can occur.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333440 13f79535-47bb-0310-9956-ffa450edef68"
9afdd2d745fa45271fffbbc2856504b76bfaa0b6,"Make sure we're using .cs.JavaUtils, not .bsf.JavaUtils (claim was made that wrong one was checked in)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333441 13f79535-47bb-0310-9956-ffa450edef68"
cf2b892285da57e3ca315c21fdfce04428a983a4,"1.1-redir.xsl -- Editorial fix
2. MyCounter.java -- Changed Hashtable to static.Extnsion now works!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333442 13f79535-47bb-0310-9956-ffa450edef68"
f09b26c778dd0288063fe999188ab7ab6708c689,"Adopt the javac-invoking code into synthetic.*. (Break BSF
dependency, prepare for some generalizations.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333443 13f79535-47bb-0310-9956-ffa450edef68"
8908402d430515a57810befd0b15a782b3060b2b,"Made DocumentBuilderFactory namespace aware.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333444 13f79535-47bb-0310-9956-ffa450edef68"
75877f9983fda93e191e52bbfe9c634b8f108443,"Make sure nextNode is only called once in sort processing


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333445 13f79535-47bb-0310-9956-ffa450edef68"
32b59794c6f573cbe80f7a9ae86eb2fec31acf42,"Tolerate '\' chars.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333446 13f79535-47bb-0310-9956-ffa450edef68"
9f70b78777ef36d177e85470956a87e64ab92702,"Clip off ""file:"" from ""file:xxx"".  Hack to workaround problem with URI class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333447 13f79535-47bb-0310-9956-ffa450edef68"
ed5eb76592d04ac90b921db9f9c4d8af0ac34808,"Simple RuntimeException that wraps other exceptions, for difficult throws, mainly out of DOM functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333448 13f79535-47bb-0310-9956-ffa450edef68"
b4c27553aa7694ca6bdb3ab9410e879f8a08d37d,"Much improved error reporting, catch clauses consolodated.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333449 13f79535-47bb-0310-9956-ffa450edef68"
642c26f061af5fca9758aab8dfcc15bed18ed61f,"Synch with TransformerImpl, instead of individual nodes, so we can be notified with a parse fails;  Throw wrapped exception if we sense that a parse error has occured.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333450 13f79535-47bb-0310-9956-ffa450edef68"
7cfbbc2f6f841da76e2ddf8f4a0ed468d64d9681,"I don't think there are any real changes here.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333451 13f79535-47bb-0310-9956-ffa450edef68"
059bbb7aaa2ddfd10c11ab19fa48697cc2da80af,"Notify if parse fails.  Handle wrapped exceptions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333452 13f79535-47bb-0310-9956-ffa450edef68"
4687d060785f1d0412420dc3f80faf4a9cdc9a0d,"Better error reporting when parse fails.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333453 13f79535-47bb-0310-9956-ffa450edef68"
82b984dcaf67db95e644a9f6f68c27af269a80ee,"Added WrappedException


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333454 13f79535-47bb-0310-9956-ffa450edef68"
714b27170f19e0a1776044df7a111dec8e13b939,"Try to fully unwrap the WrappedRuntimeException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333455 13f79535-47bb-0310-9956-ffa450edef68"
2c95972c9d8c9143a0bdaaec0d71c9e57ecdfc8e,"Count all selected children


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333456 13f79535-47bb-0310-9956-ffa450edef68"
45d238f9fbfe47f6c666b10e6e76d7a7c50cb6ee,"Fix when pushing and popping context markers


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333457 13f79535-47bb-0310-9956-ffa450edef68"
e673132d34201cd4d894bc426e90b81ec0ef7a44,"Make sure that the priority of the best matched pattern is set.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333458 13f79535-47bb-0310-9956-ffa450edef68"
4425b97625cedc493838218609a090945975841e,"Fixed problem (again) with notification being correctly handled from a parser error.  Also, added loops to waits until when the child count is required.  Also, moved notification from Parent#setComplete to the SourceTreeHandler's ContentHandler methods.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333459 13f79535-47bb-0310-9956-ffa450edef68"
3e47bb3d4a35c4f73cc0a90f8023ee9863a2474f,"Implement new extension handling mechanism


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333460 13f79535-47bb-0310-9956-ffa450edef68"
c6650f39b5447d6558d72848d4af25215369122f,"Implement new extension handling mechanism


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333461 13f79535-47bb-0310-9956-ffa450edef68"
127237ce178a9249b85fc37a646790b377d37ede,"Allow JAVA_HOME to have directories with spaces in the
directory name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333462 13f79535-47bb-0310-9956-ffa450edef68"
f85e8291dd05158263e88b26d83920cea5e8af6e,"Fix string equal compare from == to equals and clean up unneeded imports.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333463 13f79535-47bb-0310-9956-ffa450edef68"
5f9e8128c93a8830a6d1d28aae9e1e27d536128c,"Correct order of arguments to isAssignableFrom


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333464 13f79535-47bb-0310-9956-ffa450edef68"
b901be4ffe0bb1a224993056deb1d26b2ff3ed46,"Implement function-available and element-available; clean up javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333465 13f79535-47bb-0310-9956-ffa450edef68"
3c39154020c89956029289f79ae6ae311f0e3edd,"Implement function-available, element-available, processElement; clean up javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333466 13f79535-47bb-0310-9956-ffa450edef68"
e4352c7ffd7e0b2ed42f261916d77e13e4ae8e83,"Changed how ""trax.properties"" is accessed.  See note on Xalan list.
 Moved transformation to secondary thread, and parser to main thread.
 Use ""http://xml.apache.org/xslt/sourcebase"" to set base URL for input source.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333467 13f79535-47bb-0310-9956-ffa450edef68"
365423ce00ef438a853566c90ca6b85d8860a494,"Removed import statements for org.apache.xml.serialize, use transition
instead.

( it used to compile fine if xerces and xml.serialize was in classpath,
doesn't work if another parser is used )


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333468 13f79535-47bb-0310-9956-ffa450edef68"
cdef61c641cd5cc3bdbc08a2ad95dc1e520f8cf6,"Added Gary L Peskin's extension files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333469 13f79535-47bb-0310-9956-ffa450edef68"
45a01d468541fcbee48f4472799caaeaedf99614,"Like in xalan1, use dynamic class loading to load the BSF extension
handler. This allow xalan2 builds without BSF in classpath, while
allowing to use BSF when available.

Right now Xalan2 builds with no external dependency ( only standard
interfaces and it's own code ).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333470 13f79535-47bb-0310-9956-ffa450edef68"
cfb8ca7688a8f289857685606f76ea78fae5cd52,"Allow component element with no content; remove experimental reflection code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333471 13f79535-47bb-0310-9956-ffa450edef68"
75004891ade3cebaac0f34c50cad359d9627324d,"Remove BSF compile-time dependency; fix compile.trax


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333472 13f79535-47bb-0310-9956-ffa450edef68"
bb1501106f752da786645317f841747dd86d6d6e,"Rework BSF reflection;
change element call to check for ElemExtensionCall as second arg,
not Element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333473 13f79535-47bb-0310-9956-ffa450edef68"
6a99fc7d3db8971e03c7827c327d46ba7ec110b2,"Minor fix - removed ""final"" on fields that are modified.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333474 13f79535-47bb-0310-9956-ffa450edef68"
e8f4dbcd6f1f689e8fb7e8266053e27da6a83dfd,"Make sure URI is not null.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333475 13f79535-47bb-0310-9956-ffa450edef68"
2fe73e847c588890d9597c2016b9525a936f1ed9,"Fix compile.trax


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333476 13f79535-47bb-0310-9956-ffa450edef68"
1f51c5df4f1f54c0c5ea99d068478bef458c8fcc,"getAssociatedStylesheets and processMultiple should now work, enabling processing of xml-stylesheet PIs.
Processing of LRE as Stylesheet now better, xsl attribute excluded, xsl attributes are now properly applied to stylesheet, and other attributes applied to the LRE.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333477 13f79535-47bb-0310-9956-ffa450edef68"
4d8b00f56538df8b5d10ffc303d7d05406c5f12b,"Xalan-J book for website.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333478 13f79535-47bb-0310-9956-ffa450edef68"
65e39369b334e2773ae85b24a6e73eb900001455,"1. Modified compile target to explicitly include entire source
    tree, except xalan-J 1 compatability classes, and to
    explicitly copy .properties  and .res files to build tree.
2. Completed the site target (for building website doc).
3. Changed javadocs target to include public members.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333479 13f79535-47bb-0310-9956-ffa450edef68"
03448f9b940f1d4d06cd9c9b1802c20822f4b806,"Make sure upper level elements are being properly overiden for imported and included stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333480 13f79535-47bb-0310-9956-ffa450edef68"
c49de610b2d9f122695a85c40bd323359de5b7a1,"Make sure code is thread safe when getting a template


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333481 13f79535-47bb-0310-9956-ffa450edef68"
c77615ab46f0ef66f45ee96b021ced83b38d2d2d,"Ignore ""feature not supported"" exceptions, in case other parsers are used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333482 13f79535-47bb-0310-9956-ffa450edef68"
ad2f18bba24d0c7b8c2273a5c9007241a1fc555f,"Handle case where prefix attribute is specified but there is no
corresponding namespace declaration.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333483 13f79535-47bb-0310-9956-ffa450edef68"
117673e2ad9062f588bac86fd1efe0ac571b21fb,"Sandbox does not permit use of
   SerializerFactory.getSerializer(""HTML"").
So replace (FOR ""priming pump"" and performing transformation) with
    new org.apache.xml.serialize.transition.HTMLSerializer().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333484 13f79535-47bb-0310-9956-ffa450edef68"
93d7301385eb261a26abb8c7ce6ecc37c047d0f3,"adjusted applet archive setting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333485 13f79535-47bb-0310-9956-ffa450edef68"
f84c449caa39fc09b0f7a0a110fda5bb6a994ae5,"Removed reference to a copy of the applet on a Domino server,
and added info about where to put xalan.jar and xerces.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333486 13f79535-47bb-0310-9956-ffa450edef68"
5c6ef87e74c01fdb4490e61a11070aeb5634af38,"Make sure we can get to parent of attribute nodes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333487 13f79535-47bb-0310-9956-ffa450edef68"
355e7eaa6cd94a85d191e6b1a56a36ce3bdd1008,"doc updates for xalan-j 2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333488 13f79535-47bb-0310-9956-ffa450edef68"
c3a0749f3db87f5ffe089d63bca4bfe5f6c81d3a,"XercesJ V1.2 (9/1/00 3:34pm)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333489 13f79535-47bb-0310-9956-ffa450edef68"
a1242c7edf347a1c4eede2e3aa9e8ff32235928c,"Fix: if XSLTResultTarget is created with a File argument, we need
to return the right CharacterStream - TransformerImpl calls
getByteStream or getCharacterStream and both are null if file
is used ( resulting in a NPE in BaseMarkupSerializer.setOutputStream ).

I also changed the fields of trax.Result to protected - it is very
confusing to have the same field name in XSLTResultTarget and Result (
and it have unexpected effects ).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333490 13f79535-47bb-0310-9956-ffa450edef68"
48bae58190ac3d2b13a6a7181c810295eb36bc71,"Major rewrite of ResultTreeHandler class, to make it more understandable, and to fix the bug where prefix events were not being generated correctly.
Several bugs related to whitespace before the XML decl were fixed in the process.
Also, fixed bug where string conversion of result tree fragments were being done with the XML serializer, instead of the Text serializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333491 13f79535-47bb-0310-9956-ffa450edef68"
fc852a567dd0c97c2f420e55619474880ada2f56,"Moved trax.* to org.apache.trax.*
Moved serialized.* to org.apache.serialize.*
Moved synthetic.* to org.apache.xalan.utils.synthetic.*
Updated makefiles, antfile, samples (though I didn't test the samples...)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333492 13f79535-47bb-0310-9956-ffa450edef68"
f6c33c339897542abbf2eaee62554242e9a5e268,"Moved trax.* to org.apache.trax.*
Moved serialized.* to org.apache.serialize.*
Moved synthetic.* to org.apache.xalan.utils.synthetic.*
Updated makefiles, antfile, samples (though I didn't test the samples...)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333493 13f79535-47bb-0310-9956-ffa450edef68"
69abc0968fc502bb47844b292d1752b33d8f67b7,"Removed Xalan1J compatibility classes.  Sorry, Myriam.  These may go back in on a later date, perhaps in another directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333494 13f79535-47bb-0310-9956-ffa450edef68"
55b8faf40f01ecc72d350cc81a8eb6b8e0e4109d,"Removed StylesheetSpec, which got in there somehow, from the compatibility stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333495 13f79535-47bb-0310-9956-ffa450edef68"
2713f27a11da3ba9481d960d125eed3d2a38bf7a,"Check for null prefix in startPrefixMapping, and set it to """", for default prefix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333496 13f79535-47bb-0310-9956-ffa450edef68"
7b141b3a81375e80c447461bd1cb93474f8f3d75,"Fix problem with swallowing a char when buffer is full


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333497 13f79535-47bb-0310-9956-ffa450edef68"
546aa28fb5d9bfed94bb99df2f9fe3e8fbbf1482,"Remove SimpleRedirect -- use org.apache.xalan.xslt.Process


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333498 13f79535-47bb-0310-9956-ffa450edef68"
15baae530e8f0c42f784e6d91f280ea81cebfb17,"Added public serializeXPathResultNode(Node n) to
serialize each of the nodes in a node-set returned by
an XPath expression.  This method wraps the protected
serializeNode(Node n) method, which uses a switch statement
to handle different node types. Not all node types are included,
and the default behavior does nothing, so I changed default
to getNodeValue, and send the String if any to the characters()
method. This handles attribute nodes, which were not handled
previously.

Used by the ApplyXPath sample.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333499 13f79535-47bb-0310-9956-ffa450edef68"
3e2b58a872cdf10657ef19e7630cd4bfde645ab7,"Use the new serializeXPathReturnNode() I just added
to the BaseMarkupSerializer. This sample now provides
what looks like complete coverage for serializing XPath results.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333500 13f79535-47bb-0310-9956-ffa450edef68"
6ef54192b31f5d2d61625d77b732036188fbd340,"Added ClonerToResultTree.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333501 13f79535-47bb-0310-9956-ffa450edef68"
94912efe70328d9ee595f377b463eaf663e8a000,"Removed elem param to ClonerToResultTree, since it is no longer needed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333502 13f79535-47bb-0310-9956-ffa450edef68"
0e814fb7a106a35b26c7c1f2a57ce791dfbdb47b,"Call isDefinedNSDecl for an attribute before adding it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333503 13f79535-47bb-0310-9956-ffa450edef68"
3a67a1e7e751aad1ebc3ef835e8ace9774f5040d,"ensurePrefixIsDeclared fixed, so that it uses the raw name (duh...)
Added a check for ns decls that were already added, to try to fix problem
when RTFs are added that end up having redundent namespaces.  To no avail.
Need to clean up attribute setting in general to make it
more structured.
Added a compile-time debug flag.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333504 13f79535-47bb-0310-9956-ffa450edef68"
80dcf2425b16ca594b3dbd957aee33f8e4524871,"Removed ElemTemplateElement param and member var, as it is no longer needed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333505 13f79535-47bb-0310-9956-ffa450edef68"
f71c537dae332acea7a2e105c5ad8f699b86d083,"Renamed nodeset() function to asNodeIterator, and changed it a bit
to test for NodeList.
As per Gary Peskin's note on xalan-dev.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333506 13f79535-47bb-0310-9956-ffa450edef68"
de51747867bc4cb6bfdcb7c880cc0e9235686148,"Initialize extension declarations in included stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333507 13f79535-47bb-0310-9956-ffa450edef68"
86f67ce753076f2f9ab77264adcb4a47cbc173e0,"Adjusted ""book"" file names: xalan-jlocal.xml and xalan-jsite.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333508 13f79535-47bb-0310-9956-ffa450edef68"
d6fff2c251d936d6dec7ab571b7350dc04ad8d1c,"Cleanup of ""distribution"" book vs. ""site"" book


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333509 13f79535-47bb-0310-9956-ffa450edef68"
6c43bd4a6cf19e503fc501ef5fa009b65ba2a10b,"Javadoc corrections per what we are including with Xalan-J 2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333510 13f79535-47bb-0310-9956-ffa450edef68"
71358e6d658d669236179726040e3c3c119a8935,"Fix typo. Wrong loop variable used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333511 13f79535-47bb-0310-9956-ffa450edef68"
1fb075ba6b61c773fb2c5d6d37dd2c85fac27cd2,"Sort templates by priority first, then by document order


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333512 13f79535-47bb-0310-9956-ffa450edef68"
056556af4220ee33dc9b0957f8bedd6d47075feb,"Output META tag after HEAD tag for HTML output


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333513 13f79535-47bb-0310-9956-ffa450edef68"
6f3ef77c012fe9405d96bca8272419ae1eb5be75,"Javadoc package-level and 2 interface-level comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333514 13f79535-47bb-0310-9956-ffa450edef68"
7414658938dd45783246e9b1cd61e0656020e039,"Package-level javadoc comments for SAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333515 13f79535-47bb-0310-9956-ffa450edef68"
0c73f0e0559034b09e7b084480f805f74347c3c7,"Package-level javadoc comment for serializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333516 13f79535-47bb-0310-9956-ffa450edef68"
1f06ac583ca0ad3e93bef80ca1adfe59aee4e46a,"Review draft for Xalan-J 2.0.D01


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333517 13f79535-47bb-0310-9956-ffa450edef68"
e09b9c397665f96c245d7ea856d8b4384969006b,"Review draft for Xalan-J 2.0.D01


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333518 13f79535-47bb-0310-9956-ffa450edef68"
0bc600a990c31aeb6da429a7eb41b03fac18e0b7,"1. Changed FileWriter to FileOutputStream
2. Added readme.html for distribution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333519 13f79535-47bb-0310-9956-ffa450edef68"
f17793006e5d0a3a9d2d664119f6896a9f334aec,"Changed FileWriter to FileOutputStream


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333520 13f79535-47bb-0310-9956-ffa450edef68"
fef13f7cb8c5403bbddb84efec18023976ad9d5e,"Revised per comments from Shane.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333521 13f79535-47bb-0310-9956-ffa450edef68"
5d79a6e05dbc44448cc2f60ab62c19f4a840cbd2,"Corrected spelling error (for Javadoc)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333522 13f79535-47bb-0310-9956-ffa450edef68"
5559438710c5676e834dab668ee575d812fb8bf6,"Revised Javadoc comment (per Dave Marston).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333523 13f79535-47bb-0310-9956-ffa450edef68"
2a0120dcf36c10fa362f4112d0edea25457b2921,"Revised Javadoc comment (per Dave Marston).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333524 13f79535-47bb-0310-9956-ffa450edef68"
c6b386f45095cb04556cfe4a9464d065928c4143,"Move ExpressionContext from org.w3c.xslt to org.apache.xalan.extensions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333525 13f79535-47bb-0310-9956-ffa450edef68"
91c02864b62a5424d4f98984e721b32b0128fc3c,"Removed message in compile about compitaiblity classes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333526 13f79535-47bb-0310-9956-ffa450edef68"
9172ad5a667313907f1d2088a9ea1a02082df6e2,"Removed nodeset method (not yet functional).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333527 13f79535-47bb-0310-9956-ffa450edef68"
41236e528e1ce514a4694c305330c0b119d85c82,"Removed org.w3c.xslt package from javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333528 13f79535-47bb-0310-9956-ffa450edef68"
5873818cb7ad91c787eccf0b48943ec08ceb4e65,"Release notes and note about new contributors.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333529 13f79535-47bb-0310-9956-ffa450edef68"
06c31fa6fb78e4ac8a1116e087c8986e7fb4a930,"Final draft (I hope) for Xalan-J 2.0.D01.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333530 13f79535-47bb-0310-9956-ffa450edef68"
95052c20f92334d65f4433bee09cd6f5511a4d15,"Build template list by priority then document order. Misc changes to be able to get a template score for both step and union patterns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333531 13f79535-47bb-0310-9956-ffa450edef68"
b9e49658c2a4dd926abcbb17a341ac6276618fad,"bool() function should always return true.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333532 13f79535-47bb-0310-9956-ffa450edef68"
afea44acc4240ca3a4e76ecad50886b42470dbdc,"Revised per Shane's review comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333533 13f79535-47bb-0310-9956-ffa450edef68"
6de5ff7600a78e282a3a8a67f89fb6903078c5f4,"Corrected spelling errors.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333534 13f79535-47bb-0310-9956-ffa450edef68"
c73eec5f556a762a497b076c1f68ba533fe05f17,"1. Added bug on stylesheet PIs
2. Fixed TraceListener example.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333535 13f79535-47bb-0310-9956-ffa450edef68"
d1474f6acc19343ad55168e71484d5ebfb749cfa,"Fixed typographical errors in text associated with a link.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333536 13f79535-47bb-0310-9956-ffa450edef68"
5619c5d37da878d62728e2d23dc738966331fbb4,"Fixed TraceListener example.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333537 13f79535-47bb-0310-9956-ffa450edef68"
4ceae5f455a148944ff864c762803cb55b492225,"Fix NodeIteratorWrapper to properly return NodeIterator with just
a single root node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333538 13f79535-47bb-0310-9956-ffa450edef68"
1b26af01e528c2973f07fe531415cd43be7a3a7a,"Clean up convert() method so all conversions are now done and done properly.
Still need to work on scoring for Object -> Object conversions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333539 13f79535-47bb-0310-9956-ffa450edef68"
a2949c41aec2a11710782fecc23de55a85a86b79,"Implement nodeset extension function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333540 13f79535-47bb-0310-9956-ffa450edef68"
45658780bfd827d24eb940932cc7bc8837a95609,"1. Removed stylesheet PI bug.
2. Put absolute URI into stylesheet PI example and added
info on using command-line utility.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333541 13f79535-47bb-0310-9956-ffa450edef68"
233bf292931768ea32f066e3185d2294d323734d,"Changed the default indent amount to zero... for optimization purposes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333542 13f79535-47bb-0310-9956-ffa450edef68"
1176ebe30f32ff00bcaeb68c4dbb46de14a324c5,"Changed parameters to cloneToResultTree, in conjunction with changes to that method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333543 13f79535-47bb-0310-9956-ffa450edef68"
93367c7050091cd3999f81bb1fbfa318ec21e03b,"Added feature for NodeTestFilter, so the walkers can use this instead of doing an instanceof.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333544 13f79535-47bb-0310-9956-ffa450edef68"
14573c770cb3e7e7984b358d9d4dfd2a14846e8e,"Added isCompiledTemplate() method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333545 13f79535-47bb-0310-9956-ffa450edef68"
e2061ed5fd3a670ce3f478aacac04d96a196fc19,"Pass one less parameter to avt.evaluate.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333546 13f79535-47bb-0310-9956-ffa450edef68"
275d73c0d027e5a90f3cfca9f3c7668351e69c1b,"Pass m_doc directly from getOwnerDocument, instead of getDocumentImpl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333547 13f79535-47bb-0310-9956-ffa450edef68"
bf0309d2817201f10000e606c37e6240f2c89361,"In getFirstChild, use hasChildNodes instead of getChildCount, which solves the last incrementality bug that I know of.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333548 13f79535-47bb-0310-9956-ffa450edef68"
770ee4a15e0ff5955cd2c03f9b2827efb41e7e10,"Only notify every 10 events or so (this number needs to be controleable by an application).
When the parse thread is done use the join() function to block until the transform thread is complete.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333549 13f79535-47bb-0310-9956-ffa450edef68"
5903ba530d136892975f63b98e54f4a3b78fc1ef,"Massive rewrite, simplifies template matching.  Now, sort the pattern to assocations lists in priority
and document order, then add clones of the wildcard associations to each
association list.  This allows us to pattern match through only one list, and
quit when the first match is found (since the priorities can be statically determined).
For now, do not warn about conflicts... this will be added as an option
later (if the option is on, it will be at the expense of performance).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333550 13f79535-47bb-0310-9956-ffa450edef68"
a8ca2df42b0549d98cabc2a913661c1b832cb906,"Functionality moved from inner class in TemplateList.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333551 13f79535-47bb-0310-9956-ffa450edef68"
d40b2ddc7528308d33b9ddce1811cd1cddca36db,"Use buffer pool, create buffers instead of getting them as params.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333552 13f79535-47bb-0310-9956-ffa450edef68"
dbe8cf56954160a3d5fc6d30219a7e450cb4e622,"Don't pass new string buffer to avt, use StringBuffer pools.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333553 13f79535-47bb-0310-9956-ffa450edef68"
8a13e8f6325abacc725700df751f23c00374a757,"Don't pass new string buffer to avt.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333554 13f79535-47bb-0310-9956-ffa450edef68"
875ff6bb5aa74122c8508c3358df2099f44e25ee,"Remove isDot optimization, generally clean up the code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333555 13f79535-47bb-0310-9956-ffa450edef68"
8146c880189f5d8d0ce1e111a9dd96ce0e840c61,"Changed params to cloneToResultTree, in accordance to changes made to that method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333556 13f79535-47bb-0310-9956-ffa450edef68"
df4ff282b866dd135116fb27b6136f530ba00e49,"Added isCompiledTemplate function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333557 13f79535-47bb-0310-9956-ffa450edef68"
cc32feabc1a723eb90e4fc18f3de55892e23dd33,"Moved extensions from NodeSetOperations into Extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333558 13f79535-47bb-0310-9956-ffa450edef68"
044a997676a3661ae606a15a15122103aefda1fa,"Call compose() method on the TemplateList, so that it can insert the wildcard associations into the associations table.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333559 13f79535-47bb-0310-9956-ffa450edef68"
d5b66d81c2b45f8f75d601c8330d1d5f39adbb93,"Changed getDefaultXXXRules to final.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333560 13f79535-47bb-0310-9956-ffa450edef68"
f13cd081be09e20bd017b01399b5ae9c479dfa06,"Set S_DEBUG to true if a listener is added.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333561 13f79535-47bb-0310-9956-ffa450edef68"
967ba8f32d513a4b1f4293969b1e8e80e1f864f4,"Rip out strip whitespace stuff, decrease number of parameters, since they weren't all used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333562 13f79535-47bb-0310-9956-ffa450edef68"
205cefab77f9560505c17889ed5411eb152ff41b,"Defensive check for null template.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333563 13f79535-47bb-0310-9956-ffa450edef68"
062c6c6456505f341ee425cc7ef16ffbee4b5163,"Added serializer property.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333564 13f79535-47bb-0310-9956-ffa450edef68"
d15726c1747c2ec5f1adc50389059e7e6d6c243d,"Reduce method calling vs. property access.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333565 13f79535-47bb-0310-9956-ffa450edef68"
05ed00dd579996462c78857f1ace3f8ce552da1d,"Changed some method calling to property access on queued events.
Pass false instead of true for flush for the default startPrefix mapping,
which seemed to fix the namespace bug (more testing needed).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333566 13f79535-47bb-0310-9956-ffa450edef68"
5974946fc9fadc9a80e878693ab76f1457e902d5,"Changed the m_recursionLimit variable to package private, so it can be accessed by the TranformerImpl in time-critical loops.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333567 13f79535-47bb-0310-9956-ffa450edef68"
ca305e635477211a9ce42a1f69f57a437c528ade,"Used StringBuffer pooling, ResultTreeHandler pooling.
Changed pushes of current context node and template to single node list with pushPair and popPair methods.
Other minor changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333568 13f79535-47bb-0310-9956-ffa450edef68"
2031b7b217457f84cd302f21e049574b22dd1927,"String buffer pool for pooling StringBuffers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333569 13f79535-47bb-0310-9956-ffa450edef68"
f215e37bc0d81da16810056c59a1a1461c3308dc,"Added methods for using as a stack, including a pair stack.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333570 13f79535-47bb-0310-9956-ffa450edef68"
5c67d198f3466b1d8c15cf784e9669d83403fe6a,"Default to return false from setFeature.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333571 13f79535-47bb-0310-9956-ffa450edef68"
ce9ebbf3b274dbb7b14bf9d9c690292eb5fb1b47,"Comment out traceMethodCalls.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333572 13f79535-47bb-0310-9956-ffa450edef68"
c687bb0baf723e1150c1a35620a5f02684765174,"Remove line break normalization.  Ain't worth it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333573 13f79535-47bb-0310-9956-ffa450edef68"
618f5b5a403e7b3f544b35d47c5627af72ce08d9,"Cosmetic changes only.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333574 13f79535-47bb-0310-9956-ffa450edef68"
d3ea90f3f59be7a724f544b89fce4e858389890f,"Optimize entity lookup for first 256 characters.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333575 13f79535-47bb-0310-9956-ffa450edef68"
b9e7eab0e55b62e9ff2d9f78fa09ee85b8aefe6a,"Very slightly optimize a loop.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333576 13f79535-47bb-0310-9956-ffa450edef68"
9304deb986fc5d6f313691ff7b1e918c3ef3eee7,"Use StringBuffer pool.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333577 13f79535-47bb-0310-9956-ffa450edef68"
ffaea715e4bd883854eac5c91127c1bdeed33192,"Use a side index instead of pushing element frame objects.  Big improvement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333578 13f79535-47bb-0310-9956-ffa450edef68"
50458ed8080591ae33a48f061e6466e5e4c7b649,"Make a bunch of methods final.  Use NodeVectors instead of stacks for context node stack.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333579 13f79535-47bb-0310-9956-ffa450edef68"
4ae7ccb1e36469f577ce9e64717c004f13fad961,"Optimize some searches based on an compile-time analysis of the pattern.
Other minor optimizations also.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333580 13f79535-47bb-0310-9956-ffa450edef68"
52d4d3c9f19b5ff653c59b6ba1657f8f832ff42f,"Make countPredicates public.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333581 13f79535-47bb-0310-9956-ffa450edef68"
b08e2e25f8d4debb79d44f624282038858d11c91,"Added toString method, that will return the string representation of the pattern.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333582 13f79535-47bb-0310-9956-ffa450edef68"
860b80980ebbb02d95dfb6afbffcfc4b2a4b68f0,"Added calcScore method for compile time determination, which assigns a value of SCORE_OTHER.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333583 13f79535-47bb-0310-9956-ffa450edef68"
adc8030be4b9926c74e3fa082dbc82a0c4495eda,"Various optimizations, including the direct use of the DOM2 namspace and local
name functions.  We'll have to see if I get in big trouble for this.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333584 13f79535-47bb-0310-9956-ffa450edef68"
50614e2f0ead8c6189337cc303060a0dc5771ae8,"Don't match on the Document node for show_all.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333585 13f79535-47bb-0310-9956-ffa450edef68"
cf63be516d94ad41d9efe748a2a34123533414c3,"Overall checkin for optimization effort.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333586 13f79535-47bb-0310-9956-ffa450edef68"
a5b42bcf191593449f6cfc220b9d24155d9a0a8b,"Param/variable without content or select attribute now assigns value of empty string.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333587 13f79535-47bb-0310-9956-ffa450edef68"
4f5d4f1dd51fdb1214f19bf468fc9344735f4184,"Added nodeset example and some preliminary info on use of the
new http://xml.apache.org/xalan namespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333588 13f79535-47bb-0310-9956-ffa450edef68"
eb6e4a1a579e4a7482e6bde25c29d847339370f6,"I think I got in trouble... adding back in use of DOMHelper functions for namespace and name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333589 13f79535-47bb-0310-9956-ffa450edef68"
53b344b3ad99cb885bdb5a58dbe1378fd952c8dc,"Updates on Xalan namespace per info form Gary Peskin.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333590 13f79535-47bb-0310-9956-ffa450edef68"
0a48a003d5f558b250fed2ebc84e60ee38ad584a,"Implement evaluate extension function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333591 13f79535-47bb-0310-9956-ffa450edef68"
3b75d8d929c806b16ad2bde0a7dede8cfb113425,"Added FastStringBuffer class, since StringBuffer is pretty sad for reuse.
Optimized loop in getTemplates so it doesn't do the pushes and pops of the context inside the loop.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333592 13f79535-47bb-0310-9956-ffa450edef68"
16f2d12581ba9525ecb87c31035f9d92b2ffbd02,"Added mssing resources element!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333593 13f79535-47bb-0310-9956-ffa450edef68"
f4f258195cfb29054db798a7c4f3ba9dc73e7c0b,"Beefed up nodeset description and example.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333594 13f79535-47bb-0310-9956-ffa450edef68"
d9eb601f97ac730410accb679c3c8548e91bfca8,"Fix up base to an absolute file URL if both uri and base are relative.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333595 13f79535-47bb-0310-9956-ffa450edef68"
8f1222929de4186d078a49bbe05c03e86765aad3,"Send true for element flush for startPrefixMapping.  This fixes namespace25.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333596 13f79535-47bb-0310-9956-ffa450edef68"
556b2e8f1c6dc85e32f2ecf6759e4f2037ddbc93,"Make the m_schema non-static, since it holds processors that
hold state, and are therefore not threadsafe.  Work on this down the line.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333597 13f79535-47bb-0310-9956-ffa450edef68"
8267d822eb9a5ec10f80d605ae35801dbf05446f,"Updated to use org.apache.xml.serialize.transition in place of the
Xerces package.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333598 13f79535-47bb-0310-9956-ffa450edef68"
65ce4d2b49e7cbcc622396d1076439d8c75f5b31,"Warning about order of xalan.jar and xerces.jar on classpath.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333599 13f79535-47bb-0310-9956-ffa450edef68"
cc26ffe47951f5e5cb21d0d08951caf3a16d9289,"Added note about how to enable indenting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333600 13f79535-47bb-0310-9956-ffa450edef68"
a4e102cffe26c01a09fff32b0bae101720e03d9d,"Avoid returning null, so servlet can run with lib.sql.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333601 13f79535-47bb-0310-9956-ffa450edef68"
42ad4ce25831afa47275d0e10ba4b47cb3ed8015,"Oops, forgot the mode test.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333602 13f79535-47bb-0310-9956-ffa450edef68"
5662e1ae715e15cf503388eddd8e5f0c51b045f4,"Added note about org.apache.trax.Examples


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333603 13f79535-47bb-0310-9956-ffa450edef68"
a35d7d2a3db4b277948dfc5f3f0c4ef1020b6dfe,"1. Updated ref to new serializer packages.
2. Added more visible ""alpha release"" to release notes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333604 13f79535-47bb-0310-9956-ffa450edef68"
2a37eb619c19c2d4c732c6dd7eaf0c9a1239b48a,"link to docs/whatsnew.html


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333605 13f79535-47bb-0310-9956-ffa450edef68"
6830d540c4f3fc72195f350db19609bb63915d88,"Updated keyfile to contain group's public key.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333606 13f79535-47bb-0310-9956-ffa450edef68"
92ef0d570abc5b616ad49172c1629afe03a8b8fa,"Puts readme.xml in root.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333607 13f79535-47bb-0310-9956-ffa450edef68"
120ff8b8154610f9c0e7b762c46de58d73d607c9,"Updated to use new trax package.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333608 13f79535-47bb-0310-9956-ffa450edef68"
121e2b9a9dafb86e57d0d341db5c22250eb34206,"Fixed zip and tar to include base dir.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333609 13f79535-47bb-0310-9956-ffa450edef68"
8fb0b835da119df6c9fa1c80869904b356c2aa9c,"bsfengines.jar no longer used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333610 13f79535-47bb-0310-9956-ffa450edef68"
31f70473165b428c8c0cd1cb26c9db76f0f0c54c,"Removed refs to compat.excludes files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333611 13f79535-47bb-0310-9956-ffa450edef68"
60dd17ff93c7a3726a598b74319f0c90bf103b32,"Rearranged javadocs class so do not attempt to place patterns.xml
before apidocs/org/apache/trax exists.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333612 13f79535-47bb-0310-9956-ffa450edef68"
0fe75f44d3eefeb3e5dc56bc888d4f47f12d33a8,"Corrected link to trax.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333614 13f79535-47bb-0310-9956-ffa450edef68"
ebdddff06dc3bca4e8a9d51b13a1a60e68109aa8,"Added TraceListener and stylesheet PI samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333615 13f79535-47bb-0310-9956-ffa450edef68"
1fc52662c46ad16e882e41cd48be1c3c497ae446,"Updated version number.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333616 13f79535-47bb-0310-9956-ffa450edef68"
c0ab2d2ef9f1a9b40f6f85dca26313a23e6c18b7,"Serializability clean-up and jarfile generation


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333617 13f79535-47bb-0310-9956-ffa450edef68"
f13c05ea843336cacc222f67afde1098bd703fa6,"Generate and reload .zip file containing serialized compiled stylesheet (and generated .classes to support it)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333618 13f79535-47bb-0310-9956-ffa450edef68"
c6fdd5bad0ecc075f98aa7dc005711ce8a2c0c4d,"Update comments for new package; specify ElemExtensionCall;
evaluate attributes within current XPathContext.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333619 13f79535-47bb-0310-9956-ffa450edef68"
ea137d5829f204e78c8cd80dc5d368710172af9e,"Support for serializing stylesheets


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333620 13f79535-47bb-0310-9956-ffa450edef68"
027b02f743f6a3b9707f05dfb531a572c495c681,"Better documentation of compiled stylesheet sketch


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333621 13f79535-47bb-0310-9956-ffa450edef68"
ad684980eb29e19acfc6dcd53c2300d3a44ea5e8,"Updated to use Ant 1.2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333622 13f79535-47bb-0310-9956-ffa450edef68"
fc0dc69ae68863ce63aa694ad7a564a2227dba2c,"Ant 1.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333623 13f79535-47bb-0310-9956-ffa450edef68"
4b37a616eff0ec3907218129f467a37018131613,"Root element not used, so removed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333624 13f79535-47bb-0310-9956-ffa450edef68"
a14e1a2a6f3465808275ee613b069cfab9ff95e6,"Output file name based on stylesheet system ID (w/ fallback)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333625 13f79535-47bb-0310-9956-ffa450edef68"
720fc4ca1abb35ca6952570ba33ad323663137d1,"Cleanup: Reloading bundle should yield a TraX Templates object, rather than exposing our internal Stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333626 13f79535-47bb-0310-9956-ffa450edef68"
989cef56a1514fe58fc179f5eb6459b974ee6bfb,"Changed version to 2.0D02.  anticipating next developers release.
Note that the version reported for Alpha D01 is just 2.0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333627 13f79535-47bb-0310-9956-ffa450edef68"
e0345dc4f53247450b577ceeb9251c9954ad3b90,"Ant 1.2 javadoc task ignores destdir if doclet is set, so must
assign -d param directly to doclet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333628 13f79535-47bb-0310-9956-ffa450edef68"
a3ea22b2894ecc70768b9b2c589779a90218e0a4,"Generalizing, esp. to deal with MSVJ++


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333629 13f79535-47bb-0310-9956-ffa450edef68"
10c3db0ad10be8c20d48f4caa87a49f1d863429d,"Take advantage of generalized compilation routine


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333630 13f79535-47bb-0310-9956-ffa450edef68"
af888f9011bd154b146355c9dc0a2a34080993a0,"Oops. Wrong access on one method


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333631 13f79535-47bb-0310-9956-ffa450edef68"
3a4c60c3e249c2ce5901c4ac4f80a07d3038066b,"Cleanup and documentation


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333632 13f79535-47bb-0310-9956-ffa450edef68"
667659c70dbf8122d0faad2312e3d210ab2959da,"Status message tweak


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333633 13f79535-47bb-0310-9956-ffa450edef68"
4f762a01ba6a55ca2f43b896474c3af6d66f8f9b,"Fix argument class evaluation test.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333634 13f79535-47bb-0310-9956-ffa450edef68"
d9fcfc759fb237d3524206c41a9c453079feb04b,"Development version must be numeric.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333635 13f79535-47bb-0310-9956-ffa450edef68"
ce4c938774f585936278de2942eb88552d6cb275,"Implement tokenize extension function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333636 13f79535-47bb-0310-9956-ffa450edef68"
c1257c47bffde118c98e7e9bd1f64cd92626fbf7,"Improved error reporting for java extension method errors.
Fixed scoring for non-XSLT object -> java object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333637 13f79535-47bb-0310-9956-ffa450edef68"
e17824c7a1827566ef005a6593e9e44c4563b106,"Made getTypeString() public to improve error reporting for java extension method errors.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333638 13f79535-47bb-0310-9956-ffa450edef68"
6fbfc5b396871b2ddb731ea98fccffe88307b5d3,"Fixed some bugs with import\include.  JIndent formatting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333639 13f79535-47bb-0310-9956-ffa450edef68"
0e2298c0c460e281c6e54e92ac95421ec5eca2e4,"In addition to JIndent formatting:

Many fine-grained optimizations.

Change the Stree DOM to use linked references to first child and next and previous siblings, instead of arrays for child lists.  This follows much more naturally the way they are being accessed by the iterators, though perhaps at some expense for space.

The DocumentImpl node now holds a single character array for text.  Text nodes copy into that array, instead of each making a String object as soon as they are created.  A string is created upon demand.  With some transformations, this could actually mean more space taken, rather than less, though I think the net will be a gain for most transformations.  In the long run, the real solution is to be able to use the original array, and not make a copy at all.  We'll be working with the Xerces folks on this, and maybe try to push this onto the SAX standard.  Having to make a copy of the character data is a real nasty issue with the SAX spec.   And why-o-why doesn't Sun define a String object that can reference a character array, instead of having to copy?

Stree character nodes now implement a SaxEventDispatch interface.  Xalan asks the node if it implements this interface via the .supports method, and then calls dispatchSaxEvent(ContentHandler ch), allowing the text node to directly dispatch to the characters event, directly passing in the data from the character array in the DocumentImpl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333640 13f79535-47bb-0310-9956-ffa450edef68"
77ad973f1d6ad8f28fd358f2ba4d4c63da65d953,"In addition to JIndent formatting:

Brought the central loop code for itterating over selections and applying templates to a function in ElemForEach, transformSelectedNodes.  Spent a fair amount of time optimizing this loop and making it as clean as possible.

transformSelectedNodes calls the dispatchSaxEvent directly when encountering a character node that doesn't have a template defined (and thus uses the default text template).  dispatchSaxEvent can be used in other places in the code, but right now it's only used in transformSelectedNodes.

various other finer grained optimizations, based on measurements from Rational Visual Quantify.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333641 13f79535-47bb-0310-9956-ffa450edef68"
17684b2b4c8177166f6bf2eeeeb2d55d693d7557,"Major checkin that includes JIndent formatting.   See my note titled
""Optimizations, changes"" on the xalan-dev list 10/30/2000 03:55 PM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333642 13f79535-47bb-0310-9956-ffa450edef68"
3280ee4a45c19ba5c3b7532b4147832a589bcc26,"Changed dev build number to 02


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333643 13f79535-47bb-0310-9956-ffa450edef68"
f5e04aa94dc0d95ec59af6621ecaae847fb5afbc,"Fast iterator for ""node()"" selections.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333644 13f79535-47bb-0310-9956-ffa450edef68"
db6cf3dd941ddf2a337381782a3fd13377f61db0,"Add NodeFilter.SHOW_DOCUMENT_FRAGMENT, for DocumentFragment compatibility.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333645 13f79535-47bb-0310-9956-ffa450edef68"
9ad5f53a7cf413a3ea4a096f16ce1e8a66cbb0fd,"Check for DocumentFragment for traversal.  Attributed to Gary L Peskin <garyp@firstech.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333646 13f79535-47bb-0310-9956-ffa450edef68"
21ab31babc7f97cc0cf1303e5bc421fd7b8836f7,"In getRoot, use DocumentFragment as the root.  Attributed to Gary L Peskin <garyp@firstech.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333647 13f79535-47bb-0310-9956-ffa450edef68"
2ddf9568892bcf3378c78427917b14df86b9f8b6,"Use same head fetch for DocumentFragment as for Document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333648 13f79535-47bb-0310-9956-ffa450edef68"
63b91382be1d9f7975c3016ef33077446ed99ad0,"Remove xml-space stuff, which is processed at the ElemTemplateElem level.  Attributed to Gary L Peskin <garyp@firstech.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333649 13f79535-47bb-0310-9956-ffa450edef68"
f7b9851253abd2ebf8fa279287e498c2a5d2b055,"Have setXmlSpace use an int instead of a boolean, since it is an enumerated value.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333650 13f79535-47bb-0310-9956-ffa450edef68"
df8b6518111d7a0317846d47a4038e0eb1cecabc,"Do a fireSelectedEvent immediatly after the selection (somehow this was removed).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333651 13f79535-47bb-0310-9956-ffa450edef68"
4d710a93e1eee75673b6cc3fcda4f869eb68330b,"For the selected method, if the type is an itterator, test for ContextNodeList.
If it is a ContextNodeList, do cloneWithReset.  Otherwise
simply spit out a message that says, can't do it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333652 13f79535-47bb-0310-9956-ffa450edef68"
8e4261285e9d91b972175394ea514054169949a9,"In getSetterMethodName, hack the xml:space attribute to call setXmlSpace,
attributed to Gary L Peskin <garyp@firstech.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333653 13f79535-47bb-0310-9956-ffa450edef68"
00e72246c0526434d9ca53493b122fad58904be6,"Things to be done list.  All XalanJ2 developers should try and work off this list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333654 13f79535-47bb-0310-9956-ffa450edef68"
37ebcc8e261e8f070694d1616a968c4a8a6735b2,"Generalize getSetterMethodName to handle attributes in xml: namespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333655 13f79535-47bb-0310-9956-ffa450edef68"
9994255996d72de0f3ab63ada61d81cd304bf431,"Clean up double semicolon.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333656 13f79535-47bb-0310-9956-ffa450edef68"
889343af5f39a702ebc4bfa9d567f5e89e626a60,"Implement document fragments to mirror documents.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333657 13f79535-47bb-0310-9956-ffa450edef68"
312d3fcc0ec68eb7d5aeb330d452421330f69486,"Implement document fragments to mirror documents.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333658 13f79535-47bb-0310-9956-ffa450edef68"
edebda27045afa19d5f8ecd744e664a470c9eff8,"update to ant 1.2 in progress.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333659 13f79535-47bb-0310-9956-ffa450edef68"
6271ab2d6318ad4fbe2839107e6b3db04886d8a8,"James Davidson, Rajiv Mordani, and myself got together last week at ApacheCon London to work on the TrAX proposal.  You can find the results of this work at http://xml.apache.org/trax/trax_10_30_00.zip (sorry about the apache address, it's all I have outside our firewall).

The highlights of the changes are:

1) Processor has been renamed to TransformerFactory, in order to match the javax.xml.parsers pattern.

2) Input and Result are defined with abstract interfaces (Source and Result) that are empty.  You must use a concrete implementation of these interfaces.

3) Three subpackages are defined: sax, dom, and stream. These implement the specifics for the given Source and Result types.  In addition, the sax package has a SAXTransformerFactory, SerializerHandler, and TransformerHandler.

4) The serializer package is gone (sorry, Assaf).  Instead, TransformerFactory now implements a newTransformer method that takes no arguments.  This method is defined to return a Transformer that does an identity copy from Source to Result.  With this, you can do everything the serializer interface did, and more.

5) The one thing I don't like much, is that TransformerFactory.newInstance no longer takes a string as an argument (which signified the type of TransformerFactory you want).  James used the same argument about this as he used about the DOM builder.  But, there are complicating factors, and it's better to be more simple now, and add this in later, if it is really needed.

6) The Features class contains URLs for all the supported types of features, i.e. DOM, SAX, etc.

7) Namespaced names (or Universal Names) are specified to be passed as {url}local-name.  While this is ugly, it's the only way to cleanly use existing Java classes like Properties that use the String class, and is easy enough to parse.  These are used both for output properties, and for variables.

I am pretty happy with this API at this point, though I'm sure it needs some polishing on details.  It lines up cleanly with the existing JSR63 transform stuff (a lot of the wording won't have to be changed), allows anybody to define a transformation from any object to any object (for instance, it will be easy to define a JDOM transformer),  supports different transformer models, is very powerful, yet is relatively simple for the job to be done.  I *think* Mike Kay will be pleased also, but he'll have to speak for himself.

A good place to start is the examples file.

Work to be done:

1) Documentation, both JavaDoc and the JSR doc (which James will do).
2) Rajiv needs to do some work on the TransformerFactory to bring it fully into line with javax.xml.parsers.
3) Respond to comments and requests for revisions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333660 13f79535-47bb-0310-9956-ffa450edef68"
b91ef1396573c7c269de5dee5bf03aa15ef26876,"Only declare a serialize(Node node) method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333661 13f79535-47bb-0310-9956-ffa450edef68"
2960ea8202b3c918d1a1cfb0330512c3f3bd3c66,"Implement DOMSerializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333662 13f79535-47bb-0310-9956-ffa450edef68"
3ec9c550e45221b1b278619eb56831125e1c51c0,"Completed update to work with ant 1.2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333663 13f79535-47bb-0310-9956-ffa450edef68"
f45e6a403d45ab50ef730bf97cead7f5b710822f,"Fixed references to distribution directory (dist.dir).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333664 13f79535-47bb-0310-9956-ffa450edef68"
003154feaae10911ab4d89fe2355e83ccc43ceee,"Added and corrected links to external resources.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333665 13f79535-47bb-0310-9956-ffa450edef68"
ff7469af754d3e69713db78fcd5a2314229afd5f,"Addressed SPR on documentation detail: DMAN4QHQB6


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333666 13f79535-47bb-0310-9956-ffa450edef68"
3815287376886bf5802b256d1ed37345f0695420,"Eliminate unneded calls to Compiler.getWhatToShow()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333667 13f79535-47bb-0310-9956-ffa450edef68"
76daa2a562eb6305fb6e7730230db030812c56f9,"Fix cloning to ensure that a fresh copy is returned.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333668 13f79535-47bb-0310-9956-ffa450edef68"
639e0b03dda9e75d65d12f35c8d1df92780d2b00,"Improve error handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333669 13f79535-47bb-0310-9956-ffa450edef68"
38e8858bab3124c46d7cf9c151b68f4a15d50135,"Visit compose() method for all elements in all imported and included stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333670 13f79535-47bb-0310-9956-ffa450edef68"
d9d22c113a0cf26e448a0ddfb23b94674bb4627b,"Renaming to javax.transform


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333671 13f79535-47bb-0310-9956-ffa450edef68"
887d5aa5dfb0123e74ea475534a88623b5970938,"The javax.xml.transform
package is the reborn TrAX.
Changed factory exception classes to be closer to JSR63 parser stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333672 13f79535-47bb-0310-9956-ffa450edef68"
253e20477707e0b14dde31adc706e7d850100a35,"TrAX (Transformations API for XML) changes.  The javax.xml.transform
package is the reborn TrAX.  Significant changes were needed in
the code because of the change of exception derivation and
Locator change, and also because the structure has indeed changed
a bit.  The code is still a little rough for the wear.  I'll work in the coming
days to polish it up.  Internally, the code still uses Assaf's OutputFormat,
but this should change to use the Properties bag.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333673 13f79535-47bb-0310-9956-ffa450edef68"
408c4a22800729d4f07993f543c763966e6f7d43,"Define services files for default settings of the JAX properties.

The ANT file needs to be updated to process these into the
JAR file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333674 13f79535-47bb-0310-9956-ffa450edef68"
ade43fdf4927c2a2845f14e65036ef71b9e06268,"Modified so the META-INF directory will be copied into the JAR.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333675 13f79535-47bb-0310-9956-ffa450edef68"
3f4ac11edf103ce7a084ae3e028d94c3cc4eee0a,"Examples all seem to work, except the exampleXMLFilterChain
must use baz.xsl instead of foo.xsl, because of a bug that I have
not yet solved with threading and piped transforms.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333676 13f79535-47bb-0310-9956-ffa450edef68"
c5b066f6f2a33bd446849033e1273395c96f8b62,"Changed name of StylesheetProcessor to TransformerFactoryImpl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333677 13f79535-47bb-0310-9956-ffa450edef68"
136ffeca37a5d7192de900c47b47109456e39fd9,"Copy META-MF stuff into jar file, fix for javax vs. TrAX.  Exclude msclasses and classes dirs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333678 13f79535-47bb-0310-9956-ffa450edef68"
8fb98b3508a4e6623fa38e3dedee4229437b241b,"Manifest file, that should be properly filled in over time.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333679 13f79535-47bb-0310-9956-ffa450edef68"
9227071f0d29f11014c23a82584b683dddab33f1,"Added more examples.  Moved xsl and xml to subdirs to stress relative URL handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333680 13f79535-47bb-0310-9956-ffa450edef68"
84bc7ce6ad475135451c7d7038a887ba144d3b0a,"Moved getAssociatedStylesheet up from SAX level.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333681 13f79535-47bb-0310-9956-ffa450edef68"
8857c7b3a6e748afa3c83a6302e512b3f560ae28,"Moved getAssociatedStylesheet up to generic level.  added newTransformerHandler(Templates templates).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333682 13f79535-47bb-0310-9956-ffa450edef68"
5edf4d13ca5a2067307fa38e4584ba9bd6dab825,"Removed decl handler stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333683 13f79535-47bb-0310-9956-ffa450edef68"
07c1176f5cf4977f26b91e83580c4a045107f8aa,"Added newTransformerHandler(Templates templates),
call second processFromNode method so that
m_DOMsystemID gets set.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333684 13f79535-47bb-0310-9956-ffa450edef68"
196f4b7191ba020b98e94888d7e7b31cfd8fa38e,"Some experimentation with whitespace sensing in the characters event.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333685 13f79535-47bb-0310-9956-ffa450edef68"
2e867ca988ff109c5708417e6ff25ad40e83df43,"Documentation changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333686 13f79535-47bb-0310-9956-ffa450edef68"
5ae09661cd9efe8645901d875614d61e54abf87e,"Documentation changes, changed setIDAttribute to only take id and element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333687 13f79535-47bb-0310-9956-ffa450edef68"
abcfdbad9a75318af517dc507e308577c1c66ef1,"Remove commented section in startDocument.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333688 13f79535-47bb-0310-9956-ffa450edef68"
e78b31470c47e6896b606dd6a0f99ba898ef88d3,"Documentation changes, only pass ID and elem to setIDAttribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333689 13f79535-47bb-0310-9956-ffa450edef68"
470c591f2b73eacdccc5c3522a8ab749459f9ad5,"Param documentation should be complete for this class now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333690 13f79535-47bb-0310-9956-ffa450edef68"
bbfe5cccdb5c5bd399a51f69aad0f968e659388d,"Try identity comparison for OutputKeys first, before testing for equality.
Also, small exception handling fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333691 13f79535-47bb-0310-9956-ffa450edef68"
30c8415d45960584c40fd98cfd6e5c060182d9a3,"Mainly fixes for exception handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333692 13f79535-47bb-0310-9956-ffa450edef68"
a41e1732e8c746971a862652c3fb3076b3c512e6,"Documentation.
Also, call setIDAttribute with only two args.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333693 13f79535-47bb-0310-9956-ffa450edef68"
6f87e31bbebf8b21a05f098b9d47932fb4ea6cb1,"Add getOutputProperties.
Explain that Transformers may be reused.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333694 13f79535-47bb-0310-9956-ffa450edef68"
d8d7884e8be2a991b2eef26f8592b36261457275,"Add exampleTransformerReuse.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333696 13f79535-47bb-0310-9956-ffa450edef68"
0b3e4bd2fc8be98d8212d7af5e428258e23a2200,"Reset the document cache in reset.  Add getProperties.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333697 13f79535-47bb-0310-9956-ffa450edef68"
298d6011e7bb515f6365c2a1c1ee004ae939cbc9,"Check for null reader and null error handler in warn and error functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333698 13f79535-47bb-0310-9956-ffa450edef68"
afd3568bd92188506156ece4bdb401b7424facd7,"Add reset method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333699 13f79535-47bb-0310-9956-ffa450edef68"
78bed35566a41c950646c0edc030de70dfebb7ef,"Check m_xpath for null also.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333700 13f79535-47bb-0310-9956-ffa450edef68"
c1a6dcbf97edb16837a2e84c9dacc2d7bfdfdee8,"Do nested stack traces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333701 13f79535-47bb-0310-9956-ffa450edef68"
bc546475418d1aadfa86bb288ed9bf6d6f9e42ed,"Add methods to save and set the search context of the stack.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333702 13f79535-47bb-0310-9956-ffa450edef68"
0922b7add40aa310e7015f0c5bad1178e50154df,"Save the variable stack search context when initContext is called,
and restore the state every time next node is called.  Another performance
issue.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333703 13f79535-47bb-0310-9956-ffa450edef68"
2c4075837a699afffd8721101e98391ebf6ec41a,"Modified to deal with the Manifest better


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333704 13f79535-47bb-0310-9956-ffa450edef68"
a9842af604987d11964b965ef92517e350fa56a8,"Moved from META-INF, which the build/jar doesn't like.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333705 13f79535-47bb-0310-9956-ffa450edef68"
20422b32852c165b528dff172d99b05be20809ae,"Moved ""implement javax.trax interfaces"" task to completed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333706 13f79535-47bb-0310-9956-ffa450edef68"
8b030450dbea3540a4acc46e8096fe9af45f143e,"Javadoc fix, and distinction between javax.xml.parsers and javax.xml.transform


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333707 13f79535-47bb-0310-9956-ffa450edef68"
4c2420296d2cd998e37c5a5ca8ba544298f56293,"No longer used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333708 13f79535-47bb-0310-9956-ffa450edef68"
9dc5fa6bbd1d06d89c311fbd66115a7232428c0c,"Added getURIResolver.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333709 13f79535-47bb-0310-9956-ffa450edef68"
9206ba0a9c508069fe1139d7abc7b80d1aeae49b,"Minor JavaDoc change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333710 13f79535-47bb-0310-9956-ffa450edef68"
831b18b9fa65ff3c6374f8a576642bc2da15d53f,"Minor JavaDoc change for getURIResolver.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333711 13f79535-47bb-0310-9956-ffa450edef68"
b832ec79f315836810663054b57525460885a48a,"Added getURIResolver method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333712 13f79535-47bb-0310-9956-ffa450edef68"
6393300b21c7459443c2d6ddc1d0ca01a83196e6,"Fix so that if an extension element processes its children (like Redirect), xsl:fallback elements will by bypassed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333713 13f79535-47bb-0310-9956-ffa450edef68"
73367b6ea14fe09bf21d5f06bd5f62cec538c6db,"Clean up nodeset to handle any type of argument.  Fix javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333714 13f79535-47bb-0310-9956-ffa450edef68"
16d90e2bee7a411cdbcd6c33f9f22956c7c65526,"Fix javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333715 13f79535-47bb-0310-9956-ffa450edef68"
d30b740160d9b82e39ed72e452f593c8c94636ae,"Javadoc fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333716 13f79535-47bb-0310-9956-ffa450edef68"
0f084614fb851297f74accd74355ac815138f63f,"Make sure current node remains in the same place when getCurrent is called.
This needs more work, I think, and the fix should really be made
lower down.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333717 13f79535-47bb-0310-9956-ffa450edef68"
22a14f0a337e71b629cfbe28556c663208fc9bf6,"Javadoc comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333718 13f79535-47bb-0310-9956-ffa450edef68"
cac7f0283ebae441f91bf379b4e4c034fb160dc3,"Javadoc cleanup


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333719 13f79535-47bb-0310-9956-ffa450edef68"
3e8f4588c29672691951c89df0741477ddc5a812,"Quick fix to use new TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333720 13f79535-47bb-0310-9956-ffa450edef68"
5d453c149423058faebaea29952d738f7d702ba3,"Documentation changes!!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333721 13f79535-47bb-0310-9956-ffa450edef68"
6502c3193b4e4777f4c6de04d995ab32ecc38a82,"Don't use child iterator if predicate is used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333722 13f79535-47bb-0310-9956-ffa450edef68"
cc8602db5116af48762c6736a4c78b61a4c512c9,"Fixes for variable resolution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333723 13f79535-47bb-0310-9956-ffa450edef68"
b3bc461dd8480f18c11281641b7735f7c15f1c27,"Minor typo change to javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333724 13f79535-47bb-0310-9956-ffa450edef68"
e47358283f55f5cfc5515dc58d5677bda4984673,"Change global variables and parameters list so that they are only
one list, and store composed global variables and params as a vector
instead of a hashtable, so that order is preserved.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333725 13f79535-47bb-0310-9956-ffa450edef68"
c3af79b7cc966b8f086838580048d8fe6df749b9,"More Documentation changes!!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333726 13f79535-47bb-0310-9956-ffa450edef68"
a777c1f4aaebcb758ff419bd8f638bdaa4aa86a3,"Fixes in servlet target to get everything needed in
.\build\xalanservlet.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333727 13f79535-47bb-0310-9956-ffa450edef68"
8e0794b60b340fdd2edeb0c45554112ed88bedf7,"Fixed problem where exception thrown from getFeature was not being
caught, which kept Crimson from working.  Also, in DOMBuilder, don't
call setAttributeNS for an xmlns: attribute because Crimson doesn't
like it.  Things should work OK with Crimson now, at least with the
TrAX examples smoke test.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333728 13f79535-47bb-0310-9956-ffa450edef68"
330f8649978756a39e011456e0cd6ad05216510a,"Just added commented out crimson lines.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333729 13f79535-47bb-0310-9956-ffa450edef68"
c7b4113a6a4ea721170a452116f5ea40bb0571ee,"Cleaned up logic to build template chains.  Added comments.
Enforce document order rules.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333730 13f79535-47bb-0310-9956-ffa450edef68"
3c4f213a456571ba43ccb58e538f106faf0a164c,"Change getWhatToShow to return a more accurate NodeFilter for node(),
Cleaned up handing of text nodes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333731 13f79535-47bb-0310-9956-ffa450edef68"
3c09d9afd35b6be68d0e804ca670110bb6feb487,"Removed special case coding in executeStep no longer needed
due to refined NodeFilter.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333732 13f79535-47bb-0310-9956-ffa450edef68"
21945be192379ec063635a7bd309fd63f081de40,"Explicitly test for child::node() before considering ChildIterator.
The old test for a NodeFilter doesn't work anymore because
getWhatToShow now returns more specific information.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333733 13f79535-47bb-0310-9956-ffa450edef68"
c962274791073aa46762fe0ebacde49896ca767a,"Added else to eliminate unnecessarily executing if statement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333734 13f79535-47bb-0310-9956-ffa450edef68"
380beb34f925a50381dd7e9f8d978a49fe8f7c8a,"Resynchronizing with trax changes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333735 13f79535-47bb-0310-9956-ffa450edef68"
7a125c0442c1af81fe6d9a7cefdbd09f376af450,"Added java doc comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333736 13f79535-47bb-0310-9956-ffa450edef68"
f2ec4361cb408f3eb4d33e9013f78e3e97a6f9bf,"Fixed variable problems.  Including forward references with globals,
and QNames with variables now work.  I don't thing that cyclic
variables are tested for yet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333737 13f79535-47bb-0310-9956-ffa450edef68"
926bf6bb440ac69d53b9a4a1b15c00aa3bda277c,"Add duplicate variable name problem


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333738 13f79535-47bb-0310-9956-ffa450edef68"
f5aaa01369656110effe92463f70c357ebe14cd0,"Small change in Examples - catch and display exceptions for each
individual example. ( if one fails, the following examples will still
be executed). Also display the ""chained"" exception, as most of the time
it is the real source of truble.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333739 13f79535-47bb-0310-9956-ffa450edef68"
5aeb227933db5b660d6dad5a45e4e03b55c42f36,"Sync with the javax.xml tree.

As sugested, the cached value for factory will be used after the
system property, because the user might change the system property.

We still cache the value read from java.home/lib/jaxp.properties and
from CLASSPATH because both involve expensive file operations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333740 13f79535-47bb-0310-9956-ffa450edef68"
bc0ffd62b5b95f4a58b7e06b97753e0da8ec94da,"Correct and cleanup recomposeImports() to generate m_globalImportList with correct precedence.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333741 13f79535-47bb-0310-9956-ffa450edef68"
9cf54aed0a428d955a76c927ea052380c544d99e,"Fixes to accomodate new trax/serializer/etc.,
and Ritesh Kumar's fix for detecting and using the correct
server port.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333742 13f79535-47bb-0310-9956-ffa450edef68"
3686880bf2cf5db39e7ff2594023570b25f6cacb,"Moved ""Catch multiple definitions"" to high priority.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333743 13f79535-47bb-0310-9956-ffa450edef68"
1f271884d98f008496385e9b9f18a6f3099c2088,"Patches submitted by ""John Ky"" <hand@syd.speednet.com.au,
for ""FONT"", and ""NOBR"",
also I added ""S"", ""STRIKE"", and ""U"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333744 13f79535-47bb-0310-9956-ffa450edef68"
e859e374ff860a1a14ad2d68249a1899591ebae2,"In TrAX, changed get/setBaseID to get/setSystemID.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333745 13f79535-47bb-0310-9956-ffa450edef68"
eca4225c6777690af4f67eb9b46fbdf325d07d23,"Added a default for the TransformImpl.

This avoids problems with ClassLoaders and broken builds. It also
allows xalan to work even if services/ is not present.

Scott, I think you forgot to check in some changes in Source ( the systemId),
I can't build right now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333746 13f79535-47bb-0310-9956-ffa450edef68"
8d8bf7ffa085123c19d26d85ea2c9873ee13fc6b,"Changes to TrAX:
  Moved OutputKeys to generic level.
  Added ErrorListener.
  set/getSystemID on Source and Result interfaces.
  Nix SerializerHandler, define PI strings on Result object.
  Define null node on result as implementation will create Document.
  Major javaDoc improvements, including package overviews.
  URLResolver example in TrAX examples.
  Other TrAX examples added.

Moved org.apache.serialize files to org.apache.xalan.serialize.
Major changes for ErrorListener, all exceptions thrown are Transformer
exceptions except when SAX interfaces require the SAX exception.

Two regressions caused to conformance tests that I haven't
tracked down yet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333747 13f79535-47bb-0310-9956-ffa450edef68"
a94b54713d1467153f7ac188bb8fbd175470dc99,"Added XMLFilter newXMLFilter(Templates templates),
Made both versions of newXMLFilter throw
TransformerConfigurationException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333748 13f79535-47bb-0310-9956-ffa450edef68"
a93d5a62d535e3a8438629dae150e20636cea5e0,"Removed JavaDoc part about doing identity comparisons.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333749 13f79535-47bb-0310-9956-ffa450edef68"
2d77313fd6e9f0f47a63a51c2cef8db0d2ace415,"Javadoc updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333750 13f79535-47bb-0310-9956-ffa450edef68"
cde6fd3e6c39139b763b01505370a3e94af5d6b5,"Javadoc updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333751 13f79535-47bb-0310-9956-ffa450edef68"
c336ba05501e9d4974d9c2d207f36842877c5654,"In getBaseIdentifier(), try to use the
m_baseIdentifiers stack, and only use
the locators stack if this is empty.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333752 13f79535-47bb-0310-9956-ffa450edef68"
045e23e9f6d124ad7f4ed7eb7795ccb86980cc0b,"In recomposeOutput, fix it so the call to getOutput gets the output
from the stylesheet passed in, not the ""this"" output format.
Fixes impincl\impincl01 test.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333753 13f79535-47bb-0310-9956-ffa450edef68"
181cc32b5ebf7e1d500e6b072eba86e20af9a3e5,"Commented out garyp code of 2000/11/2.  The current node should
not be reset with a normal clone, but should only be reset with
a reset operation, and the clone should not be marked as fresh.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333754 13f79535-47bb-0310-9956-ffa450edef68"
e46c4c08ee276a28c7edec53b8414fde621bebcd,"Catch and disallow use of circular variables plus miscellaneous changes to error reporting and exception handling. Also change code to use SourceLocator and not SaxSourceLocator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333755 13f79535-47bb-0310-9956-ffa450edef68"
85e15b533df854d0a871b9db5c483f8b1c60a857,"Javadoc update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333756 13f79535-47bb-0310-9956-ffa450edef68"
b89b6450b4cb3e9ec4a30f6fe1739d218adbe26b,"Javadoc update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333757 13f79535-47bb-0310-9956-ffa450edef68"
2eae15744e9a56b5c4841bc79827cb9ac8c65217,"The last() function was trying to turn the context list into
a cached list on the fly, which causes nasty problems from inside
a predicate.  So, I commented that code out (but left it there for
reference), and use a clone to get the count from the current
position.  I then defined a set/getLast method on ContextNodeList,
and store the count there.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333758 13f79535-47bb-0310-9956-ffa450edef68"
be09a78d1c182cd0c71ad7af8c4b073c837b7cd3,"Bugs from Shane TrAX API testing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333759 13f79535-47bb-0310-9956-ffa450edef68"
6544a343908e04413d5f29b0a8a093cc96e7f451,"Changed TemplateHandler#setSystemID to TemplateHandler#setSystemId.
Delete the Features class, and define FEATURE variables on
the Source and Result derived classes, as well as on SAXTransformerFactory
and also define FEATURE_XMLFILTER on SAXTransformerFactory.
The overview is now broken from the javax.xml.transform package doc.
Other minor javadoc fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333760 13f79535-47bb-0310-9956-ffa450edef68"
91e1e0a66001c5ee8b33791b8ae0c32e7d250e89,"Updated for TrAX changes:
Changed TemplateHandler#setSystemID to TemplateHandler#setSystemId.
Delete the Features class, and define FEATURE variables on
the Source and Result derived classes, as well as on SAXTransformerFactory
and also define FEATURE_XMLFILTER on SAXTransformerFactory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333761 13f79535-47bb-0310-9956-ffa450edef68"
b38f52a2793ca202360efa9ae5574ba4bed18f5c,"Removed Features.java and added overview.html.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333762 13f79535-47bb-0310-9956-ffa450edef68"
41c5c99bfe789ec96398b1c01785561774363c0a,"Minor javadoc changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333763 13f79535-47bb-0310-9956-ffa450edef68"
c45b5cc85e82e1430c3acdcfb317f6017b207d5c,"Fix ouput for disabled output escaped text


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333764 13f79535-47bb-0310-9956-ffa450edef68"
aab214a78ce6e7a28e112538bafa7df999841558,"Bug fixes for SPRs that have to do with output properties and param setting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333765 13f79535-47bb-0310-9956-ffa450edef68"
d1454b8527eba7821a15b331d801a841da4b7b8b,"All SPRs pended.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333766 13f79535-47bb-0310-9956-ffa450edef68"
21d8dc4d0939e7fef36030fa33eb40f71b9107a1,"Two reports from Mikael Stldal <d96-mst@d.kth.se>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333767 13f79535-47bb-0310-9956-ffa450edef68"
dcccbf3667c90ef933ccb1704b02e0f8a6e9e00c,"Wrap setAutoCommit with try, and catch SQLException if thrown.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333768 13f79535-47bb-0310-9956-ffa450edef68"
7f5085e203d7b815c3ff8290013326762cd04a2a,"Don't suppress output of whitespace before the first element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333769 13f79535-47bb-0310-9956-ffa450edef68"
a7a87f2de05b5795317a44e85f33c28fc74ef509,"Use """" instead of null, as Xerces likes """" for the
name of the default namespace.  Fix attributed
to ""Steven Murray"" <smurray@ebt.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333770 13f79535-47bb-0310-9956-ffa450edef68"
cb95fc80299ccf6bb630bab451d4d473e59b1898,"Add document order indexes to ElemTemplateElements, as per
discussions with Gary P., and pass them into TemplateList#setTemplate.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333771 13f79535-47bb-0310-9956-ffa450edef68"
ca12bef91c403823559066dbc14681c291c5248d,"Updated to new DOM API, so we match with Xerces 1.2.1.  Updated
Xalan code to use isSupported instead of supports.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333772 13f79535-47bb-0310-9956-ffa450edef68"
3e9d2705ff52c17ce791d35a79dfe15ef7ea3c81,"Updated to use new TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333773 13f79535-47bb-0310-9956-ffa450edef68"
3d0ee18117c0b9c201cf660d63f662d093841040,"Xerces 1.2.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333774 13f79535-47bb-0310-9956-ffa450edef68"
aeed7096a0c462b7c5b90142ce1968bc5d76bfe5,"No longer in use.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333775 13f79535-47bb-0310-9956-ffa450edef68"
cfe595a20f70b5d1ee3ef7c18a761d10637b1144,"Changed TransformerHandler#setBaseID to setSystemId (sorry), and
added getSystemId to both TransformerHandler and TemplatesHandler.
Fixed setURIResolver comments to accurately reflect use in the
document() function vs. xsl:include/xsl:import.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333776 13f79535-47bb-0310-9956-ffa450edef68"
65077ca95bd7f4f68b5f7dc36ebe1c4c64347a6c,"Added trax material to javadoc target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333777 13f79535-47bb-0310-9956-ffa450edef68"
e1ed953018ac8b0cdfa392332045723fe9954f07,"The trax package.html files and an overview file are generated
during the build from trax.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333778 13f79535-47bb-0310-9956-ffa450edef68"
7535ba0889b9e3cba9187ce51dd382cac299c51e,"Fixed assign in setInputSource.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333779 13f79535-47bb-0310-9956-ffa450edef68"
0730bfa5c29ad31fbd21b0c01e6a7185b6ce5c65,"Append current text to text of previously created text node from the last Characters


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333780 13f79535-47bb-0310-9956-ffa450edef68"
98458e1b18b149346963842450fcacb87696d96c,"When the node being copied is a root node (and thus no node
is created), call super.execute so that the ElemUse stuff gets
applied to the containing element.  This fixes bugs in attributeset 27
and 29.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333781 13f79535-47bb-0310-9956-ffa450edef68"
a3d7e5c5ff391082c48b8b28deff165359307e9f,"Loose extra printStackTrace in processFromNode.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333782 13f79535-47bb-0310-9956-ffa450edef68"
505cb5c4ececcbc59c937e66d95e40b1be6aa7f4,"Replaced javax.xml.parsers ( wich used to represent JAXP1.0 ) with the
latest JAXP1.1.

Now both javax.xml.transform and javax.xml.parsers correspond with the
latest spec.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333783 13f79535-47bb-0310-9956-ffa450edef68"
f6d6c3c9c4de708ad9246e0cd88e7f233b63c1dd,"Fixed the trax example to use the latest spec.

Also, use JAXP1.1 to get the XMLReader.

Tested it with both crimson and xerces - just include the parser you want
in CLASSPATH and it'll work !


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333784 13f79535-47bb-0310-9956-ffa450edef68"
9414add53be92a712d23c25db2aabdadea3f1439,"Updated xerces.jar - now it's the latest ( as of Nov 15, 19:17 PST ).

The new xerces.jar implements JAXP1.1.

From strange reasons, the default for namespaceAware is false ( used to
be true in previous versions ) - you need to explicitely set this to
true to use it with xalan.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333785 13f79535-47bb-0310-9956-ffa450edef68"
2b194d8f46374fa9c2fa843a5269f08857af464f,"Use JAXP1.1 to get  the XMLReader - there are 5 files where a new
XMLReader is created, and now we use SAXParserFactory to get
it.

We do check for NoSuchMethodError - that means the code will work even
if you have an old JAXP1.0 parser ( assuming you have the old parser
at the beginning of CLASSPATH, same for JAXP1.0 - since xalan
includes the latest ). Probably that will disapear when no longer needed.

I tested with crimson, xerces ( latest - JAXP1.1 ), xerces ( old - JAXP1.0),
it seems to work fine.

Also, in StylesheetHandler, add an extra check for NPE - during debug
it happened to have an unchecked null ( and it can't hurt to check )


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333786 13f79535-47bb-0310-9956-ffa450edef68"
8acaa8136af6723208a1245cf261f6a5dced03bb,"Implement entity handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333787 13f79535-47bb-0310-9956-ffa450edef68"
b0a4f3e2ceb1d87f738e03459039ab6896455cff,"Removed commented crimson lines.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333788 13f79535-47bb-0310-9956-ffa450edef68"
a4e276c41b32dedf337e16acd44a220597f7fba2,"Javadoc correction for empty constructor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333789 13f79535-47bb-0310-9956-ffa450edef68"
65d57f0eccb279eb581c6c0de7ca108536ed01bb,"1. Fixed ApplyXSLTListener constructor to match DefaultErrorHandler.
2. Use default OutputFormatExtended if get null from stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333790 13f79535-47bb-0310-9956-ffa450edef68"
4a2c386f46899c7700d5b31e7dfe4ec8732efb85,"Uncommented code for check for name, so that keys work when there
are multiple declarations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333791 13f79535-47bb-0310-9956-ffa450edef68"
94cc411a47dbb89b6a94432b35e73379792ca34a,"Uncommented code for check for name, so that keys work when there
are multiple declarations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333792 13f79535-47bb-0310-9956-ffa450edef68"
060861ea3397b13b3eb7889aec57f3be6ae120a0,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333793 13f79535-47bb-0310-9956-ffa450edef68"
566540e7a9a44ad8f899e5a59e944c8354eb7a20,"Add fast iterator for simple child tests without predicates.
Tried to do .detach on iterators but ran into too many regressions,
so I commented code out.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333794 13f79535-47bb-0310-9956-ffa450edef68"
193c8f19c262376197ae17f32b2bf4624e920128,"Commented out samples task -- needs work to catch up to
new TrAX -- servlet and applet are working.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333795 13f79535-47bb-0310-9956-ffa450edef68"
d2c6083673c0d365e9ba24efd9bbb83a94d44699,"Fix name and namespace functions so they don't return names for ""#xxx"" names.
Fix version system property so that it returns the version of the spec we conform to.
Fix terminate attribute on xsl:message.
Don't put out warning prefix for a warning in the default error listener.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333796 13f79535-47bb-0310-9956-ffa450edef68"
40894880eb20605a69428dac7dc8a4330553b566,"Updated to use new TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333797 13f79535-47bb-0310-9956-ffa450edef68"
05fd9b23c27ec23090bbeb341fb5f89ac4bfb16b,"Removed space in front of the string that caused an hour of work.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333798 13f79535-47bb-0310-9956-ffa450edef68"
6e3861d8bcfe4090efc8a3b0190e97593e27468d,"Updated to use new TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333799 13f79535-47bb-0310-9956-ffa450edef68"
7c7cfd7d3d8f8dac011b715d9080bdd23df638ff,"Process templates and whitespace stripping with proper precedence.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333801 13f79535-47bb-0310-9956-ffa450edef68"
527d7302fc0f592ec6996ce7dcf75448f25b7f27,"In newTemplates, make the default for a null base ID be:

      String currentDir = System.getProperty(""user.dir"");;
      baseID = ""file:///""+currentDir+java.io.File.separatorChar+source.getClass().getName();


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333802 13f79535-47bb-0310-9956-ffa450edef68"
b5acebeffbf35edde927c9e3f3f8b3315a8ca732,"Changes made to TrAX API in response to Sun evaluation:
StreamSource/Result now have File constructors and setSystemID(File).
set/getCharacterStream and set/getByteStream now changed
to set/getReader/Writer and set/getInput/OutputStream.
Added getCause stuff to TransformerException.
Added clearParameters method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333803 13f79535-47bb-0310-9956-ffa450edef68"
1b5aab82776c71d14144d5b785c76c185330bc3c,"Updated to use new TrAX. Doesn't really work with new Serializer!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333804 13f79535-47bb-0310-9956-ffa450edef68"
19b10c7108c25b1e5a77fa818449a5c7d55b7c5c,"Updated to use new TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333805 13f79535-47bb-0310-9956-ffa450edef68"
62f2d321c3b0d8a0eca9b602d5faf494400c0b5a,"Include all samples in samples target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333806 13f79535-47bb-0310-9956-ffa450edef68"
66e929fbbef13f9ae1204b8f56e3e53d356dc8e6,"Updated to use new TrAX. Only works for serializing entire document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333807 13f79535-47bb-0310-9956-ffa450edef68"
7ff256f747ffd0e2113ea9fe61746cdd4dcf008a,"Updated to use new TrAX. Only works for serializing entire document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333808 13f79535-47bb-0310-9956-ffa450edef68"
3e82fd3e3d9dc2524c0b1d90563821d6706152c8,"Updated to latest status.  Reformated a bit, to produce status reports.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333809 13f79535-47bb-0310-9956-ffa450edef68"
439923692a62793c8cfd9d134feec9dfbbe71531,"XSLT file for formatting todo list.  Probably should be placed somewhere else.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333810 13f79535-47bb-0310-9956-ffa450edef68"
7aa0b2e8c558b6f5187d24c3fd8797864e40cf44,"StreamSource.getByteStream() is now
StreamSource.getInputstream().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333811 13f79535-47bb-0310-9956-ffa450edef68"
91f44277829f32db130ca1ef944aa7bc8dc581f9,"Fixed error (calling old TrAX)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333812 13f79535-47bb-0310-9956-ffa450edef68"
8d83417740b4b62b81026f5a127fae1ddf39fc2f,"Editorial fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333813 13f79535-47bb-0310-9956-ffa450edef68"
18adb3c8c83aa3c3c99ea9b05e86cdb46b9d2341,"work in progress


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333814 13f79535-47bb-0310-9956-ffa450edef68"
94a60daaffc257c7732f46c7a45a80d766f1bbf1,"Javadoc complete.  Some of these files got wacked by JBuilder's
trimming of trailing spaces (which I didn't realize was on), so if
you need to do diffs, you should use a diff problem that can turn
off comparisons based on trailing spaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333815 13f79535-47bb-0310-9956-ffa450edef68"
76a7b537274e71505b349cb07d5a8c93ece5c56e,"Javadoc update.  Some of these files got wacked by JBuilder's
trimming of trailing spaces (which I didn't realize was on), so if
you need to do diffs, you should use a diff problem that can turn
off comparisons based on trailing spaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333816 13f79535-47bb-0310-9956-ffa450edef68"
171e427c88c0a0c6dd81019f0007a0f82e4fea3b,"Minor javadoc change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333817 13f79535-47bb-0310-9956-ffa450edef68"
745585e8504b1f11c8df987a280ae54703f989ef,"Javadoc update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333818 13f79535-47bb-0310-9956-ffa450edef68"
d5874b41e1d667beac1124deb4891288ecec129f,"Made FUNC_KEY_STRING public, so it can be accessed for recursive key evaluation check.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333819 13f79535-47bb-0310-9956-ffa450edef68"
5e449760ed2ab434b37dd5bc04eddc4a6a3638b8,"Re-added package files.  Not sure why these were removed, but
I think the HTML versions should stay check in, if possible.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333820 13f79535-47bb-0310-9956-ffa450edef68"
44e5218b1ece3cfff3d8f4aa213d7e09c6a908d8,"Explain cleaned-up extension support.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333821 13f79535-47bb-0310-9956-ffa450edef68"
d4f9ef1128e471c78e8cc97f9a11f7021597682b,"Moved the org.apache.xalan.utils package to org.apache.xml.utils,
in response to a design concern that, since XPath uses the utils
stuff, this package should not be in the Xalan package.  Also moved
a bunch of the org.apache.xalan.res classes to org.apache.xml.utils.res,
so that the base internationalization stuff can be in a neutral place.
The utils stuff still has a few dependencies on the xalan package,
but we'll be fixing this over the next couple of weeks.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333822 13f79535-47bb-0310-9956-ffa450edef68"
0abf88c6006f9ff7daa4da57a6f2aebfe65d4bf3,"Removed, as I don't think this is used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333823 13f79535-47bb-0310-9956-ffa450edef68"
6dbaffcf1d69bdb3ee16da8fdf19cec35ed33ea6,"Javadoc complete.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333824 13f79535-47bb-0310-9956-ffa450edef68"
7162591c86fc8d74f0663afd6efd8283a26ff2a2,"Removed org.apache.xalan.serialize.QName in favor of
org.apache.utils.QName.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333825 13f79535-47bb-0310-9956-ffa450edef68"
71abb395f0c576e1cab5a225e026cb8970677d6c,"Change signature for equals(QName) method to equals(Object) to properly override Object.equals for equal compares.
Problem showed up in a hashtable.get() which was failing to find an object in the table.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333826 13f79535-47bb-0310-9956-ffa450edef68"
706bbb44ea15dbc72bde15ae048ce80517408286,"Fix check for namespace nodes.  Avoid object creation for empty string.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333827 13f79535-47bb-0310-9956-ffa450edef68"
d9b92e19a2c80dbc98c6c3d999c936f0f9e4283b,"If no ErrorListener is set, obtain one from the owner, if available.  Otherwise, create a default one.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333828 13f79535-47bb-0310-9956-ffa450edef68"
b6ec0dbcb05cb538ee1c35b834fd15762d673928,"Since the free method is not synchronized, do setLength before
the object is freed.  Fix attributed to Peter Speck <speck@ruc.dk>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333829 13f79535-47bb-0310-9956-ffa450edef68"
848202a264b7ce8eba8a14c0caabae3ecaa49698,"Implement element-available for built-in elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333830 13f79535-47bb-0310-9956-ffa450edef68"
5549ca6101253052baa892977b2e5aeafc25f9e7,"Implement function-available for built-in functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333831 13f79535-47bb-0310-9956-ffa450edef68"
899de124b8d5503be452b562e27e9a4bdd7dbccb,"Javadoc added


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333832 13f79535-47bb-0310-9956-ffa450edef68"
301ba4830045a9fdb79ceef248dc34a68014d08b,"Avoid some branch overhead, improve name of ensureFreeSpace()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333833 13f79535-47bb-0310-9956-ffa450edef68"
1666ca913541a6f371d1d3d28fe20735bb9547ea,"Added testing actions and updated the stylesheet with links, etc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333834 13f79535-47bb-0310-9956-ffa450edef68"
460400fdda341e275169fc7d0b594a13154d3cd9,"Implement new recompose() design.
Correct template match order to precedence, then priority.
Check for circular includes as well as import.
Improve some recompositions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333835 13f79535-47bb-0310-9956-ffa450edef68"
9bdb03eaf6c27e3a56b46b1c9c5dc1160620168d,"Change Key() to incrementally build a table with key values and iterators. With this change, we will only walk through the source tree once per key name definition.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333836 13f79535-47bb-0310-9956-ffa450edef68"
3ee8d1b9fed93f531f125683f816558178557d15,"Update javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333837 13f79535-47bb-0310-9956-ffa450edef68"
004b5f39fad3b529674b41ac05343d05f9139955,"Update javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333838 13f79535-47bb-0310-9956-ffa450edef68"
1b334bf6000933baa2dca8cb2a78332c72912575,"Update javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333839 13f79535-47bb-0310-9956-ffa450edef68"
97ce5bfcd7e14b943b16b1e128617e854382c903,"1. Added spec.dtd and spec.xsl to files not to be purged in the
""clean"" target.
2. Added ""todo"" target for transforming todo.xml into todo.html.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333840 13f79535-47bb-0310-9956-ffa450edef68"
c17379c0f2e1365913fe6ce6a44f0e6c963259d1,"Namespace aliases should now work.  1) now build composed namespace
alias table indexed by URL and with a value of the namespace
element, 2) in ElemTemplateElement#resolvePrefixTables insert the
aliased (result) namespace instead of the namespace, 3) in ElemLiteralResult
augment resolvePrefixTables by fixing up the m_namespace and
m_rawName members to use the result prefix and URL, and do the
same to the AVTs.  I think ElemLiteralResult is the only place that
this fixup should be done.

The namespace tests that use alias don't match because we now
properly use the result prefix.  These tests will need to be fixed.

namespace20.xsl is broken.  Not yet sure if this is a regression.  I'll
look into this later today.

Added javadoc comments to all execute functions in the Template
package, and a few other places as well.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333841 13f79535-47bb-0310-9956-ffa450edef68"
2dba1be61fc6fb6f518ee155215f28114c0ac6a3,"Update javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333842 13f79535-47bb-0310-9956-ffa450edef68"
b7d1d90ad9c586f668edc4ce1b748dab69c3d0d1,"Commented hack to clip off the scheme at the start of a relative URI.
I'm not sure anymore of the exact reason for this hack, but it
clearly screws things up with namespace20, when the test harness
passes a URL of file:e:/foo.xsl (for example).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333843 13f79535-47bb-0310-9956-ffa450edef68"
71063cd715257c182d621bfba626dfb53debcd99,"Transforms from DOM to DOM . Should rename.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333844 13f79535-47bb-0310-9956-ffa450edef68"
37e7795137ef9b7adc7d5821ffc22c67ca1412e4,"More work on new TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333845 13f79535-47bb-0310-9956-ffa450edef68"
a3909127cffe6e6be9fe47414cfe317930f05b38,"Fix handling of default namespace nodes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333846 13f79535-47bb-0310-9956-ffa450edef68"
1c673198366bfef5eda665e9bebe9dc5ac3a0042,"Fix handling of xsl:exclude-result-prefixes attribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333847 13f79535-47bb-0310-9956-ffa450edef68"
817e3ee2962f28f3f0ca73ee824d72ad014f4a47,"Fix bug where Walker root was an attribute or namespace node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333848 13f79535-47bb-0310-9956-ffa450edef68"
37abb1153c9ef45514e21a55cf84b4450cd7dcf8,"Remove Recomposable classes where possible.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333849 13f79535-47bb-0310-9956-ffa450edef68"
58ee56a95c0eb9cf6f85dada19d836d292bca5ed,"Load extension using thread's ContextClassLoader, if available.
Patch in XalanJ1 from Martin Klang <mars@pingdynasty.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333850 13f79535-47bb-0310-9956-ffa450edef68"
ca187d1e0643ff1fa587ce622878c0183b0741e7,"New Javadoc doclet that does not inherit status metatags.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333851 13f79535-47bb-0310-9956-ffa450edef68"
01f9ca9251e587f89e5f88a76ec42df1480732ad,"Work in progresss for xalan-j 2.0.d02


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333852 13f79535-47bb-0310-9956-ffa450edef68"
30d935b26867ef5977354687c295c9bbf7d92de0,"Renamed and moved to DomToDom


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333853 13f79535-47bb-0310-9956-ffa450edef68"
6ceef08751457d3c2df285c512a290b4a80f7e35,"Renamed and moved from TransformToDOM (also uses a DOMSource).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333854 13f79535-47bb-0310-9956-ffa450edef68"
1adfef4d8218f0d028c7a8e040cf110787580c7e,"Allow recompose() methods to throw TransformerException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333855 13f79535-47bb-0310-9956-ffa450edef68"
4f7e49d678444b11aca1ca1f02527e0a27746594,"Revised and renamed this sample: transforms from DOMSource
to DOMResult.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333856 13f79535-47bb-0310-9956-ffa450edef68"
831f93113a83c41187aabad8e8f03af8cdd7ba98,"Cleanup


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333857 13f79535-47bb-0310-9956-ffa450edef68"
0479b58d10ba512c39bea940c4b763eadaf75026,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333858 13f79535-47bb-0310-9956-ffa450edef68"
4df2bf88c8fe21eae731da08d2521fcedce80cfd,"Add support for compiling templates with the new recompose architecture.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333859 13f79535-47bb-0310-9956-ffa450edef68"
ffd08c31de6e720bd0bdfeddd518737f478a9a45,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333860 13f79535-47bb-0310-9956-ffa450edef68"
3cfd022d9dc9a065a1d8b2340ff9855cf7621f6a,"Fixed bug in initCause.  Thanks to Mike Kay for this.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333861 13f79535-47bb-0310-9956-ffa450edef68"
d75d4515c1a6f642f53976e97441e11502a82c26,"cause needed to be upcast.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333862 13f79535-47bb-0310-9956-ffa450edef68"
e0a73f8df62e63c3909fca5044dc7ebb80eadd2e,"Added message indicating where output is to be found.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333863 13f79535-47bb-0310-9956-ffa450edef68"
ed00d1e1f41a191a783b8ebbe931f5c05a5c008b,"Gave Scott something to keep him busy (serializing XPath
expression results).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333864 13f79535-47bb-0310-9956-ffa450edef68"
5d831219aca329890736b6859dbed1b20ceb9495,"Update for DOM Level 2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333865 13f79535-47bb-0310-9956-ffa450edef68"
214e5ea6897fa49005c1b4fe9bb7b7b10ece09f8,"Update javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333866 13f79535-47bb-0310-9956-ffa450edef68"
aa3f0ea05cb9e81ab6b48cb421c8243f246315c7,"Update javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333867 13f79535-47bb-0310-9956-ffa450edef68"
2ffc73af793fd776943e3f1676cd4620cb929ca4,"Update javadoc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333868 13f79535-47bb-0310-9956-ffa450edef68"
5a13040690320fa3e96e683e3ccd4c3053adf489,"Added comment about new file in xml-xalan/test/java/.../ExamplesTest.java
that basically mirrors this file as an automated test


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333869 13f79535-47bb-0310-9956-ffa450edef68"
4f8f4af949e2d7d21cf54d69eac8d89d18b3aacf,"Add to stylesheet child list, so that element can get to it's parent.  This to
solve the exception:

java.lang.NullPointerException
        at org.apache.xalan.templates.ElemTemplateElement.getStylesheetComposed(
ElemTemplateElement.java:193)
        at org.apache.xalan.templates.ElemTemplateElement.compareTo(ElemTemplate
Element.java:1179)
        at org.apache.xalan.templates.StylesheetRoot.QuickSort2(StylesheetRoot.j
ava:973)

etc.  Not sure why Gary didn't see this?


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333870 13f79535-47bb-0310-9956-ffa450edef68"
df5c1b34a26daa91f021c134f1ca08b9b9392ac6,"Change to new OutputProperties class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333871 13f79535-47bb-0310-9956-ffa450edef68"
f07146dff4dc4be9bab8e0c01b914cdfb61aeed7,"Add foregn attribute handling to xsl:output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333872 13f79535-47bb-0310-9956-ffa450edef68"
9d6ca22a6de9281f5df44e511d4e44b27325639a,"Changes for OutputProperties.  Use class as the setter methods
implementor, and then set the properties object.  Add the object
to the stylesheet so you don't get the same type of errors as with
DecimalFormat.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333873 13f79535-47bb-0310-9956-ffa450edef68"
0358f6f5317b22c3e2b7701e4cb22edb42b970eb,"Added toNamespacedString(), and changed
string representation to use curly
bracket syntax for namespaces.  toString
will use prefix if it can, while toNamespacedString()
always uses curly namespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333874 13f79535-47bb-0310-9956-ffa450edef68"
33f779dc81e61483b9643d2acd338bbc570deec9,"Javadoc comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333875 13f79535-47bb-0310-9956-ffa450edef68"
c16e9953ba58c9ab24b0bc9829f0a55a49436ea4,"Deleted OutputFormat and OutputFormatExtended in favor of new
OutputProperties class.  Default properties are now resource based.
Serializers should be pluggable, though this hasn't been tested.
Entity references are now specified through resources, and a bitmap
is built for fast test to determine special status of character.
indent-amount and URI character escaping can now be controled
via xalan attributes on xsl:output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333876 13f79535-47bb-0310-9956-ffa450edef68"
641bbf291f87b78b8ac91774acd38ee09f244252,"Deleted OutputFormat and OutputFormatExtended in favor of new
OutputProperties class.  Default properties are now resource based.
Serializers should be pluggable, though this hasn't been tested.
Entity references are now specified through resources, and a bitmap
is built for fast test to determine special status of character.
indent-amount and URI character escaping can now be controled
via xalan attributes on xsl:output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333877 13f79535-47bb-0310-9956-ffa450edef68"
674ba6a451065a3caca34eddf04a32e124db49fc,"Just removed import of OutputFormat.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333878 13f79535-47bb-0310-9956-ffa450edef68"
42a83515e62509f6aa66a5de06846b3493f49b7b,"Deleted OutputFormat and OutputFormatExtended in favor of new
  OutputProperties class.  Default properties are now resource based.
  Serializers should be pluggable, though this hasn't been tested.
  Entity references are now specified through resources, and a bitmap
  is built for fast test to determine special status of character.
  indent-amount and URI character escaping can now be controled
  via xalan attributes on xsl:output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333879 13f79535-47bb-0310-9956-ffa450edef68"
44b806a51e9ec0009c141c6b2e94784a72a71b92,"Moved xsl:output and serialization stuff to completed.  Assigned the
internal jaxp DOM needs to be STree to Myriam.
Next stuff on my list is the axes stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333880 13f79535-47bb-0310-9956-ffa450edef68"
3cfd9cacab9e2170feb91536b3db6a1d26df7462,"Add reference to parent Stylesheet to prevent NullPointerException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333881 13f79535-47bb-0310-9956-ffa450edef68"
0105377f50e138968f4d10da7d9b432effbbefb2,"Set system id for the DOMSource.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333882 13f79535-47bb-0310-9956-ffa450edef68"
f5e576935e29c0881aaf04dd56937db3167d7774,"Get rid of uneeded imports.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333883 13f79535-47bb-0310-9956-ffa450edef68"
0acf51ae78b46918400c69839e7d194238e56fe9,"Added trax to samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333884 13f79535-47bb-0310-9956-ffa450edef68"
86870a4e29adf9c568b67d6dc17aa05bf63b04db,"Add code to fix up the property keys and values if the "":"" is not being escaped and if the property name specified is not the appropriate constant. Also allow System properties to overide properties specified in the output properties files


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333885 13f79535-47bb-0310-9956-ffa450edef68"
4dc5fe4c9f6acae8477fc14ae542d31cc708e47c,"Remove Recomposable family of classes.  They are no longer needed
since all recomposable elements now extend ElemTemplateElement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333886 13f79535-47bb-0310-9956-ffa450edef68"
a07586bb34cc9582f97672cac0b95ae01a5a6634,"Don't add indent/line break if element is empty, to be consistent
with XT and SAXON.  As per discussions with Paul and Dave today.
Same fix has been made in XalanC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333887 13f79535-47bb-0310-9956-ffa450edef68"
b976cc54b48b3b77402bd9fefa932279039dcf15,"For some VERY strange reason, the end element was passing an
empty string for the namespace and local name.  This is fixed, and
it addresses a bug which the Cocoon folks were having.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333888 13f79535-47bb-0310-9956-ffa450edef68"
bed615cbc02bcfd36d4a160d87bceb15b5d9133a,"Allow xsl:output xalan:entities attribute to override entity ref map.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333889 13f79535-47bb-0310-9956-ffa450edef68"
943c37c8ec51c517743eae6f3aee823b770b0284,"Resolve xalan:entities attribute value to absolute URL.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333890 13f79535-47bb-0310-9956-ffa450edef68"
d588a4f7ab8f0c785e47f32c17f1f8c6862e628c,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333891 13f79535-47bb-0310-9956-ffa450edef68"
0a52144b016f50e1ef32e2737b8f24a69d55f984,"Added link to ""Testing""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333892 13f79535-47bb-0310-9956-ffa450edef68"
70e63558ab8e2a68c7e392f627decc2b93296513,"Updated Xerces release to 1.2.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333893 13f79535-47bb-0310-9956-ffa450edef68"
078c62502be22e9ae5b5c03fb5c58a69d13fabd5,"Changed title from Xalan for Java to Xalan-Java.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333894 13f79535-47bb-0310-9956-ffa450edef68"
b3885e4e7c0c1f6832c6788e43af0f0bdfc70496,"Fixed getSerializer()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333895 13f79535-47bb-0310-9956-ffa450edef68"
13a56396180765f3ed60b551fc3ac98e56bd6b6a,"Updates for Xalan-J 2.0.D02


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333896 13f79535-47bb-0310-9956-ffa450edef68"
b2e6d7b8a6ce80b1e24ca688f3ce862355afee37,"Javadoc fixes and incorporate todo list into doc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333897 13f79535-47bb-0310-9956-ffa450edef68"
3bf2e0bdf8a8fb02e8dd5773b2d327b1aacf3f70,"Fixed identity transform so that it processes any node.  Duh.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333898 13f79535-47bb-0310-9956-ffa450edef68"
f0ac92b2d084ddbd9cb6377f026f01feaf9da368,"Keep identity Templates in static variable for reuse.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333899 13f79535-47bb-0310-9956-ffa450edef68"
965d046fa9351ffbcb4bd862aeca28e9e8705ec8,"Load extension function via system ClassLoader if ContextClassLoader receives ClassNotFoundException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333900 13f79535-47bb-0310-9956-ffa450edef68"
8d83e47c3449abd7ea55afab3b27c4c7138787d9,"Do reset after transformation, so the transformer will be set up for
another transformation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333901 13f79535-47bb-0310-9956-ffa450edef68"
52ef8ee4ab0df7b4a3df7e226e4ff8357c3adf11,"Do reset after transformation, so the transformer will be set up for
another transformation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333902 13f79535-47bb-0310-9956-ffa450edef68"
845b6274b4229a35d08b22d6f8a0bc26d0f55bab,"Removed walking of DocumentFragments via NodeList.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333903 13f79535-47bb-0310-9956-ffa450edef68"
09ebed1676d7bc9b28c15e7c0ceb4d2baa381e11,"Latest release of xerces1.2.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333904 13f79535-47bb-0310-9956-ffa450edef68"
2aaee5a0ae63000ee7b096d808bd3ba372d7c01f,"Call-through to new Xalan-J 2.x Minitest in xml-xalan/test!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333905 13f79535-47bb-0310-9956-ffa450edef68"
32b32abce024bb5a2718c1bd766ec55a77259492,"Fix typo. Error() need to issue an error, not a warning!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333906 13f79535-47bb-0310-9956-ffa450edef68"
d9b2d0d4727789fd9bca4a0b4e0f48d63556ad65,"prepare.docs is a dependency for the site target (so that
todo.html can be copied to the site directory).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333907 13f79535-47bb-0310-9956-ffa450edef68"
3416de3aa1601233026dd4644dbc47793a3970bc,"Updates for Xalan-J 2.0.D02.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333908 13f79535-47bb-0310-9956-ffa450edef68"
742ae9e673e5b82df55c1dbebc0a78a13222841e,"Fix loop. Wrong object was used to walk through sibling nodes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333909 13f79535-47bb-0310-9956-ffa450edef68"
39c46013767dcd13dca33d78639dbe52004c313a,"Use Stree for resultTreeFragments if the source node is an Stree node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333910 13f79535-47bb-0310-9956-ffa450edef68"
92995e645f79e9a9c287fe3305ffd8ac0334a68f,"Clarify usage of Xalan namespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333911 13f79535-47bb-0310-9956-ffa450edef68"
d469873d94d981014d16027b35cc623ae2da308f,"Update for next build number 2.0.D03


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333912 13f79535-47bb-0310-9956-ffa450edef68"
f197d0f9821fbbad64ff9fc35c017428952b251f,"Editorial updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333913 13f79535-47bb-0310-9956-ffa450edef68"
29b2f2baf8b70c0d755ee9adde9a6698bde1bb18,"Changed getSerializer() to new API so the sample compiles
and we can do complete builds.
Still waiting for Scott's bug fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333914 13f79535-47bb-0310-9956-ffa450edef68"
7f4577db818212326ac364551620ee56651e229e,"Editorial updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333915 13f79535-47bb-0310-9956-ffa450edef68"
fbe2b40321bee7eae6d223393072c363dd629555,"Added IOException to throws clause.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333916 13f79535-47bb-0310-9956-ffa450edef68"
97760fa26369ca0741ba741e5b532d4ab68e3782,"1. DefaultErrorHandler in a new package.
2. Use tRAX to get output properties.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333917 13f79535-47bb-0310-9956-ffa450edef68"
24fc40418539d973b5dcd15982cf015da29432ee,"Modified getContentType)( to pay attention to the output method
property, not to media or encoding. This appears to work. The
other always returned text/xml, even if the output method is html.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333918 13f79535-47bb-0310-9956-ffa450edef68"
59980e50e96c9ca1d9b9e7518c1ecfdfa8f6de60,"Respect precedence levels when composing xsl:output elements.
Be sure OutputProperties has the correct Uid to ensure proper sorting when recomposing.
Bring cdata-section-elements processing into standards conformance.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333919 13f79535-47bb-0310-9956-ffa450edef68"
53eef2144810a4e00ee4e19c51b9b0079f75bc70,"Fixed the media-type defaults, and also set the version default for HTML.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333920 13f79535-47bb-0310-9956-ffa450edef68"
406ba1f39b32910d4bcec46a5d1fcce7583d4dae,"Set the encoding for the text method to be the system default.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333921 13f79535-47bb-0310-9956-ffa450edef68"
aafe4968ecf84c71186c26bf688d9e04f5a79a2d,"Set the encoding default if file.encoding is not available to be UTF8.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333922 13f79535-47bb-0310-9956-ffa450edef68"
1ffce2733e4a425b468ba473eec6e9eb6f61525b,"Rather than popping the stack each time, use an index, so that cloned walkers will work correctly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333923 13f79535-47bb-0310-9956-ffa450edef68"
3ccf0b719778903f8f24926b9811990b81ae7cef,"Put defensive code in for negative predicate index.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333924 13f79535-47bb-0310-9956-ffa450edef68"
03c004a5352f965cc7f9087e15bb3d624b347f5f,"Some javadoc added.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333925 13f79535-47bb-0310-9956-ffa450edef68"
85fa2bc305091ccf26eacd43d633196437896058,"Add value to the itterator to mark the start of where the waiters
should be looked at.  In the walker, set the bottom of the waiters
list to be the current size of the stack when executing a predicate,
then restore it on return.  This fixes a bug when executing the
last() function inside a predicate in a walker that has to wait for
the parent walker to walk past it.  Fixes test axes91.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333926 13f79535-47bb-0310-9956-ffa450edef68"
9d6e9947130f8230939aa50f03c68093523ce125,"Just some added javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333927 13f79535-47bb-0310-9956-ffa450edef68"
5b6c85f387684ebe60d8891931000696523ad483,"For namespace alias, use the styelsheet prefix instead of the result
prefix, as per XSL WG decision.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333928 13f79535-47bb-0310-9956-ffa450edef68"
c4912eb82b7f352a5e004f0b63b75cb8eedea2f5,"Use 0 for zero, instead of #(0).  To match test suite.  I think this will
be resolved in the XSLT 1.0 erreta.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333929 13f79535-47bb-0310-9956-ffa450edef68"
952025185d27106793cae5209b92829797ad1b24,"Tweak file:xxx munging.  Wish I didn't have to do this.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333930 13f79535-47bb-0310-9956-ffa450edef68"
5b2958a426292c1e586641ac8fcbf15b46308584,"Fix LANG_BUNDLE_NAME to be the right name, which fixes several
tests that access the bundles.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333931 13f79535-47bb-0310-9956-ffa450edef68"
4de3d28fb1971ff3da7fa24fe759dad5d3afbfed,"Set the carriage return as special, and normalize the
cr/lf in attributes, since the parser doesn't seem to
do it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333932 13f79535-47bb-0310-9956-ffa450edef68"
98459a978efb76a519aff301c990c82106c80c72,"Move the reassignment of member variables from clone to cloneWithReset.
This fixes test position56.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333933 13f79535-47bb-0310-9956-ffa450edef68"
b6781ce90e63332c766979df6220a2ddc638cda1,"Enabled Scaron entity, for the sake of
passing the conformance tests.  I am
told that Netscape does not support this.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333934 13f79535-47bb-0310-9956-ffa450edef68"
b92506b6de9998b7014f29648d5630a1383fb53b,"Set the PrefixResolver to the template being matched before executing
the match expression.  This is needed so that XSLT functions,
like xsl:key, can get to their template context.  This fixes test idkey03.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333935 13f79535-47bb-0310-9956-ffa450edef68"
62d180e75d7109462744233800c2afd35c49ce23,"Clone the key iterators before returning.   Have Myriam check that
this is really what we want (I can't see how it isn't).  Fixes test idkey01.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333936 13f79535-47bb-0310-9956-ffa450edef68"
29690b0ba52154128326dbf747c9314c709d56ab,"Remove reverence to old lotus namespace, and use the constant
value for the apache extensions address.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333937 13f79535-47bb-0310-9956-ffa450edef68"
0caff438fd24c5fc4d4da6a82d0ea3970c547151,"Don't add duplicate nodes.  Fixes test select59.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333938 13f79535-47bb-0310-9956-ffa450edef68"
456f9cb297db1f7c24fb87e504e8b95c7a03b6b2,"Moved ""fix axes tests"" and ""use stree for rtree frags"" to completed section.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333939 13f79535-47bb-0310-9956-ffa450edef68"
ec632bfa6657aa2269682580f4013f7fa88fbeaf,"Fix problem with exclude-result-prefix and Litteral Result ELements


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333940 13f79535-47bb-0310-9956-ffa450edef68"
d891ef5da4452b890c7fed2d2959afac4050d779,"Update to new template enumeration. May be awaiting fixes in the Composition code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333941 13f79535-47bb-0310-9956-ffa450edef68"
4d171e913df1f6ad283f79a56934f8b331afc781,"Documentation


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333942 13f79535-47bb-0310-9956-ffa450edef68"
0bfc030d258a9a594228e90cccaf3c5408235716,"Documentation and cleanup


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333943 13f79535-47bb-0310-9956-ffa450edef68"
84f12e9aabb6425731a5bab1b51a1ea4ca5cd034,"javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333944 13f79535-47bb-0310-9956-ffa450edef68"
76b3b7f066f49bf718cf8d83899bc787db3c1d7c,"Declare the Extensions namespace as a URI; make it a {universal} only in the one place where that's needed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333945 13f79535-47bb-0310-9956-ffa450edef68"
e10dde15630629107f6ca9fd59a291ddc124c229,"Rewrote writeAttrURI to encode UTF-16 to UTF-8 when escaping
characters.  Subject to code review, re message I sent to the list.
Also consolodated surrogate pair handling in the normal character
handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333946 13f79535-47bb-0310-9956-ffa450edef68"
2e3afd1245c25c871baf439302aeee1fef2abc71,"Changed TransformerException nested exception to take a Throwable
instead of an exception, so that initCause works right.  Approved
by JCP.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333947 13f79535-47bb-0310-9956-ffa450edef68"
ab28dd6ef0aaf50af711ce73322880283d1b9432,"A few minor changes for TransformerException change.
(Changed TransformerException nested exception to take a Throwable
instead of an exception, so that initCause works right.  Approved
by JCP.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333948 13f79535-47bb-0310-9956-ffa450edef68"
cb73444190a02a943bbe0f39f87fc5d0f23ac615,"This constructor needs to be public because CompilingStylesheetHandler references it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333949 13f79535-47bb-0310-9956-ffa450edef68"
6a039f734ecf27e82c6b8217d99ca68d895234b9,"Make constructor public; CompilingStylesheetHandler wants to invoke it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333950 13f79535-47bb-0310-9956-ffa450edef68"
001e0527c7dee73a383368b00629cdc1c20834e8,"Got rid of unneeded system property settings.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333951 13f79535-47bb-0310-9956-ffa450edef68"
4f10217df1364aed9235f235f57f496416511c70,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333952 13f79535-47bb-0310-9956-ffa450edef68"
60a5d58bdf44bd07f383a23b1d30f50fe6ff72e9,"Documentation


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333953 13f79535-47bb-0310-9956-ffa450edef68"
046bd42f893214a3fcc0f44d39701f3c49a6afdb,"Remove unused constants


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333954 13f79535-47bb-0310-9956-ffa450edef68"
12fa4e63f172d3b9b161c19d01b4f143b2ce0c5a,"typo


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333955 13f79535-47bb-0310-9956-ffa450edef68"
1ae6a952ff05c2bed9a3efec28b4124621a943db,"Dead code


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333956 13f79535-47bb-0310-9956-ffa450edef68"
5315a33bb2d9def29669fb5d1918750d38616893,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333957 13f79535-47bb-0310-9956-ffa450edef68"
f19cabbd18d4782eedf2f8b880065bb45efc175e,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333958 13f79535-47bb-0310-9956-ffa450edef68"
6a8e81a33fd60e74029617e70342c64e9d98ca72,"Docs and dead code


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333959 13f79535-47bb-0310-9956-ffa450edef68"
016242c35ebddcaa52a3b6c69b46aefcf08b5960,"Docs, minor code clean


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333960 13f79535-47bb-0310-9956-ffa450edef68"
34cfb65da74e12113066bafd68603525e96c6228,"Implemented fast iterator for ""@foo"" pattern.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333961 13f79535-47bb-0310-9956-ffa450edef68"
70086862aab153526ecd8825c0d0ccf86dfa05cb,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333962 13f79535-47bb-0310-9956-ffa450edef68"
e7e462209312fc73f8d7abc38ea4505c47c4c696,"Moved ""implement fast iterator for ""@foo"" pattern."" to completed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333963 13f79535-47bb-0310-9956-ffa450edef68"
39d253bf95b377a6af97e2ceb5cbf528107b173d,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333964 13f79535-47bb-0310-9956-ffa450edef68"
02155c1ce3f3c4de91b0addba3f97c19d57f9451,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333965 13f79535-47bb-0310-9956-ffa450edef68"
234abbc2bf3ff0dace1e676f07fcadf553a72894,"Changes for TrAX as per JCP process:
TransformerHandler now implements DTDHandler.
TransformerConfigurationException now has SourceLocator constructors.
TransformerException now has setLocator.
Nested exceptions changed to Throwable, in order to support getCause.
TFactoryConfigurationError changed to TransformerFactoryConfigurationError.
The way output properties nest has been respecified (javadoc change).
Many javadoc editorial changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333966 13f79535-47bb-0310-9956-ffa450edef68"
90d062c6d6d62e38e65965e69c16cc837e575ff0,"Docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333967 13f79535-47bb-0310-9956-ffa450edef68"
6f6b4e7f4641d5a6e8171b8e1ffea790c89465d1,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333968 13f79535-47bb-0310-9956-ffa450edef68"
15425b774c6a66ee4e4ecf5820a559d20d697fcf,"Replaced TFactoryConfigurationException with TransformerConfigurationException.
Sorry, this broke the build last night.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333969 13f79535-47bb-0310-9956-ffa450edef68"
27cd7cb84cc13da0e2c1457f33f7842078d26eb6,"Optimized attribute iterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333970 13f79535-47bb-0310-9956-ffa450edef68"
568d01f6e28bcba7c57c4d80da413d21ba9c047f,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333971 13f79535-47bb-0310-9956-ffa450edef68"
6155708099727e4f0e67b28f8471471acf345b50,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333972 13f79535-47bb-0310-9956-ffa450edef68"
671910757d110712d45cab4be6cc5bba31dd43c5,"Catch and flag an empty DOMSource input error


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333973 13f79535-47bb-0310-9956-ffa450edef68"
29c2c6d915ec2fd7c5aa12be59610140643097bd,"Catch and flag an empty DOMSource input error


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333974 13f79535-47bb-0310-9956-ffa450edef68"
1b6e3b8197abef2226aa6b53a3a1e875e4036ac4,"If m_outputProperties is null, fall back to the stylesheetRoot defaults


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333975 13f79535-47bb-0310-9956-ffa450edef68"
8d06f4ea7dbce88c032bfdf68dd47ea6131a5b6d,"Use GetOutputFormat when need to get output properties


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333976 13f79535-47bb-0310-9956-ffa450edef68"
5fb0422a115df9b4d6a6c6d4a90b90f2fdd1c0e7,"Re-worked analysis in Walker factory so that it is more sane.  It now
uses a bit scheme instead of enumerated values for the analysis.
Added DescendantIterator which optimizes ""//foo"" patterns as well
as ""descendant-or-self::foo"", ""descendant::foo"", and "".//foo"" patterns.
ToDo: It would probably be nice to add handling of ""//foo/@attr""
patterns also, since the attributes do not have the danger of overlapping
in document order, as child patterns do.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333977 13f79535-47bb-0310-9956-ffa450edef68"
66a491a148331f45467d4961ddd215cc4eaf3360,"Moved optimization of ""//foo"" patterns to completed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333978 13f79535-47bb-0310-9956-ffa450edef68"
ff5f0f5ff611416f12ee8015ab50a0b11a5c2dc1,"Separated DocumentFragmentImpl from DocumentImpl.
DocumentFragmentImpl no longer extends DocumentImpl.  Instead, both now extend a new class DocImpl.
This allows DocumentImpl to enforce the ""one document element"" constraint of the DOM and implement all of the ""create"" methods while not forcing DocumentFragmentImpl to do the same thing.
We now allow RTFs to have multiple element and text children per the XSLT spec.
The common DocImpl superclass allows the root of the source tree to be either a Document or DocumentFragment.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333979 13f79535-47bb-0310-9956-ffa450edef68"
7c923422961023fdd963e1941ac9f58f0c384ff7,"nextSibling should not return a value for attributes.  I'm not sure
why it was??


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333980 13f79535-47bb-0310-9956-ffa450edef68"
cf1ceb07d9de0bba559690a775c94d5728e8c6d9,"Fixed support for following sibling from an attribute, and adapted
XalanC method for following axes after an attribute, though both
XT and SAXON give different results.  Xalan treats the children of the
owning element as if they were siblings following the attribute, which
the are in a sense.  XT and SAXON process everything following the
owning element.  Since self, following, descendants, preceding, and
ancestors are supposed to encompass the entire document, and attributes
obviously can't have descendants, and the children of the owning
element clearly don't occur before the attributes, I think Xalan
is right.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333981 13f79535-47bb-0310-9956-ffa450edef68"
145cdbffb517f2a079cc728302c72179467d6345,"Don't append a space after the last property value


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333982 13f79535-47bb-0310-9956-ffa450edef68"
f734dde7165355e09a389ccd5c45bc2c5eb60aaf,"Improved prefix-to-namespace lookup (trust the DOM), some docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333983 13f79535-47bb-0310-9956-ffa450edef68"
36f2efbba33afa8a2226c3c428b8155b4fc6d0e6,"fixed typo in property name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333984 13f79535-47bb-0310-9956-ffa450edef68"
14e74a8621ec6b4be7cb956ff89d52d83b76bcb1,"When setting an output property, don't overide existing properties from the stylesheet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333985 13f79535-47bb-0310-9956-ffa450edef68"
5ccc0287f6f70d7c96fd823e8e641fcd73c8f44a,"fixed typo in property name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333986 13f79535-47bb-0310-9956-ffa450edef68"
1dc519dc3d9dea0e9b12e464ab22a7452c4db6cf,"1. Don;t need to set system properties.
2.getContentType() can now be restored to its previous form;
OutputProperties.getProperty(OutputKeys.MEDIA_TYPE) has
been fixed. It no longer returns a value if the stylesheet does
not have a media attribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333987 13f79535-47bb-0310-9956-ffa450edef68"
a1839c2bf6b85ad3d346a12f87a7a91890e3a8f9,"Improved parent-of-Attr lookup (trust the DOM), some docs.
The code changes seem to have fixed one known bug, and
should run faster.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333988 13f79535-47bb-0310-9956-ffa450edef68"
ef2fbfe78cdcc35e0587e91f16000584795184f9,"Fixed error (changed Exception to Throwable).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333989 13f79535-47bb-0310-9956-ffa450edef68"
4f8b6b252691e0f70e40428d4591c28755795a8e,"Docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333990 13f79535-47bb-0310-9956-ffa450edef68"
2e8b92984756cc9caa2001d99efdca20961589da,"Fixed serialization to use TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333991 13f79535-47bb-0310-9956-ffa450edef68"
8321523687b5887ee2b7099a9437b358ba67e3b0,"Some doc fixes, some open questions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333992 13f79535-47bb-0310-9956-ffa450edef68"
2964c9fe53353bf0b59223720db9d78c7cc49d4f,"Javadoc bug fix for null constructor for DOMResult and DOMSource.
Not specifically approved by the JCP, but it is clear that this is a bug.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333993 13f79535-47bb-0310-9956-ffa450edef68"
b498c190379f794caf98b8e203cd2aecb2ff9bc6,"Some doc fixes, some open questions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333994 13f79535-47bb-0310-9956-ffa450edef68"
87d5b5ffb0de729b32b08da7de32af3ed7b3d3ec,"Docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333995 13f79535-47bb-0310-9956-ffa450edef68"
bbb890533d4e626b23ddfca1a25cd58e2694abf4,"equals() methods never used, seemed to be intended to be
equivalent to getQName().equals(). Removed for now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333996 13f79535-47bb-0310-9956-ffa450edef68"
8ec5e6abbe71644c577a970026f0ac616bac74a2,"Finished Minitest action; alphabetized <person>s


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333997 13f79535-47bb-0310-9956-ffa450edef68"
6bc394525bad83141d16528a2f692e32716f2d3a,"Now uses trax interfaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333998 13f79535-47bb-0310-9956-ffa450edef68"
e0d7b0af8f109d5274fefd128df3fc91f4eeecf7,"Default to appending a new line to ProcessingInstructions that are outside of an element


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@333999 13f79535-47bb-0310-9956-ffa450edef68"
4e1d4735f7f74d48a563f5c953febb55e04bbafc,"Docs, minor code tweak (Seems to pass one more test?)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334000 13f79535-47bb-0310-9956-ffa450edef68"
6a0f8dfcd683cb406c27597361b3034fd90f11a7,"Doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334001 13f79535-47bb-0310-9956-ffa450edef68"
1d8153b7c3139b63257e939512be4e78a2c230f2,"Some docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334002 13f79535-47bb-0310-9956-ffa450edef68"
25131efce930afb6cc4a8ba9ba2a86a0cbc5e2af,"Fixed regression that occured when the Arg#equality function
was removed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334003 13f79535-47bb-0310-9956-ffa450edef68"
38b6d549c0bc0c4f482221134a10dbd8733e9876,"Fixed bug where the waiting list of walkers were not being cloned.  Fix
was made by defining a cloneDeep function on AxesWalker, and
handing it in a Vector to which is added the original-clone pairs.
Each clone operation checks to see if it is on the list, and, if so,
uses the already cloned object, otherwise it clones itself and adds
its pair to the list.  This has more expense than I would like, but
is safe.
Also made many member variables transient, in order to work towards
the ability to serialize the iterators (this was done so that a given
iterator could be serialized and then checked against another
serialization after an clone and execute operation to see
what had changed.  This debugging technique kind of worked!)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334004 13f79535-47bb-0310-9956-ffa450edef68"
4641a975369c6499fc1d683ee0a32c7caaec6c90,"Moved ApplyXPath task to completed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334005 13f79535-47bb-0310-9956-ffa450edef68"
4916df7ebbfeec17fc4597c8cf5562e53f09c9c8,"Remaining javadoc work for org.apache.xpath.functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334006 13f79535-47bb-0310-9956-ffa450edef68"
a75525671df0983b40396ff4be292325618767e4,"Javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334007 13f79535-47bb-0310-9956-ffa450edef68"
8f3ab3d0d81f88a4cf6b47d41ff41171445c55f7,"Set the variable context in setRoot, since it may be executed during
a cloneWithReset operation, in which case the variable context
is not set by LocPathIterator's nextNode.  This bug was uncovered
by fixing the deep clone operation, at which point the filter walker
may not have been cloned.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334008 13f79535-47bb-0310-9956-ffa450edef68"
69422c18c8c3cd8a64933bc26873ae214caccbd0,"Get the qname from the arg and do the compare with that, so we
don't have to do the extra instance of in Arg#equals.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334009 13f79535-47bb-0310-9956-ffa450edef68"
30e49fb4a5426ef03cc529c73158697e08dd2cd5,"Java doc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334010 13f79535-47bb-0310-9956-ffa450edef68"
b1b504321234d293fa8eb4099ead26e9e88f0f8b,"Java docs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334011 13f79535-47bb-0310-9956-ffa450edef68"
4bf4e0a125b4d9912df809acf9fdaa3ffe9d011f,"Javadoc work.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334012 13f79535-47bb-0310-9956-ffa450edef68"
e6960d9806ee71bd001f2c7a9662654eb001b5bd,"Not currently being used, so I'm removing the heap classes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334013 13f79535-47bb-0310-9956-ffa450edef68"
9a5a0b27e7615a8da4adb10fc7775cd7ee2a7d9a,"Removed the NEEDSDOC from these.  Joe can finish these sometime
at his convenience.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334014 13f79535-47bb-0310-9956-ffa450edef68"
dbc23e9e1ba5b75c12818e6726fb40e1a06f9a40,"Finished up remaining javadoc holes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334015 13f79535-47bb-0310-9956-ffa450edef68"
cddaae12f459a9c477e5a8220f212f8bdaa3f437,"Minor javadoc fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334016 13f79535-47bb-0310-9956-ffa450edef68"
62e15ff13e16b0a9f1e0879926a2ead2413fc2a8,"Moved javadoc task to completed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334017 13f79535-47bb-0310-9956-ffa450edef68"
ae559776b6bade54360096b41763bbb47f9ba793,"Add new PredicatedNodeTest base class for both the LocPathIterator
and the AxesWalker.  This helps break up AxesWalker a bit, and
allows optimized location path iterators to have predicates.
Adapted optimized iterators to this new scheme.
Also fixed bad bit test for creating childWalkerMultiStep, which
may have been the source of the performance degragation reported.
Also set the waiting list in LocPathIterator to null by default.
Also made it so that, for AxesWalker#cloneDeep, don't pass a
vector in (and don't create one in the first place) if the waiting
list is null.  Also fixed childWalkerMultiStep so that it can be built
for as long as the steps are down pointing and one level traversing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334018 13f79535-47bb-0310-9956-ffa450edef68"
d8ac41a78b9dc32b7ab60c5bd9a1ef10ca464775,"Just removed unneeded import of AxesWalker.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334019 13f79535-47bb-0310-9956-ffa450edef68"
d4320d36e4c2382a21cdeeb135ba058fdb613a66,"Use PredicatedNodeTest instead of AxesWalker to get the current
location path iterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334020 13f79535-47bb-0310-9956-ffa450edef68"
86ec7ee97fcb659e2612dcc011affde898fb73c2,"Move the test for NodeFilter.SHOW_ALL to the two argument
execute, so it can be called directly from the PredicatedNodeTest.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334021 13f79535-47bb-0310-9956-ffa450edef68"
566253b9c41d1b6315fc619f871317f51f496650,"Fix compose of cdata-section-elements to work with Myriam's change to revision 1.6


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334022 13f79535-47bb-0310-9956-ffa450edef68"
f5b5ca3fb5d00f09bdd5026e1e21f6c4a6e7611a,"Applets are set to look for xalan.jar and xerces.jar in the bin directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334023 13f79535-47bb-0310-9956-ffa450edef68"
46053ff1ec57b46c26bc698b4c961f28cddd6339,"Added get-todo-list.html


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334024 13f79535-47bb-0310-9956-ffa450edef68"
54a0eb42cc4eb6d0a4af7437f7f64c0a1435218a,"Added ToDo listl


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334025 13f79535-47bb-0310-9956-ffa450edef68"
a2b33ca9e03d1eafefd847c547ef9ed6557f53c1,"Cleanup tasks on servlet and applet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334026 13f79535-47bb-0310-9956-ffa450edef68"
7a0723adb522ce61ba668a77c1b04610b423b7a9,"Rewritten to use TrAX interfaces. To avoid IE security restrictions,
TrustedAgent in separate Thread used to get documents
(using Transformer identity transformation).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334027 13f79535-47bb-0310-9956-ffa450edef68"
170ed605db094c56e7ec0a41c24bd9da4f9f3e07,"Changed alpha to beta.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334028 13f79535-47bb-0310-9956-ffa450edef68"
5529e4e7c2cbd1671fc21caf3a719e80cf4be421,"Added method to get the table of available elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334029 13f79535-47bb-0310-9956-ffa450edef68"
3398b86055cb6102c1f10fe954b2f700a6330195,"Changed the reference to XSLTSchema to hashtable of available elements.
This should fix some of the serialization problems.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334030 13f79535-47bb-0310-9956-ffa450edef68"
799dc67f8a52a76ce8fa0e21894cfc391b40ee01,"Get the hashtable of available elements instead of the XSLTSchema, from the stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334031 13f79535-47bb-0310-9956-ffa450edef68"
7e76ae3b6ff3f47fb1e1f1c2c8903fe7bf158629,"XML source for appletXMLtoHTML


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334032 13f79535-47bb-0310-9956-ffa450edef68"
6b26ed1fc3bb4bdb3f3b2a3839aa7b82d9f7ec3e,"Fixed typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334033 13f79535-47bb-0310-9956-ffa450edef68"
5b1200146b6428dda104088c2f9634ed61b10642,"Update version number.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334034 13f79535-47bb-0310-9956-ffa450edef68"
1a1e745a6c603682c834de0c67982c2460dd105d,"Updates for beta release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334035 13f79535-47bb-0310-9956-ffa450edef68"
7261c1caf5dce2485342d1d742e394d932dac87a,"Updates for beta release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334036 13f79535-47bb-0310-9956-ffa450edef68"
c736f17b9444627f273abb55d5d543623637654b,"Fix code so that it uses the XMLReader provided when one is provided


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334037 13f79535-47bb-0310-9956-ffa450edef68"
78463a0ed6cc3eb3bcdcab29898153f02599d4f5,"Added evaulate and tokenize extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334038 13f79535-47bb-0310-9956-ffa450edef68"
e49b61cc9ceca5245e0945eb1be8a484d6485fc3,"Replaced with DOM2DOM


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334039 13f79535-47bb-0310-9956-ffa450edef68"
906d7cfc8f622e55ead31c3a065793c7cb9fafc7,"Commented out cloneWithReset in favor of the reset function which
is being called from the location path iterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334040 13f79535-47bb-0310-9956-ffa450edef68"
3ecb49eab92aa7ddecf490f3579b6e4c7a33a4cc,"Call nextNode in the reset of the contained iterators, so that getCurrentNode
will return something in UnionPathIterator#nextNode.  This was the
cause of the problems that looked like an xsl:key problem
 that Davanum reported.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334041 13f79535-47bb-0310-9956-ffa450edef68"
20b663590dfe6c6931c39da8c43ad36bb02f5a51,"Warning about using DOMResult more than once without doing
a setNode().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334042 13f79535-47bb-0310-9956-ffa450edef68"
10b9c6e926414d1a8489ca314dd19eadca67bb3f,"Version 2.0.D04


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334043 13f79535-47bb-0310-9956-ffa450edef68"
7d82c8d2378b44e2a090dbe6942ea7bc68d1f01d,"Pad single hex values in URLs with zero.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334044 13f79535-47bb-0310-9956-ffa450edef68"
9c05ce2d4783091e1a2b2fa4b3dc549252e2e1f3,"Updates for beta release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334045 13f79535-47bb-0310-9956-ffa450edef68"
2b7961501dc7beb69352eeab79eeee944a3129ca,"Updates for beta release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334046 13f79535-47bb-0310-9956-ffa450edef68"
0c2dbc2a0e46850912cf228e78bc236c7cd9e28c,"Make hex string for generate id upper case.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334047 13f79535-47bb-0310-9956-ffa450edef68"
1ac6d2b6c83cdfd7538762d7c09b3a3dcf61d3ec,"Back on the air, updated to conform to new Composed Stylesheet logic.
(No other new function yet.) Seems to pass about as many of
the conformance tests as the interpreted code does, though I'm not
sure it's passing the same ones.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334048 13f79535-47bb-0310-9956-ffa450edef68"
7df73f6d7cdbd07b74f5dd69e5b121483dd89d7d,"Updates for beta release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334049 13f79535-47bb-0310-9956-ffa450edef68"
d780cc254e1996d99ab3339816392df7eaee71b7,"Remove Catch IOException clause.  It would never be reached.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334050 13f79535-47bb-0310-9956-ffa450edef68"
6e8456eebc366113583547994eacca2e94c3d7ec,"Updates for beta release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334051 13f79535-47bb-0310-9956-ffa450edef68"
091db2a7c38ef570ab54f33f8c36772de587a8f8,"Patch from Steven Serocki: Fix deadlock with getLocale() in ElemNumber.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334052 13f79535-47bb-0310-9956-ffa450edef68"
c1d6691e614b369579558997169377d7a5042ede,"Updated version number to 2.0.D04


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334053 13f79535-47bb-0310-9956-ffa450edef68"
1920e49ee9f3c86d237fac38bd0ce541b8b93543,"Correction in our reference to the test suite per Dave Marston.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334054 13f79535-47bb-0310-9956-ffa450edef68"
2e85532aec574bf29f6af6e19f8dfc91c27b81c7,"One-line workaround for a bug in the parser. Crimson seems to return
null for attrUri instead of """".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334055 13f79535-47bb-0310-9956-ffa450edef68"
eac44e44a98e4f08a2c3cf379a0b5dcae1324770,"Fix for variables out of context. Basically, searchstart need to be adjusted when variables or params are added because of an xsl:call-template or xsl:apply-templates. Note that Scott needs to do some additional work in this area!!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334056 13f79535-47bb-0310-9956-ffa450edef68"
a614e8f903a24c18b2205b0a9c43f2e1b3e8faa4,"Suppress addition of whitespace when outside a document
element, to avoid DOM006 Hierarchy request errors.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334057 13f79535-47bb-0310-9956-ffa450edef68"
61006dedfc16a2f5e65364ba6d0cee144e875316,"Added ""-flavor d2d"" for testing of dom-to-dom transformations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334058 13f79535-47bb-0310-9956-ffa450edef68"
92d5ab9c793a20faa49c78505d9974c7aa0bba59,"From Rajiv Mordani <Rajiv.Mordani@eng.sun.com>: 		 I have made some changes to the javadocs in the transform package
and also added getDOMImplementation to the DocumentBuilderFactory (was
discussed earlier in the expert group but forgot to include it).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334059 13f79535-47bb-0310-9956-ffa450edef68"
fd4249a1022cba6a10ff9d764e7e174c51e3d547,"Adapted Joe's work on fixing the problem with multiple text events
appending to a node, but the node being accessed by the transformer
thread before the appends are complete.  Now the node is created
but not appended until setPreviousIsText is called.  Also, the transformer
now properly sends an end document event when an RTF transform is
done, so that setPreviousIsText(false) is called in endDocument.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334060 13f79535-47bb-0310-9956-ffa450edef68"
299c8b2803b5083a0060dd75027b16097d417429,"Changed variable stack to be a stack of frames, which makes
everything a hell of a lot easier.  When a frame is first pushed, it
is a static empty frame, and then is switched to a real frame if
a parameter or variable is pushed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334061 13f79535-47bb-0310-9956-ffa450edef68"
78e572dc2f9487a03258dc75c54aed64f3ea8e17,"Modified Myriams setting of searchStart a bit, so the nested variables at
inside a variable at the top level work now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334062 13f79535-47bb-0310-9956-ffa450edef68"
286dec3ccfa10bc80e165432634f85bad63d37ad,"When pushing params, now just keep track of the param declaration
context and the reference context, and just change the start search
inside the loop, instead of doing two loops.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334063 13f79535-47bb-0310-9956-ffa450edef68"
2eeec53c4081c37918e9507a71db726d277df037,"Add space if find ""?>"" inside PI data.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334064 13f79535-47bb-0310-9956-ffa450edef68"
fe350112308852892b819aa22f8bcd5c4f779346,"Updated version to 2.0.D5


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334066 13f79535-47bb-0310-9956-ffa450edef68"
449c1679d07de2a6d399bf75cefab1419a23e72c,"Updated version to 2.0.D05


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334067 13f79535-47bb-0310-9956-ffa450edef68"
0934e8ff426a43aa0a66ffe2d602bc919425297c,"In addAttribute, don't do ensurePrefixIsDeclared  for the xmlns
name itself.
Uncomment code that checks if the prefix is declared already
before adding the attribute.
This fixes bug with duplicate xmlns attributes reported
by ""Jarno Elovirta"" <jarno@elovirta.com>
on 12/20/2000 02:35 AM.  May cause fairly minor performance
regression.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334068 13f79535-47bb-0310-9956-ffa450edef68"
6a95a4bb21c0f3e2f30f92cbf982519f35c51b7b,"Added extract from SPR database to our doc build.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334069 13f79535-47bb-0310-9956-ffa450edef68"
497c905da2ca369c7242667f814e778cb3b721a3,"BUGs is now build dynamically from xml-xalan/java/bugs-j-2.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334070 13f79535-47bb-0310-9956-ffa450edef68"
c92c50868c284fad3f579061dcabca7febf53f52,"Rearrangment of BUGS.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334071 13f79535-47bb-0310-9956-ffa450edef68"
e14361a7324b6b0c230e2571c5115779e778faa1,"Made set/getLexicalHandler public.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334072 13f79535-47bb-0310-9956-ffa450edef68"
93df3e961d2d4526097f13ece620f789451ef2c3,"Call JAXP to get the reader, which was not being done!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334073 13f79535-47bb-0310-9956-ffa450edef68"
9c02fc0402a81c449cf0d6c96bbd3942d6f15829,"Removed a couple of debug statements I had left in by mistake.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334074 13f79535-47bb-0310-9956-ffa450edef68"
aa208a03aad32d0fdc1a46e5d48f437d1449d250,"Added accessors for the param variable flag.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334075 13f79535-47bb-0310-9956-ffa450edef68"
dbac29f83d6fbf49e416b97c29525ec041eceec6,"Changed getParamVariable to getParamArg.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334076 13f79535-47bb-0310-9956-ffa450edef68"
40c9758187a960d07c8b1d7194fc6e2d60082345,"Set the isParam flag to false.  In the variable stack, only get variables
that are *not* params.  This all keeps us from executing parameters
that are not declared.  See test variable 26.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334077 13f79535-47bb-0310-9956-ffa450edef68"
968f8adc64a33351fbacd1f726cbf2adae7f2035,"Added remarkParams function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334078 13f79535-47bb-0310-9956-ffa450edef68"
fa9140a9d146205a191083af0cf8d59582fd1992,"The parameters now work like this:
1) Before an apply-template loop (i.e. outside the loop)
push all the params on
the current frame.  Each Arg is marked as being a param.
2) When ElemParam executes, if a real parameter is found on
the stack, mark it as *not* being a param, else execute it as a
variable for the default value.
3) When the variable stack looks for a variable, it doesn't
return those marked as a parameter.  Thus it won't return
parameters that are marked as parameters, given #2.
4) after the template has executed, remark all the parameters
as parameters, and go back to #2 in the next itteration of the
loop.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334079 13f79535-47bb-0310-9956-ffa450edef68"
03b7a13c9543da1158ce16b4b8b35a436f9843b3,"Absolutize the URL for unparsed entity URIs.  From the sped:
""The root node has a mapping that gives the URI for each unparsed entity declared in the document's DTD. The URI is generated from the system identifier and public identifier specified in the entity declaration. The XSLT processor may use the public identifier to generate a URI for the entity instead of the URI specified in the system identifier. If the XSLT processor does not use the public identifier to generate the URI, it must use the system identifier; if the system identifier is a relative URI, it must be resolved into an absolute URI using the URI of the resource containing the entity declaration as the base URI [RFC2396].""
Note that this will cause problems with the testsuite.  We should
probably try and do something with the public ID to avoid this, both in the
code and in the test?


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334080 13f79535-47bb-0310-9956-ffa450edef68"
567f6a140d1114da17ce0fd8a3ef846d5b5b8dc0,"Add dfactory.setNamespaceAware(true); to d2d flavor, so it will
work correctly!!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334081 13f79535-47bb-0310-9956-ffa450edef68"
11f333f0bd9797a987fc40b5e0634602fcd2bb2f,"Moved unparsed entity task to completed, and added two performance
related tasks, and one error handling task to be done for beta2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334082 13f79535-47bb-0310-9956-ffa450edef68"
43f1d4b97650d46c91186dbc7943f4c35078a58d,"Changed the composed variables to non-transient.  I'm not totally
sure why Gary had these listed as transient.  Perhaps he was thinking
that we would recompose on readObject?  I was thinking the opposite,
that we would throw away all uncomposed stuff if you serialized.
In any case, this seems to make serialization work OK, though
surely not optimized for storage space!!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334083 13f79535-47bb-0310-9956-ffa450edef68"
ca712ead58105205f9a606c63df13f224c20196f,"Small, ugly hack in getClassForName to substitute the
""org.apache.xalan.xslt.extensions.Redirect"" with
""org.apache.xalan.lib.Redirect"", for backwards compatibility
with XalanJ1 stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334084 13f79535-47bb-0310-9956-ffa450edef68"
62a1ee5de1ab8a33722de3eed3a3ef7d42672dad,"Transforms bugs.xml (extracted from SPR db) to BUGS
for inclusion in readme.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334085 13f79535-47bb-0310-9956-ffa450edef68"
c61030ffbf9e8072c199fabbb64d3c044b568dfa,"Updates for beta release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334086 13f79535-47bb-0310-9956-ffa450edef68"
f3040a90580e904be2936d7b56b7873af9162215,"Reverted to bugs.xml


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334087 13f79535-47bb-0310-9956-ffa450edef68"
746711ff76679f94c85b7173a6eab7caba693e6f,"Not sure how this got purged, but here it is again.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334088 13f79535-47bb-0310-9956-ffa450edef68"
bbb6bda1f197e1bacca6e6886ca14caa7115c2f6,"Fixed nasty bug where an arg was being set in the stack, instead of the frame.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334089 13f79535-47bb-0310-9956-ffa450edef68"
01d46dcaf0a16fb0ce92bade37d1b8b2e0487843,"Try not to check for arg.isParamVar() is global var.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334090 13f79535-47bb-0310-9956-ffa450edef68"
b3ac8b73a8ba7fa73667d926834d35715fe577ab,"Added note on handling of cr-lf in output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334091 13f79535-47bb-0310-9956-ffa450edef68"
5634c604dc9916aefb31bfc838d128afb58fac2e,"Added note on handling of cr-lf in output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334092 13f79535-47bb-0310-9956-ffa450edef68"
eb2c62e7100a1823bd3c345798866d7ea60cb881,"Removed the now dumb check for global var stack in getVars.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334093 13f79535-47bb-0310-9956-ffa450edef68"
7088bccc8685dbdec2f8fb29a416689a6cf81ae4,"No real changes, just changes in the commented debugging stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334094 13f79535-47bb-0310-9956-ffa450edef68"
acae11bdbd2908e024bc18a15b62054257df8074,"Quick editorial pass.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334095 13f79535-47bb-0310-9956-ffa450edef68"
1ee448550a9b07c42be5ed494ebb68d598970d72,"Clarification on setting output properties.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334096 13f79535-47bb-0310-9956-ffa450edef68"
2cf2a622ac54f56ab583d1cec435dcde60de9421,"Added gary's tasks from his mail, added NodeSet compatibility task,
added some other tasks.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334097 13f79535-47bb-0310-9956-ffa450edef68"
6fef1df1674202599912eda270ead7d91744fe95,"Added tast for architecture documentation for myself.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334098 13f79535-47bb-0310-9956-ffa450edef68"
7b968981b4ce95ff4428e9490dcf9b380414077d,"Editorial correction.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334099 13f79535-47bb-0310-9956-ffa450edef68"
d87e581b02843faf10be97ced339781e49028d7f,"Final update for beta release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334100 13f79535-47bb-0310-9956-ffa450edef68"
2cc92677365e8a27386a6b86b32a8a5a2f41e537,"In pushOrReplaceVariable, check if elem frame is the empty stack
frame, and call allocateCurrentFrame if it is.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334101 13f79535-47bb-0310-9956-ffa450edef68"
8ec99e6d045001a88f72c0e0989ff3537afec06e,"In pushOrReplaceVariable, move check of empty frame to before
the loop.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334102 13f79535-47bb-0310-9956-ffa450edef68"
dfdebbb71f3cfca7a7b8ba09c5d08a7dfbde121a,"Add check for isParamVar so we don't replace a non-param var.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334103 13f79535-47bb-0310-9956-ffa450edef68"
5d9178dc1952dc6d608b63e03b739d326f887de5,"On reset, force the stack size to 1, so that everything's correct
on entry again.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334104 13f79535-47bb-0310-9956-ffa450edef68"
6c8b2d190bb4136e7cc735e457769d97c3dd45a7,"Javadoc cleanup.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334105 13f79535-47bb-0310-9956-ffa450edef68"
c21e84fff0a7d50100e631919fae8dad5dd6d9ca,"Add paragraph about XSLT extensions in general per suggestion from John Gentilin <johnglinux@eyecatching.com>.
Updated url for Dave Pawson's FAQ.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334106 13f79535-47bb-0310-9956-ffa450edef68"
1e854e9950e8ead916aab8ff6054a5157aa2c99a,"Add conftest, examplestest, and smoketest targets, to call
the test package's build.xml, after the fashion of minitest.
This obviously needs more work to call the tests more easily, as
I would like to be able to call a still more extensive list of tests,
perhaps all of them for a test-fill target, which seems difficult right
now given the granularity of the tests.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334107 13f79535-47bb-0310-9956-ffa450edef68"
44c2aeda08ca2a3c22506b2638b64d107eff0604,"Removed for now, to be added later.  These classes are non-functional
for the moment.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334108 13f79535-47bb-0310-9956-ffa450edef68"
0af78232f19f364dc53ed74f160434cdf6ab95d6,"When setSystemID is called, create a StreamSource, and assign to
m_inputSource.
In unparsedEntityDecl, check to make sure m_inputSource
isn't null before trying to resolve to absolute URL.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334109 13f79535-47bb-0310-9956-ffa450edef68"
aa65cf9deafc3ec6929a1a7edeb3d4781cd7e759,"Add canTraverseOutsideSubtree method, which will be part of
the infrastructure for being able to prune used source tree nodes,
when possible.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334110 13f79535-47bb-0310-9956-ffa450edef68"
a80d35c47b2d700d929a17eb6d0b4d4d2621c7ba,"Optimize for ""/foo/baz"" patterns.  Add canTraverseOutsideSubtree support.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334111 13f79535-47bb-0310-9956-ffa450edef68"
3d37dbb1c320e316f7eb4e6f1d8da677274d3ada,"Check for null entities and entity, partly as defensive check if
setDTD has not been called, and also simply for a miss.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334112 13f79535-47bb-0310-9956-ffa450edef68"
4ce76afdeaf7ccd967e4985db16930a2abb96804,"Support for canTraverseOutsideSubtree.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334113 13f79535-47bb-0310-9956-ffa450edef68"
97b4824735c609fd5a20ac68b44d1d2186834fdf,"Protect call of endElement inside a finally call, which *helps* with
hung transforms in piped transform scenarios.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334114 13f79535-47bb-0310-9956-ffa450edef68"
5c72eab19064b0d3eff78dceba407dc4cf4fc7da,"Just added some debugging stuff.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334115 13f79535-47bb-0310-9956-ffa450edef68"
a2ee3e2da3fbe14325597cb717d44690d52e0a38,"When creating a input content handler, make it multi-threaded by default.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334116 13f79535-47bb-0310-9956-ffa450edef68"
b88f4783a1b5d9bba4a9780b8fab39a918082009,"Moved the source tree pruning task to 'till after January release,
since I believe it undoable by that time (as noted was possible
in the task description).
Moved optimization of ""/foo/baz"" patterns to completed.  Optimization
is verified, but, strangely enough, did not make a difference in the
test case I was using.  Hmph.
Re-prioritized some other tasks.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334117 13f79535-47bb-0310-9956-ffa450edef68"
64dac5e428d3f234223498d60d4146d8fde82572,"Various updates: added built.xalan.jar variable, cleaned up most
test execution stuff: fix dependencies for test targets,
added back tests-not-available target (see checkin notes for
test\java\build.xml as well)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334118 13f79535-47bb-0310-9956-ffa450edef68"
fa7f7dd6e237aac8538e780d2ef99e79717c5d98,"Moved the Shane s2s bug and the intermittent failures bug to
completed.  Added task for SQL extension code integration.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334119 13f79535-47bb-0310-9956-ffa450edef68"
c5208fb9133013ca31b85414b7e49d0765eafd6f,"Override logging level, excludes and embedded for calling test tasks.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334120 13f79535-47bb-0310-9956-ffa450edef68"
6cdcae44a8ed3d128a1488d4a1fe10d1457aa8c1,"Only return empty string (not null) for namespace, to match SAX
rules.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334121 13f79535-47bb-0310-9956-ffa450edef68"
81cb0d260df7b913af416e167356885e3315d733,"Move append back to above the attributes add, to make sure
we don't cause strangeness with other DOMs, that might not like
adding attributes to an unparented node.  The entire startElement
method is now overridden by StreeDOMHelper, for various reasons.
Make the m_currentNode and m_elemStack
protected for this reason.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334122 13f79535-47bb-0310-9956-ffa450edef68"
433918e00e59c0c2c0a105da7114e98fee8893b4,"Fix strange problem where getIndex(uri, localName) didn't seem
to be working in addAttribute (for xmlns), use the QName instead,
which should be fine in this limited instance, since prefixes will
always be the same within a single attribute list (we're just checking
for duplicates).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334123 13f79535-47bb-0310-9956-ffa450edef68"
7488b1d7a77c9203c2143d693f06188483dbf43d,"Fix MAJOR bug where empty strings were always being passed for both
the uri and the local name.  Leftover, I guess, from the original
SAX2 conversion, though I can't believe this hasn't showed up
until now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334124 13f79535-47bb-0310-9956-ffa450edef68"
a6b243578fd98a8c26a53cff2e01628a4626de54,"In newTransformerHandler(Source src), reduce code by just calling
newTransformerHandler(templates) after the templates are created.
In newTransformerHandler(Templates templates), call new
TransformerImpl#getInputContentHandler(boolean doDocFrag) with
doDocFrag set to true, so that SAX events don't have to establish
a root element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334125 13f79535-47bb-0310-9956-ffa450edef68"
21fbfb769e581f9588d256fff0ae8b7e0068a3fe,"Just added commented-out debug statements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334126 13f79535-47bb-0310-9956-ffa450edef68"
8de4b0d4d89c5c616d9aea875f105c12f0ae34cc,"Added debug variable, and some debugging code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334127 13f79535-47bb-0310-9956-ffa450edef68"
c8797de09a5b18951fb8b11a0063ad12716749c3,"Added getStartOffsetInBuffer and getLengthInBuffer
for debugging purposes from another file, without
causing the string to be created.  These
also may well be useful for some other purposes,
namely, optimizations where the string is
not created.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334128 13f79535-47bb-0310-9956-ffa450edef68"
8ce4bc7b5bc5932f3f8b6e51b5017ddcc70acc2b,"Put a timeout of 100 milliseconds on the wait, so that it can check
for a posted exception every so often.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334129 13f79535-47bb-0310-9956-ffa450edef68"
3f88c980aaa507e86b5467615e7f93d4fc20f314,"Put a timeout of 100 milliseconds on the waits, so that it can check
for a posted exception every so often.
In AppendChild, don't set the uid and increment the doc order count
if the uid value is non-zero.  This so that the StreeDOMBuilder can
set the UID before the append, so that the UIDs on the attributes that
are added before the append will be correct.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334130 13f79535-47bb-0310-9956-ffa450edef68"
cdbfac928b949025cb41023a7f64ec15c1294169,"Change the derivation from DocImpl to DocumentImpl, so that
document fragment use can be properly threaded.  This works
because DocumentImpl#appendChild now checks to see if it
is a DOCUMENT_FRAGMENT_NODE before complaining about
multiple roots being added.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334131 13f79535-47bb-0310-9956-ffa450edef68"
82c7a996e47c75c6d9c4425db05ea3d0391b8a07,"DocumentImpl#appendChild now checks to see if it
is a DOCUMENT_FRAGMENT_NODE before complaining about
multiple roots being added.
Add 100 ms wait so that posted exceptions can be checked
periodically.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334132 13f79535-47bb-0310-9956-ffa450edef68"
bf62d08a3fc5c69e18a8552908f38c7e6611b41f,"Add 100 ms to wait arg so that posted exceptions can be checked
periodically.
Add defensive code for null namespace URI for attribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334133 13f79535-47bb-0310-9956-ffa450edef68"
7bcd4fe17487a265fc35c75d972eba8342f496b8,"Add lots of debugging code which can be turned on by setting
the DEBUG variable to true.  Move the setComplete and notify to
AFTER the the endDocument event is called (duh).  This was probably
the cause for the still variable results that JK was seeing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334134 13f79535-47bb-0310-9956-ffa450edef68"
6d8b14a38e165af27921dc8cfbef0605a04c9309,"Add lots of debugging code which can be turned on by setting
the DEBUG variable to true.

Override the startElement method so that the append can occur
after the attributes are added, but we can set the uid before the
elements are added.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334135 13f79535-47bb-0310-9956-ffa450edef68"
49aef5a7aef4441cf86d8ddb6fcdfdbc4c524acd,"Add defensive code to make sure namespace isn't null.  Should
probably remove at some point.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334136 13f79535-47bb-0310-9956-ffa450edef68"
7ad4daf4787598c855443539be28f193906b26b0,"Check for document fragment as well as document for root node handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334137 13f79535-47bb-0310-9956-ffa450edef68"
e1211ff18c3437be94daf54741050858932c35fa,"Use empty strings instead of null for null namespaces, as per
SAX convention.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334138 13f79535-47bb-0310-9956-ffa450edef68"
dcb633d5db8ffc1abace2fc808799f31165cb140,"Do same handling of document fragment as for document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334139 13f79535-47bb-0310-9956-ffa450edef68"
cfb1207db4a4183d5e0130075ab247cffe398a1e,"Add a bunch of debugging code that can be turned on by setting
the DEBUG variable to true.
Make sure namespaces are empty strings and not null.
Have startPrefixMapping(String prefix, String uri) call
startPrefixMapping(prefix, uri, true) instead of
startPrefixMapping(prefix, uri, false), so that pended element flushing
will occur by default, which fixes a bug when it is called from TreeWalker
(which can only use the SAX interface).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334140 13f79535-47bb-0310-9956-ffa450edef68"
86b763d7f90154ed2837193e9de9a191b66ff0d6,"Check the transformer output properties, NOT the stylesheet output
properties (duh).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334141 13f79535-47bb-0310-9956-ffa450edef68"
2d20413a7178b4da9688e124ba26f59b78eb8022,"Add getOutputPropertyNoDefault method.
Pass posted exception to resultContentHandler,
which fixes a lot of problems with hung
threads when an error occurs.  Do a stack
dump for an exception if we are being called
from SAX events, since there is no good way
(that I can see) to pass the exception
to the main thread.
Add a method to get a document fragment
rooted content handler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334142 13f79535-47bb-0310-9956-ffa450edef68"
c15d3a0c78811c17756e8ccd84ff003ec665a9c0,"Fix really nasty bug where variable context was not being set in
simple iterators.  Reported by ""Will Allan"" <will@active.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334143 13f79535-47bb-0310-9956-ffa450edef68"
232bc54c41fd011b6a2458c6fa9b0a5a7d7123c7,"In startElement, set the level before adding the attributes, so
the level number of the attributes will be correct.  This fixes a
bug with complex axes walkers where nodes can be lost.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334144 13f79535-47bb-0310-9956-ffa450edef68"
983767b0832faa40266b57b3cef3a72f5b1f5649,"Names of serializers changed from FormatterToXXX to SerializerToXXX.
Also, javadoc work done.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334145 13f79535-47bb-0310-9956-ffa450edef68"
e354091fdb505b36c15694d9c1c2ab3f726afdd4,"Javadoc work


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334146 13f79535-47bb-0310-9956-ffa450edef68"
c4e2276b96e9fe46fd7bbeb5abea7ee821c3598f,"Javadoc work.  Removed many of the (broken) @see tags.  Sorry,
but it would have taken way too much time to fix them, and I'm actually
not sure they were very useful.  removed many empty @return tags.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334147 13f79535-47bb-0310-9956-ffa450edef68"
1483259f577517c752ceadc79358f1c1181992ad,"Javadoc work, to make the javadocs build clean.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334148 13f79535-47bb-0310-9956-ffa450edef68"
279f1c50eed8f5886e8bbdf8a749617d488e46af,"Minor javadoc tweaks to make clean doc build.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334149 13f79535-47bb-0310-9956-ffa450edef68"
b7e487efa0f897223e152335193ed363728bb528,"Changed old TFactoryConfigurationError
to TransformerFactoryConfigurationError.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334150 13f79535-47bb-0310-9956-ffa450edef68"
2059260ad9965b83ba461b265dc0b4736c7aff77,"Update to D06.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334151 13f79535-47bb-0310-9956-ffa450edef68"
0632704b5e5ec7bd30c4eac21d4da5d68c62a70b,"Changed old FormatterToXXX to SerializerToXXX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334152 13f79535-47bb-0310-9956-ffa450edef68"
c2b1fbf21891b1d6a645ae0309d91d4f4b1730cd,"Moved javadoc stuff to completed list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334153 13f79535-47bb-0310-9956-ffa450edef68"
e3aaba5febeedf07505e4a24a4fd43fac3e471ac,"Update to D06


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334154 13f79535-47bb-0310-9956-ffa450edef68"
6bf5d49d55ee1c75518b7f5ab8927eda3a89ea3d,"Fix bug in setOutputProperty where it was effecting the Templates
properties.  This made the harness test fail in several places.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334155 13f79535-47bb-0310-9956-ffa450edef68"
36769c51182e1d5c18a3fd83df7ea99bf4f67982,"Updates for Xalan-J 2.0.D06.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334156 13f79535-47bb-0310-9956-ffa450edef68"
95d451ba09aad1bfa6b2f632a736e23144bfb9d7,"Added handling for 0 open bugs!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334157 13f79535-47bb-0310-9956-ffa450edef68"
a8b949d23c9c6b47ad0b022ad0f8fb66c53262c0,"Updates for Xalan-J 2.0.D06.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334158 13f79535-47bb-0310-9956-ffa450edef68"
fa79f78d63aa2ad4b52dbc5a2448189f37200ddc,"No longer exclude embed01 and embed 07, since the tests are fixed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334159 13f79535-47bb-0310-9956-ffa450edef68"
a317ba8d286aece47217cb125ff7337c5a70c924,"Fixed javadoc on error method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334160 13f79535-47bb-0310-9956-ffa450edef68"
411f84e0aa4f840d7d0da6bdfec699e92122c90c,"Since the DOM is passing xmlns decls as attributes, ignore these.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334161 13f79535-47bb-0310-9956-ffa450edef68"
0c67e8e3a6f3663240d8495a6a23c6cc5937100f,"Register incoming DOMSource with source tree manager.  This fixes
bug where relative URLs to the document tree weren't being processed
correctly.
Change the setProperties a bit to make sure the right defaults
are being created.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334162 13f79535-47bb-0310-9956-ffa450edef68"
8bca27855d0649d7bc7f4ed9f3a21d69706cb715,"Fix -flavor d2d, so that it more closely mirrors Shane's code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334163 13f79535-47bb-0310-9956-ffa450edef68"
dfdc653a8244e5ef1456bb54c0e81b49c5e4a9d2,"Add URI string to error message.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334164 13f79535-47bb-0310-9956-ffa450edef68"
27e2899d3e694d829816439b4b0ede1bf2c73d58,"Allow DOMSource to be registered.  Part of bug fix where relative
URLs weren't being resolved for DOM processing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334165 13f79535-47bb-0310-9956-ffa450edef68"
39a834084f1261865c4f18404678a919888ec1c5,"Since an attribute can have a child in the DOM, but not in XSLT,
check for attributes before calling getFirstChild.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334166 13f79535-47bb-0310-9956-ffa450edef68"
ee155fba7b1cd46226df826c3235004c60468adc,"In setRoot in the strange fixup code for preceding of an attribute,
use dom helper to get the owner of the node, so that we don't
get NULL for a generic DOM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334167 13f79535-47bb-0310-9956-ffa450edef68"
9edba08d18116ff408dac74d552678bb620ec871,"Updates for Xalan-J 2.0.D06.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334168 13f79535-47bb-0310-9956-ffa450edef68"
daa309af607a5640dca4efffa0841080f67b3878,"Updates for Xalan-J 2.0.D06.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334169 13f79535-47bb-0310-9956-ffa450edef68"
30516a584e4d162f8f09e936030bfc43a32bbec3,"When calling TransformerFactory#newTransformer() or
TransformerFactory#newTransformerHandler(), i.e. when creating
an identity transformer, don't go through a templates, or create
a source tree, but go directly to the result ContentHandler.
This is a good performance improvement, but may increase the
testing matrix, as these kinds of specializations tend to do.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334170 13f79535-47bb-0310-9956-ffa450edef68"
acce76ca10e8c4f1d9403a75dbc9b811f61d7024,"Move direct identity transform task to complete.
Add several bug tasks.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334171 13f79535-47bb-0310-9956-ffa450edef68"
8c858818bc2d5764adc8b0f2bb355577eb4839dd,"Update package name for ElemExtensionCall.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334172 13f79535-47bb-0310-9956-ffa450edef68"
88b760d171128b682542e311ed8a1a3f35bf9c4e,"Fix bug where ChildTestIterator was being created for ""node()""
patterns, instead of ChildIterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334173 13f79535-47bb-0310-9956-ffa450edef68"
8637a1aeed23ef3a1570d93c67ab6a109d3e7e01,"Implement xsl:strip-space functionality for generic DOMs, somewhat
against my better judgement, at some (slight) expense to all processing,
and at great risk to my sanity.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334174 13f79535-47bb-0310-9956-ffa450edef68"
f25feaa7fd26aa50a280bb4e2a7ddd6854850c39,"John Gentilin &lt;johnglinux@eyecatching.com> work,
for SQL Extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334175 13f79535-47bb-0310-9956-ffa450edef68"
5f3ec46f07f17df6701a59215d90cf6eaeac94a7,"John Gentilin &lt;johnglinux@eyecatching.com> work.  From note
that John sent:

Accomplished so far:
Connection Pools,

The way I implemented Connection Pools was to provide
a controller that contains a list of named pools. This list is
static, so as long as someone has an instance of the controller,
the pools will  remain intact.  The Connection Pool is defined
as a minimal interface. If you want to use you own  connection
pool all you have to do is create an adapter class that implements
the interface and register it with the controller. All of the original
functionality was left intact to hold backward compatibility. There
is a default connection pool that is implemented as part of the
extension so the code will work without any external pool.
I plan to  implement a wrapper around Apache Turbine pools
as a sample.

There are several examples. I used a database that I am currently
working on. Is there a way to distribute samples that work stand alone.
i.e. Do you know of a small DBMS implemented as a JAR that we can
distribute in the lib dir ??

As a helper function, I added a constructor that allows a single xpath
statement to point to the DB connection Info. Its value is questionable,

I was unaware that a function could take multiple xpath statements
as arguments until Gary pointed it out. I thought you had to create
several variables and pass them in separately which seemed messy.

I still need to do the documentation, I have a design spec in a format
that
I am using internally but I need to reformat it for the apache code.
I took a quick stab at it in the samples dir but it is know where
complete.

Parameterized Queries,

You can set your query to contain the ""?"" that are used in
PreparedStatements. Then pass in the matching parameters
using data from the source document. The type information
can either be passed in as a comma separated string as a
second parameter of the pquery statement or as part of the
data. You will have to look at the code comments for this one
as I have not even touched the docs on this one.


Error handling through XML formatted responses.

This is experimental code, I just wanted to see how it works.
The information in the XML document is minimal, if we decide
that this is a valid approach, the implementation need quite a bit
of clean up.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334176 13f79535-47bb-0310-9956-ffa450edef68"
c5d118e0004d41fad50f7e66e40178c745993bdb,"Moved xsl:strip-space task for generic DOMs and SQL work
integration to completed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334177 13f79535-47bb-0310-9956-ffa450edef68"
6c81924700b82eddd9c007a21650966d651875ba,"Remove until connection pooling revised to work with jdk 1.8.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334178 13f79535-47bb-0310-9956-ffa450edef68"
9665a65181bb4d9c53946ab39d69a474b9f71b0c,"Add try..catch(SecurityException) around getting user.dir;
Reported by: morad@db.informatik.uni-kassel.de
Reviewed by: sboag


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334179 13f79535-47bb-0310-9956-ffa450edef68"
7ccf5e9c2cdeaf508e800b696475f2c2d9534f87,"Back out of John Gentilin &lt;johnglinux@eyecatching.com> work.
From note from Shane:

Personally, my vote is -1 to any code that doesn't compile cleanly under JDK 1.1.8, although for extensions and other non-core functionality I wouldn't mind if the extensions don't work under earlier JDKs, as long as the compile and run far enough to give an appropriate error message.

Using WinNT 4.0 SP5; Sun's JDK 1.1.8; xml-xalan\java from CVS 8AM eastern today.
...
compile:
compile entire source tree and copy  .properties and .res files to build tree.
    [javac] Compiling 464 source files to E:\builds\xml-xalan\java\build\classes

    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\DefaultConnectionPool.java:61: Class java.util.Set not found in import.
    [javac] import java.util.Set;
    [javac]        ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\DefaultConnectionPool.java:62: Class java.util.Iterator not found in import.
    [javac] import java.util.Iterator;
    [javac]        ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XStatement.java:71: Class java.util.Iterator not found in import.
    [javac] import java.util.Iterator;
    [javac]        ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XConnection.java:252: Method setProperty(java.lang.String, java.lang.String) not found in class java.util.Properties.
    [javac]       prop.setProperty(""user"", user);
    [javac]                       ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XConnection.java:253: Method setProperty(java.lang.String, java.lang.String) not found in class java.util.Properties.
    [javac]       prop.setProperty(""password"", password);
    [javac]                       ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XConnection.java:386: Method setProperty(java.lang.String, java.lang.String) not found in class java.util.Properties.
    [javac]         prop.setProperty(""password"", s);
    [javac]                         ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XConnection.java:397: Method setProperty(java.lang.String, java.lang.String) not found in class java.util.Properties.
    [javac]         prop.setProperty(""user"", s);
    [javac]                         ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XConnection.java:414: Method setProperty(java.lang.String, java.lang.String) not found in class java.util.Properties.
    [javac]           prop.setProperty(Name, s);
    [javac]                           ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XConnection.java:602: Method add(org.apache.xalan.lib.sql.QueryParameter) not found in class java.util.Vector.
    [javac]     m_ParameterList.add( new QueryParameter(value, Type) );
    [javac]                        ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XConnection.java:619: Method add(org.apache.xalan.lib.sql.QueryParameter) not found in class java.util.Vector.
    [javac]       m_ParameterList.add( new QueryParameter(value, Type.getNodeValue()) );
    [javac]                          ^
    [javac] E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\XConnection.java:688: Method add(org.apache.xalan.lib.sql.QueryParameter) not found in class java.util.Vector.
    [javac]           m_ParameterList.add(
    [javac]                              ^
    [javac] Note: E:\builds\xml-xalan\java\src\org\apache\xalan\lib\sql\ExtensionError.java uses a deprecated API.  Recompile with ""-deprecation"" for details.
    [javac] 11 errors, 1 warning

BUILD FAILED

E:\builds\xml-xalan\java\build.xml:173: Compile failed, messages should have been provided.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334180 13f79535-47bb-0310-9956-ffa450edef68"
e2e129a7517cd389a4aa81ce9ea3a9917265df44,"Make it possible to serialize a single attribute node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334181 13f79535-47bb-0310-9956-ffa450edef68"
688399773ba47941204ac0b3963e5a74355fae2a,"Defensive code for string coming from SQL lib.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334182 13f79535-47bb-0310-9956-ffa450edef68"
ad37fd79811ac0e034bd975e052a9d65457eb4d5,"Don't send start document if it is a Document -- TreeWalker will
do this.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334183 13f79535-47bb-0310-9956-ffa450edef68"
e5732bc0f3ab566f3371611a6cfa42b1e4695bb6,"Comment out SQL integration completed task.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334184 13f79535-47bb-0310-9956-ffa450edef68"
a1971504bc9c369113c549c9acd1eddf8230bb7e,"mxl-site target is xalan-j.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334185 13f79535-47bb-0310-9956-ffa450edef68"
a705b2f27174a243c6cfaaf312dfd4e31718396a,"Correction from Scott.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334186 13f79535-47bb-0310-9956-ffa450edef68"
607707601a72aa7b85d342a41505da67148e8294,"Same string was defined for both PI_DISABLE_OUTPUT_ESCAPING
and PI_ENABLE_OUTPUT_ESCAPING!!!  Fixed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334188 13f79535-47bb-0310-9956-ffa450edef68"
c016329635ec15d93b86e5a83e1ffbecd718ef59,"setLexicalHandler(LexicalHandler handler) was defined as
this.lexhandler = lexhandler!!!
Changed to this.lexhandler = handler.
(This is why I use m_xxx in my own coding conventions, where
this bug would have been much clearer.  This is
not done this way here because I was trying to stick to Sun conventions).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334189 13f79535-47bb-0310-9956-ffa450edef68"
096c5702a82b71a17d11d5f6a674d4b4ebd240e7,"CharKey class to be used as a key for char hashtable lookups.

This class is used in the serialization stuff to look up chars without
creating a Character object for each lookup.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334190 13f79535-47bb-0310-9956-ffa450edef68"
dc4e2c7e2d46f722c5d301ffb58a7c00a2c83ae0,"Use the new CharKey class so that chars can be looked up without
creating a Character object for each lookup.  This showed up fairly
high on the JProbe profiler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334191 13f79535-47bb-0310-9956-ffa450edef68"
b21f2d5c3c6c97ee9501ffe725758382aa5966a9,"Handle IllegalArgumentException, which JDK 1.8 throws,
 in addition to UnsupportedEncoding exception.  Addresses
SPR ID#:  SCUU4SPUV3 / Sev: 1 / JDK 1.1.8 only:
extend01.xsl throws TransformerException...transformNode().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334192 13f79535-47bb-0310-9956-ffa450edef68"
aeb49bd709924b49d94275cde0da4b2cc2d24222,"Defend against empty class name, which showed up because
JDK 1.8 throws an illegalArgumentException.  Probably more
defensive than it needs to be, Gary may want to restructure this
a bit.  Addresses SPR ID#:  SCUU4SPUV3
New SPR / Sev: 1 / JDK 1.1.8 only: extend01.xsl throws TransformerException...transformNode()
(The previous commit that listed this was an error,
that commit addressed SCUU4SPUXC).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334193 13f79535-47bb-0310-9956-ffa450edef68"
fb3d62c1982e3872d697ad55fc8fb23b64dacb7a,"Do synchronization on the m_chars field in TextImpl, to address
data read/write race that JProbe Threadalizer reported.  This may
or may not fix the problem that Joe K's been reporting, with dropped
text on the IBM JDK with numb37, numbering65, numb69,
and numbering80.  The Theadalizer reports other race
conditions, but I believe I have accounted for them all.

The m_chars buffer initial size and growth size has
been reduced from 64K to 8K.  We should consider
doing blocks down the line to avoid having to do
array copies and allocations everytime we want to
grow the array.  I would consider this too destabilizing
for the upcoming release.

Also, changed SaxEventDispatch#dispatchSAXEvent to
#dispatchCharactersEvent, and implemented it at
the level of child, so that all known direct character events
from the source tree can be dispatched directly from
the nodes.  This saves a fair amount in string construction,
and is also a big savings in not having to copy child text into
a buffer in order to aggregate it for the string value
of an element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334194 13f79535-47bb-0310-9956-ffa450edef68"
b1afd95182ec297bc118ac7eaed04872a6cad5f5,"Optimize ""."" patterns to not use an itterator, and also take advantage
of SaxEventDispatch#dispatchCharactersEvent.  Addresses performance
issues found with JProbe with large-all_well.xml test.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334195 13f79535-47bb-0310-9956-ffa450edef68"
12252d977a7d61d3a9ca980da7a04b8375346783,"Update to use SaxEventDispatch#dispatchCharactersEvent, instead
of SaxEventDispatch#dispatchSAXEvent.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334196 13f79535-47bb-0310-9956-ffa450edef68"
7e378bb134b92a4bfc91062c0cb071347a7c52f9,"Handle null ExtensionHandler from makeJavaNamespace.  Put
fallback stuff into executeFallbacks method, so that it can be
called from two places.
Also added ""YOU CAN'T DO THIS HERE, AS STYLESHEETS
MUST BE IMMUTABLE DURING RUNTIME."" comments to
use of isAvailable member variable.  I think this will cause bugs when
a Stylesheet is used among multiple threads.  I tried to hack not
having this, but gave up for the moment.  I need to talk to Gary about
the right way to address this.  I suspect the value should be
kept in the ExtensionHandler instance?


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334197 13f79535-47bb-0310-9956-ffa450edef68"
0f777f3cec26a079522ccc5165f39655a3548ed0,"Don't create GenerateEvents if there are no tracers.  These event
objects, which weren't being used, were showing up as 11% of
garbage collected objects in JProbe, for large-all_well.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334198 13f79535-47bb-0310-9956-ffa450edef68"
01e5b3f77fc1e72c612866a40258d4b95623c680,"Take advantage of SaxEventDispatch#dispatchCharactersEvent,
instead of getting the string value and creating an array from it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334199 13f79535-47bb-0310-9956-ffa450edef68"
1a23eaae3d4a27e39d2da8cef3fe4650c8f99a6e,"format-number is implemented in org.apache.xalan.templates, since
it is not an XPath function.  This class in xpath has long been
dead code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334200 13f79535-47bb-0310-9956-ffa450edef68"
224bd46c81f9ec401bff9edbd5891470eac1b057,"Make sure both the source locator and the error listener are set in
the XPath Compiler and XPath parser, and the XPath object itself.
This required passing the error listener to the XPath object, which
had a ripple effect on several functions, including the constructor
for StylesheetRoot.

This was sparked by BugId 4402417 which Krishna.Meduri@eng.sun.com
submitted to me privately, but may not be the same thing, since
he was getting a NoSuchMethodError, and I don't
have the stylesheet to replicate the bug.

This fixes an error where a null pointer
exception was being thrown if an unknown
function was found.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334201 13f79535-47bb-0310-9956-ffa450edef68"
5eb42fb07e82ed5b930df79d6a8a31f56bec8eca,"Updated version numbers to d07


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334202 13f79535-47bb-0310-9956-ffa450edef68"
d070822bf313a0e577b0663831635c367687fc1a,"Fixes problem reported by Guoliang Cao <cao@ispsoft.com>,
note titled ""A possible bug in xalan 2.0 D05/D06"",
01/08/2001 11:18 AM.  The DOMBuilder was screening out
whitespace nodes before the first element was being pushed, which
it shouldn't if a document fragment is being used.  The fix is to
always return false from isOutsideDocElem() if the (null == m_docFrag).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334203 13f79535-47bb-0310-9956-ffa450edef68"
4fe75a5921ac5d71c63c6aaf14b38a7ca9f1bfff,"Set child.m_prev *before* m_next.  From note to Joe K. about this:

I tried hard to reproduce this.  I installed IBM's 1.3 JDK, and ran many tests, but could not cause the problem.

These problems all seem to occur when xsl:number is involved.  This might make be suspect something with getPreviousSibling().  I notice in Parent#appendChild:

    if (null == m_first)
    {
      m_first = child;
    }
    else
    {
      m_last.m_next = child;
      child.m_prev = m_last;
    }

    m_last = child;

m_last is only used in appendChild, which must always be synchronized at the caller level, and is never entered by the transform thread anyway.  But child getPreviousSibling() can absolutely fail.  So I think this should be changed to:

      child.m_prev = m_last;
      m_last.m_next = child;

This should be safe because getPreviousSibling() can't be called until the node is navigated to via m_last.m_next.

However, I'm not sure why this would cause the particular problem you are having with dropped text.  I would think getPreviousSibling problem would manifest itself as a bad numbering value, not a dropped text node.  In fact, in numbering64 it just uses <xsl:value-of select="".""/> which is optimized as of this weekend to just use the current node, and then the text value operation uses getFirstChild to get to the text child of that element.  So it seems like it is really getFirstChild which is failing.

Well, I'll try reversing those on the theory that it might help.  Sorry to be making you do these runs... believe me, I wish I could reproduce the problem myself.

I know that we're pretty close to the point of just doing absolute synchronization in getFirstChild, getNextSibling, and getPreviousSibling.  But, not only am I afraid to do that because of performance issues (though I haven't measured what the difference would be), I'm worried that I could somehow introduce a deadlock or hang at this stage of the game.

It's also possible that there's something else going on in xsl:number above the level of Stree which could be screwing things up.

(And the original note from Joe):

The failure frequency seems reduced... but there still seems to be a lurking horror or two, and the pattern of failure seems unchanged.

Seventh pass, numbering64, line 9
	5: hhh
	5:
Eighth pass, numbering27, line 17
	3+1-1: Level C
	3+1-1:
Ninth pass
numb42, line 3
	(1.): Level A
	(1.):
numb66, line 35
	C. Second Subsection in third Section in second Chapter
	C.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334204 13f79535-47bb-0310-9956-ffa450edef68"
a9de09278088cd4bca5432b25ad4063de34c71a6,"SQL libray sample witnh InstantDB sample.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334205 13f79535-47bb-0310-9956-ffa450edef68"
ccd65447389a951829cb1ca3ef52772e0a1cd63c,"Patch attributed to Patch attributed to David Eisenberg <david@catcode.com>.

Note that these caught SAX exceptions should probably be fed
through the ErrorListener.  One thing at a time.

From David's note:

I'm using Xalan J2 (D06) on Linux, and I invoke
java org.apache.xalan.xslt.Process from a shell script.

When my source XML file is bad, I get nothing other than ""TRaX Transform
Throwable"", which isn't terribly useful.

I've put a patch in TransformerImpl.java to deliver the parser error
message, as well as a line and column number.  The patchfile is below.
(The extra ""{"" and ""}"" near line 600 are left over from when I was putting
in some debugging output.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334206 13f79535-47bb-0310-9956-ffa450edef68"
3887a5cf0e312ca594e67d033fbebe54cbc2786c,"Close a small timing exposure in endElement().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334207 13f79535-47bb-0310-9956-ffa450edef68"
c299b8d36bb182e4a87c66e1fa7de85942b11862,"Move the shouldStripWS test from SourceTreeHandler to
StreeDOMBuilder, so that the test can be done after the text
has been accumulated from potentially multiple text nodes.
This addresses #SCUU4SPUML : Crimson: position70 has whitespace differences

Steps to Reproduce:
WinNT 4.0 SP5, JDK 1.1.8, Xalan 2.0.D06, xml-crimson built from CVS approx 03-Jan-01
xml-xalan\test
Copy crimson.jar into xml-xalan\java\bin
ConformanceTest.bat -crimson [-category position]
(Note the -crimson flag automatically adds crimson.jar instead of xerces.jar in classpath, and sets two -D flags to use crimson jaxp classes)

From ConformanceTest.xml/.html: Note missing whitespace in various places (only some shown)
gold-parse-type;[xml]; test-parse-type;[xml]; mismatch-value;TEXT_NODE(#text)len=253;TEXT_NODE(#text)len=232;lengths do not match mismatch-value-gold;TEXT_NODE(#text);
 A(1):attC(2): This is the 1st comment T(3): text-in-doc E(4):innerT(1): inner-text C(2): This is the 2nd comment E(3):subT(1):subtext T(4): text-after T(5): text-in-doc2 E(6):inner2A(1):blatE(1):subT(1):subtext T(2):final-text

mismatch-value-text;TEXT_NODE(#text);
 A(1):attC(2): This is the 1st comment T(3): text-in-docE(4):innerT(1): inner-textC(2): This is the 2nd comment E(3):subT(1):subtext T(4): text-after T(5): text-in-doc2E(6):inner2A(1):blatE(1):subT(1):subtext T(2):final-text

=====
Get the transformer thread via createTransformerThread.  From email
on this subject:

In response to this I've created the following method in org.apache.xalan.TransformerImpl:

  /**
   * Create a thread for the transform.  This can be overridden by derived
   * implementations to provide their own thread, for thread pooling and the
   * like.
   *
   * @return thread suitable to use for the transformation.
   */
  public Thread createTransformThread()
  {
    return new Thread(this);
  }

Someone who is using XalanJ2 in an EJB environment or the like can set the javax.xml.transform.TransformerFactory system property to provide a derivation from TransformerImpl, and provide a thread suitable for the environment.

I don't know if this will do the trick.  Please advise.

-scott





	""Roytman, Alex"" <roytmana@peacetech.com> 01/07/2001 12:14 AM Please respond to xalan-dev 	   To: ""'xalan-dev@xml.apache.org'"" <xalan-dev@xml.apache.org>  cc: ""'tomcat-user@jakarta.apache.org'"" <tomcat-user@jakarta.apache.org>, (bcc: Scott Boag/CAM/Lotus)  Subject: Xalan2 in server environment (was Xalan2 Stree Module spans sec ond thread to do transform?)



Scott,
Thank you very much for your reply.
One part which is sensitive to thread origin in my opinion is Extensions
In extensions people can do all sorts of things. I am not very experienced
with EJB implementation but I can imagine that many things (transactional
context, bean environment, etc.) depend on threads and some static variables
which helps with setting /switching context for beans being managed by the
server.

Example: in J2EE it is recommended to create JNDI initial context using
default constructor InitialContext(). The result of the instantiation
depends on the context where it was executed and the context is set by the
server for the thread on which your component is running. So if you call new
InitialContext() in your extension (in sql extension to get JDBC DataSource
for example ) it might fail.

Do extension run on the second (created by Xalan) thread?

I will forward your message to Tomcat news group lets see what Tomcat
developers think.

Alex

-----Original Message-----
From: Scott_Boag@lotus.com [mailto:Scott_Boag@lotus.com]
Sent: Saturday, January 06, 2001 11:39 PM
To: xalan-dev@xml.apache.org
Subject: Re: Xalan2 Stree Module spans second thread to do transform?



> In many
> cases component should not attempt to create its own threads.
> For example thread's ContextClassLoader or ThreadLocal variables might
need
> to be initialized by the server.
> Also it defeats thread pooling done by the server etc.
>
> Could you please comment on this issue

Yeah, I've been a bit worried about this.  However, I've not yet heard of
any problems that have been caused by it, and XalanJ1 has long had a two
threaded system (though not as effective as in XalanJ2).   Ultimately, I
would rather use a pull model for this, and only have one thread, but a)
there is no standard ""pull"" API for XML parsers, and b) this doesn't work
anyway when SAX events are used, for whatever reason.

I'm open to any input to how Xalan might request the thread from the
servlet environment, though it has to be able to be run outside a servlet
environment too.  Also, it would be good if someone with deep knowledge of
EJB's and the like could comment.  I talked this over in a hallway
conversation with someone who is fairly familiar with EJB's, and he didn't
think there was a problem, though I forget why.  It seems insane/crazy to
me that a component can't use a thread in it's internal modules.

-scott






                    ""Roytman,

                    Alex""                 To:
""'xalan-dev@xml.apache.org'"" <xalan-dev@xml.apache.org>
                    <roytmana@peac        cc:     (bcc: Scott
Boag/CAM/Lotus)
                    etech.com>            Subject:     Xalan2 Stree Module
spans second thread to do transform?


                    01/06/2001

                    10:48 PM
                    Please respond

                    to xalan-dev









Dear Xalan developers,
I have a question about using upcoming Xalan2 in server env.

In Xalan2 design specs it is said:

""The Stree module implements the default Source Tree for Xalan, that is to
be transformed. It implements read-only DOM2 interfaces, and provides some
information needed for fast transforms, such as document order indexes. It
also attempts to allow a streaming transform by launching the transform on
a
secondary thread as soon as the SAX2 StartDocument event has occurred.""

In server environment server usually controls threads creation. In many
cases component should not attempt to create its own threads.
For example thread's ContextClassLoader or ThreadLocal variables might need
to be initialized by the server.
Also it defeats thread pooling done by the server etc.

Could you please comment on this issue

Thank you very much in advance

Alex Roytman


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334208 13f79535-47bb-0310-9956-ffa450edef68"
ffc35019488b6bbd87abb63d07babae81600f99d,"Move the shouldStripWS test from SourceTreeHandler to
StreeDOMBuilder, so that the test can be done after the text
has been accumulated from potentially multiple text nodes.
This addresses #SCUU4SPUML : Crimson: position70 has whitespace differences

Steps to Reproduce:
WinNT 4.0 SP5, JDK 1.1.8, Xalan 2.0.D06, xml-crimson built from CVS approx 03-Jan-01
xml-xalan\test
Copy crimson.jar into xml-xalan\java\bin
ConformanceTest.bat -crimson [-category position]
(Note the -crimson flag automatically adds crimson.jar instead of xerces.jar in classpath, and sets two -D flags to use crimson jaxp classes)

From ConformanceTest.xml/.html: Note missing whitespace in various places (only some shown)
gold-parse-type;[xml]; test-parse-type;[xml]; mismatch-value;TEXT_NODE(#text)len=253;TEXT_NODE(#text)len=232;lengths do not match mismatch-value-gold;TEXT_NODE(#text);
 A(1):attC(2): This is the 1st comment T(3): text-in-doc E(4):innerT(1): inner-text C(2): This is the 2nd comment E(3):subT(1):subtext T(4): text-after T(5): text-in-doc2 E(6):inner2A(1):blatE(1):subT(1):subtext T(2):final-text

mismatch-value-text;TEXT_NODE(#text);
 A(1):attC(2): This is the 1st comment T(3): text-in-docE(4):innerT(1): inner-textC(2): This is the 2nd comment E(3):subT(1):subtext T(4): text-after T(5): text-in-doc2E(6):inner2A(1):blatE(1):subT(1):subtext T(2):final-text


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334209 13f79535-47bb-0310-9956-ffa450edef68"
7934c9b26e8cbd3988cbaf3e9cefc744e82786c2,"At least for now, I commented out the m_reportInPostExceptionFromThread stuff altogether.  I'm a little worried that this could cause problems with diagnostics from piped transforms, but hopefully the call to setExceptionThrown to the input handler should cover this.  In any case, the setting of m_reportInPostExceptionFromThread seemed pretty funky to me.
Response to note sent by Nicola Brown <Nicola.Brown@jacobsrimell.com>
01/08/2001 08:36 AM

=====
Get the transformer thread via createTransformerThread.  From email
on this subject:

In response to this I've created the following method in org.apache.xalan.TransformerImpl:

  /**
   * Create a thread for the transform.  This can be overridden by derived
   * implementations to provide their own thread, for thread pooling and the
   * like.
   *
   * @return thread suitable to use for the transformation.
   */
  public Thread createTransformThread()
  {
    return new Thread(this);
  }

Someone who is using XalanJ2 in an EJB environment or the like can set the javax.xml.transform.TransformerFactory system property to provide a derivation from TransformerImpl, and provide a thread suitable for the environment.

I don't know if this will do the trick.  Please advise.

-scott





	""Roytman, Alex"" <roytmana@peacetech.com> 01/07/2001 12:14 AM Please respond to xalan-dev 	   To: ""'xalan-dev@xml.apache.org'"" <xalan-dev@xml.apache.org>  cc: ""'tomcat-user@jakarta.apache.org'"" <tomcat-user@jakarta.apache.org>, (bcc: Scott Boag/CAM/Lotus)  Subject: Xalan2 in server environment (was Xalan2 Stree Module spans sec ond thread to do transform?)



Scott,
Thank you very much for your reply.
One part which is sensitive to thread origin in my opinion is Extensions
In extensions people can do all sorts of things. I am not very experienced
with EJB implementation but I can imagine that many things (transactional
context, bean environment, etc.) depend on threads and some static variables
which helps with setting /switching context for beans being managed by the
server.

Example: in J2EE it is recommended to create JNDI initial context using
default constructor InitialContext(). The result of the instantiation
depends on the context where it was executed and the context is set by the
server for the thread on which your component is running. So if you call new
InitialContext() in your extension (in sql extension to get JDBC DataSource
for example ) it might fail.

Do extension run on the second (created by Xalan) thread?

I will forward your message to Tomcat news group lets see what Tomcat
developers think.

Alex

-----Original Message-----
From: Scott_Boag@lotus.com [mailto:Scott_Boag@lotus.com]
Sent: Saturday, January 06, 2001 11:39 PM
To: xalan-dev@xml.apache.org
Subject: Re: Xalan2 Stree Module spans second thread to do transform?



> In many
> cases component should not attempt to create its own threads.
> For example thread's ContextClassLoader or ThreadLocal variables might
need
> to be initialized by the server.
> Also it defeats thread pooling done by the server etc.
>
> Could you please comment on this issue

Yeah, I've been a bit worried about this.  However, I've not yet heard of
any problems that have been caused by it, and XalanJ1 has long had a two
threaded system (though not as effective as in XalanJ2).   Ultimately, I
would rather use a pull model for this, and only have one thread, but a)
there is no standard ""pull"" API for XML parsers, and b) this doesn't work
anyway when SAX events are used, for whatever reason.

I'm open to any input to how Xalan might request the thread from the
servlet environment, though it has to be able to be run outside a servlet
environment too.  Also, it would be good if someone with deep knowledge of
EJB's and the like could comment.  I talked this over in a hallway
conversation with someone who is fairly familiar with EJB's, and he didn't
think there was a problem, though I forget why.  It seems insane/crazy to
me that a component can't use a thread in it's internal modules.

-scott






                    ""Roytman,

                    Alex""                 To:
""'xalan-dev@xml.apache.org'"" <xalan-dev@xml.apache.org>
                    <roytmana@peac        cc:     (bcc: Scott
Boag/CAM/Lotus)
                    etech.com>            Subject:     Xalan2 Stree Module
spans second thread to do transform?


                    01/06/2001

                    10:48 PM
                    Please respond

                    to xalan-dev









Dear Xalan developers,
I have a question about using upcoming Xalan2 in server env.

In Xalan2 design specs it is said:

""The Stree module implements the default Source Tree for Xalan, that is to
be transformed. It implements read-only DOM2 interfaces, and provides some
information needed for fast transforms, such as document order indexes. It
also attempts to allow a streaming transform by launching the transform on
a
secondary thread as soon as the SAX2 StartDocument event has occurred.""

In server environment server usually controls threads creation. In many
cases component should not attempt to create its own threads.
For example thread's ContextClassLoader or ThreadLocal variables might need
to be initialized by the server.
Also it defeats thread pooling done by the server etc.

Could you please comment on this issue

Thank you very much in advance

Alex Roytman


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334210 13f79535-47bb-0310-9956-ffa450edef68"
209c2eea193d7f9b6c8373b81edf72991448fbfb,"Add constructor that takes a SAXParseException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334211 13f79535-47bb-0310-9956-ffa450edef68"
83569e7d1e195ee06b6952436ad8ce719b8252f9,"Change exception handling to use SAXSourceLocator(SAXParseException spe)
and call the m_errorHandler, in transform(Source source).
Somewhat changed from the patch that David Eisenberg <david@catcode.com>
sent in, 01/09/2001 03:55 PM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334212 13f79535-47bb-0310-9956-ffa450edef68"
405dfa665e830abb14801d96587e69e61b657304,"Move Xalan-J  design documentation to Xalan-J 2 tree.
Scott will update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334213 13f79535-47bb-0310-9956-ffa450edef68"
32fe1704cc9821df962e4fd0a687ead2e75a1565,"Added Xalan design documentation to build and distribution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334214 13f79535-47bb-0310-9956-ffa450edef68"
bf74b4cb0227e189736e518c55a4cbb74b8801fa,"Link to design documentation in design subdir.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334215 13f79535-47bb-0310-9956-ffa450edef68"
8733defa3da19c4891460e2b0c968243577369d1,"Revised to match edits by Rajiv Modani:
1. sample code removed.
2. refs to ""TrAX ""removed from package-level docs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334216 13f79535-47bb-0310-9956-ffa450edef68"
7868ea45e16458a104cec67c74d0b8d35c02a828,"Revised links to javadoc to be local links.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334217 13f79535-47bb-0310-9956-ffa450edef68"
54be95dee709f3f9020994ec48d5204f130224ec,"Call XString.castToNum(s.trim()); instead
of using the numberFormatter, which allocates
an object on every request.
There certainly doesn't seem to me to
be any reason why rtree frags should format
differently than any other object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334218 13f79535-47bb-0310-9956-ffa450edef68"
a3d7a58c6d48e70a36d0e75988b6d7021cb79e1f,"Add way to control the size of the char buffer being created, and
use only 1K for document fragments, which are used for result tree
fragments.  This could effect performance of SAX transforms, which
I think create document fragments also, so I should probably add control
clear down to TransformerImple#transformToRTF.
This is to address the note from thomas.maesing@bgs-ag.de,
""Re: XalanJ2 outstanding issues?"", 01/10/2001 02:57 AM,
where he included a stylesheet with lots of RTFs created in variables.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334219 13f79535-47bb-0310-9956-ffa450edef68"
71c9785b13de74652bc6da03af0e9f35631d940f,"Fix bug reported by ""Krishna Mohan Meduri[Temp]"" <Krishna.Meduri@eng.sun.com>
over private email, 01/10/2001 08:21 PM, titled
""[BUG] in clearParameters() of Transformer"".
In clearParameters, m_userParams wasn't being set to null, which
is now fixed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334220 13f79535-47bb-0310-9956-ffa450edef68"
5dfa2ac03c057bf5413e446853a1bc1763da6206,"Clarify that getParameter will return null if the named parameter has
not been set.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334221 13f79535-47bb-0310-9956-ffa450edef68"
0e05226ee09f612aa85aeec5e6459c5f16ad2018,"Undefined namespace prefix now generates appropriate error.  Formerly, it was mapped to a URI which was the same as the prefix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334222 13f79535-47bb-0310-9956-ffa450edef68"
254958707b40a87eb224ead4e501f534f8c9eaff,"Remove isAvailable field that was being changed at execution time which is not allowed since Stylesheets must be immutable at execution time so they can be shared between threads.
Make the default execute(..) method for ElemFallback do nothing.
Add an execute(..) method to ElemFallback that must be explicity invoked for fallback execution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334223 13f79535-47bb-0310-9956-ffa450edef68"
e98ebfedb38ee1f3c34c48d399d1ade5c59c53bf,"Change execute with four arguments to executeFallback to clean things up.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334224 13f79535-47bb-0310-9956-ffa450edef68"
e9b9706a87a848a73c39aebe7ccfd81015e782ee,"Check for CDATA section node as well as text node for whitespace stripping.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334225 13f79535-47bb-0310-9956-ffa450edef68"
5413974d250a56cc89d34f50c9ce7111c22c46ac,"1. Took sbk protocol out of DOCTYPE system refs, so can transform
docs without going thorugh Stylebook.
2. Preliminary updates for Xalan-J 2.0.D07.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334226 13f79535-47bb-0310-9956-ffa450edef68"
5e872df789df19efc39687d83f667ea8d6626e4d,"In calcTargetString, handle NodeFilter.SHOW_TEXT | NodeFilter.SHOW_CDATA_SECTION
that is now constructed in the XPath compiler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334227 13f79535-47bb-0310-9956-ffa450edef68"
14f7be53446c327eef6d3f8a2281d5f7c4982e34,"Stylesheet for transforming xalan doc collation into Formatting Objects.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334228 13f79535-47bb-0310-9956-ffa450edef68"
f6741a185862b2ff0514673641a721691f77e666,"Used to collate xml documentation into single source for transformation
to fo and pdf.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334229 13f79535-47bb-0310-9956-ffa450edef68"
e012ca3bde9480d80bfa6700f5c6df78c3c95ddc,"In getWhatToShow, in OpCodes.NODETYPE_TEXT, construct
NodeFilter.SHOW_TEXT | NodeFilter.SHOW_CDATA_SECTION instead
of just NodeFilter.SHOW_TEXT.
Addresses bug submitted by Thomas Foerster <y0000981@tu-bs.de>,
01/10/2001 05:59 AM, ""Different behavior between Xalan-C++ and Xalan-J?"".
The bug was not the disable-escaping
mechanism itself, but the fact that the text() pattern was not matching
CDATA section nodes!

Two fixes have been made:
1) the pattern itself has been fixed so that they will work correctly with
input DOMs, and 2) the StreeDOMBuilder has been modified so that
CDATASections aren't created at all... only text nodes.  Since CData
sections are not part of the XPath data model, and append operations in the
StreeDOMBuilder could screw things up anyway, Stree should not be creating
CData section nodes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334230 13f79535-47bb-0310-9956-ffa450edef68"
94d2aa9f8455c52efbeb1040e1a22f802e98d349,"Include target for building print doc. Not yet for distribution.
Also updated xalanonly-styledocs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334231 13f79535-47bb-0310-9956-ffa450edef68"
792e49729d5530ba46c8784a4a57783d12bf56e1,"In processing the characters event, only create TextImpls,
never CDATASectionImpls.

Addresses bug submitted by Thomas Foerster <y0000981@tu-bs.de>,
01/10/2001 05:59 AM, ""Different behavior between Xalan-C++ and Xalan-J?"".
The bug was not the disable-escaping
mechanism itself, but the fact that the text() pattern was not matching
CDATA section nodes!

Two fixes have been made:
1) the pattern itself has been fixed so that they will work correctly with
input DOMs, and 2) the StreeDOMBuilder has been modified so that
CDATASections aren't created at all... only text nodes.  Since CData
sections are not part of the XPath data model, and append operations in the
StreeDOMBuilder could screw things up anyway, Stree should not be creating
CData section nodes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334232 13f79535-47bb-0310-9956-ffa450edef68"
0205bab6ec61f490333a81f483f9d46516faa0ff,"Updated from SPR database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334233 13f79535-47bb-0310-9956-ffa450edef68"
85f00a9f3543311360eb32294289bd99c119e59a,"Fixed variable for resources.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334234 13f79535-47bb-0310-9956-ffa450edef68"
ea124cbd0abd326177a45524bf6b2d026bcdaa0f,"Compatibility classes for xalan1 APIs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334235 13f79535-47bb-0310-9956-ffa450edef68"
3f52b172a6c8a829eed780240b997ca1ac37d628,"Make this public for Compatibility classes for xalan1 APIs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334236 13f79535-47bb-0310-9956-ffa450edef68"
74ddfe2f4b29e67f67b57c807f2c2fadaf3108d8,"Make this public for Compatibility classes for xalan1 APIs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334237 13f79535-47bb-0310-9956-ffa450edef68"
73d05507e04c447cdfcc45d14df7bdb15d1ded24,"Added compat.jar and compat.apidocs targets and added compatability
jar and javadoc to the autodist target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334238 13f79535-47bb-0310-9956-ffa450edef68"
621f3efaf395a6686835d83e87366dfb1e892fe9,"fix constructors


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334239 13f79535-47bb-0310-9956-ffa450edef68"
fab786fcbc81a2eba7d9da8e6fea0e4927b8c369,"Corrected typo!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334240 13f79535-47bb-0310-9956-ffa450edef68"
a56b39da2c0e0bfd89b29703b4979f8b4d4076b4,"package.html for each of the TrAX packages is generated during
the build from trax.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334241 13f79535-47bb-0310-9956-ffa450edef68"
6a0191e25d8765210f6874c7a04fba0032cfbcd3,"Top-level and package-level doc for compatability jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334242 13f79535-47bb-0310-9956-ffa450edef68"
f1b0dd9b44e36ee39bc9221671ab009ffbab032a,"Added overview doc to javadoc build for compatability API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334243 13f79535-47bb-0310-9956-ffa450edef68"
3777142d1695b8b285d7f22b52710bed2f78109c,"Updates for 2.0.D07


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334244 13f79535-47bb-0310-9956-ffa450edef68"
fb66ecc7c616815764742880c006ccf099d22ec9,"Compatibility classes for xalan1 APIs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334245 13f79535-47bb-0310-9956-ffa450edef68"
fe1153a22d863cfaf3dead1c257b597920b100c9,"Updates for 2.0.D07


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334246 13f79535-47bb-0310-9956-ffa450edef68"
8ee6aa0873f8f2efd6f3f66c6d852a689f3293f2,"Just do a normal throw from extFunction if callFunction throws an
exception.  This will be caught by XPath and passed to the
error listener, with the SourceLocator set.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334247 13f79535-47bb-0310-9956-ffa450edef68"
1419e2a7e5507bca48726a44900c076d0bc470d9,"Modified the error handling code when an exception is thrown from
the extension mechanism.  Now, if the message contains the word
""fatal"" or contains no message, the error listener's error method witll
be called, otherwise the error listener's warning method will be called.
Also, make sure the source locator is set in the TransformerException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334248 13f79535-47bb-0310-9956-ffa450edef68"
de2f5ffa17f06d82a1e6502ba075aef0d72ce444,"Add @serial tag to m_isDot.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334249 13f79535-47bb-0310-9956-ffa450edef68"
e545beb322f6ca82d824724d7ab56ed602fc805d,"Make public so javadoc can be accessed from the design document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334250 13f79535-47bb-0310-9956-ffa450edef68"
3d737f8d0f82d1f497c267303298d9d8aeefd275,"Modify error handling code in execute method so that exception is
caught and sent to the error listener.  There is some danger that
duplicate exceptions could be sent, but that is preferable an exception
not being passed to the error listener at all.  Also, make sure the
SourceLocator is set.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334251 13f79535-47bb-0310-9956-ffa450edef68"
ff84a0c166130ab2647a712c20d4ca315c75c40a,"Make the class not serializable.  This class should never be serialized,
and any non-transient references should be considered in error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334252 13f79535-47bb-0310-9956-ffa450edef68"
381cc5def2715d9a75069a7579b9f78bbc6a0194,"Update of design doc to match reality.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334253 13f79535-47bb-0310-9956-ffa450edef68"
d35ecd6fabb9bdd583d51d79f2ac6b32091c5de2,"Moved my remaining architecture doc task to completed, moved
Gary P's items to next release.
No known actions pending for 2.0.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334254 13f79535-47bb-0310-9956-ffa450edef68"
e4977d59584f6f4612607b204a4b2582cc909e1c,"Added some more things that were done.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334255 13f79535-47bb-0310-9956-ffa450edef68"
ccf3e9270db01deff4d6b0a5ca23553e8fc04194,"Moved stuff leftover in the production release section to the next release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334256 13f79535-47bb-0310-9956-ffa450edef68"
8020de31115edf42d7e9e28b7b1b35f1fb3dbd1f,"Added correction to ""site"" target for new compatibilty javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334257 13f79535-47bb-0310-9956-ffa450edef68"
061cdd4498056298d3716f6a2a5b24546140fa04,"Updates for 2.0.D07


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334258 13f79535-47bb-0310-9956-ffa450edef68"
7de9a50e83e8f065355fe5caa331ca72cf96a395,"Updates for 2.0.D07


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334259 13f79535-47bb-0310-9956-ffa450edef68"
6ad648ea0527b47ff13c0c794d22348b9ec4e07b,"Added some doc for new targets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334260 13f79535-47bb-0310-9956-ffa450edef68"
94409b2bf768cb45ea50d9aab3c71526c0761acf,"For consistency, changed built.xalan.jar to build.xalan.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334261 13f79535-47bb-0310-9956-ffa450edef68"
41702b692ad84ddac764de94c10476a31bc617fa,"More info on which Xalan-J1 samples are supported by compatibility layer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334262 13f79535-47bb-0310-9956-ffa450edef68"
fd7c07097c699a6774f35d09abbd066056345c45,"More info on which Xalan-J1 samples are supported by compatibility layer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334263 13f79535-47bb-0310-9956-ffa450edef68"
8cdf538cb36c8f303a1c144f719c10d3e31a9955,"The isTopLevel state was not being set in LocPathIterators when they
were in a union.  This caused the variable stack evaluation to be
incorrect, and thus you could get bogus unresolved variable
errors when executing a location path in a union that had a variable
reference.

Bug fix in response to report by Guoliang Cao <cao@ispsoft.com>
titled ""Can I use recursive template with parameters? files are attached.""
on 01/10/2001 06:29 PM.  Actual test case sent via private email
01/12/2001 02:55 AM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334264 13f79535-47bb-0310-9956-ffa450edef68"
a9999e512c3cd0f5508de7b8d973e96ee414bd2e,"Fixed typo in dist target for xalanj1compat.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334265 13f79535-47bb-0310-9956-ffa450edef68"
4cf0687fcc1de9ac00ceed4976a58ad5483aabaf,"Fixed syntax for executing 6-sqllib-instantdb


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334266 13f79535-47bb-0310-9956-ffa450edef68"
2c63e6e48bc06d62b31338d84ec807cf21d9cc3b,"Added bug fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334267 13f79535-47bb-0310-9956-ffa450edef68"
1e5ec26afbded32ce72a01f74bccefaeab902ce0,"Compatibility classes for xalan1 APIs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334268 13f79535-47bb-0310-9956-ffa450edef68"
a1e6217d033451157b6c46efa4365cef28e90a51,"Added target for building xalan-j1 samples with compatibility jar
and xalan=j2 xalan.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334269 13f79535-47bb-0310-9956-ffa450edef68"
66527087ecae6d6da505261aedf4b05f543f2236,"Don't send old cdata events to the DOM builder!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334270 13f79535-47bb-0310-9956-ffa450edef68"
6287b834212464d5cef0b7764b1b3ffbf8bdf695,"Compatibility classes for xalan1 APIs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334272 13f79535-47bb-0310-9956-ffa450edef68"
9db85c089ed1df27137e987912107e3f0ca52b34,"Turned resourceFile into stylesheet parameter.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334273 13f79535-47bb-0310-9956-ffa450edef68"
74d5b3bcf7da7d39307b3d151c2c88e771f46193,"Compatibility classes for xalan1 APIs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334274 13f79535-47bb-0310-9956-ffa450edef68"
633aa81079ddbab531d16388f8f40e2b11948c7b,"Minor changes to print.docs target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334275 13f79535-47bb-0310-9956-ffa450edef68"
9ac53930b68c3669280d8bdb245a816c676ca1a5,"Preominary update for production release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334276 13f79535-47bb-0310-9956-ffa450edef68"
064a47e5575818a0a133170c3e0463692925cc4c,"Added stylesheet param for title and page headers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334277 13f79535-47bb-0310-9956-ffa450edef68"
20c45302045da210c2082d6da0b5e8976ff7ec87,"Compatibility classes for xalan1 APIs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334278 13f79535-47bb-0310-9956-ffa450edef68"
c0a6e9505f84be6c8e1fbb98ee64d25780f1d5a9,"editorial update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334279 13f79535-47bb-0310-9956-ffa450edef68"
c0d2a1c91b3c84f731be43491e5e153c10779328,"Edits to the Ant section.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334280 13f79535-47bb-0310-9956-ffa450edef68"
c49ae884237cdfbab605cd0bb5b24b2508f34349,"Javadoc cleanup -- down from 75 javadoc warnings to 3
(haven't yet figured out exactly what the remaining 3 warmings mean).
Removed many refs to API that is no longer there., so if we
expand this API, should add refs back.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334281 13f79535-47bb-0310-9956-ffa450edef68"
475acac1b0ffe5ca1eb58ab5cb0228fc08ee9dbd,"Updated version number and compat targets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334282 13f79535-47bb-0310-9956-ffa450edef68"
38577da371121ef7957cabb48f1ba4a85b55b4df,"General cleanup.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334283 13f79535-47bb-0310-9956-ffa450edef68"
06152ffce8e066c50e8965e9d8787f593fbe5c84,"Changed the default method to be ""html"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334284 13f79535-47bb-0310-9956-ffa450edef68"
a7945b7d6b26bb5d5049193dcefd1a2cfba4f1b1,"Remove local re-definition of m_stylesheetRoot!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334285 13f79535-47bb-0310-9956-ffa450edef68"
39010042322e29c4fab876e0b64ccb653ab8f380,"Change throws ... FileNotFoundException to IOException to compile under JDK 1.1.8;
Change stylesheet name to 1-redir.xsl so it will work


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334286 13f79535-47bb-0310-9956-ffa450edef68"
886b6c6f4940f75c1753202aa9255fb7c590d4c5,"Fix problemListener interface and displayDuration()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334287 13f79535-47bb-0310-9956-ffa450edef68"
8d3f30d7bf030ee696d7eaf8207d08892cfc3160,"Fix problem with an href value with parameters to be passed to a servlet (ie foobar?id=16). Make sure the href value is not clipped at the ""="".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334288 13f79535-47bb-0310-9956-ffa450edef68"
79be6e2d5f2f361348809b6d49c2f0ceafb242df,"Run the redirect sample from the command-line.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334289 13f79535-47bb-0310-9956-ffa450edef68"
fd2b6e499e25eebb9d26420bad994be3950f4700,"Don't push a stylesheetRoot in the case of a DOM


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334290 13f79535-47bb-0310-9956-ffa450edef68"
45fb14fc912fcb0df56cc16325a3557cd71a2925,"Derive all classes from XObject


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334291 13f79535-47bb-0310-9956-ffa450edef68"
ea5ee9f9715e2fb54aed9314144d16dac0e8e6e5,"Used by XObjects


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334292 13f79535-47bb-0310-9956-ffa450edef68"
63995a33c6d5d46228f502954b0f74c83e33a86e,"Version 2.0.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334293 13f79535-47bb-0310-9956-ffa450edef68"
f5521d78f16ea5903fb18c010f98892b18526dc9,"Added FAQs
Other updates for version 2.0.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334294 13f79535-47bb-0310-9956-ffa450edef68"
9e0ec094033ac532a2f5523af4adda813bfda623,"updates for version 2.0.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334295 13f79535-47bb-0310-9956-ffa450edef68"
010bb5910890915504f4519ef309db3c17ed89da,"Added FAQs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334296 13f79535-47bb-0310-9956-ffa450edef68"
a0b277dd106d10c506693d7ec72b4ed85a7792c9,"Use seperate XPathContext from the main transform to do
whitespace node matches (i.e. xsl:strip-space), which solves threading
problems, which esp. show up in a dual processor system.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334297 13f79535-47bb-0310-9956-ffa450edef68"
2ca2c82467dc53b4f7b2479abd1675fce6fbd3c3,"In the FilterExprWalker, don't set the variable stack position if
the walker is not owned by a top-level node iterator.  This solves
a bug when running Norm Walsh's docbook stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334298 13f79535-47bb-0310-9956-ffa450edef68"
961c6a4837734d66ba2d1e13930345bd56e333d6,"Change unknown XPath error to be a fatal error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334299 13f79535-47bb-0310-9956-ffa450edef68"
35017af9c12f9fc11bd7e645d62471b5e432469c,"Enchanced support for FAQs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334300 13f79535-47bb-0310-9956-ffa450edef68"
a3b166281d5461d17f6407ca16d4efeee79a7d39,"Added FAQs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334301 13f79535-47bb-0310-9956-ffa450edef68"
871e61141ce06f3f3ebfa555734e983f81c6db12,"handle stylesheet parameters when they are expressions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334302 13f79535-47bb-0310-9956-ffa450edef68"
e01980c20b150ed33ded7f8df9c4b57d094d2fbe,"Spell checking updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334303 13f79535-47bb-0310-9956-ffa450edef68"
843db6727bec4d893a098866e0a1e77ea38bda3a,"Need to check if there are more tokens before advancing to the next


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334304 13f79535-47bb-0310-9956-ffa450edef68"
2d71df75d6cfe97b784db08f71e58287777d0d5a,"Try and avoid multiple resets on exit.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334305 13f79535-47bb-0310-9956-ffa450edef68"
9643155cda623f901d999f58bb66ade706920966,"Preliminary ""done"" list for 2.0.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334306 13f79535-47bb-0310-9956-ffa450edef68"
1249558ddcbe1f0c1b4298999d7d87af0f2ac6b3,"New extract from SPR database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334307 13f79535-47bb-0310-9956-ffa450edef68"
3a1cdc83a96dec95c69800db033a5048dbbc3705,"The error method now throws an exception, instead of just printing
a message and trying to continue.  The continue behavior proved
to be too confusing, and the lack of stack dumps a significant problem.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334308 13f79535-47bb-0310-9956-ffa450edef68"
aa18d1c00af53322c40f0ab50e6c0a19704eb821,"Add support for type=""text/xml"" and type=""application/xml+xslt"" if PI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334309 13f79535-47bb-0310-9956-ffa450edef68"
96eebc644a35d108f6ae24661a18cbe38107296a,"Propagate the error message to super().
( as pointed by Rajiv )


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334310 13f79535-47bb-0310-9956-ffa450edef68"
5cc47525ca4e88c6ab56b0c73ac95970a7cec0fe,"Bug fix: the spec requires that if an ErrorListener is set on the
TransformerFactory, it should receive notification of the errors,
instead of throwing the exceptions.

Since all exceptions in creating the transformer prevent further operation,
fatalError() callback is used.

The code is a bit complex - various exceptions are wrapped into
TransformerException ( required by ErrorListener signature ) and the
exception propagated by ErrorListener are re-wrapped in what the original
method expects.
( an ErrorListener could either re-throw the original exception or do something
else )

( this fix should solve the common case of an exception during Transformer
creation. In future we may want to pass the ErrorListener and send
warning notifications, etc - that would require too much change at this
stage and it's not required by the spec. )


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334311 13f79535-47bb-0310-9956-ffa450edef68"
336cb783245aac5deac5985ea8d529eaa56e8faa,"fixes for problem listener for compatibility


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334312 13f79535-47bb-0310-9956-ffa450edef68"
a42d0d25ffccac373bdcfa68ae47cbf8db62696f,"Removed unused stylesheet parameter declaration.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334313 13f79535-47bb-0310-9956-ffa450edef68"
8bbfeace13cc1acafc478da6381f8c422cb3478f,"Javadoc updates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334314 13f79535-47bb-0310-9956-ffa450edef68"
545963311d692a00e5ded556a23598c34d929899,"New extract from SPR database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334315 13f79535-47bb-0310-9956-ffa450edef68"
ef8d77f9c4b9fce904394fddb60103fddec4de70,"Revised spacing of items in the bug list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334316 13f79535-47bb-0310-9956-ffa450edef68"
f756ba764be5a217612165bbd105178ab34aaa6e,"Added Xalan-J1 compatibility bug fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334317 13f79535-47bb-0310-9956-ffa450edef68"
03cb76849701ffa9e3835feb18032b93866c22bd,"Incorporated review comment from Myriam.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334318 13f79535-47bb-0310-9956-ffa450edef68"
96691eb15db9bd889bbf7d19391d454bdb5b8c88,"Lieft (start) justify s2, and body elements (para, note,list).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334319 13f79535-47bb-0310-9956-ffa450edef68"
4fc8e4fc4ef6d89bbf33182cb51a5b5ab352fab5,"Added 2 Costin bug fixes to list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334320 13f79535-47bb-0310-9956-ffa450edef68"
3cf767a4c7eb5e889f0f13d776e4a36b13474ea4,"Rearranged layout and added entry for Bugs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334321 13f79535-47bb-0310-9956-ffa450edef68"
2e893944a40f8cae23e3fc2e626192fd6dd487f8,"Moved instructions for reporting bugs above the bug list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334322 13f79535-47bb-0310-9956-ffa450edef68"
5483d6a2fa55645b1dbe4d64bff952ed568bad87,"Fix problem with null namespace being passed from xsl:element, which
manifests itself when running the latest DOCBOOK stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334323 13f79535-47bb-0310-9956-ffa450edef68"
1b2e5e6e8a573fa2ca7dd36f8a880c985e388c08,"Added faq from Dave Marston on retrieving nodes from default namespaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334324 13f79535-47bb-0310-9956-ffa450edef68"
d75032ddb962a61561a248c2b823e9f90b61c622,"In resolvePrefixTables, add defensive code against a null URI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334325 13f79535-47bb-0310-9956-ffa450edef68"
ee1e1fdab6e45a0442596a279efb323b1b72687d,"Clarified Scott's latest bug fix and added some missing <br/>s.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334326 13f79535-47bb-0310-9956-ffa450edef68"
4277cd19ef95ac40c517302a243972d941aaacdf,"Added Myriam's bug fix for identify transformation of XML document
containing a DOCTYPE declaration.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334327 13f79535-47bb-0310-9956-ffa450edef68"
27c50466593ca121acb18cf3946c616102477542,"Another bug fix: ElemTemplateElement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334328 13f79535-47bb-0310-9956-ffa450edef68"
bc5202bdb8e29a823282d4741c4b629707963c14,"Fix problem with DTD and Identity transformations. Handle the startDTD event and system and public doctype.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334329 13f79535-47bb-0310-9956-ffa450edef68"
1cdc6917c31cc0ba37e39da09dcb683b8c30049f,"When passing an exception as an argument to a constructor, use
that argument's message instead of generic message.  This makes
a major difference with simple error reporting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334330 13f79535-47bb-0310-9956-ffa450edef68"
06df089eccb19f10746c4a044b7f818ea414bdb9,"Make sure there is a default problem listener


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334331 13f79535-47bb-0310-9956-ffa450edef68"
bce3b140ef6b3f953f7b0fc4fa1b83905e0467c6,"Make sure there is a default problem listener


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334332 13f79535-47bb-0310-9956-ffa450edef68"
4e266c5fbbec01954df8944435be2c5243ec4e1b,"Another bug fix: TransformerException


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334333 13f79535-47bb-0310-9956-ffa450edef68"
e4d496ac6f2928fa31f892f2f07e23473b1936fa,"Make sure we use the existing stylesheet if there is one


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334334 13f79535-47bb-0310-9956-ffa450edef68"
dd1ca7b6c48d31c127891092b9ec482480703590,"Reset flag indicating we need to evaluate stylesheet params


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334335 13f79535-47bb-0310-9956-ffa450edef68"
9b12ce5782db9eb08109d7226623d91e03239da1,"New extract from SPR DB.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334336 13f79535-47bb-0310-9956-ffa450edef68"
513de7ba9598bf2484d8772415dbb6b6bd163fff,"Added Myriam's xlanj1compat processs() method bug fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334337 13f79535-47bb-0310-9956-ffa450edef68"
32bc73f6793943a7199346a5da21363d1aabc8a9,"Reset m_stylesheetparams during a reset. Bottleneck all parameter setting in setParameter()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334338 13f79535-47bb-0310-9956-ffa450edef68"
f9019f082a248f781d270e2ca579eb3f3b80953a,"Make sure the same parameter is not added twice.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334339 13f79535-47bb-0310-9956-ffa450edef68"
48bba5be41f2ef90fccb37a9e11b7e1cb7c740e3,"* Message manager modified so that the SourceLocator must always be passed in,
which will make a major difference in getting line number information.

* xsl:element's handling of namespace attribute and prefix in
name attirbute changed so that it no longer manufactures prefixes...
it always tries it's best to match the prefix entered.

* Nasty bug fixed with namespace contexts in the stylesheet processor.
The bug could cause <a xmlns:a=""x""><b> to produce <a xmlns:a=""x""><b xmlns:a=""x"">.

* xsl:message now sends the message to the consol, and also
throws an exception with the message ""Stylesheet directed termination"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334340 13f79535-47bb-0310-9956-ffa450edef68"
5cfc370a21cdd86a1b969dfb221dd3a2a3aa92f4,"Minor tweaks for xsl:message... line numbers are now output with each
message, since the primary purpose for xsl:message is as a debugging
aid, and having the line numbers help a fair amount.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334341 13f79535-47bb-0310-9956-ffa450edef68"
88687951d9ce1a98a942ed6ba20014e346bf543f,"Check that the cause != null when checking for a contained exception.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334342 13f79535-47bb-0310-9956-ffa450edef68"
e12e9eba41d5818cd2e96b758e784c35d03fed69,"Update to make compile on JDK 1.1.x; needs SBoag code review


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334343 13f79535-47bb-0310-9956-ffa450edef68"
84f70e2c8185752c40208c4d1113c24c2531d813,"Changed tag identifying SPRs from ""Name"" to ""SPR#""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334344 13f79535-47bb-0310-9956-ffa450edef68"
5c84a3b9476f5466cdd7731875f81b66ed6f42aa,"Added new bug fixes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334345 13f79535-47bb-0310-9956-ffa450edef68"
651819eaff3bc2754cd7816f2b7691d084563233,"New extract from SPR DB.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334346 13f79535-47bb-0310-9956-ffa450edef68"
65d0bbddc4e6d67cb86a484ab8036aaaa813f627,"Added index and link to Xalan-J1 compatibility Javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334347 13f79535-47bb-0310-9956-ffa450edef68"
25efd1a7b00c913439f48bee2d47e53c2df847e4,"BSF 2.2 release candidate


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334348 13f79535-47bb-0310-9956-ffa450edef68"
e313be6868ff93578fc54c794e81a3e65e741a04,"Added missing period (.).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334349 13f79535-47bb-0310-9956-ffa450edef68"
63e8be172d51b2377fd72ae99a007b09cb918f20,"Info on BSF and modified link (to developerWorks, not alphaWorks).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334350 13f79535-47bb-0310-9956-ffa450edef68"
4887126a8cc0acfdb1b0321c37803cd20faced18,"Allow problem listener to specify whether or not to throw an exception


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334351 13f79535-47bb-0310-9956-ffa450edef68"
6f601d4a87ddb532d766290cfe6416fe2e687584,"Fixed problem with non-namespaced attributes not being properly
validated.  Also fixed test whitespace20, which I guess worked
before??  It copies xml:space attributes to the result, and these
were being lost.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334352 13f79535-47bb-0310-9956-ffa450edef68"
800438339b18efab2646001fdde2914536d02161,"Throw an exception if result is null


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334353 13f79535-47bb-0310-9956-ffa450edef68"
d7336580de3830f5c4d57baef9a016b73378f448,"Fixed problem with non-namespaced elements being allowed as
children of the stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334354 13f79535-47bb-0310-9956-ffa450edef68"
c83243c4cb972245b4a9ebf7e7e9bbb859782364,"Added a bug fix and a note about the negative test bugs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334355 13f79535-47bb-0310-9956-ffa450edef68"
ab3afa447adb5db8e250ded26994a45211c2db71,"Use correct stylesheet during process


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334356 13f79535-47bb-0310-9956-ffa450edef68"
cde2dfc98127d3d0a9f5d165fa8067c8efed6746,"Fix the fix for ErrorListener. The spec is not clear about what
should happen if an ErrorListener is set, and fatalError is called -
it does mention that ""ErrorListener callbacks should be called _instead_
of throwing exception"" ( in ErrorListener's comments ), but what happens
when fatalError returns ?

The current code returns null ( since creating the object - Transformer,
etc - failed, and we can't throw exceptions ).

This fix does some extra checks for NPE, in this case. It shouldn't be
a big performance problem, constructing the transformer is a
very expensive operation any way.

Scott - please review the changes, maybe you have a better idea to deal
with ErrorListener.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334357 13f79535-47bb-0310-9956-ffa450edef68"
d0ee3a89892f6772820990eda0f6112672e18d54,"New extract from SPR DB.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334358 13f79535-47bb-0310-9956-ffa450edef68"
0bb39f0a2cd2aa0a4e125347ed5bd68b1b5f96ae,"Fixed 3 bad internal links found in print.docs target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334359 13f79535-47bb-0310-9956-ffa450edef68"
367d509c0ebc48a22c64a8dc1eb325afdb423dd8,"Corection per Scott.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334360 13f79535-47bb-0310-9956-ffa450edef68"
3a2adc1c1bc65301582dface5d4daaab5553f1c9,"Problem workaround for Crimson which doesn't put the XML Namespace
namespace on xmlns attributes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334361 13f79535-47bb-0310-9956-ffa450edef68"
500ee4ee0274d036422512b07446d3e098c56245,"Fix checking of number of arguments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334362 13f79535-47bb-0310-9956-ffa450edef68"
052d4d064c2e4b13206dce0b521bc7a42e1d58b0,"Fix problem with template mutation during runtime.  The resolution of the
template is now done in the compose() method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334363 13f79535-47bb-0310-9956-ffa450edef68"
28c7ba97736d98d197011baa5d5ea52fde977750,"Fixed some minor threading issues.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334364 13f79535-47bb-0310-9956-ffa450edef68"
c30519159cf76944d40d1bc74bc027a615e7634b,"Main change is introduction of m_reentryGuard, which
is used to synchronize on TrAX API functions which can mutate,
to guard against mutation during a transformation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334365 13f79535-47bb-0310-9956-ffa450edef68"
ea75c20dcca0e23a3fad7ed6db43e94369c4ac43,"Added construction that takes the name of a class instead of a
class, which the JProbe Threadalizer seems to like better, for
some reason.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334366 13f79535-47bb-0310-9956-ffa450edef68"
612a9aae390d7f574183fbd39d2e25bdb2bc18a1,"Fixed bug reported by ""Jarno Elovirta"" <jarno@codeonline.com>
01/29/2001 02:36 AM about substring throwing an error if the start index
is larger than the string:

Error when attempting to evaluate

  <xsl:value-of select=""substring($some-string,string-length($some-string) +
$x)"" />

where $x >= 2, Xalan2-J (checked out on Mon Jan 29 09:29:43 GMT+02:00 2001)
throws an error ($x = 2)

  XSLT Error (javax.xml.transform.TransformerException): String index out of
range: -1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334367 13f79535-47bb-0310-9956-ffa450edef68"
ce1925cbe1d1174af7be5f168811e17d26e5c040,"Provide toString method that returns the value of m_str.  In response
to potential problem reported by Ito Kazumitsu <ito.kazumitsu@hitachi-cable.co.jp>,
01/28/2001 11:59 PM:

I am afraid that the equals method defined in
org/apache/xalan/xpath/xml/StringKey.java
(Xalan-Java version 1.2.2) is not symmetric.

String s = ""aaaa"";
StringKey k = new StringKey(s);

In this case, k.equals(s) is true, but s.equals(k) is
false because k is not a String.  This is a violation of
the symmetry expected of equivalence relations.

If the use of this equals method is closed within Xalan,
I do not care.  But it may be used in java.util.Hashtable.
Although it seems Xalan's StringKey works fine with
JDK's Hashtable now,  it may be only by chance and not
necessarily so.

In fact,  Xalan-Java cannot work with Kaffe Java VM because
of the unsymmetric behaviour of equals of StringKey.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334368 13f79535-47bb-0310-9956-ffa450edef68"
5b2bf0d7892606d69161c7bba2db81a90a7bff6a,"In response to note by Ito Kazumitsu <ito.kazumitsu@hitachi-cable.co.jp>,
01/28/2001 07:42 PM, added EUC_XX java encodings:

I suggest that the Java encoding name ""EUCJIS"" that appears in
org/apache/xalan/xpath/xml/FormatterToXML.java
(Xalan-Java version 1.2.2) should be changed to ""EUC_JP"".

http://java.sun.com/j2se/1.3/docs/guide/intl/encoding.doc.html
does not have ""EUCJIS"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334369 13f79535-47bb-0310-9956-ffa450edef68"
155e5874a26a4fbd313abd802ad0818684f3b55a,"When Xalan creates a FileOutputStream, close the stream before exit.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334370 13f79535-47bb-0310-9956-ffa450edef68"
b0b876fa30f1a33211b1a5e0c98d839907c1cc22,"More bug fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334371 13f79535-47bb-0310-9956-ffa450edef68"
b783c219ce31fe5d522c4b481448c1bdb231c538,"New extract from SPR DB.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334372 13f79535-47bb-0310-9956-ffa450edef68"
3eab336ee96f9e363f99783460f8adb941307784,"Another bug fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334373 13f79535-47bb-0310-9956-ffa450edef68"
99d905f8a08689f7458e7c313bd57f48c2cf4289,"New extract from SPR DB.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334374 13f79535-47bb-0310-9956-ffa450edef68"
99e8d338fb4f647e6a0b9df0eb469bd9ce7460fe,"Edits per Dave Marston.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334375 13f79535-47bb-0310-9956-ffa450edef68"
15de9247fd472599eec88921c130dd0d73fe6c90,"Fixed spelling error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334376 13f79535-47bb-0310-9956-ffa450edef68"
cbfd35f4a8d0200a0bb757585fbf23694d471b38,"Page breaks before each s1 or faqs section


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334377 13f79535-47bb-0310-9956-ffa450edef68"
4d5e9352bf58d5dc85b2700f6bcb0b793c3cb63a,"Fixed placement of page breaks and added page numbers to TOC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334378 13f79535-47bb-0310-9956-ffa450edef68"
7b328fa61d50e5aa9268a9a1a331e4ee24e2b55e,"Fixed placement of page breaks and added page numbers to TOC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334379 13f79535-47bb-0310-9956-ffa450edef68"
bb59ae9461feece0479e35148b4d93e8af673641,"Fix handling of NCNames that begin with ""_"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334380 13f79535-47bb-0310-9956-ffa450edef68"
782088c17ddcb654d1ccc394dc8cead8970a35ff,"Add locator to error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334381 13f79535-47bb-0310-9956-ffa450edef68"
f352c4a05cd8eb407518154d6ea7cdd1dd7828b0,"Work-around for Crimson problem with setAttributeNS.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334382 13f79535-47bb-0310-9956-ffa450edef68"
bfc9f3fb90c8b9d148863eacddb7bec65fbf68ee,"Minor fixes for an exception throw from the DOM helper.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334383 13f79535-47bb-0310-9956-ffa450edef68"
1d7d1ea1bc9ffc0a34bb8d522d2dc3822b99ae65,"Can't handle fo:leader yet in TOC


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334384 13f79535-47bb-0310-9956-ffa450edef68"
3dc9bb9a58a521f39cd2b5ee9f2dc7898d7af0ce,"Aother bug fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334385 13f79535-47bb-0310-9956-ffa450edef68"
235812d10e68773156a2bde1bc93b1dce2c73414,"Make serializable, in response to exception reported by Dimitry.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334386 13f79535-47bb-0310-9956-ffa450edef68"
1b326eb6c5a0e2a78abd7ab8aa365a5b14114756,"Aother bug fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334387 13f79535-47bb-0310-9956-ffa450edef68"
0121c08ba9e6f3f6b46eda059d4f7a5b8bd6b00f,"Removed work-arounds for Crimson, as they fixed the problem in the crimson jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334388 13f79535-47bb-0310-9956-ffa450edef68"
607c3301202d0abdab839f80782339bb643e4905,"Small fix for applet support - catch SecurityExceptions for getProperty.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334389 13f79535-47bb-0310-9956-ffa450edef68"
06303746da78b470ac79618008a635a618e67d1b,"Small fix for applet support - getProperty needs to ignore
SecurityExceptions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334390 13f79535-47bb-0310-9956-ffa450edef68"
2276997f3df7ebfac2dfd3ded8dce740e7c73b8b,"Added Costin's applet related bug fix to the list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334391 13f79535-47bb-0310-9956-ffa450edef68"
c8c0c6e45993248596e2a97620770f3716479065,"Explicit list of packages for compat.apidocs. For some reason,
other J1 packages were being included.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334392 13f79535-47bb-0310-9956-ffa450edef68"
f828c064b46704f8a65689dfd35bffad3138d2d1,"Do setCoalescing(true) for d2d flavor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334393 13f79535-47bb-0310-9956-ffa450edef68"
f72408fba8c6e404f769f2bd114b6eb99e040ac0,"Added note about setCoalescing().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334394 13f79535-47bb-0310-9956-ffa450edef68"
581d0fc149fc465293333f4c7a685c275dc7fda0,"Added License.
Corrections to dist target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334395 13f79535-47bb-0310-9956-ffa450edef68"
f68dc21257595432ea6923c9f99f728eff784275,"Purged sourcepath for compat.javadocs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334396 13f79535-47bb-0310-9956-ffa450edef68"
94e415d318bdfd1abc55ef91784fe005555da3ca,"BSF 2.2 release


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334397 13f79535-47bb-0310-9956-ffa450edef68"
a661f391ba4ec58774b92c2f53818dab97654160,"Fix bug reported by Krishna 01/30/2001 09:47 PM.
The bug is that values that were set by the
stylesheet were not overridden by the properties,
because a confusing function was called that is
also used for internal processing, which does
not override properties that are already
set (the function is used to process higher
precidence properties first, then lower precidence,
for various reasons).  The fix is fairly
straight-forward, the call that copies in the
stylesheet properties has to be done after the
copy from the caller's properties, instead of
before.

Also contains a minor change to executeChildren to
allow for the supression of xsl:attribute from xsl:element
when an element production needs to be ignored.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334398 13f79535-47bb-0310-9956-ffa450edef68"
850d049a45b832fddabeed5289a784c28bbabffd,"Fix regression for error recovery for ignoring of elements where the
prefix can not be resolved, or the name is bad.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334399 13f79535-47bb-0310-9956-ffa450edef68"
28091ea95df2487bce4b7edaa93023b70609a67f,"Avoid error flagging if the qualified name contains prefix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334400 13f79535-47bb-0310-9956-ffa450edef68"
4b09ca72626a7bb2b68631004acddaff5495dc7e,"Added comment about order of copyFrom in setOutputProperties.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334401 13f79535-47bb-0310-9956-ffa450edef68"
5aa3443d3064463d8da82c5bc74aff200c7aa3af,"Minor tweak for error message.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334402 13f79535-47bb-0310-9956-ffa450edef68"
f076b98700c7688f2cd41f7c635941ecf08ac47b,"Added link to Credits (in ""todo"" list""), in place of a separate CREDITS text file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334403 13f79535-47bb-0310-9956-ffa450edef68"
e4c77b7c4be3cc4f04819d405ad282447619351e,"Added 2 late-breaking bug fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334404 13f79535-47bb-0310-9956-ffa450edef68"
8d974f9e8e9ae9982b633932b639fb99a00a2a3b,"Added AbstractMethodError handling for when JAXP does not work, in addition
to NoSuchMethodError handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334405 13f79535-47bb-0310-9956-ffa450edef68"
a7f4308c628e4b0e7c7462848b712ea3947ab583,"Add 'jar' to depends of docs and dist targets; required to build cleanly/automatically


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334406 13f79535-47bb-0310-9956-ffa450edef68"
e34912ed7a09b68fbbbf934afbac49f9a64d5caf,"The m_lastFetched value needs to be set before the call to
acceptNode (i.e. the predicate), otherwise the cloned itterator
will not work correctly.  In response to bug report by
""Timm, Sean"" <STimm@mailgo.com> 01/31/2001 01:48 PM.
The bug caused //item[last()] to fail.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334407 13f79535-47bb-0310-9956-ffa450edef68"
9ea52a0ccca6d9e963781ecec3f50b45887082f7,"Fix null pointer exception that could occur with getValue(""xxx"").


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334408 13f79535-47bb-0310-9956-ffa450edef68"
caee2bea67bd40f1ffe6851cf928d59f50224e89,"Implement proper xml:space handling, as per bug reported by
""Timm, Sean"" <STimm@mailgo.com> 01/31/2001 02:02 PM
A stack of whitespace preserving state is now maintained in StylesheetHandler
and queried in ProcessorCharacters.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334409 13f79535-47bb-0310-9956-ffa450edef68"
14939ea3d7a2cfdccab18cfbb3bce872937e5dab,"Added note on trax sample.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334410 13f79535-47bb-0310-9956-ffa450edef68"
844d6e32e2a92e80475c1054f0919f5ca60cd2c5,"Added note on trax sample.
Added to list of bug fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334411 13f79535-47bb-0310-9956-ffa450edef68"
3380772d66487b6fd1b1047725638bc96a9c7e30,"Update from SPR database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334412 13f79535-47bb-0310-9956-ffa450edef68"
36300859275c0d376ad15d2b6754914f8e59d818,"Added resource for compatibility api.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334413 13f79535-47bb-0310-9956-ffa450edef68"
2e3b7e2a8017fd3505ca5003b6f2f35043448b58,"Fixed spelling error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334414 13f79535-47bb-0310-9956-ffa450edef68"
3236d5b39ba623ffac67d304e578a9ae1ab79b6a,"Implement some more methods for compatibility


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334417 13f79535-47bb-0310-9956-ffa450edef68"
c1adaf6b78976019c833405eeb847182cfa61703,"Fixed javadoc for api that was just added back.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334418 13f79535-47bb-0310-9956-ffa450edef68"
a92b8076e74fa48e0c5c8a45a8475f321cb3a732,"Fixed javadoc for api that was just added back.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334419 13f79535-47bb-0310-9956-ffa450edef68"
4e5da93184587b55468e28c8b0809007b5590301,"Fix problem with calling the processor with a liaison


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334420 13f79535-47bb-0310-9956-ffa450edef68"
771391fb4db4eb72b4bd1555ae970a74176d0d6b,"Fix problem where source file was being parsed more than once and if using an input stream, we would get a read error


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334421 13f79535-47bb-0310-9956-ffa450edef68"
24f249c957e66f444427385594011e970db0cb1c,"Fix for bug reported by ""Chris P. McCabe"" <chris_mccabe@choicehotels.com>
02/06/2001 06:55 PM.
Defensive fix for if the last used walker is null, then don't check to
see if it is a fast walker!  Without this, a null pointer exception is
very possible.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334423 13f79535-47bb-0310-9956-ffa450edef68"
dd317ba703cd717f757d48f2f88539a02d829f61,"Fixes for exceptions being thrown that weren't being passed through
the error listener.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334424 13f79535-47bb-0310-9956-ffa450edef68"
ca649c10e4965a75014cc61b550ec2262f27a25e,"Fix for bug reported by Dave Haffner <dave.haffner@xmls.com>
02/06/2001 04:03 AM
In parentNode(), don't screen out nextAncestor, since the parent
is never actually returned.  This sets things up correctly for firstChild
and nextSibling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334425 13f79535-47bb-0310-9956-ffa450edef68"
177844b475b2ddf93f211a617d59adab0f21a597,"Fix for bug reported by Dave Haffner <dave.haffner@xmls.com>
02/06/2001 04:03 AM
In nextSibling(), don't return null if isAncestorOfRootContext, instead
do next.getFirstChild().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334426 13f79535-47bb-0310-9956-ffa450edef68"
36c81e2f7a2d9c21b5a5dd884720fc3305df9d44,"Fix for bug reported by anders.domeij@uc.se
02/07/2001 09:35 AM
removed extra bogus TransformerException decl in resolveURI


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334427 13f79535-47bb-0310-9956-ffa450edef68"
0c290e178261ac309cb81ea39951ae7f43e04b3d,"Added xml2fo.xsl to xalanonly-styledocs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334428 13f79535-47bb-0310-9956-ffa450edef68"
30ea92adb902c87dc88df5e0d372d4c90a79b3ea,"Fix bug reported by Jason Harrop <jharrop@bigpond.net.au>
02/07/2001 08:12 PM
Don't process comment or whitespace events if inside a startDTD/endDTD
event.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334429 13f79535-47bb-0310-9956-ffa450edef68"
3bd7bc2f98ecbbd4c1593c86573a7e1f1867527a,"In indirect response to bug posted by ""Thee Boon Hoo"" <theebh@newstakes.com>
02/07/2001 09:37 PM

""//table[1]"" patterns would give one node
when they should have given 2, when applied to Boon Hoo's
source.
""//table[1]"" is equivelent to
""/descendant-or-self::node()/table[1]"",
and so must return the first table child
of each table-inst element.

An optimization was optimizing this to
""/descendant-or-self::table, which is
fine as long as indexing isn't used.  Since
we can not tell until runtime if indexing
is being used, we have to turn of this
optimization for all predicated ""//foo[xx]""
patterns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334430 13f79535-47bb-0310-9956-ffa450edef68"
45d44dc34d28916f3e0635df3665ed837deee110,"Set system id in stylesheet handler


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334431 13f79535-47bb-0310-9956-ffa450edef68"
1ce8b1837002720aa32af1731df0aeb53dbe2dca,"Patch for Dmitri IIyin to use the specified URIResolver.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334432 13f79535-47bb-0310-9956-ffa450edef68"
6c7834cd5440ad95ce82ce0e67597324279fba88,"Number Expression should be evaluated then rounded up.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334433 13f79535-47bb-0310-9956-ffa450edef68"
72dcb17ebaeafc7aa53c5815d2a5455204baee6b,"Added processing for <source> elements, i.e., code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334434 13f79535-47bb-0310-9956-ffa450edef68"
b47560f5c0c22710f498b5b63d9306cea249b50c,"Fixed typo in class name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334435 13f79535-47bb-0310-9956-ffa450edef68"
f219bb563b3bb6cadabd22f80f70248039f7ac08,"Create a document fragment for the output node, for -flavor d2d.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334436 13f79535-47bb-0310-9956-ffa450edef68"
2ee2c79b8b2f1842ed650f8138c318a33227d127,"Better error message when quo is used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334437 13f79535-47bb-0310-9956-ffa450edef68"
575b197a423aa8f8e8ed2e0608a174fa45980f35,"Remove extra method/call to TransformerImpl.executeChildTemplates()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334438 13f79535-47bb-0310-9956-ffa450edef68"
3c0c2daaa1d1767e7a7ddf3193299c13c23cfa20,"preliminary updates for next release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334439 13f79535-47bb-0310-9956-ffa450edef68"
574b09c1a9988994b63163f801bd3132ee6d1f35,"Return an empty string instead of null from getLocalName() when the
nodetest does not have a name.  Encountered with the SQL extension,
in response to bug reported by ""Michael Kay"" <mhkay@iclway.co.uk>,
02/08/2001 08:57 AM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334440 13f79535-47bb-0310-9956-ffa450edef68"
28ed5dbe5e0b3969f016dce0a75e0ea82ed701b9,"In getData() return an empty string instead of null if there is
no data to be obtained.
In response to bug reported by ""Michael Kay"" <mhkay@iclway.co.uk>,
02/08/2001 08:57 AM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334441 13f79535-47bb-0310-9956-ffa450edef68"
c3181352feeac44607c87686c41ef8be90b29cfe,"Added SQL library bug fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334442 13f79535-47bb-0310-9956-ffa450edef68"
389f64e3a47eff553f8c3fcb0033598be8ae3279,"Added support for images.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334443 13f79535-47bb-0310-9956-ffa450edef68"
1b2a7fdcc4f459e57f6c226d85dcc2ce5bc789f8,"Call local setSystemId.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334444 13f79535-47bb-0310-9956-ffa450edef68"
d7a0d7b7052de758023a9f0620f7f25799603654,"1. Added item on classpath problems using the IBM JDK 1.3.
2. Added usage patern note on change in handling of string
stylesheet parameters from Xalan-J 1 to Xalan-J 2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334445 13f79535-47bb-0310-9956-ffa450edef68"
16f8c59a0f2f92adf57f3b58358a1e8d42c795aa,"Added processing for <br/>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334446 13f79535-47bb-0310-9956-ffa450edef68"
71d18d6cc96e1cea741a862d828622f91bbf0098,"Fix problem with processing an input source created from a reader with no systemId
Fix problem with reading an input source file twice if it has a PI


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334447 13f79535-47bb-0310-9956-ffa450edef68"
34bcacff9c909a45804e673b0bfea87f83bf6008,"Tried to refine use of keep-with-next. This component is
currently broken.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334448 13f79535-47bb-0310-9956-ffa450edef68"
f66cd67c8a7f11e827008a39adcf49d9330f5270,"Correct ConversionInfo array for Node-Set and RTF.  Remove DocumentFragment from RTF and replace with NodeList.  Remove duplicate Boolean from both.  Fix Boolean conversion to make java.lang.Boolean higher than string.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334449 13f79535-47bb-0310-9956-ffa450edef68"
44f3350d2ec9a190d4154efea5cf23e0f5d580a1,"Use null nodetest to mean the same as ""node()"".  This fixes a bug reported
by ""Voytenko, Dimitry"" <DVoytenko@SECTORBASE.COM>
where <xsl:copy-of select=""sql:query(...)""/>
crashes with NullPointerException, i.e.
there are cases where we really don't want
to set the NodeTest.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334450 13f79535-47bb-0310-9956-ffa450edef68"
994ca0a365ede09b25d13eebe04937f6990575be,"Updated two links.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334451 13f79535-47bb-0310-9956-ffa450edef68"
f236226261f75bd9d8b8ecb688c661a1827a25c6,"Updated ref to XSL spec.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334452 13f79535-47bb-0310-9956-ffa450edef68"
15a77b7cf8e222fba435572d4966365226272a73,"More bug fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334453 13f79535-47bb-0310-9956-ffa450edef68"
006ce791a4d32d2f28cbd1cd8cd925d6dd213455,"Check for null token before checking if it is a letter


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334454 13f79535-47bb-0310-9956-ffa450edef68"
b0db1ec88ac783644766990aa9a5e786bc5b265c,"Fix made for bug reported by ""Glencross, Christian"" <Christian.Glencross@gs.com>
on 02/16/2001 10:18 AM.
Xerces 1.2.3 SAX parser calls
handler.setDocumentLocator() before handler.startDocument().
TransformerIdentityImpl.m_resultContentHandler isn't initialised until
TransformerIdentityImpl.startDocument() is called.
Added lazy construction of result handler
in setDocumentLocator, in addition to
startDocument.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334455 13f79535-47bb-0310-9956-ffa450edef68"
6f2ea30db72e9ed835e57549e3e6ed23ae49b2e8,"Correct implementation of string value of a node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334456 13f79535-47bb-0310-9956-ffa450edef68"
c2cfcbdd41d11ba293a0d55d9cecd71be62a1fb5,"Added experimental usage metatag to all classes in this package,
and an explanatory note to package.html.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334457 13f79535-47bb-0310-9956-ffa450edef68"
44ccbfd59f49dd8d557085e79ccd244c6d7c8f4b,"Added  explanatory note about experimental nature of this extensions package.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334458 13f79535-47bb-0310-9956-ffa450edef68"
c7022d1332318773a9344d86018b20f7259ebae2,"Removed -validate flag from command-line options.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334459 13f79535-47bb-0310-9956-ffa450edef68"
a90a09a600a1b5cc276ee124dd3bcc699eed55c5,"Add getOutputMethod API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334460 13f79535-47bb-0310-9956-ffa450edef68"
d0b37577e569b94f676b64286151db48f9bf09c7,"Bug fix attributed to Norman Walsh <ndw@nwalsh.com>, on
02/20/2001 09:50 AM.  if the attribute 'name' doesn't occur in the AttList, the
result of getIndex(name) is -1, but
getChildAttribute() would incorrectly
return the first attribute.  Fix returns
null if index < 0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334461 13f79535-47bb-0310-9956-ffa450edef68"
985bcda32607b5275a931ffcde08b004e5144831,"Simpler servlet samples


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334462 13f79535-47bb-0310-9956-ffa450edef68"
3bb81a3d321ecda06037c6d37aec72527172fc0d,"Implement DeclHandler for identity transforms


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334463 13f79535-47bb-0310-9956-ffa450edef68"
29d1e55d9bd411e6fc2aba4e05587aeee7df7807,"Added info on servlets and 2 new samples.
More bug fixes in ""DONE"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334464 13f79535-47bb-0310-9956-ffa450edef68"
c5b87eb111ad73c7f75c84ee1fb0fd6e8c04cb56,"Fix for bug originally reported by Daryl Beattie <DarylB@screamingmedia.com>
on 02/14/2001 04:16 PM.  A hang was occuring inside the use
of a Result Tree Fragment.  When the result tree fragement was
being created, the Redirect extension was being called, which
called createResultContentHandler which set the ContentHandler
in the Transformer, but not in the ResultTreeHandler.  Then, Redirect
called Transformer#executeChildTemplates(
          ElemTemplateElement elem, Node sourceNode, QName mode, ContentHandler handler)
 which saves the reference to the original content handler in
the transformer, and then sets the new one by calling setContentHandler,
which sets the ContentHandler in the ResultTreeHandler as well
as the Transformer.  When it tried to restore the old ContentHandler,
it restored the value in the ResultTreeHandler to a Serializer, instead
of the correct ContentHandler.  When transformToRTF then called
endDocument on it's resultTreeFragment, the event was sent
to the Serializer instead of the SourceTreeHandler, and thus the
isComplete flag was not set, and thus the hang.  (whew!)
The fix is in executeChildTemplates save the value of the
resultTreeHandler's contentHandler as well as Transformer's
content handler, and restore them both.  A more architectual fix
could be made, but not without high risk, so I think this is the best
and safest way to fix it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334465 13f79535-47bb-0310-9956-ffa450edef68"
969a934aebd0d47b51db1fe620f2e3c08bf47776,"Changed version to 2.0.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334466 13f79535-47bb-0310-9956-ffa450edef68"
5a755bd243ef71495be06eb5ce529130058a3d4c,"version 1.3 from Xerces-J-Tools.1.3.0.zip


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334467 13f79535-47bb-0310-9956-ffa450edef68"
e89c7f9c1465403a4e03ddd178e48994b35492cf,"extract from SPR database


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334468 13f79535-47bb-0310-9956-ffa450edef68"
283db1e4124c555aec54b0c7c9d5ecf7e0bc439f,"Returning to Xerces 1.2.3. Release 1.3 generates the following error:
[java] http://www.w3.org/1999/XSL/Transform grammar not found
[java] java.lang.NoSuchMethodError: org.w3c.dom.Node: method
isSupported(Ljava/lang/String;Ljava/lang/String;)Z not found...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334469 13f79535-47bb-0310-9956-ffa450edef68"
2e1f927f1c7a4422c25504a3ebefef6617ccea12,"The real Xerces-J 1.3.0.
The xerces.jar in the xerces-1_3_0 binary distribution is OLD.
I built the jar from the src distribution, and it appears to work fine.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334470 13f79535-47bb-0310-9956-ffa450edef68"
90cb65bca157e138e7332b5a30b96370ec55887d,"Update text of error messages
Submitted by:	Andreas Zehnpfund


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334471 13f79535-47bb-0310-9956-ffa450edef68"
e61fbb9f8b96c783e72cc9ae7c52e361a6ec8fa2,"Update printArgOptions() with better text and to better reflect actual
options that are currently supported; catch missing -IN argument


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334472 13f79535-47bb-0310-9956-ffa450edef68"
34f00a1d3cb03300357c9c31b08be9685d6f3403,"Build prepare.docs now transforms commits.xml, extracted from
our Notes copy of the commits, generating DONE for inclusion
in readme.html.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334473 13f79535-47bb-0310-9956-ffa450edef68"
3c781605cfc98c14fab5a10f2c2bf80becad12e6,"Removed from repository. Now generated during doc build from
xml-xalan/javba/commits.xml


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334474 13f79535-47bb-0310-9956-ffa450edef68"
6794a108f6f900c89def4234474d67982f679ac4,"Stylesheet for generating DONE for inclusion in readme.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334475 13f79535-47bb-0310-9956-ffa450edef68"
73a29dda252a1f279c77c2aa3dd0310a0513f894,"Change to parse the xsl stylesheet into a DOM as well; also
add the required setNamespaceAware(true)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334476 13f79535-47bb-0310-9956-ffa450edef68"
6613793cfd160cc87583f630d271550cae659ae2,"Removed bugs.xml from build. We are now using Bugzilla.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334477 13f79535-47bb-0310-9956-ffa450edef68"
94c29b41e857f45872a13f32b407d6773056f1fe,"Removed bugs.xml from build. We are now using Bugzilla
(add resource ref to resources.xml).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334478 13f79535-47bb-0310-9956-ffa450edef68"
4e6b73a11c90fd43f6cd0efafc569cc522f000b3,"Upgrade to Ant 1.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334479 13f79535-47bb-0310-9956-ffa450edef68"
196bed2c4d8a64f2b56536632b9e78677cbdd14d,"New approach to FastStringBuffer, and changes needed to support it.
We still need to do some serious work on both the initial values of the
tuning parameters and the heuristics driving the ""chunk growth"" algorithms.
Currently set for fixed-sized chunks of 8Kch in main tree, .5Kch in RTF.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334480 13f79535-47bb-0310-9956-ffa450edef68"
00f5ecfd3b2dafadf0ef1ecbcd3ba95d03d5e0ed,"Fix for http://nagoya.apache.org/bugzilla/show_bug.cgi?id=741.

1) ResultTreeHandler now implements the TransformState interface.
2) Queued state such as the current node and the current template is stored as part of QueuedStartElement.  Storage will only occur if the ContentHandler implements TransformClient.
3) When state is requested (for instance TransformState#getCurrentElement()), if the queued element is null or not pending (for instance, in a characters event), it will get the state from the transformer, otherwise it will get the state from the queued element.

Other fixes were attempted for this problem, including trying to
get rid of queueing altogether, and flushing a bit earlier before
the state was pushed on the various stacks, but both of
these had show-stopping issues (see discussions
on xalan-dev).

Note that for the moment the ContextNodeList is node
cloned as it needs to be in order for
TransformState#getContextNodeList.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334481 13f79535-47bb-0310-9956-ffa450edef68"
4ff487734e523299f17fcebbb955a0f533b2ab14,"The field Arg.isParamVar was attempting to serve two functions: to indicate variable Frame entries which are not currently activated and to indicate Frames containing parameters passed with xsl:with-param.  When processing was finished for a node in a node-set, the isParamVar flag was turned on to indicate the Frame slot was available.  Unfortunately, this also indicated that the item was passed as a parameter which it wasn't.  This fix changes isParamVar into to fields, isAvailable which indicates that the slot is available and isFromWithParam indicating the Frame slot came from an xsl:with-param or a top-level parameter passed in via the tranformerImpl.setParameter() API.
I have tested this change against the conformance suite and had no regression.  I've also submitted a test case which fails on the existing codebase but works okay after this fix.
It is possible that I've missed something with regard to the API setParameter calls but we can fix those if problems are reported.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334482 13f79535-47bb-0310-9956-ffa450edef68"
e641792f75ffdae8a3aed98f6bea1e96b92f4e7a,"Correct operation when length of content to be appended is zero.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334483 13f79535-47bb-0310-9956-ffa450edef68"
32b98e55441f156d1f3187bf6b2e25e12e65daff,"Updated to refer to bugzilla bug reports, with link to XalanJ2 open
bugs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334484 13f79535-47bb-0310-9956-ffa450edef68"
584efc088405b5f4de76050b13dc8ee61b134e9e,"Fix closing out doctype declaration


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334485 13f79535-47bb-0310-9956-ffa450edef68"
dea13107537298b146482521d18129c67cd99440,"Put in Apache copyright.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334486 13f79535-47bb-0310-9956-ffa450edef68"
0bf348996a754736da2015e791507a18e88d16bf,"Change SystemIdResolver to default to user.dir if the base URI is null


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334487 13f79535-47bb-0310-9956-ffa450edef68"
ace862195a804e2b61983021274aa0da9340b8c8,"Parameters set with setParameter were available to stylesheet as variable references ($myParam) even though there was no xsl:param element to receive it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334488 13f79535-47bb-0310-9956-ffa450edef68"
3df0bf37025e33a0cc184c82da93e7c3555d95da,"Check if there is a DeclHandler before calling it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334489 13f79535-47bb-0310-9956-ffa450edef68"
d3fb37ab0ea9405d2dd037e5d334788cf80d4b64,"Patch attributed to Patrick Moore <patrickm@rioport.com> on 03/09/2001.
Adds another constructor to pass in the error message.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334490 13f79535-47bb-0310-9956-ffa450edef68"
f7b1d89f02853bc1e36440a92dfcc14675159e61,"Checkin addresses http://nagoya.apache.org/bugzilla/show_bug.cgi?id=923.
elemAttribute now derives from elemElement so the basic name resolution
code can be shared.  Breaks attribset24 test, but I think the newer
behavior is better.  New virtual methods overloaded by elemAttribute are
constructNode, resolvePrefix, and validateNodeName.  Also, in the
elemAttribute#execute method, checks are made to make sure an
element is pending.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334491 13f79535-47bb-0310-9956-ffa450edef68"
19d04a72b6f1c4efe9e983bc731d31145c78e4f5,"Added getAbsoluteURI(String url), and merge
with Myriam's changes.
Part of fix for problem found when
investigating http://nagoya.apache.org/bugzilla/show_bug.cgi?id=906.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334492 13f79535-47bb-0310-9956-ffa450edef68"
be58440a49fdab9237347e3450c474f2dd9ad24d,"Call getAbsoluteURI(String url) for the source URL.
Fix for problem found when
investigating http://nagoya.apache.org/bugzilla/show_bug.cgi?id=906.
This tries to force us always having an absolute URL in the processing
stack as the base URL, which should be OK, I hope.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334493 13f79535-47bb-0310-9956-ffa450edef68"
1ac73fc095270ce6c18352d7bd9dd2916ffc2bd1,"The user for http://nagoya.apache.org/bugzilla/show_bug.cgi?id=741 reported
problems on testing, so these changes are a re-fix.  He tested and
everything seems OK now.  There actually may be a slight performance
improvement involved here.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334494 13f79535-47bb-0310-9956-ffa450edef68"
f07a69264a17fa84d98ee299c6cc00db500321cf,"Applied patches from dmitri.ilyin@memiq.com (Dmitri Ilyin)
from http://nagoya.apache.org/bugzilla/show_bug.cgi?id=705.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334495 13f79535-47bb-0310-9956-ffa450edef68"
c0fe49b23a527ec4262fda4c74a45b826f891f1c,"Applied patch submitted by nboyd@atg.com (Norris Boyd)
at http://nagoya.apache.org/bugzilla/show_bug.cgi?id=702.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334496 13f79535-47bb-0310-9956-ffa450edef68"
6ce0b0105a4a893d3af36097bdcd869e2f578938,"Applied patch submitted by havardw@underdusken.no (Hvard Wigtil).
Also added ""XXX-X"" variants for all ""XXX_X"" java encoding names.
I'm not totally confident that this is the right thing to do, but I can't
see that it will hurt, except to make the table a bit larger.  I
would prefer to be safe and make sure we handle the encoding.
See my comments in http://nagoya.apache.org/bugzilla/show_bug.cgi?id=718.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334497 13f79535-47bb-0310-9956-ffa450edef68"
d73fa2f387de0b36c6f9c3512728f58aabe519a0,"Minor changes to better bottleneck throwing of Runtime exceptions
during processing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334498 13f79535-47bb-0310-9956-ffa450edef68"
322b00d9e5d3d0c55b4a161f76257bec656fb3b2,"Catch all exceptions thrown when processing stylesheet, and send
them to the error listener.  There's probably some danger of having
the same error sent to the error listener multiple times, but better too
many reports, than none, I guess.
This addresses http://nagoya.apache.org/bugzilla/show_bug.cgi?id=906.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334499 13f79535-47bb-0310-9956-ffa450edef68"
7de1c51733f2d0cef9711903a8446ca555c549a8,"These are John Gentilin <johnglinux@eyecatching.com>
patches for connection pooling and parameterized
queries.  These should be considered to be unstable
right now, as we are still working on some things.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334500 13f79535-47bb-0310-9956-ffa450edef68"
a8855c631cbd476a4ac4111fbc8a443f995165b3,"The DOM2Helper#isNodeAfter(Node node1, Node node2) method
has been fixed so that it no longer does the try/catch thing if one
of the nodes doesn't implement DOMOrder, but instead does an
instanceof test.  In StreeDOMHelper, it overloads this method and
*does* do the try/catch business, since almost always both nodes
will implement DOMOrder in this case, and this will be faster than
an instanceof test.  Also, in various classes, I did some stuff to try
and make sure that a DOM2Helper wasn't being created and used
when a StreeDOMHelper is needed.

This addresses http://nagoya.apache.org/bugzilla/show_bug.cgi?id=800
and should give a good performance fix for foreign DOM processing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334501 13f79535-47bb-0310-9956-ffa450edef68"
b82c8c3675b06aa66d834eae8ab5011050961b47,"Xerces at some point decided to use """" instead
of null for null namespaces.  There has been a
discussion between Gary Peskin in
Joe Kessleman on xalan-dev about this,
but I hadn't been fully keeping up the the
thread that well, and missed it's relation to
this problem.  I include some of the discussion
at the end of this note.  I made Xalan be able to
compare a """" namespace to null for now, until
we get this resolved.

The gist of the discussion on xalan-dev regarding this is:

>>1.  Declare the Xerces-J support of schemas to have a bug and ask that
>>Xerces be corrected to always use a null namespace URI to indicate that
>>there is no default namespace.  Even if the Xerces people change this
>>behavior, is this correct?
>
> Yes. If your description of the problem is accurate (you should probably
> submit a more detailed case so it can be reproduced in the lab), this is a
> parser/DOM-builder bug.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334502 13f79535-47bb-0310-9956-ffa450edef68"
c2ec968ef0bd1d5a67c86be39d3ba74c268da3e7,"Removed ( commented out ) dump() method and the imports in ExtensionError.

So far the method doesn't seem to be used ( no warning in the compile ).

The problem is that this method is breaking the build with crimson ( since
it uses xerces-specific classes ). It is possible to implement it on top
of the serialization classes that are part of xalan - if someone needs the
method I'll try to port it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334503 13f79535-47bb-0310-9956-ffa450edef68"
821dfa3ca291035fec8fbed949f9c65991762397,"Periodic extract of commit messages from local Notes database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334504 13f79535-47bb-0310-9956-ffa450edef68"
6e3c12ff3581e0541d84ba500d5817d3786b7be1,"Made changes for change to API for XalanJ2 TreeWalker, which
now requires that the DOM helper be created by the caller.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334505 13f79535-47bb-0310-9956-ffa450edef68"
c788903eda393a7b373cb1d0583e93a2486e09c8,"Added back in the TreeWalker(ContentHandler contentHandler)
constructor, because I'm worried I'll break more dependent code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334506 13f79535-47bb-0310-9956-ffa450edef68"
ea4dcf60cf1875c5f6c3e132e3c80b48cb4a8c13,"Implement new arguments for the command line interface: URIResolver, EntityResolver and ContentHandler


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334507 13f79535-47bb-0310-9956-ffa450edef68"
59361d8677af4f41d55d74638d00aef9b174b1fd,"Fix error message to say that 2 or 3 arguments are required.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334508 13f79535-47bb-0310-9956-ffa450edef68"
a7aa0ae2ac93fa8cdf8d2cfd4ed6ec5ede3b6035,"Better error message for missing or incorrect XSLT namespace declaration in a stylesheet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334509 13f79535-47bb-0310-9956-ffa450edef68"
f1bcc482ba36940d9f0b58bbe6b10a64134bc253,"Periodic extract of commit messages from local Notes database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334510 13f79535-47bb-0310-9956-ffa450edef68"
10153fd4135cb8f1573447d81c00f4c39e85b44b,"Updates for Xalan-J 2.0.1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334511 13f79535-47bb-0310-9956-ffa450edef68"
24b8a2255c62c889fe2730562fbd2c377be5c03f,"Remember the Result that was used to trigger the transform.  Access that result from the Redirect extension to make file references in Redirect relative to the original result URI.
If this is not available, references are relative to the source URI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334512 13f79535-47bb-0310-9956-ffa450edef68"
022b02a5eb28a013f6774308adc063bec4f16224,"Added protection for null pointer exception that I discovered when
running some Cocoon tests.  Since I've never seen this before,
I assume this is related to the changes that Gary made, but am
unsure as it's 4:00 in the morning and I'm too tired to look into it deeply.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334513 13f79535-47bb-0310-9956-ffa450edef68"
ac73d5d87dc639c48bcf4dd69f7a0308ea35e871,"Periodic extract of commit messages from local Notes database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334514 13f79535-47bb-0310-9956-ffa450edef68"
7e92f42e9fc4298efabbbbc106dcd3d527d1f1d3,"Updated version number to 2.0.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334515 13f79535-47bb-0310-9956-ffa450edef68"
d216c20a123c01115ff8cbf314f554c69d5948c8,"Replaced by Bugzilla.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334516 13f79535-47bb-0310-9956-ffa450edef68"
b99e6bd37c6569bc1eface3d6e1069fea45d0dda,"Remove check for missing -IN arg; there are a number of use
cases for calling Process.main without an XML document


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334517 13f79535-47bb-0310-9956-ffa450edef68"
66c7c01d6199b72d716cfbf709ef4cd7c52b045c,"A (last ? ) place where XMLReaderFactory was used without
trying jaxp first. I used the same code that is used in all other
places in xalan.

With this change, the parser defined in XSLTInfo.properties will be used
only if jaxp is not available.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334518 13f79535-47bb-0310-9956-ffa450edef68"
a58e447c2f5e69fbedd9ef8a09246334fed1b876,"Added Main-Class and Class-Path attributes to the manifest.

Let me know if there is a problem with that - it's easy to change back.
This would allow people to just type ""java -jar xalan.jar"" and not
have to remember the org.apache.xalan.xslt.Processor or to set
class path ( assuming xerces.jar is in the same directory with xalan.jar).

The class path also includes crimson.jar, in case someone is using
crimson+xalan ( xerces is the first, so if both are present, xerces will
be used in most JVMs ).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334519 13f79535-47bb-0310-9956-ffa450edef68"
851317382816a75c91b713c13291e6c70be5894e,"Fixed typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334520 13f79535-47bb-0310-9956-ffa450edef68"
2748afcd83339ee4191fecf74f0d15b88fb18aab,"Checkin the REAL xerces.jar from Xerces-J-bin.1.3.0.zip; apparently
Don had looked in the Xerces-J-tools-1.3.0.zip in his previous checkin
and decided that was too old.  I'm a little suspicious that this xerces.jar
is almost twice the size that his was, but it's the one straight from the distro.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334521 13f79535-47bb-0310-9956-ffa450edef68"
4b4db8043d9f7aa67e69e69546f89b3ba4c4c5f3,"Fixed ""status"" anchors.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334522 13f79535-47bb-0310-9956-ffa450edef68"
5a08e5adcd497116f6900e28377ebfcf1b832a45,"Added missing @serial Javadoc tags.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334523 13f79535-47bb-0310-9956-ffa450edef68"
5705535900cf79765491f1ce84d09819c63fc068,"Periodic extract of commit messages from local Notes database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334524 13f79535-47bb-0310-9956-ffa450edef68"
9d16236b3ffabb893629fb44baba87ad989a69bc,"Added preliminary support for definition lists.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334525 13f79535-47bb-0310-9956-ffa450edef68"
bef813d9bc122ff785e2473868d5cf6e5149ef5e,"Periodic extract of commit messages from local Notes database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334526 13f79535-47bb-0310-9956-ffa450edef68"
6ddd245f26112b4be7f18e0af4e9f39fba3f6fa2,"Replaced by Bugzilla.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334527 13f79535-47bb-0310-9956-ffa450edef68"
7d744512dc8e245dd21d7f5e5ed2fe25c213821d,"Update from John Gentilin <johnglinux@eyecatching.com> to
fix connection cleanup.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334528 13f79535-47bb-0310-9956-ffa450edef68"
e82f3ac56c2b478765ebea733ad7812a334770d2,"Added sql.lib commit.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334529 13f79535-47bb-0310-9956-ffa450edef68"
60fd3bc836eb6020c622e9a853df688d0a9dc17b,"Update from John Gentilin <johnglinux@eyecatching.com> for new
sql connection pool support and sql parameter support.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334530 13f79535-47bb-0310-9956-ffa450edef68"
74ec63b8397bbe25df287bb30a4bfaee8733b981,"Split compile target into separate javac steps to avoid JDK 1.1.8 bug reported at:
http://developer.java.sun.com/developer/bugParade/bugs/4043508.html


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334532 13f79535-47bb-0310-9956-ffa450edef68"
7b1c3221356922cc4830420511ac21bee8b83f17,"Renamed ""assert()"" to ""assertion()"".

Assert can be a keyword, and brake the compilation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334533 13f79535-47bb-0310-9956-ffa450edef68"
4d29408b0c0c3a57378d8e660f6677c62045db92,"Fix bug 994 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=994) reported by jtl@schlund.de (Jens Lautenbacher).
Stylesheets included via xsl:include or xsl:import were not honoring the xsl:namespace-alias in an including/importing stylesheet.
The resolvePrefixTables() was being done as each stylesheet was at endDocument so the compose() on the root had not yet been done.
The call to resolvePrefixTables() was moved to the compose() method on ElemTemplateElement.  In addition, resolvePrefixTables() no longer has to walk
the ElemTemplateElement tree because this is done by compose() already.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334534 13f79535-47bb-0310-9956-ffa450edef68"
795f741b335ff2dac549ef7a13455f77d66d0254,"Throw an error message if the key name in a key function was not defined


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334535 13f79535-47bb-0310-9956-ffa450edef68"
c925cf40b46af5bceabd01fd416ae3d92f1ecb15,"Added UseStylesheetParamServlet, submitted by
Paul Campbell <seapwc@halcyon.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334536 13f79535-47bb-0310-9956-ffa450edef68"
e62d142f69381f431ad7de27c6645f02ab1a0544,"1. Added UseStylesheetParamServlet, submitted by
Paul Campbell <seapwc@halcyon.com>.
2. Following the example set by UseStylesheetParamServlet,
I changed XSLTServletWithParams to use
request.getParameter() rather than request.getParameterValues()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334537 13f79535-47bb-0310-9956-ffa450edef68"
58f188c2e533344ce151c264e31a5105f03c2c9c,"Reworked ""chunk growth"" algorithm again. Growing mode not
yet adequately tested, but fixed-size mode (which is what Xalan
is currently using) is simpler code and shows improved performance.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334538 13f79535-47bb-0310-9956-ffa450edef68"
9aa404525d48a0a41afe2c84f8350357f25a7111,"Utility class to check your JVM environment for common problems


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334539 13f79535-47bb-0310-9956-ffa450edef68"
519aec827bf6e9ca5e07cc21106a6385a1a231d0,"Double-semicolon fixed so Henri's compiler stops complaining about an unreachable statement. <grin/>


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334540 13f79535-47bb-0310-9956-ffa450edef68"
dc770f1d327fc2cca6c3d740fb6b01d4bd2a84e6,"Periodic extract of commit messages from local Notes database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334541 13f79535-47bb-0310-9956-ffa450edef68"
699f0a45e576f436ee8120323b472d46d7278041,"Moved 2.0.1 updates to history.xml


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334542 13f79535-47bb-0310-9956-ffa450edef68"
df31d0e0d418eaad407c5b5eca688c044c857f9f,"Add XercesLiaison class to APIs. Also fix the code in XSLTEngineImpl so that when a liaison is passed in, use it and only it to parse the stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334543 13f79535-47bb-0310-9956-ffa450edef68"
1a121a2d04eb5356b84626edf6020b881c7a6e6d,"Added more .jar sizes to jarVersions listing


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334544 13f79535-47bb-0310-9956-ffa450edef68"
94fe6f440f6847ceaa33f7a4a6c1d587c94985a0,"We've reworked the algorithm again. The fixed-chunk-size mode (initial
and max. chunk sizes equal) runs essentially unchanged, though with a
few cycles less overhead. The variable-chunk-size mode now uses a
recursive-encapsulation scheme, where the first chunk may itself be a
FastStringBuffer whose total length equals one chunk; every so often
we push the existing data down one level and restart with a larger
chunk size. The new scheme has been stress-tested and is apparently
working.  At this writing, however, Xalan uses only the fixed-size
mode (initial size equals max size), and no effort has been made to
find the optimial values for the tuning parameters. It does appear
likely that the best values will vary with usage patterns, but we hope
to find a good compromise.

I'll probably be putting this aside for a while to work on other things.
If someone wants to experiment with varying the block sizes and
how frequently they grow, and suggest good performance/memory
tradeoff points, go for it!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334545 13f79535-47bb-0310-9956-ffa450edef68"
ac9f25198eb00a16cb702def91e4c1dcd6ba6b80,"Minor tweak to the javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334546 13f79535-47bb-0310-9956-ffa450edef68"
355044b5ef2b41881e15b5eeba786af98c97c578,"reset() versus setLength(0).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334547 13f79535-47bb-0310-9956-ffa450edef68"
7c5bab36bcb232062b6b7623bba1ee50e312b5c8,"Fix for bug# 1116, getMatchedTemplate throws ClassCastException.
Don't push template unless it is a xsl:template.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334548 13f79535-47bb-0310-9956-ffa450edef68"
7ae171b8cd03e6b7e5c3db5b8b4e94a9516533e6,"Patches submitted by Patrick Moore <patrickm@rioport.com>
on 03/15/2001 01:25 PM:

This proposed change does a number of things:

1. Problem: HTML output method does not uses XML output properties as
default.

In both org/apache/xalan/templates/output_html.properties and in the java
doc for
org/apache/xalan/templates/OutputProperties#getDefaultMethodProperties(Strin
g) It specifically states that all OutputProperties use the
output_xml.properties as a base. In the code this is not true for html. This
is now changed to match the comments

2. Problem: unclear IOException.

If there was a problem loading the XML properties file. The wrapped
exception now will say which file was trying to be loaded. If the file did
not exist I was getting a very strange ""Stream closed"" IOException message.

3. Problem: the streams were not closed after reading the property file.

Fixed.

4. Problem: the double-check locking mechanism does not work in Java (see
bug #919)

<http://www.javaworld.com/javaworld/jw-02-2001/jw-0209-toolbox.html>


5. QUESTION: now if there is a default properties (i.e.
output_xml.properties has been loaded) but the expected properties file does
not exist a error message will be printed to System.err and the processing
will continuing using just the default properties (output_xml.properties) I
felt that this is the best behavior.

(comment by sboag: I think it's better to
throw a runtime exception in this case.
but we can discuss this over time.  For now
the patch was modified to do the runtime exception).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334549 13f79535-47bb-0310-9956-ffa450edef68"
9711221bf9de387af9e9519a11d668789e5cba88,"Add Stylesheet class to APIs. Change StylesheetRoot to extend from Stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334550 13f79535-47bb-0310-9956-ffa450edef68"
9d8c2a4421510d3b13e76f3b0c9a2450aa0354df,"Excluded lre02.xsl;lre03.xsl;lre07.xsl;lre10.xsl;lre12.xsl;lre21.xsl so
that smoketest will pass.
The excluded lre tests are at issue or are new bugs, and should
be included as soon as they are resolved.  They do not indicate
regressions, and thus shouldn't be part of the smoketest.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334551 13f79535-47bb-0310-9956-ffa450edef68"
4757229d46038db3c57e30bad2f4fa1a4b6d9ed0,"Removed in favor of managing these tasks via bugzilla.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334552 13f79535-47bb-0310-9956-ffa450edef68"
ab26fd5c3ee9187f53c430083f438ff5e28e50bf,"This check-in contains a couple things that overlapped on my
system, so I'm checking them in together.
1) Unfinished (in progress) implementation of TransformSnapshot mechanism,
which will hopefully allow a result ContentHandler to take a snapshot
at a given point, and the restart execution from that point at some
later time.  For tooling support.
2) Check to make sure SourceTreeHandler isn't being entered twice,
which is related to the cocoon bug from a couple of weeks ago.  This
will just help diagnose such a problem in the future.
3) Removed the error stack trace print from postExceptionFromThread.
4) Report exception in SourceTreeHandler#endDocument after
the join, if we can determine that the posted exception won't be
caught elsewhere.
5) removed some catches that simply rethrew the exception
(thanks to Patrick Moore <patrickm@rioport.com>).
See my note on 3/27/2001 to Patrick for more info
on the last two.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334553 13f79535-47bb-0310-9956-ffa450edef68"
bc4a5c3f7da927db1de4cc19307d9b8ac4333e7d,"Unfinished (in progress) implementation of TransformSnapshot mechanism,
which will hopefully allow a result ContentHandler to take a snapshot
at a given point, and the restart execution from that point at some
later time.  For tooling support.on the last two.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334554 13f79535-47bb-0310-9956-ffa450edef68"
6e8fe71fae60c3a52d17a97b79baed2e23d8d79b,"In progress, new source tree interface to replace the internal use
of the DOM interfaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334555 13f79535-47bb-0310-9956-ffa450edef68"
fb9b3aa4e89f0d4bb9b040ed0999514db9aabd66,"Add XSLProcessorException class to compatibility classes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334556 13f79535-47bb-0310-9956-ffa450edef68"
5da57e68a02ef1fd0dc96673cb31772be9dbc76d,"Restore from version 1.28, after I removed it when I really shouldn't have.
This is in dire need of updating.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334557 13f79535-47bb-0310-9956-ffa450edef68"
58aa3e060be0133a490be7e88032ee71c6a6b4a3,"Ongoing DTM interface work.  Added DTMFilter, DTMIterator, and
DTMManager.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334558 13f79535-47bb-0310-9956-ffa450edef68"
73d9c60a379a409d20355f4fc37d46d7b7b372d4,"Try to catch element order and required element errors during stylesheet object creation. This new code adds an order and a required field to XSLElementDef objects where it is applicable.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334559 13f79535-47bb-0310-9956-ffa450edef68"
b88024a10411a5eb2d40ac4f72c12e6c133de4a1,"Fix bugzilla bug 1170.  If we're trying an xsl:apply-imports at the top level (ie there are no
imported stylesheets), we need to indicate that there is no matching template and prevent and infinite recursion by using the built-in template.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334565 13f79535-47bb-0310-9956-ffa450edef68"
56a87f1a71bd0c465ce12b1d0ef4309d798750c8,"Fixed typo identified by Christian Brechbuehler <christian@arsdigita.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334566 13f79535-47bb-0310-9956-ffa450edef68"
3d27d13c4da4f565bf580c04a5fad42ad7087755,"Code cleanup submitted by Art Welch <art_w@EASTPOINT.COM>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334567 13f79535-47bb-0310-9956-ffa450edef68"
0a9b50563dd5ee43d033ebd37f2b89d1b5dd4c2f,"Add locator support to TreeWalker


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334579 13f79535-47bb-0310-9956-ffa450edef68"
48f2037390d6db994079a570ad77170b489a0935,"Small fix made for getCurrentNode.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334581 13f79535-47bb-0310-9956-ffa450edef68"
25a9f956786a1de9c19f1ea79bba5eae0ecd6f7e,"Commented out extra call to getData()... this could be a big performance
improvement for some stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334582 13f79535-47bb-0310-9956-ffa450edef68"
80abd30efca95fb32056ca4892089493d3369a93,"Additional support for tooling. Allow tools to take a snapshot of context and restart execution at that point.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334585 13f79535-47bb-0310-9956-ffa450edef68"
8d02c05f6f10fcee4ba35cb0037ad02bbff212c6,"Misc stuff left out from previous check in


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334588 13f79535-47bb-0310-9956-ffa450edef68"
f259ba3dc8ef0df9630af3daaab54097d89b2e00,"Don't assume that the object returned by getSubContextList() is a PredicatedNodeTest object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334590 13f79535-47bb-0310-9956-ffa450edef68"
1a6d948b55fa4372e991855a7d7c3411306fa3b8,"Create new TreeWalker constructor that takes a systemId parameter. Change TreeWalker to change fields in the locator and not set it for each node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334591 13f79535-47bb-0310-9956-ffa450edef68"
c3491e3d4beca0e6ad53900013661ee5d064fc72,"Initial XSLTC donation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334615 13f79535-47bb-0310-9956-ffa450edef68"
04cd06ccc8508fa79570baab0e73de3b6f2c45eb,"Initial XSLTC binary dependencies.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334616 13f79535-47bb-0310-9956-ffa450edef68"
03ad9acde9b798f70446fbddc2c746bdfb9ec21f,"Initial XSLTC docs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334617 13f79535-47bb-0310-9956-ffa450edef68"
1687cf55cc0e70caa4aae6c643f072fd85f058ee,"XSLTC directory excluded for the time being.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334618 13f79535-47bb-0310-9956-ffa450edef68"
0a710d1fc82425b8bcf005ec1c902077196752f1,"Fix Bugzilla bug:
PR: 1106
Submitted by: elharo@metalab.unc.edu


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334619 13f79535-47bb-0310-9956-ffa450edef68"
1a2b63ed7e1cb8b92018d269451877d4645a8812,"XSLTC GNU makefiles.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334620 13f79535-47bb-0310-9956-ffa450edef68"
13ac6e620744221d908f2fd53d3ac18084609fc7,"Minor Javadoc updates (add @author name, remove declared but unthrown @throws)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334622 13f79535-47bb-0310-9956-ffa450edef68"
5050834228ac76831cabd1fb68de9bf17aad7d72,"Support for Streamable Mode- John Gentilin


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334623 13f79535-47bb-0310-9956-ffa450edef68"
76cb602ef06bd22554708846d25abed21bc173e9,"New Example files for the SQL Extension


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334624 13f79535-47bb-0310-9956-ffa450edef68"
c92aa251bbca2204864d0c34e469c3893affce75,"Example Files for SQL Extensions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334625 13f79535-47bb-0310-9956-ffa450edef68"
264066e4e3d606d5167a1f5680c45669efd7e5c9,"Fix DOM level compile problems (sorry for large diff; formatting change too)
Submitted by: morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334626 13f79535-47bb-0310-9956-ffa450edef68"
7c884283c55b56dfd0a16601b2646f300c22a974,"Samples to show streamable nodes for the SQL Extension


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334627 13f79535-47bb-0310-9956-ffa450edef68"
52ead2576db75ea512cab08330b7768abefef0db,"Example file that dumps the entire result of an SQL query.
To be used as an example of the DTD for the XConnection/XStatement
object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334628 13f79535-47bb-0310-9956-ffa450edef68"
7e11694110f50630f97f5b8d991ae5b5a8ba5d32,"Remove files that should generated by the build


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334629 13f79535-47bb-0310-9956-ffa450edef68"
27ddac6e4f9b283398df45ff31b09c31837d4f25,"Major cleanup and integration of basic XSLTC stuff;
Simplify batch script to only setup parser and ant.jar;
Cleanup unused targets and organize variables;
Added xsltc.compile, .jar targets, but they're not quite complete yet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334630 13f79535-47bb-0310-9956-ffa450edef68"
9d1826435bfd399bb2e72aa98a7adbce1236b31c,"1.  Updated per comments by Albert Tsun about including
charset=UTF-8 in the SimpleServlet ContentType prior to gettting
a Print Writer from the response object.

2. Updated ApplyXSLT to use default output properties for anything
that the stylesheet does not supply for setting the ContentType.

3. Updated ApplyXSLT to be able to use a default Templates object
when an xslURL parameter is not included in the request
and the XML source doc does not include a stylesheet PI.
Useful for cases where the same stylesheet is being used for
many/most transformations performed by the servlet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334634 13f79535-47bb-0310-9956-ffa450edef68"
9ec033e13bfefb67f4614d9ab0f6c3abd5a59826,"Update to use JAVA_OPTS to fix Bugzilla 1044; plus cleanup
Suggestions for improvement to .sh script welcome!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334635 13f79535-47bb-0310-9956-ffa450edef68"
627db9799eee023955b11b6b1e6d253405940660,"Resolve bugzilla bug 1015 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1015>.
Fix prevents null pointer exceptions when null non-XSLT arguments are
passed to an extension function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334636 13f79535-47bb-0310-9956-ffa450edef68"
4b76ca9d585b5e6fe8ab95e7cb196d02bf7529e8,"1.  Updated per comments by Albert Tsun about including
charset=UTF-8 in the SimpleServlet ContentType prior to gettting
a Print Writer from the response object.

2. Updated ApplyXSLT to use default output properties for anything
that the stylesheet does not supply for setting the ContentType.

3. Updated ApplyXSLT to be able to use a default Templates object
when an xslURL parameter is not included in the request
and the XML source doc does not include a stylesheet PI.
Useful for cases where the same stylesheet is being used for
many/most transformations performed by the servlet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334637 13f79535-47bb-0310-9956-ffa450edef68"
25ac2f24b03da68f564c8ad75f4e175b7d02aa41,"Remove generated file


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334638 13f79535-47bb-0310-9956-ffa450edef68"
818e796a77b5852f90e8e03687ddadfe2196e416,"Utility to switch -stdin filename.ext argument to an input stream;
used solely to integrate java_cup utility into Ant build script


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334639 13f79535-47bb-0310-9956-ffa450edef68"
a456c78f1b03428f160af80ac0adb0aeef258d0d,"Update xsltc.* targets to properly generate sources and then compile them;
also added xsltc.clean target to delete generated files


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334640 13f79535-47bb-0310-9956-ffa450edef68"
334c43140e324d021b0bc22121dcd4a24a4d3ed2,"Fix copy/paste error. Want to use TransformerFactoryImpl's class loader.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334641 13f79535-47bb-0310-9956-ffa450edef68"
9ed55903c68fa277fc46b98eb47d7ffa1651e056,"Keep a copy of current contextNodeList is there is one


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334642 13f79535-47bb-0310-9956-ffa450edef68"
14e7f5be8cb542bd32a747f7170e0d3e354e224b,"Added checkDirForJars() which checks java.ext.dirs as well now


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334643 13f79535-47bb-0310-9956-ffa450edef68"
97cb82fd663aa406e20eb9c97c2374d94920a710,"Change xsltc.compile java tasks to fork=no for Win98 compatibility


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334644 13f79535-47bb-0310-9956-ffa450edef68"
77007bac8e0d07a62d0654911d9ec69daa82dda4,"Update from Notes (does not include DTM and xsltc)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334647 13f79535-47bb-0310-9956-ffa450edef68"
dabbd3220c22d3d29a65c2a3e461c2247fb5ee70,"Add package.html for each package in javax.xml.transform.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334650 13f79535-47bb-0310-9956-ffa450edef68"
a330e0157895f5ca2cc5a37139a7782faa3e897e,"Move TrAX overview to top-level.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334651 13f79535-47bb-0310-9956-ffa450edef68"
7751a61df802de728e3c29db1a1426035aa0f642,"Removed special handling of trax.xml (has been incorporated
into standard doc).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334653 13f79535-47bb-0310-9956-ffa450edef68"
10ffff7dad914accbab0ba4c27fd638a5a499df9,"Resolve bug 1496 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1496> where xsl:param statements were not being reset properly if the TransformerImpl was reused.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334656 13f79535-47bb-0310-9956-ffa450edef68"
6a89a1b600f95097b711c81f80421763487a50c3,"1. Added Java Server Page sample submitted by Paul Campbell.
2. Updated fooparam.xml to include the doc text node from the
   source document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334660 13f79535-47bb-0310-9956-ffa450edef68"
cc5b901c636c4b10db0d9ee5dd9ae1513b4dd197,"1. Added jspSample.jsp to samples.
2. Fixed a class path in usagepatterns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334661 13f79535-47bb-0310-9956-ffa450edef68"
40a339cffc9730aeca9cbb1b16f5ccb4c1383860,"Contitionalize calls to System.exit to allow running from containing Java programs (-s turns it off, for lack of a better flag)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334662 13f79535-47bb-0310-9956-ffa450edef68"
c571ca61c02569db0e0c7c4aac456b0211ab144d,"Fix for #1561


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334663 13f79535-47bb-0310-9956-ffa450edef68"
6577e89982519b6446f1b514744b1769d66d108b,"Resolve bugzilla bug 1373 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1373>.
Added code to support return of Integer or Long by an external function.
Code was contributed by Patrick Moore <patmoore@ieee.org>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334664 13f79535-47bb-0310-9956-ffa450edef68"
b2e4b505dcabcc3f1522ef30d6728889b3e46322,"Incorporate Scott's TrAX document into User's Guide and remove
from javax/xml/transform.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334665 13f79535-47bb-0310-9956-ffa450edef68"
045d53327037eee48b051e4ab6d3bf816dc39deb,"xsltc/compiler/LiteralElement.java and
xsltc/compiler/XslElement.java:
  o) moved handling of xsl:exclude-result-prefixes and
     xsl:extension-element-prefixes to compiler/SymbolTable.java
  o) improved handling of namespaces.
xsltc/compiler/Parser.java:
  o) added two static QName instances containing xsl:exclude-result-prefixes
     and xsl:extension-element-prefixes (for comparisons in SymbolTable)
xsltc/compiler/SymbolTable.java:
  o) added global handling of xsl:exclude-result-prefixes and
     xsl:extension-element-prefixes. Namespace declarations are (if possible)
     excluded in the respective element and its children.
xsltc/dom/DOMImpl.java:
  o) added loads of comments to most methods
  o) updated DOM builder inner class to handle SAX2 events
  o) improved and simplified namespace handling

PR: n/a
Obtained from: n/a
Submitted by:	Morten@xml.apache.org
Reviewed by:	Nobody


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334666 13f79535-47bb-0310-9956-ffa450edef68"
f2fe7f9d94bd192393615a25097479e99decd25e,"Added a few files that were missing in my last putback.

PR: 		none
Obtained from:
Submitted by: 	Morten@xml.apache.org
Reviewed by:	None


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334667 13f79535-47bb-0310-9956-ffa450edef68"
b7d8e00dd2d286c95ec4316817c61cc1cebd41bd,"Updates to sql/extensions samples: removed xml source
document where not required, and modified ExternalConnection.java
to use a ""dummy"" XML source.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334668 13f79535-47bb-0310-9956-ffa450edef68"
e90130c8e613ede7f26d578f2fed5e2b64a62e81,"Purge SQLExtension tree. These samples are now in
 extensions/sql.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334669 13f79535-47bb-0310-9956-ffa450edef68"
a2be32ea69bcbfeef352530989cd3a3bc4e47dd2,"Updates to sql/extensions samples: removed xml source
document where not required, and modified ExternalConnection.java
to use a ""dummy"" XML source.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334670 13f79535-47bb-0310-9956-ffa450edef68"
bb3f35d43912c6f1508e07d23dd382cdabcb4bef,"Removed all references to the ProjectX parser and DOM implementation from
the compiler package. The only side-effect (so far) is the lack of line-
numbers in error and warning messages.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334671 13f79535-47bb-0310-9956-ffa450edef68"
d1b2892e5b6cf74be45eeb29fad4733e88fa7454,"Removed the extended document builder. This class was used to store element
line-numbers in ProjectX's ElementEx (using the setUserObject() method).
These line-numbers were used by the stylesheet parser when generating
error and warning messages. We need to find a new way of doing this now
that we are using JAXP 1.1.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334672 13f79535-47bb-0310-9956-ffa450edef68"
c60e3f708460f3241fc231a44ad44d4f9135f420,"Added info on John Gentilin's addtions to the SQL extensions
libary and associated sample apps.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334673 13f79535-47bb-0310-9956-ffa450edef68"
656bea01b686f4219eab86cb172e955fc12d3f6d,"Added 3 demos that show how translets can be run in an applet, servlet
or brazil handler. (Brazil is a prototype from sunlabs that web-enables
applications without the need for a web server.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334674 13f79535-47bb-0310-9956-ffa450edef68"
1db6a9a09083053035f5b3ebca64027746d60eb9,"fixed runtime error: string index out of range: 0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334675 13f79535-47bb-0310-9956-ffa450edef68"
35c1f86bb9af9da7df169e993bc4d579a630c0eb,"Small fix to avoid file:////path that may fail on some JDK.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334676 13f79535-47bb-0310-9956-ffa450edef68"
6844c8448b7bea7fed14f053266aabaac06472cf,"Added xsltc to-do list.
Revised original and todo.xsl to generalize transformations and apply
same stylesheet to both lists.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334677 13f79535-47bb-0310-9956-ffa450edef68"
2cf4294d90504869ee6df6561156641ddc961679,"Transformed Morten Jorgensen's XSLTC design documents
to XML.
Adding to repository with accompanying .gif files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334678 13f79535-47bb-0310-9956-ffa450edef68"
9488d83f38237920a3d360578b319b4beb1221cc,"Putting XSLTC book document in repository.
Have added links to this book to the Xalan book.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334679 13f79535-47bb-0310-9956-ffa450edef68"
e3103c1d513893b2013bcdaadb1e087326886757,"New document2html.xsl, which adds
<br clear=""all> after images.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334680 13f79535-47bb-0310-9956-ffa450edef68"
1d423df316dd8b69cb496515771b3f2d75327ef5,"Added xsltc.prepare.docs and xsltc.docs targets.
Builds an XSLTC book (including a to-do list).
Also updated distribution to include xsltc_todo.xml
(the rest was included automatically).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334681 13f79535-47bb-0310-9956-ffa450edef68"
713b1e3b1eadeacab5b2ecd41b1f4c51af94a5fd,"Added readme.html files for extensions/sql and subdirs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334682 13f79535-47bb-0310-9956-ffa450edef68"
cf5638d85f6304196c315a16e91f8b3dd8f18291,"Preliminary updates for John G's work.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334683 13f79535-47bb-0310-9956-ffa450edef68"
5f23b1d41873c4e93116609bd7c3d062a24f2b9a,"Added faq on using .sig files to verify authenticity of a download file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334688 13f79535-47bb-0310-9956-ffa450edef68"
ca971c6fb2c45fb578be4e54bd1101bb394d1548,"Updated (does not include xsltc, for which we need a ""global""
statement, or DTM).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334689 13f79535-47bb-0310-9956-ffa450edef68"
b8a6f87e2075c5d4e60c17961f5cbc5debebe93c,"Added mkdir to xsltc.prepare.docs and didn't use basedir
in commandline argument!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334690 13f79535-47bb-0310-9956-ffa450edef68"
c08ebdc10862a79e8a864b109df4a1383ac2d99d,"Check for a null contextNodeList before returning its clone


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334691 13f79535-47bb-0310-9956-ffa450edef68"
b90d12f0168ee98a23a7e0d8559b5fd469e24376,"Set the element's level correctly, before we process attributes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334692 13f79535-47bb-0310-9956-ffa450edef68"
bee16702169b9d1e0b8118dff99dc153ae0294a0,"Resolve bugzilla 1648 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1648).
TransformerIdentityImpl was improperly using an old LexicalHandler when invoked for a second transform.
This bug only affects identity transforms with StreamResults.
Many thanks to John Keyes <johnkeyes@yahoo.com> for reporting this bug.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334695 13f79535-47bb-0310-9956-ffa450edef68"
de20a828014a870f4a0eb81464e00973f9c8ef40,"Added link to XSLT Usage and fixed a few typos.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334702 13f79535-47bb-0310-9956-ffa450edef68"
8174b5bcb5c966fe278d7027dc96648fe3562122,"New material for XSLTC


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334703 13f79535-47bb-0310-9956-ffa450edef68"
e141ca9aabb0390954b9f129e79804ebd0313fa5,"Updated version number to 2.1.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334704 13f79535-47bb-0310-9956-ffa450edef68"
9b9bc9734b5b577a9a8c063b237b98c0169c2357,"Oops! Added Apache license.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334705 13f79535-47bb-0310-9956-ffa450edef68"
6c744cea897e139a72ade2943b0640e806bffd86,"Removed javax.xml.parsers from the generated jar file.
The files are still in repository - to avoid build problems or new
dependencies.

Automatically add tools.jar in CLASSPATH ( as in build.bat )

Added a note that build.sh can be replaced with using ""ant"" ( as people
would use ""make"" ) - many other apache projects are using this ""style"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334706 13f79535-47bb-0310-9956-ffa450edef68"
524f0ab892784c7737025af050e3be705340df83,"Change submitted by Patrick Moore <patmoore@ieee.org> as part of bugzilla 1373 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1373).
Return value from extension function is now generalized so that all derivatives of Number are now properly handled.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334710 13f79535-47bb-0310-9956-ffa450edef68"
e70f3f29090e8608b7b92bbace4fcee403e6c048,"xerces.jar version 1.3.1 from Xerces-J-bin.1.3.1.zip


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334711 13f79535-47bb-0310-9956-ffa450edef68"
cca08c8477dd033a26de26471c5f0f25f92267f9,"Added dist target dependency on xsltc stuff; also copy xsltc.jar into distro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334712 13f79535-47bb-0310-9956-ffa450edef68"
c7e22a53c5ca753ffecadfee2ecc636074e6b1bb,"JAXP + Translet integration, new classes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334720 13f79535-47bb-0310-9956-ffa450edef68"
8348626354df0aad540f53e7c54aa6aec5cf53a3,"now extends JAXP Transformer


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334721 13f79535-47bb-0310-9956-ffa450edef68"
7c732cf2dd01fc131441a05a0341c14b13a091c6,"Set the correct order of xsl:include elements


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334723 13f79535-47bb-0310-9956-ffa450edef68"
a783ea68d707388655ab3f6754039cc4245b4d75,"Updates Javadocs
PR:
Obtained from:
Submitted by:John Gentilin mailto://johnglinux@eyecatching.com
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334724 13f79535-47bb-0310-9956-ffa450edef68"
4e6660030fdd8b739e498d521d9eff64340a036c,"stubbed out methods now thrown exception to warn users instead of returning null


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334729 13f79535-47bb-0310-9956-ffa450edef68"
cf3a1c194915077bc05ab73ccab7f16fa0278942,"stubbed out methods now thrown exception to warn users instead of returning null


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334731 13f79535-47bb-0310-9956-ffa450edef68"
4e8dfe01db07a4f71d9d997e3c51da4116280787,"Added Todd Miller's ""Integration of the Translet API and TrAX""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334732 13f79535-47bb-0310-9956-ffa450edef68"
64144669c444608c74e26ada6553756257c1c508,"Changed -out argument for calls to Process method.
The -out path no longer contains any reference to basedir (./).
Hope this fixes UNIX build problems.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334735 13f79535-47bb-0310-9956-ffa450edef68"
c292e023437ac08c07c69e65fc90a95565916ee1,"fix typo and table on required jars


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334738 13f79535-47bb-0310-9956-ffa450edef68"
2c90c4c4698c8c6248419b24838b5f0133bc3194,"Added info on using JAXP API


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334739 13f79535-47bb-0310-9956-ffa450edef68"
4e49255afaeac8a068d74504ebbf1b3ac6217c22,"Correct typo introduced in revision 1.30 causing problems with transforms on Unix platforms.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334740 13f79535-47bb-0310-9956-ffa450edef68"
f57db4948949df3d3c5e2171d7380e87835dbd6f,"Correct bugzilla bug 1748 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1748>.
When evaluating xsl:when, the xsl:choose element was used to resolve namespace prefixes instead of
the xsl:when element itself.  This caused namespace prefixes defined on the xsl:when to be ignored.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334741 13f79535-47bb-0310-9956-ffa450edef68"
c3956f5252215bfe56dc6d708230b4e57c8fe8f4,"Added info on using Crimson parser to usagepatterns.xml
Edited TrAX section in xsltc_usage.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334745 13f79535-47bb-0310-9956-ffa450edef68"
56fe1520da097332c6331c4d7a9572d80c68b765,"Added link to in xsltcreadme to XSLTC Design docs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334747 13f79535-47bb-0310-9956-ffa450edef68"
198a23bbf0e32346d0291583f1cf16a977a16308,"Added link to xsltc_usage#api


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334748 13f79535-47bb-0310-9956-ffa450edef68"
e5276f0d0703212d68a3e711b42df179fcca3bbf,"Added link to design doc on transets and TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334749 13f79535-47bb-0310-9956-ffa450edef68"
d3ddaa804bb4a40739ef562edc468e3f3bd49d0e,"TransletTemplates compiles its own translets now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334756 13f79535-47bb-0310-9956-ffa450edef68"
c3fb1c5fee3e22a7ecd481c864dd170bbb26d6b5,"PR:
Obtained from:

	Added the -s option for System.exit to enable test suite to
	continue after an error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334757 13f79535-47bb-0310-9956-ffa450edef68"
265023a30294a6725f1bd3e96959599f08aef8ce,"Use the context class loader if available.

The implementation is based on ExtensionHandler, and it's needed in order
 to work in certain environments ( like tomcat ).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334758 13f79535-47bb-0310-9956-ffa450edef68"
c95d6dfe77a6fb269b86ed892d4b7eff35117692,"Make getClassForName a public method. There are few other places in xalan
where Class.forName is used, and this can create problems in some cases
 where the Thread.getContextClassLoader should be used.

getClassForName uses introspection to call getContextClassLoader
( so it works in JDK1.1 ).

In ExtensionHandlerGeneral, use the thread loader to find BSF ( it may be
possible that xalan is installed in CLASSPATH, but BSF is in a webapp ).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334759 13f79535-47bb-0310-9956-ffa450edef68"
4d337267a78ac28d581dbb382e7588fb9c977d5c,"2 more instances where Class.forName was used.

Use the method in ExtensionHandler for consistency ( we could move it in
org.apache.xml.utils, but for now it's easier to just use it as it is )


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334760 13f79535-47bb-0310-9956-ffa450edef68"
d6438fe9255131ac4944a8a8a02907b124ff462e,"This is the ""thread pooling hook"".

It slightly changes the API used to create and wait for the transform thread.
Instead of using threadCreate() and Thread.start() that creates a new thread
and  thread.join() that waits for a thread to end, we now use a ThreadControler
class that has the equivalent methods:
- run( Runnable ) - executes a task in a thread. The default implementation
is identical with what we had, using new Thread() and start()
- waitTread() - waits for a task to end. The default impl. is identical with
the previous code, using thread.join().

Someone wanting to use a thread pool for xalan will have to extend
the ThreadControler and override the 2 methods, then call setThreadController.

Xalan itself doesn't implement a thread pool right now ( for mosts uses it's
not even needed - if you just do few transforms for example ), instead
a server that runs xalan could plug it's own thread pool.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334761 13f79535-47bb-0310-9956-ffa450edef68"
7648b9e61725ec60086b03d61737b62c552cf9aa,"removed all caching for now


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334766 13f79535-47bb-0310-9956-ffa450edef68"
1d7ef2428bfca218685a5d74f7cf72cfc41b4924,"Attempted to clarify situation with respect to streaming vs. caching.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334769 13f79535-47bb-0310-9956-ffa450edef68"
8a47970518c8f2c2f5b40d1f0cd2e2078b24ec8b,"Editing pass.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334770 13f79535-47bb-0310-9956-ffa450edef68"
00ac2d0b624c508f714e324450d8315aa686a71f,"Fixed ""conflict"" in javadoc comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334771 13f79535-47bb-0310-9956-ffa450edef68"
6da5b8a2644bf6949bc32e53994d8c63e31ad458,"Added missing 'import' from first import statement in the 2 examples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334772 13f79535-47bb-0310-9956-ffa450edef68"
519e6c4a85d985a221c1249d78358be283d5c6cc,"Code cleanup in examples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334773 13f79535-47bb-0310-9956-ffa450edef68"
379665e0b288a50a2c9605c1a1fdd36a95603564,"Added exclusion of include18.xsl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334784 13f79535-47bb-0310-9956-ffa450edef68"
1e5b49772ce3c86a10fd800638b4c3c22317b99b,"Changed the TypedFollowingSiblingIterator and TypedFollowingIterator
inner classes of DOMImpl to fix the following::* iterators.
CHanged the DOM builder's endDocument() SAX entry point to properly
handle @xml:<blob> attributes (such as xml:lang and xml:space).
PR:		bugzilla 1758 & 1677
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334785 13f79535-47bb-0310-9956-ffa450edef68"
f5f297725fd3f9e16036aca188e805bdf387c13d,"Changed the URI for external Java functions (still only static methods) to
""www.apache.org/xalan/xsltc/java/<class>"". Are we sure we don't want the
""http://"" prefix on this URI?
PR:		bugzilla 1747
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334786 13f79535-47bb-0310-9956-ffa450edef68"
62c1c673a73d437d350ae4a2b7b097d3acc2bc32,"Added a small fix to make sure that global variables and parameters are
instanciated and made available before any other top-level elements are
parsed. Previously a top-level (global) variable would not be available
to other top-level elements that occured before the variable inside a
stylesheet element.
PR:		bugzilla 1487
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334787 13f79535-47bb-0310-9956-ffa450edef68"
8ae3d40cf1b97b536152c6bab66e97b0f999df6e,"Added code that resolved import precedence for multiple declarations of the
same global variable/parameter. This fix would not have had any effect
without the previous, recent fix for bug 1487 (in Stylesheet.java).
PR:		bugzilla 1408 (related and dependent on fix for 1487)
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334788 13f79535-47bb-0310-9956-ffa450edef68"
0d0bfca8d169bca35469ee388f681977db840a6f,"Changed Template's translate() method so that the current class name is
obtained from the MethodGenerator class and not the parent Stylesheet
class. This because the Stylesheet does not always know the correct name
of the translet class name. This is soemtimes the case with imported or
included stylesheets.
PR:		none - bug not registerd in bugzilla
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334789 13f79535-47bb-0310-9956-ffa450edef68"
b9a50d76d126e5d0565712efb5bb9ce688e55c0d,"Added a qname stack to the translet output handler to ensure that closing
tags get the same prefixed qname as the opening tag.
PR:		bugzilla 1473
Obtained from:	bugtraq 4426607 (Sun Microsystems)
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334790 13f79535-47bb-0310-9956-ffa450edef68"
29685933ec7ec77715b26eaa7df1e311ef020600,"Added prefix to xsltc extension URI.
PR:		bugzilla 1747
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334791 13f79535-47bb-0310-9956-ffa450edef68"
66d6f359280dde9f3df6ee452734b1f39db2ea52,"bug # 1406 fixed, omit xml header implemented


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334792 13f79535-47bb-0310-9956-ffa450edef68"
3a95a1170cdaf75e31b569273d342c7d91d4d0c7,"Translet samples using JAXP 1.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334793 13f79535-47bb-0310-9956-ffa450edef68"
d77d798346cd36758ed58be610643bc0edf8137d,"Preliminary info on translet JAXP samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334794 13f79535-47bb-0310-9956-ffa450edef68"
0c92e0cfdc7e75f2395bcb297434ab8ab0d56e23,"Removed demo files from src/org/apache/xalan/xsltc/demo
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334795 13f79535-47bb-0310-9956-ffa450edef68"
86adc6bc90d9189ee40637382d217af9e37b1ea3,"Rmeember to reset system properties!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334796 13f79535-47bb-0310-9956-ffa450edef68"
f7b574527aa4c84142052e4f4ea0eb229e8920dd,"Added XSLTC demo files to the java/samples directory.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334797 13f79535-47bb-0310-9956-ffa450edef68"
83b2cf9f26a74c60e14e39e39ad13b8ca000a0d2,"Simplified getting/setting system properties.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334798 13f79535-47bb-0310-9956-ffa450edef68"
6a535c46800a04bfb51785232830023ea40ecacc,"Fixed key name for TransformerFactory system property.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334799 13f79535-47bb-0310-9956-ffa450edef68"
eb03979b1fc1348d818ab92af631a0e161b0df4f,"Removed printline


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334800 13f79535-47bb-0310-9956-ffa450edef68"
ce2854001f8b2803b9c6799797a0e80891e67924,"Remove outdated, unused files: old makefiles


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334801 13f79535-47bb-0310-9956-ffa450edef68"
cf1842a87e671033ef675ae0504d147ba86e4871,"Update Javadoc and remove commented out reference to properties file
PR:Bugzilla1627


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334803 13f79535-47bb-0310-9956-ffa450edef68"
ddc92b624a3b4245c49b1705533f5448610a17e1,"Moved XSLt stylesheet to working directory


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334805 13f79535-47bb-0310-9956-ffa450edef68"
3c8df5d7461576ed54a1510f59a143385b7de73c,"Added xsltc.samples target for building translet samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334806 13f79535-47bb-0310-9956-ffa450edef68"
1c91b95339ef00385945e4d0025cdaef75a2299a,"Clariified setup for running xsltc samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334807 13f79535-47bb-0310-9956-ffa450edef68"
5736422d932e1b219b10268f5821632e0caca515,"Removed ref to -Validate option.
More detail on using JAXP to generate and use translets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334808 13f79535-47bb-0310-9956-ffa450edef68"
d1ff8ff87f72a793c6f89f8f94049aaa0b298fdc,"added more support for StreamResult output targets


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334809 13f79535-47bb-0310-9956-ffa450edef68"
036bbd73790c55784f193dd2a8da2dbeb1c681af,"Added comment on loading properties from properties file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334810 13f79535-47bb-0310-9956-ffa450edef68"
5a9b7382a4ffcab373f7fe3a9ff5fcd35b796508,"Resolve bug 1330 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1330>.
setContentHandler failed to also reset m_lexicalHandler if the ContentHandler
was also a LexicalHandler.  This caused the old LexicalHandler to be used which
was pointing to a previous result tree.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334812 13f79535-47bb-0310-9956-ffa450edef68"
7af205352fb7ce2bc7bad98ab59817b79dfb1a09,"Release Notes for XSLTC's first release on Apache.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334813 13f79535-47bb-0310-9956-ffa450edef68"
e7760984e96772a64198dec54c8c026128bc27f2,"Resolve bug 1762 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1762>.
TransformerFactoryImpl's URIResolver was not propagated to created Transformers.
Modified code to propagate.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334814 13f79535-47bb-0310-9956-ffa450edef68"
44800258c1a2e6c71f686067d1cc9bfeb34d1205,"Catch SecurityException whenever accessing System.getProperty(""user.dir"");
minor javadoc update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334818 13f79535-47bb-0310-9956-ffa450edef68"
4708afd73f980ac835679a64cae30082ddad0642,"Optimized the DOM builder inner class of DOMImpl
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334822 13f79535-47bb-0310-9956-ffa450edef68"
b532a16fbda4c6d23424d3f5f520d0b6cfa35607,"Fix for bugs reported by the Eclipse folks for TransformState, where
some operations (xsl:value-of, xsl-copy) were not pushing the
current node on the current node stack.  Addresses
http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1524.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334824 13f79535-47bb-0310-9956-ffa450edef68"
88a204d59f493cb221485b9bcee593b32e4146ae,"Catch SecurityException as needed
PR: Bugzilla1258


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334825 13f79535-47bb-0310-9956-ffa450edef68"
648a45beaf046b5fc6116cb7e6ce56f56f074928,"Change to ensure that the translet only instanciates e DecimalFormat
object when it has to. FormatNumberCall.typeCheck() sets a flag
in Stylesheet to indicate that a DecimalFormat object is needed.
PR:
Obtained from:	none
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334826 13f79535-47bb-0310-9956-ffa450edef68"
4e9d84ff90c686ab6d81ef87e4c53e78d0efbdcf,"1. build.xml - Added xsltc design docs to site target.
2. Updated commits.xml from Notes database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334827 13f79535-47bb-0310-9956-ffa450edef68"
a1221497fc7bf7be79de286ef017819e421ffb6d,"Updates for releae 2.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334828 13f79535-47bb-0310-9956-ffa450edef68"
5463aefa38d204091af6ff3394b3bb4a19ae2771,"Performance: Improved the way in which translets pass namespace declarations
to the output post-processor. Previously this was done by constructing a
""xmlns:<prefix>"" string for the attribute name and an ""<uri>"" string for the
attribute value, and then passing the two strings to the handlers
attribute() method. The output handler now as a namespace() method that
receives the prefix/uri pair as two separate, clean strings.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334829 13f79535-47bb-0310-9956-ffa450edef68"
a3e1484f10df9e22533abb8f83e6fedbb7c12d44,"Fix to the following bug reported by dims@yahoo.com:

loadPropertiesFile method in org\apache\xalan\templates\OutputProperties.java does not fall back
to the Thread Context Class Loader to load properties files like output_xml.properties etc. This
is causing problems in ServletExec_3_1+C2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334831 13f79535-47bb-0310-9956-ffa450edef68"
96bede9317a8a3f6a5b4e954e746b835b16699fb,"Updates for releae 2.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334832 13f79535-47bb-0310-9956-ffa450edef68"
fc7763a8fafad9b814b82ad2a92f208e26401a2d,"light edit


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334833 13f79535-47bb-0310-9956-ffa450edef68"
d6c9285afe108d5b00a593bd9963a5dac6a76b27,"Correct implementation of ContextClassLoader to support case where properties file is to be loaded by a different ClassLoader than the OutputProperties class.  Thanks to Davanum Srinivas <dims@yahoo.com> for this code and for reporting this bug.
loadPropertiesFile should eventually be moved into a thread-specific class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334836 13f79535-47bb-0310-9956-ffa450edef68"
1708db688d06ebf97d3c7ad1815ce46ce333a80c,"bug fix 1499, text output method and copy of


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334837 13f79535-47bb-0310-9956-ffa450edef68"
60a0aee593e25969da2f17a4d3ef29e1bc885e7f,"Removed question mark from entity defining Xerces release used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334839 13f79535-47bb-0310-9956-ffa450edef68"
4912cc54556b3a19fa86c3aabb7524f6bd8de938,"Added info provided by Shane on use of EnvironmentCheck
utility to figure out ClassDefNotFound errors.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334840 13f79535-47bb-0310-9956-ffa450edef68"
0e6f904549d0609eb9f16564552dc8315c5a530f,"Added John Gentilin and Costin Manolache to list of active
developers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334841 13f79535-47bb-0310-9956-ffa450edef68"
da7c69889ff30d319547b709c097e54f3e3c407b,"Modify getResourceAsStream calls to use the contextClassLoader, if available.
This is a temporary fix until we can centralize this function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334842 13f79535-47bb-0310-9956-ffa450edef68"
de366b02f1f74ff88506350ec2e725c1228406ef,"Always use _underscore variables and unset them all to not conflict with runtest.bat


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334846 13f79535-47bb-0310-9956-ffa450edef68"
1a03baee5b6d1a767d16597191471ee2d4c6a248,"Major performance improvement. I removed all references to
java.util.Hashtable in the XSLTC runtime directory. I added my own
implementation of Hashtable (based on the Java1.1 implementation, but
without any synchronized methods and with some performance improvements).
Some minor changes in the internal DOM - also for better performance.
A small change in the DOMImpl.getNamespaceName() method to prevent null-
pointer exceptions in some rare cases where the xsl:strip/preserve-space
elements were used.
Eliminated one String instantiation on the TextOutput class.
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334847 13f79535-47bb-0310-9956-ffa450edef68"
ce855a27a39f85af3bfa4ebe050cb61ab4866f17,"Updated to include commits after 5/15/01


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334848 13f79535-47bb-0310-9956-ffa450edef68"
d196420e30dad137b1af38f8a38c7ee54d1876fa,"Updated Xerces version to 1.4


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334849 13f79535-47bb-0310-9956-ffa450edef68"
1b4eff6bf3d13f341294297fdf60f2f765435cd9,"Minor editorial corrections.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334850 13f79535-47bb-0310-9956-ffa450edef68"
7bdbb08b3ec0757b728fc60fa5b5f985543f75e1,"xerces.jar version 1.4 from Xerces-J-bin_1_4_0.zip


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334852 13f79535-47bb-0310-9956-ffa450edef68"
82f2199d815fc7dc11d2c55dcb73f3c658ac3cb4,"Updated for xalan-j_2_1_0 release


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334853 13f79535-47bb-0310-9956-ffa450edef68"
8d2128634079f73ed6e480131db75a0a06e4e891,"Added a new demo. This one demonstrates how pre-compiled translets can be
invoked by an EJB (another way of offering compiled XSL transformations as
a web service). Very simple, nothing fancy, but it works.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334857 13f79535-47bb-0310-9956-ffa450edef68"
5a914fbfc8c077cc35a2372e7e1f08b2025a7817,"bug fix 1403, output escaping fixed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334858 13f79535-47bb-0310-9956-ffa450edef68"
6d7f5a870c12f28b6494ea549c071c13ddf18f4f,"Updated for xalan-j_2_1_0 release - hack to remove misc javadoc files longer than 100 chars
Should be removed once we have a permanent solution!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334859 13f79535-47bb-0310-9956-ffa450edef68"
2097598e6285705e68f7eff7c3b914c519b52f20,"Fixed minor typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334861 13f79535-47bb-0310-9956-ffa450edef68"
6d893d266c018f533141c3d5750b0205ae08955d,"Fixed removeAttribute bug pointed out by by dims.  This should be fixed in the next release of SAX.
Made the same change to both Xalan and xml-commons.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334884 13f79535-47bb-0310-9956-ffa450edef68"
63aa4e85cff96a0421a0712c7bc0af7c82921120,"Clarify format for declaring extension namespaces as the xalan: scheme evolves.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334885 13f79535-47bb-0310-9956-ffa450edef68"
fa29b0732187ea7cf603d03186adc0257c1f3bbd,"Resolved bugzilla bug 1830 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1830).
The EntityResolver in the primary XMLReader was not being propagated to the XMLReader created to handle the document() function.
The routine to construct the new XMLReader now obtains the primaryReader and uses its EntityResolver if available.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334886 13f79535-47bb-0310-9956-ffa450edef68"
d0fe2e4cf70186a3c970cf1b4c61b80593763c21,"stylesheet compilation error listening added for
TrAX support


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334912 13f79535-47bb-0310-9956-ffa450edef68"
b92fef6c9bfbc0d3a2db722d7f027e2d571847c2,"fix typo XCLTC, should be XSLTC


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334913 13f79535-47bb-0310-9956-ffa450edef68"
dd47e6ba0c52878935ae65a6380027c437ca7849,"Enabled servlet to sometimes use a default Tem0lates object
and sometimes use (in the same sessions) an embedded
stylesheet PI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334914 13f79535-47bb-0310-9956-ffa450edef68"
a04e7137de32eb7e0b40e134b95858f36f87532b,"Transformer factory's setErrorListener() now throws
IllegalArgumentException is listener is null


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334915 13f79535-47bb-0310-9956-ffa450edef68"
9dc85be2183d4ba09d7dcc7992609bfe9eafd985,"translet transformation errors now forwarded to
TrAX error listener when applicable


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334916 13f79535-47bb-0310-9956-ffa450edef68"
2b028a9df96f8d261a0ed4821b4edcf989879821,"Added a constructor for copying an org.xml.sax.Attributes to our
org.apache.xalan.xsltc.runtime.AttributeList.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334919 13f79535-47bb-0310-9956-ffa450edef68"
ffe1c187988fe3a2be415e4d3efc378b44b0bce0,"Removed the intermediate DOM used to contain the input document (the
stylesheet) for the compiler. The compiler now uses SAX2 to import
the stylesheet, and all references to DOM interfaces have been removed.
This means that most classes representing XSL elements have been
changed, but most classes representing XPath functions, expressions
and patterns are unchanged.
PR:		After suggestion from Scott Boag
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334920 13f79535-47bb-0310-9956-ffa450edef68"
fb94c3e7dc09b6599efeed71fcda4589ae9e0bd1,"Adding a class for handling unsupported stylesheet elements
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334921 13f79535-47bb-0310-9956-ffa450edef68"
c0f018d8f030e7a05fda9513f626318119656838,"Minor fix to make sure that attributes are processed in the correct order.
PR:		n/a
Obtained from:	n.a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334922 13f79535-47bb-0310-9956-ffa450edef68"
ea3c3427e7cfff5c0ac76d90507ff3604f59eb66,"Minor change in output indentation/line feeds.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xmp.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334923 13f79535-47bb-0310-9956-ffa450edef68"
a0de7e16ad6db7fbfe837f1daff6187f9b51a677,"Fixed the code that resolves conflicts between templates with identical
patterns. The order of the templates is not taken into account - after
import precedence and priority has been checked.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334924 13f79535-47bb-0310-9956-ffa450edef68"
02590212b115b5fc981fcd7b71faa52f42f8bb45,"Reverted changes to SAX output handler.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334925 13f79535-47bb-0310-9956-ffa450edef68"
171fe8561dd9c4a174674a89a68453678a8aacfb,"unified Parser error reporting to use Mortens
reportError routine


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334926 13f79535-47bb-0310-9956-ffa450edef68"
b1a7c0df430d4a65e01b367e1526e278629a13d3,"Updated a few classes that were still calling Parser.addError(),
Parser.addWarning() and Parser.addFatalError() to use the new common
error handler Prarser.reportError(int category, ErrorMsg message).
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334927 13f79535-47bb-0310-9956-ffa450edef68"
dce4b2abaf4fa19266af6d41a3d8115c15b02e0f,"Added two lines of code to explicitly set the feature
""http://xml.org/sax/features/namespaces"" of the SAXParser to ""true"".
The default is ""true"" but xerces seems to set it to ""false"", and this
caused some problems for our Stylesheet and XML doc parsers (which are
both using SAX2).
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334928 13f79535-47bb-0310-9956-ffa450edef68"
8c32fe843477ca631cba902291eba6247a192ba2,"A few more changes to make sure the parsers used are namespace aware.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334929 13f79535-47bb-0310-9956-ffa450edef68"
b8ad8bad1e008e8eecccb39b7bd96d01c8418ae2,"The change from using DOM to using SAX in the stylesheet input caused some
of the elements in the Abstract Syntax Tree (AST) to be out of order. I
added a few lines of code to the xsl:element/attribute handling code to
fix this.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334930 13f79535-47bb-0310-9956-ffa450edef68"
9913f59859d92432d4bf23da310af954be225e3f,"fix path for external java function


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334932 13f79535-47bb-0310-9956-ffa450edef68"
7991b7526b21bccf8426e26f9609e649c7c3345f,"Enhancement to implement xalan:omit-meta-tag=""yes"" on the xsl:output element.  When specified,
no META tag will be created with the HTML output method, even if one should be created according to the XSLT Recommendation.
This clears bug 1310 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1310).
Also, implemented fix in bug 2000 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2000) to avoid changing OutputProperties out from under the Enumeration.
We now enumerate a clone of the OutputProperties.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334933 13f79535-47bb-0310-9956-ffa450edef68"
c0b8c5e1f3970a1d9f382d74ef11afe9cb0f22a3,"Resolve bugzilla bug 2098 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2098).
The routine checkForFragmentID was checking for an attribute of type ""ID"" instead of the ""id"" attribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334934 13f79535-47bb-0310-9956-ffa450edef68"
f2b35c498dc058f4df47d5aadce27a5bdaf41711,"This putback contains three fixes:
 o) fix for complex <xsl:attribute-set> inheritance structures
 o) fix for xsl:element-available() function used in <xsl:when> or
    <xsl:if> to test support for various extension elements
 o) fix for preserving namespace prefixes for <xsl:attribute> output.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334935 13f79535-47bb-0310-9956-ffa450edef68"
55f7ebbea76827f0c8306315941af3538fa15dd6,"Fix to allow iterator access within attribute sets. This is necessary for
attribute sets that contain attributes whose values are generated by XSL
functions such as position() and last().
PR:
Obtained from:	test mk013
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334936 13f79535-47bb-0310-9956-ffa450edef68"
dfbeed8948e55d9d1e49ef91c52a36c216cc55cc,"Added output character escaping for non-breaking space characters.
I cannot believe we've waited this long before doing this. Madness!
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334937 13f79535-47bb-0310-9956-ffa450edef68"
7e91be77b5155d89c8b328295b4675023017c051,"support for java.io.InputStream StreamSources


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334938 13f79535-47bb-0310-9956-ffa450edef68"
90f11471dbaf6d5199efc96b7ad4955188e20a97,"Fix for bug 1511. Predicates on the format ((a or b) and c) are not
handled correctly. I added a small piece of code to direct the true-list
of the OR expression to the beginning of the AND test.
PR:		Bugzilla 1511
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334945 13f79535-47bb-0310-9956-ffa450edef68"
47a3ef7beb8bc67af267f937c1f3fd814f55b82b,"Fix attribute node-set comparisons. There was a bug in one of the compare()
methods of the BasisLibrary class which prevented attribute values from
being compared. The method compared node IDs instead of node values.
Pretty stupid bug, but now it is solved anyway.
PR:		Bugzilla 1409
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334946 13f79535-47bb-0310-9956-ffa450edef68"
13a1ebc9a3b60e353e295ed1cd5f659b588f8841,"Fix to make sure that the implicit ""text()"" pattern is run when templates
containing ""text()"" in their pattern fail. XSLTC would not previously
invoke the built-in pattern for ""text()"" if a stylesheet contained a
template such as <xsl:template pattern=""foo/bar/text()"" .../>
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334947 13f79535-47bb-0310-9956-ffa450edef68"
8d74d360968c03468c7fd7bfc14ed5edec232b59,"Modified test for legal element names in <xsl:element>. The element name is
treated as an attribute value. Whitespaces are not allowed in plain text
element names, but should be allowed inside ""{...}"" attribute values.
PR:		Bugzilla 1489
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334948 13f79535-47bb-0310-9956-ffa450edef68"
1fb940933ef692837ec0be2ad9a6d71a909e43f3,"A fix for the preceding:: iterator
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334949 13f79535-47bb-0310-9956-ffa450edef68"
7e799830b3888603d2f99efefab3feebe8b1d38f,"Minor re-adjustment to last fix for preceding:: iterator
PR:		1407
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334951 13f79535-47bb-0310-9956-ffa450edef68"
b5a55a3774a2416ae979559f8257737e492ecf24,"Fix to prevent compiler warnings to be output more than once.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334952 13f79535-47bb-0310-9956-ffa450edef68"
7fb289795090de591b8cbea9f028e5c48b88bd40,"Final fix (for now) for attribute sets. In cases where multiple
<xsl:attribute-set.../> elements make up one attribute set (ie. they share
the same name) attributes that occured last in the stylesheet will take
precedence.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334954 13f79535-47bb-0310-9956-ffa450edef68"
e7304c8eba7c5414ef5baae19b1aaf995e9c0d6a,"Updated release number.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334955 13f79535-47bb-0310-9956-ffa450edef68"
2f04a1be38d0253d2ba37eaf36415deb0cd6aa19,"Updates for Xalan-J 2.2.D1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334960 13f79535-47bb-0310-9956-ffa450edef68"
f3f37df8af412b58744ef5152b9af12a9339243e,"DTM_EXP branch merge.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334962 13f79535-47bb-0310-9956-ffa450edef68"
04b59d011ded6058cb3ca70fec3d6908053a0da4,"added support for java.io.InputStream StreamSources


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334963 13f79535-47bb-0310-9956-ffa450edef68"
5e62be58fc0d3433922ff8cf1dcf075db0cf8a2b,"minor edits for Xalan-J 2.2.D1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334964 13f79535-47bb-0310-9956-ffa450edef68"
4d55a9a3edc5ca673b94d5267a267d8e4a1b0f42,"no message


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334965 13f79535-47bb-0310-9956-ffa450edef68"
0af6b0d19453067f9410ff6d804a7f0a43031530,"Made m_unreasonableId final.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334966 13f79535-47bb-0310-9956-ffa450edef68"
549c0eb73c5f8b87e032e1d8eb006791a15bf9dc,"Made m_expandedNameTable non-static.  This
fixes errors when reusing a transformer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334967 13f79535-47bb-0310-9956-ffa450edef68"
bc6e87f3f53ac62c398a590dbc5b839020765575,"Minor tweak.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334968 13f79535-47bb-0310-9956-ffa450edef68"
d92dc260ea59e1800614d0d09aa6f55471a3d40e,"Made class public.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334969 13f79535-47bb-0310-9956-ffa450edef68"
392cb34db33037a2cb0510d5f4f77766b56bde3d,"Create a new DTMManager in reset().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334970 13f79535-47bb-0310-9956-ffa450edef68"
cfb230d6c2812aa5cab64455d187829aad0234b6,"Had to clone the iterators in cloneWithReset.  Ugh.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334971 13f79535-47bb-0310-9956-ffa450edef68"
61c190b20e947388cf2975b041747d9c35addddf,"Moved the state snapshot stuff into a inner class on the theory that
it was causing a bug.  It wasn't, but having it in an inner class is nicer
anyway.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334972 13f79535-47bb-0310-9956-ffa450edef68"
b87aeef681e5710419b4cb7dd118ec11dd724ef9,"Have to push the default template for default character template.  Yuck.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334973 13f79535-47bb-0310-9956-ffa450edef68"
98546ed98f1c31e6463da8bd4f33a5387005e1b0,"Sort-of kind-of handle DOM1 by checking if getLocalName returns
null for elements or attributes, and, if it does, use getNodeName.

Joe, I guess we should think about some DOM1 compatibility.
(It's actually not DOM1, but addElement vs. addElementNS, I think).

This is needed to make stylebook run.
(Joe, we must of been drunk when we thought we had fixed it, or,
more likely, I somehow picked up a different version of the jar?)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334974 13f79535-47bb-0310-9956-ffa450edef68"
5158ac03e41d716804eb063a09b0551d900d1023,"Have DumpDTM go to a file instead of stdout.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334975 13f79535-47bb-0310-9956-ffa450edef68"
dae44dac0ee91576bb77dd8a3105268f8ccd3e62,"Fix for code handling logical expressions and combinations of logical
expressions. Mindblowing stuff, but it now seems to work as it should.
Added another few lines of code to properly direct the program flow in
compiled predicates with various combinations of ""and"" and ""or"" expressions.
PR:		Bugzilla 1511
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334976 13f79535-47bb-0310-9956-ffa450edef68"
615f0d43a32230b6bd0a44307b8edd385655b571,"Fix for singleton iterators encapsulating variable references.
PR:		Bugzilla 1412
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334977 13f79535-47bb-0310-9956-ffa450edef68"
d91c8161ebc4c636317759789b407228bdec3473,"Not that we're using it, but the DOM API is org.w3c.dom.ranges plural, not ...range singular.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334978 13f79535-47bb-0310-9956-ffa450edef68"
f866b27534d405322aec35ce85ec950191583245,"Misnamed package, org.w3c.dom.range should be ...ranges


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334979 13f79535-47bb-0310-9956-ffa450edef68"
7cf84e09d7ba6fb93adcb3a9c19f0df4f0c3c336,"Fix infinite loop with AVT with double curly brackets


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334980 13f79535-47bb-0310-9956-ffa450edef68"
a82c06f61c0c83abaacbecd6447d9e9c3adedcb9,"Single breakpointable point for error exits.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334981 13f79535-47bb-0310-9956-ffa450edef68"
a1bd72065a0bd76b621ae92157d03b923d25efc5,"updates for 2.2.D2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334982 13f79535-47bb-0310-9956-ffa450edef68"
befccaaafb4a6e0e85fbe49bd8f7687cf6a9bd50,"Added one-line fix to prevent null-pointer error. Simple code cleanup.
PR:		n/a
Obtained from:	suggestion by Guoliang Cao <cao@ispsoft.com>
Submitted by:	cao@ispsoft.com
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334983 13f79535-47bb-0310-9956-ffa450edef68"
f9f16c26360e644a0c5b099066a04ee86ae97885,"Remove unused stree import (since stree is no more!)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334984 13f79535-47bb-0310-9956-ffa450edef68"
f64ee6b5f6d31bd068edb0c49c47d2f397e946f0,"Fix docs compile error (extra space in comment closer)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334985 13f79535-47bb-0310-9956-ffa450edef68"
f9e19722d9389fc283a417dd55ea98ca6d156b91,"Update compatibility files so that they run with new DTM changes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334986 13f79535-47bb-0310-9956-ffa450edef68"
a1c409518b4fe5528f3e33998f331d381fda1f75,"Fix Bugzilla 1490; move return of cached foundFactory to
after attempting lookup of system property (this matches
DocumentBuilderFactory; in the future we'll be using the
xml-commons files, but we're not ready to integrate those yet)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334987 13f79535-47bb-0310-9956-ffa450edef68"
fd7a5de2d8001eee358c64fc95a9c4374bde27a5,"Missed a condition; this is supposed to advance from element to first attr,
as well as from attr to attr.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334988 13f79535-47bb-0310-9956-ffa450edef68"
85e5f68e7ede317a711cc52099a973bc51ff808a,"Deprecate the compatibility package.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334989 13f79535-47bb-0310-9956-ffa450edef68"
c424efb806db18d4812fb086727f38efe9003c2a,"Provide more meaningful error message.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334990 13f79535-47bb-0310-9956-ffa450edef68"
9d86f5bf1da4764671ff1f0e9b6e39a5f6f43f2f,"updates for 2.2.D2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334991 13f79535-47bb-0310-9956-ffa450edef68"
0546e5f80b62ab568b44f1aab5bd9a61b2182a9a,"DTM topic


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334992 13f79535-47bb-0310-9956-ffa450edef68"
514a5f73b1ad673fab64f475d25e61104e62bce1,"Renamed NodeSet to NodeSetDTM, and made NodeSet hold
DOM nodes, for extension compatibility.
Uncommented extensions.java.
Tweaked DTMNodeList so it calls runto(-1).
Enabled parts labled %DTBD%, which had to do with various aspects
of DTM to DOM conversion.
There still seems to be some problems with extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334993 13f79535-47bb-0310-9956-ffa450edef68"
aac48a1fa9fac402af3379d974ff11b36c28fe0c,"Resolved bugzilla bug 1830 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1830).
The EntityResolver in the primary XMLReader was not being propagated to the XMLReader created to handle the document()
function.  The routine to construct the new XMLReader now obtains the most recently used EntityResolver for this DTMManager, if any,
and carries that over to the new XMLReader.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334994 13f79535-47bb-0310-9956-ffa450edef68"
1e9f9e1a45235ac17e5365f93379cad17a0f93e1,"Enhancement to implement xalan:omit-meta-tag=""yes"" on the xsl:output element.  When specified,  no META tag will be created with the HTML output method, even if one should be created according to the XSLT
Recommendation.
This clears bug 1310 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1310).
Also, implemented fix in bug 2000 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2000) to avoid changing OutputProperties out from under the Enumeration.
We now enumerate a clone of the OutputProperties.
Retrofitted to the DTM merge.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334995 13f79535-47bb-0310-9956-ffa450edef68"
6934114880d40b739aaa2664e5cbc3f4860e43b1,"Resolve bugzilla bug 2098 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2098).
The routine checkForFragmentID was checking for an attribute of type ""ID"" instead of the ""id"" attribute.
Retrofit this change for the DTM merge.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334996 13f79535-47bb-0310-9956-ffa450edef68"
aacfd0d580411c379ae936e33c7891d46ddb1b19,"Fix to prevent compile-time null-pointer exceptions for certain logical
expressions. Some nexted AND-expressions would cause this error because
their true-list would not be backpatched. This would result in an
instruction list with one or more branch instructions with no target,
such as a GOTO(null) or an IFEQ(null) instruction.
PR:		none, bug found in test run and fixed immediately
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334997 13f79535-47bb-0310-9956-ffa450edef68"
1d79a2f21244c7cb2ab9d6c4f3e17d91e974b4f8,"update because of xalanJ2 changes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334998 13f79535-47bb-0310-9956-ffa450edef68"
b61ff65ff50dbbbffee5113f0eb37c8cd210deb0,"Fixed getNextAttribute to only work with an attribute;
Fixed DTMNamedNodeMap to call getFirstAttribute when it should;
Fixed old remnant from first DTM for getNodeValue, where it tried to
look to the next node for attribute values.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@334999 13f79535-47bb-0310-9956-ffa450edef68"
2db1dfe75d943082d40d8a993c60b25e22ce5424,"Added DTM to Javadoc package groups.
Dist now uses DITA doc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335000 13f79535-47bb-0310-9956-ffa450edef68"
c1c022b9ce9c5eb7e8d17cb2ab23471fe3da812d,"cleanup for 2.2.D2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335001 13f79535-47bb-0310-9956-ffa450edef68"
62408a7175bdb01e651c6bad48f14114ddd9af83,"Deprecation of Xalan-J1 API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335002 13f79535-47bb-0310-9956-ffa450edef68"
c5882f4361702c5977665b2927765cee0d2f7546,"Changed name of XObject#nodeset() to #iter(), and changed rtree()
to rtf, then added back nodeset() method to return a NodeIterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335003 13f79535-47bb-0310-9956-ffa450edef68"
2cc79f003856e4972535c6d48dc0c1733174d35f,"add Jacek and Santiago to list of developers


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335004 13f79535-47bb-0310-9956-ffa450edef68"
d8bcdb6c95cd765e4d67d5f50b5650e5860c1420,"Backout of previous change which is considered ill-advised.  The EntityResolver should not be automatically propagated.  Those wishing to do so should set up a custom URIResolver returning a SAXSource with an appropriate XMLReader.  See discussion and example code in bug 1830 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1830).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335005 13f79535-47bb-0310-9956-ffa450edef68"
bf29bfd15de70fd262ffa6a27bb48b2e942fd925,"Changes because of XalanJ2 updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335006 13f79535-47bb-0310-9956-ffa450edef68"
53f728cfc98fd8ccf297e8afb6451514b56187dc,"Update to D2 (skipped D1)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335007 13f79535-47bb-0310-9956-ffa450edef68"
ba3aada4dc2e87c4a2be470f11b97c65d68fc922,"Fixes for tooling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335008 13f79535-47bb-0310-9956-ffa450edef68"
aa7f73fc0457c381266a3f9d68f2d05e688e0934,"Add temporary root element to fix doc build problem (duh! oops!)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335009 13f79535-47bb-0310-9956-ffa450edef68"
f0eadbdddedfdd79ebf4f6c6de8e4fc82241e61f,"OK, I'm going to make a wild guess and assume that sboag's recent commit
of /NodeSet/NodeSetDTM/ got a little out of control and shouldn't have
gone down into org.apache.xalan.xsltc - undone to fix compile error


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335010 13f79535-47bb-0310-9956-ffa450edef68"
0bb2a39022a2936067fd1189fcda87e9eddeb406,"For compat.jar, put the new-built xalan.jar in front of the classpath.  If
you don't do that, compat.jar may not build due to conflicts with older
xalan jars that may be on the classpath.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335011 13f79535-47bb-0310-9956-ffa450edef68"
f31e30d7c83f6f3bfcdd6baaed0752c84777ed14,"Init m_predicateIndex to -1 instead of zero.  This should never
be >= zero unless executing in a predicate.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335012 13f79535-47bb-0310-9956-ffa450edef68"
7324da4c55da38d54f419dae985d88af9b65280c,"Tweak executePredicates to make sure that it never returns without
setting m_predicateIndex to -1 again.  This should fix the bug for
document2html.xsl for jakarta-avalon.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335013 13f79535-47bb-0310-9956-ffa450edef68"
c6450ec500eb6a64b8ebf19b0968e6ec725d3468,"Defensivly check for the context node list being null.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335014 13f79535-47bb-0310-9956-ffa450edef68"
770bcc254541c25c8aadcd55eccd0034f7e39e72,"Implement obj() as str(), since simply returning the FSB or char
array will not be complete.  This fixes bugs in some extension
functions, where the entire FSB was being translated into the
string value.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335015 13f79535-47bb-0310-9956-ffa450edef68"
03940b1315d3332d288bedf6610e4ab9c4c6c508,"Removing NodeSetType (renamed to NodeSetDTMType).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335016 13f79535-47bb-0310-9956-ffa450edef68"
1e47d7c5842c8d3654741871295370f8b7985d77,"PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335017 13f79535-47bb-0310-9956-ffa450edef68"
06bfa7c923f0aa9984b0e4abab124b7adf8aff23,"PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335018 13f79535-47bb-0310-9956-ffa450edef68"
5b684050d584ff99ba872c43c4de76be5d6b0419,"Check for zero length before sending a characters event.  This fixes
minor regression with string115, etc. where tags were not being
collapsed if empty.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335019 13f79535-47bb-0310-9956-ffa450edef68"
cc1a6379d3dbb01806b8da2a3fdcaa53da7801ff,"Exclude some of the newest attribset tests (for now)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335020 13f79535-47bb-0310-9956-ffa450edef68"
6bc385728be4e8ff60d4f1187e726a1cc993f4b6,"Setting validation to false by default to run with latest xerces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335021 13f79535-47bb-0310-9956-ffa450edef68"
a840d3a23ae47a07c0349c778cfafe19fa69637d,"Wait to flush startDocument until the another event (like startElement) is
seen.  This fixes problems with the xml header being sent out to
the result stream before the serializer is switched when the first
element is HTML.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335022 13f79535-47bb-0310-9956-ffa450edef68"
deaf1495d0e044aaa1cb8fdcac552c2e73617fa2,"In response to bugzilla bug #2124.  Don't set dynamic validation to
true if the XMLReader was handed in via a SAXSource.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335023 13f79535-47bb-0310-9956-ffa450edef68"
4321eefda469679b6615b84a71e0cfece5b052c9,"Fix for function calls used as clauses in logical expressions.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335024 13f79535-47bb-0310-9956-ffa450edef68"
918f730f10129a873ba11b515a6eea2f970295ff,"Have to send endCompose to the sort elements, or the mark
stack will not be properly popped.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335025 13f79535-47bb-0310-9956-ffa450edef68"
b6b6a5fc7dfcb48c489fa246ba80d0dfa02c4a9c,"Use asIterator instead of clone, since it is cheaper, and more likely
to be stable.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335026 13f79535-47bb-0310-9956-ffa450edef68"
d8584adb65d7c4ef11c0734022edcc87c9023db0,"Add getIndex accessor, so that the Variable hack can get to it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335027 13f79535-47bb-0310-9956-ffa450edef68"
0228e7ef2ab4c25f8be100236c1fa4e6dcff4103,"Send endCompose to the outputProperties, so that the mark stack
will be popped properly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335028 13f79535-47bb-0310-9956-ffa450edef68"
0f01bb5b28f7b6f2dd03417a39ece310e2ac398f,"In spite of the comment, whereever it came from (probably me),
reset really does have to call it's superclass reset.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335029 13f79535-47bb-0310-9956-ffa450edef68"
757b39011a1cb8072ba9538939e5a275480f76b3,"Set the base URL of the source.  If the systemID is not set in the
Source object, try and use the URL of the stylesheet.  If that is
null also, use the user.dir property.  Part of the fop codegen
fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335030 13f79535-47bb-0310-9956-ffa450edef68"
dd728cc8757318721b54a6a84cee9d05ec37b247,"Pass the extension element as the prefix resolve, instead of whatever
is pushed on the XPathContext stack.  The Variable hack needs this
to work correctly.

Comment out patch that makes the filename relative to the current
output URL.  Just to make fop codegen work.  This will need to
be commented back in, once we can get fop to change their
stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335031 13f79535-47bb-0310-9956-ffa450edef68"
0e872ea7af64b599eb0965597f2b92c23727dd07,"Fix strange clone of contained iterators.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335032 13f79535-47bb-0310-9956-ffa450edef68"
a9a22824d045c147f3673aa4048bf5f4bd49e7da,"Add iterRaw accessor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335033 13f79535-47bb-0310-9956-ffa450edef68"
c860bf1bc6338bcde686a293dc0992b93ecc8ae8,"Nasty hack.  The issue is that extensions are
building their xpaths on the fly, so they don't really
have a chance to fix up their index lookup for the
variable stack (this problem caught me a bit by
surprise).  The variable stack itself no longer has
any qname information... it's a straight index lookup
to the variable value.  In order to work around this
problem in the short term, I test whether
fixupVariables has been called, and, if it hasn't, I
take the current prefixResolver, *which must be
set to the extension element* (it wasn't in the
Redirect extension), test if it is a
ElemTemplateElement (bad because we're not
supposed to be coupled with the xalan package
in xpath), and look at the previous sibling and
ancestor previous siblings for a ElemVariable.
For each ElemVariable, I can then compare the
qname, and, if a match, get the index from that
element.  Right now it doesn't do anything special
for global variables, and so errors can occur in
this case if you have imports and includes and
the like.  The hack is good enough right now to
get fop codegen to work correctly.  I'll do some
more work on this next week, or someone else
can, and I'll try and figure out a way to do this
without the visibility to xalan.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335034 13f79535-47bb-0310-9956-ffa450edef68"
d59e6fd776479b8014e4f143e854bf24690ff11a,"Fix bug uncovered by Norm Walsh.  On call to function to test
for a proximity function, pass opPos instead of op (duh).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335035 13f79535-47bb-0310-9956-ffa450edef68"
072c0ae53b4aad23fcd22a1ce116fecf08f375ee,"Don't set dynamic validation for the source tree as per discussion with Thomas2.Maesing@bgs-ag.de
about bug 2124.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335036 13f79535-47bb-0310-9956-ffa450edef68"
6ec9d9c8dcbcd789c646e47fd951f5a9353ee334,"Commented back in URLs to be relative to result.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335037 13f79535-47bb-0310-9956-ffa450edef68"
0f362f6e8b301211a0384782fa6c8e9c130ce829,"Exp. to fix Adam Clarke bug with the DOM backpointer being out
of synch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335038 13f79535-47bb-0310-9956-ffa450edef68"
93eb2ad80bc9512998040117ab0108627b4c6b4d,"better list of developers


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335039 13f79535-47bb-0310-9956-ffa450edef68"
2be38666f2501f67c5b73fb8b99bf4bdf3851840,"Fix resource loading problem in Cocoon.
Note: this apparently fixes properly the fix that garyp attempted to
add 21-May-01; however JDK 118 and 122 behave differently when
calling getResourceAsStream, so in the 118 case I've had to
prepend a hard-coded / slash char: this should be reviewed later
PR: email on xalan-dev
Submitted by: dims@yahoo.com


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335040 13f79535-47bb-0310-9956-ffa450edef68"
4bb168115279c9b2c219d11560d63de39bfd1ca6,"Fix for Tooling problem. We need to push the current ElemTextLiteral in the currentElements stack


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335041 13f79535-47bb-0310-9956-ffa450edef68"
674bea9f5d0c0a0e0320204e9b4e2715216f32ca,"Set the context node list for the root transformation, so the TransformState stuff
doesn't complain.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335042 13f79535-47bb-0310-9956-ffa450edef68"
9c837ede979d49c939c4bf14959689490ea86776,"Fake checkin to test CVS potential locking problem (sorry!)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335043 13f79535-47bb-0310-9956-ffa450edef68"
0584d5c78536bc3927b63b60cef256e02b317684,"Make a default public constructor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335044 13f79535-47bb-0310-9956-ffa450edef68"
b95d1c87df6d6c5df6a3ef844f47c3f732846601,"In the FilterExpressionWalker, use asIterator instead of execute/setRoot,
as it is saver.

In XNodeSet, always do a cloneWithReset, as it is safer.

These are the fix for the Norm Walsh bug posted 06/20/2001 01:36 PM.
Either of these by themselves will fix the problem.  But I'm worried
the FilterExpressionWalker fix by itself will leave exposures elsewhere.
The XNodeSet fix will allow for absolute safety, but is much more
expensive... using asIterator where we can will compensate for
this by avoiding an XObject/XNodeSet altogether.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335047 13f79535-47bb-0310-9956-ffa450edef68"
bb6b8a0e87f0312b20ff32c9b3a66bb2544c5d5b,"Add SuballocatedIntVector -- much faster add at cost of slower elementAt.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335048 13f79535-47bb-0310-9956-ffa450edef68"
5f97814dc698045c86c8ab970c35e4230e29d5f8,"Cutover from realloc'd arrays to SuballocatedIntVector. Should improve build speed of larger docs, at slight cost in retrieval speed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335049 13f79535-47bb-0310-9956-ffa450edef68"
e2b54b41b4979a2e1f1ec9a86f0a4be34dc9f327,"Just comment.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335050 13f79535-47bb-0310-9956-ffa450edef68"
9f325d3154dcf7318207d9f54821621ceac5e148,"Remove unneeded import.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335051 13f79535-47bb-0310-9956-ffa450edef68"
392223645a68c617cac6d51c16b13e2731916654,"Class rename


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335052 13f79535-47bb-0310-9956-ffa450edef68"
204e5d97f932c8166e7b65b924f74ffcd43c5cad,"Like SuballocatedIntVector, but for byte values.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335053 13f79535-47bb-0310-9956-ffa450edef68"
13deb24a60ee4693b475787e23ccbc15dd76176c,"Minor javadoc tweak


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335054 13f79535-47bb-0310-9956-ffa450edef68"
0910f48520508be69c28cfd8a9a50ad484ede5b7,"Updated flags for boolean attributes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335055 13f79535-47bb-0310-9956-ffa450edef68"
6cf5cb922ba92a13d03dd0cef321ac6df478fb8f,"Replace the explicitly (and inefficiently) reallocated
byte[] m_level with a SuballocatedByteVector. Faster build
(especially on large documents), slightly slower retrieval.

Note that we may phase this field out and go back to computed
level, since recent changes to other parts of Xalan make fast
retrieval of level less critical.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335056 13f79535-47bb-0310-9956-ffa450edef68"
9e142db5ce3d7dc9e185e344fdd01aca19876ef6,"Remove deps on xerces1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335057 13f79535-47bb-0310-9956-ffa450edef68"
be937e6f6f0ef514848422a4f0fd21451ce208d0,"Fix some minor problems caused by Costin's changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335058 13f79535-47bb-0310-9956-ffa450edef68"
8b1119227db3732bcba15846c4a6f26ecaa995ff,"In setCacheNodes, don't replace the current m_cachedNodes if
it is non-null.  This fixes a bug with the NodeIterator/NodeSet
adapters.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335059 13f79535-47bb-0310-9956-ffa450edef68"
a06e30cbba8a49b62aa4fd4f85611b21299e59c3,"Minor cleanup.  No changes of substance.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335060 13f79535-47bb-0310-9956-ffa450edef68"
6832396c3d4a199769bef16cad69b4b9ff4e9458,"In getDTMHandleFromNode, if a DTM has to be created, create
it from the ownerDocument instead of the node argument.  I think
this will avoid a lot of problems with node identity coming from
extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335061 13f79535-47bb-0310-9956-ffa450edef68"
7931a81c116831e5d5e4335c964b0f54f47f491b,"Dump the filename in addition to line and column number.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335066 13f79535-47bb-0310-9956-ffa450edef68"
ba13bea236d621791ffcf3449822f5eee1d7a764,"Address bug reported by Norm Walsh (Bugzilla Bug 2275 Xalan doesn't fire the right templates).

Regression test for this bug is new position80.

The union pattern wasn't firing correctly.  This was caused by an
optimization that occured where we tried not to clone the iterators
in the UnionIterator clone function.

There were also some problems with gettting the last node count.
Fixing this uncovered another problem with a previous fix to
LocationPathIterator where the cachedNode list wasn't being
created if it was already non-null.  This was fixed by making sure
the list is reset (but not reallocated) in the WalkingIteratorSorted.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335067 13f79535-47bb-0310-9956-ffa450edef68"
d1718bd31d38be8ea85d47c4e878e5b4a6bf38cf,"Fix set attribute so that it doesn't throw an exception when you
pass FEATURE_INCREMENTAL (it was missing an 'else').
Make FEATURE_INCREMENTAL and FEATURE_OPTIMIZE
public.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335068 13f79535-47bb-0310-9956-ffa450edef68"
54dfc6469438164fd93a40c3594c0fcbfba7ebab,"If an output files is not passed in and the output is stdout, then
turn the incremental feature on.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335069 13f79535-47bb-0310-9956-ffa450edef68"
c094029bddbf419f1b16bff05c2375f9e2fe6341,"Added RemoveAllNoClear, method which resets
the size of the vector to zero, but doesn't
null out the items.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335070 13f79535-47bb-0310-9956-ffa450edef68"
270543dc0025156827ecb1644acc607f0dc03efe,"In co_yield, comment out throw of the shutdownException if
(arg == null).
You can replicate this sometimes with:
testo attribset\attribset01 -flavor th -edump
Since I'm not sure what good it does to throw a shutdown
exception here, and it certainly does harm,
I'm simply commenting it out for the time being.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335071 13f79535-47bb-0310-9956-ffa450edef68"
153acf1a1234fc470c54bf214d8899c21261b71e,"In IndexedDTMAxisTraverser#getNextIndexed, the check for
axisHasBeenProcessed has to be done after the
findElementFromIndex, but before the nextNode() call.  This
fixes several failures in the s2s test.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335072 13f79535-47bb-0310-9956-ffa450edef68"
9741c2b2c9fa5af5938e78770c02470b7252c15e,"Comment out the co_yield in setDocumentLocator, since this can
cause a hang (since it doesn't do anything to construct the
document.

Also, set the frequency down to 5.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335073 13f79535-47bb-0310-9956-ffa450edef68"
57424947bc4fd41b3d4cb5d629f04c04d2c350cc,"These checkins fix http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2005.
 Null-pointer in XPath with serialized Templates ( org.apache.xalan.templates.StylesheetRoot ).
At least they fix things enough to pass Shane's tests.  There may
be more to come...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335074 13f79535-47bb-0310-9956-ffa450edef68"
a88184a1fd5141ab568e7456442a54cd9e976d04,"added check to see if stylesheet is already an URL


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335075 13f79535-47bb-0310-9956-ffa450edef68"
111272e74432874eec4929fcb87aa59c7df7d715,"proto


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335076 13f79535-47bb-0310-9956-ffa450edef68"
072df2caaaef3c93643a61b535035008938718dc,"removed debug statements


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335077 13f79535-47bb-0310-9956-ffa450edef68"
c5631b9f43af66f107e46eff022e4e8f81cdb1c4,"Updated Development version number from 2 to 4.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335078 13f79535-47bb-0310-9956-ffa450edef68"
b6814b60d9b7e75fac1f0544e5ed9aa4e93edc00,"Updated Development version number to 4.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335079 13f79535-47bb-0310-9956-ffa450edef68"
b03fb8920fae8fc3cc4f827d558cef74a172ebeb,"Update setAttribute to accept either Boolean or String values;
Updated javadoc; implement getAttribute to at least throw exceptions
describing what attributes are recognized or not


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335080 13f79535-47bb-0310-9956-ffa450edef68"
16e6d788052d5e60ccec3088de1579ead2500c25,"Release notes for 2.2.D4


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335081 13f79535-47bb-0310-9956-ffa450edef68"
532c2c9021566d53fc97630e7132af7722018c39,"Call clearCoRoutine in fatalError, as part of the solution to not hang
when an error occurs.

If an error handler is not set, send a message to System.err.  I
am somewhat undecided about this.  I think it probably needs
more work.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335082 13f79535-47bb-0310-9956-ffa450edef68"
eb7831808d4531531612b4132a4195d2e8513c0e,"In _firstCh and _nextSib, fix so that loop will terminate if, after doing
a nextNode, the value is still in an unresolved state, and isMore is
false.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335083 13f79535-47bb-0310-9956-ffa450edef68"
603b664ebbf514b73fd42f672ad97ffcafb1eca7,"Updated version property to 2_2_D4 and year to 2001.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335084 13f79535-47bb-0310-9956-ffa450edef68"
c84cdc5db05ec52532f6fd9e989f2bdabc7a03be,"in process of moving these to new subdir


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335085 13f79535-47bb-0310-9956-ffa450edef68"
3139e546b2ae14a80c6e138c0f3ceb1f24303e02,"moved from runtime subdir to its own trax subdir


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335086 13f79535-47bb-0310-9956-ffa450edef68"
0e3d926a36c10cdda97ec3e3a676c276060b9b77,"Remove check for nParams > 0 in transformSelectedNodes in the loop where
we're setting the params, because otherwise the param won't
be nulled out, and xsl:param won't execute the default select.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335087 13f79535-47bb-0310-9956-ffa450edef68"
c93709c39eed75a0fa67181ddc355d7a7056d86e,"Add getIncremental function.  Synchronize both get/setIncremental.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335088 13f79535-47bb-0310-9956-ffa450edef68"
799637a6b534eda469c724a7a057776424f53f6b,"If the reader == null, we need to ignore the this.m_incremental flag.
This is so we make sure we create a CoRoutineParser from the
TransformerImpl.  Otherwise we'll not have a CoRoutineParser, and
we'll end up with wild racing threads... not a good thing.
This should hopefully fix Don's problems with the dita build, and
will probably also fix about a zillion problems with Cocoon when
running Xalan.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335089 13f79535-47bb-0310-9956-ffa450edef68"
69c68a46a115e69d19b44e00e865d63f149f393c,"If we are in a condition where the parser threw an exception,
we have to make sure that doMore doesn't call to wait on
the other thread, so in this case we first clear the parser
thread from the CoRoutine manager.  If we don't do this, the
handler will hang if an exception occurs (once the CoRoutine
problem was fixed!).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335090 13f79535-47bb-0310-9956-ffa450edef68"
21971f9859b1490f571424d8fd5301c0d89e2b58,"Oops!  Left a debug statement in.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335091 13f79535-47bb-0310-9956-ffa450edef68"
be0d827a1b50c9810a7252b0d10d48f7c3d4fc6a,"Send the errors to the error listener instead of trying to do a
println to System.err.  This is still a bit funky, but I think it will
do for now.
This stuff has to be worked through better with JAXP 1.2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335092 13f79535-47bb-0310-9956-ffa450edef68"
3ce0c97fd0def0c656feeda3ea0d16a638aec257,"Send the errors to System.err instead of System.out.
Have the SAX handler functions go ahead and print the
error message.  I think the ErrorListener functions should do
this also, but I'm afraid I'll cause a regression somewhere if I
mess with this.
The responsibility of who should print the error... the error handler
or the exception catcher is way too fuzzy... we need to crisp this
up for JAXP 1.2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335093 13f79535-47bb-0310-9956-ffa450edef68"
503d7fda2250a6911b8fe1e3263388b8094d8b4a,"Fix bug where getNodeName doesn't work properly for
non-named elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335094 13f79535-47bb-0310-9956-ffa450edef68"
6b91e075ae87eb0dbab6187f161c7da40081cd47,"Use && instead of || for ((null == reader) && incremental)...
(regression from previous version).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335095 13f79535-47bb-0310-9956-ffa450edef68"
865288b6372d18890ad521cfe0e9388c78e757dc,"For the select event, print node handle and node name (DOM style)
instead of java toString on node proxy!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335096 13f79535-47bb-0310-9956-ffa450edef68"
dafbf055f39012d17a90a38729dd5931d8b1680a,"Comment out || ((null == reader) && incremental)
... I've changed my mind about this.
If incremental is off the TransformerHandlerImpl
shouldn't be threaded at all.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335097 13f79535-47bb-0310-9956-ffa450edef68"
d63810548b97606687fa740b25b62529b1fca8cc,"Don't do printStackTrace in run() exception handler... this should
be handled elsewhere.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335098 13f79535-47bb-0310-9956-ffa450edef68"
2f624b8e78d57efbe44c904ea39d2749f4a2f2f2,"If the incremental flag is off, then don't use threads at all...
tweak stuff in clearCoRoutine so that we call waitTransformThread,
so we don't exit before the transform thread has finished.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335099 13f79535-47bb-0310-9956-ffa450edef68"
8074200a0beff757de38d47266e33b4fa6a363ca,"fixed bug with deriving translet name from
stylesheet name that included paths, e.g. /tmp/foo.xsl


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335100 13f79535-47bb-0310-9956-ffa450edef68"
41ae5b069264cd92858c5198fb15fe0c1ab539c6,"Corrected vendor-url to point to Xalan-J 2, not Xalan-J 1!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335101 13f79535-47bb-0310-9956-ffa450edef68"
a1974f1032d097cab120571ec4441a202e1c1fdd,"This update allows variables that contain references to result-tree fragments
to be used inside position filters.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335102 13f79535-47bb-0310-9956-ffa450edef68"
0e83bc128b287340a3b474591a3f5164e1d4abe9,"Namespaced nodes were returning the qname as the string value.
Just return an empty string for elements whose first child is null.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335103 13f79535-47bb-0310-9956-ffa450edef68"
e9cf07e3a36b4cbc5e6aae0ffeed87358c7cb058,"added url handling in doTransform


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335104 13f79535-47bb-0310-9956-ffa450edef68"
8d88e4570b39368a1153c2816dc5b142a28e40b3,"added a new sys property called 'transletPool'
to allow user to set the destination directory for generated translets


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335105 13f79535-47bb-0310-9956-ffa450edef68"
d935458b42587cfb6ada4b4d83224cba9bf17f09,"made private method setDestDirectory() public to
support the new transletPool system property.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335106 13f79535-47bb-0310-9956-ffa450edef68"
29ed514def5eae0846e150628840974394c5c11d,"Fixed anchors and use of <code> to enable transformation to DITA
along with the ""standard"" Xalan xml sources.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335107 13f79535-47bb-0310-9956-ffa450edef68"
01c52684a30c61bb1882659128e8123e0efde5ef,"Fix ArrayOutOfBounds Exception. Don't use owner document for DocumentFragments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335108 13f79535-47bb-0310-9956-ffa450edef68"
379fc48ac1e01fd82732e68e34fb72e1b2ac409b,"Various bugfixes in the way auxiliary classes access variables/fields in
the main translet class. Fixes a few VAR tests and customer tests.

Pmorten@xml.apache.orgR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335109 13f79535-47bb-0310-9956-ffa450edef68"
b8de5f704bdbeaa114e5ec57a2ef894623363c71,"Make sure we get the template mode for the trace event.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335110 13f79535-47bb-0310-9956-ffa450edef68"
c568774991b534b27f7feb1b1f10f180e9175f01,"Fix for element-available() and function-available() calls. Ties these
calls to tables in the XSL parser and the symbol-table (the actual
implementation) instead of using redundant and not-up-to-date tables
in the classes that implement the X-avaiable() calls.
I also cleaned up the Choose call so that it now properly handles
all types of function calls in the xsl:when elements' test clause.
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335112 13f79535-47bb-0310-9956-ffa450edef68"
f35af1f2961622dc837270735346013c136eff7d,"Add getVariable(QName qname) method, for reply to bug 2355.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335113 13f79535-47bb-0310-9956-ffa450edef68"
85904bc839d02f0f221eef4dd388fb7628a81714,"Added a fix for local variables inside nested xsl:for-each elements.
Local variables are usually not initialized to any default value (such as
with general Java classes), because code compiled for <xsl:variable>
elements always assign values to variable slots before they are accessed.
But the code structure generated by nested <xsl:for-each> elements is too
much for the JVMs verifier to get around, so we have to initialize all
local variables inside such loops to zero, false, null, whatever.
This takes care some of our runtime-errors caused by apparent corrupt code.
(The JVMs verifier thinks that it is corrupt, but it isn't really.)
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335114 13f79535-47bb-0310-9956-ffa450edef68"
686a06bd2b239c6915819551936353daebac038a,"Exclude processorinfo03 since it is processor dependent.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335115 13f79535-47bb-0310-9956-ffa450edef68"
3916528fa87695abc837d0f1a6b5ac915a7de09b,"Change getHandleFromNode(Node node) to call nextNode.  Should
fix bug with XPathAPI (and extensions) where element out of bounds
exception occurs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335116 13f79535-47bb-0310-9956-ffa450edef68"
fcd5f4d2424e0f2247ffe68c1ec731d7f5c465ab,"Make sure all the _xxx functions check that nextNode didn't do
anything even if it returns false.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335117 13f79535-47bb-0310-9956-ffa450edef68"
efe93db64feaa4e46c899ec0b3397d296af64fb2,"Do some extra diagnostics checking in getHandleFromNode.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335118 13f79535-47bb-0310-9956-ffa450edef68"
2d1ce2979d704e41dc791b017a59b5dcd8521d2a,"Implement extra DOM3 methods (as not implemented methods),
even though we're not compiling against the DOM3 API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335119 13f79535-47bb-0310-9956-ffa450edef68"
8efde071405c8f9c582cb278c2358d3d33bdcbeb,"Up the development number.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335120 13f79535-47bb-0310-9956-ffa450edef68"
3ab205fe4805b91103bc31966eb34ea2fa637fad,"Use the proper constructors for generate events for start and
and element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335121 13f79535-47bb-0310-9956-ffa450edef68"
7813796a491db5cdcafa26d654f3b2f9f450daa6,"Updates on XSLTC


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335123 13f79535-47bb-0310-9956-ffa450edef68"
679d28a9acbae96d7735a33b4475eccd513f3ca6,"Updates on XSLTC


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335124 13f79535-47bb-0310-9956-ffa450edef68"
c12c28ab81d88ca4aadbafcbade692a06fc250ad,"Don't do the exception for creating a WalkingIteratorSorted if
there is a filter expression (in other words, having a filter expression
shouldn't make a difference if the paths criss-cross).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335125 13f79535-47bb-0310-9956-ffa450edef68"
968684817a30667d96fdf0a65fa906d21799b124,"For isNodeAfter, always return false if the DTM IDs are different.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335126 13f79535-47bb-0310-9956-ffa450edef68"
bb300dc2c7cc735e86af9790bb156502a961d810,"Moved STATUS into readme.xml and added bug fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335127 13f79535-47bb-0310-9956-ffa450edef68"
222299abff85057f21410830932e9f18d4cfdb53,"Update on DTM


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335128 13f79535-47bb-0310-9956-ffa450edef68"
b933ef60d38b17c5314029257af17161603d0f62,"Version 2.2.D5


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335129 13f79535-47bb-0310-9956-ffa450edef68"
9fa571cc8a26493835acccf57e2d4835a8120af1,"Just check for null for the prefix in start/endPrefix mapping, and
resolve it to """" if it is null.  The SAX2 javadoc is not explicit that
it should be """" for the default namespace, so this seems like a
reasonable thing to do.  The alternative is to throw an exception, but
if we don't do something, the local-name() function will not do the
right thing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335130 13f79535-47bb-0310-9956-ffa450edef68"
c20d9d1f358b5fefc9d067097fcd130a2e1bd1c4,"Up the development version number to 6.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335131 13f79535-47bb-0310-9956-ffa450edef68"
1f89972dfd5e6b89e1af7eff47a9deac4d745a48,"Version 2.2.D6


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335132 13f79535-47bb-0310-9956-ffa450edef68"
87e990ee401334b852c7f13bdbc83b92a619f2ec,"Xerces 1.4.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335133 13f79535-47bb-0310-9956-ffa450edef68"
223b6b16b9fcb623372e7058deb8ce8a3afc84c2,"Corrected comment and indicate (for user) where the output is.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335134 13f79535-47bb-0310-9956-ffa450edef68"
97583f17976a296a7b1d59a08fbf9388d956c389,"Editorial updates for 2.2.D6.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335135 13f79535-47bb-0310-9956-ffa450edef68"
0421c424e722b5d7257f0fabd15393cf7c9358f2,"Since the real root of our tree may be a DocumentFragment, we need to
use getParent to find the root, instead of getOwnerDocument.  Otherwise
DOM2DTM#getHandleOfNode will be very unhappy.
Result of report via private mail by Carsten Ziegeler of breakage
in Cocoon.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335136 13f79535-47bb-0310-9956-ffa450edef68"
55a0e9d57b8623357a347cd04819249b74122907,"Made m_maxCharacter, accumDefaultEscape,
accumDefaultEntity, and m_isRawStack
protected by request from Johannes Farrenkopf
and Frank Nestel.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335138 13f79535-47bb-0310-9956-ffa450edef68"
104110251979d0aef502f0f7c4b1c4074dd437cf,"In executeCharsToContentHandler check first for
DTM.NULL before trying to get the DTM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335139 13f79535-47bb-0310-9956-ffa450edef68"
216e9a0f472e947978d9a78f3a1fc508a7e7a00f,"Fix bug reported by ""Carsten Ziegeler"" <cziegeler@sundn.de>.
Test for this is whitespace23.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335140 13f79535-47bb-0310-9956-ffa450edef68"
8cacba24eefe88c008be63ef497cf66eae354823,"Drop some bounds tests for cases which shouldn't arise in the first place, since this is an inner-loop method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335141 13f79535-47bb-0310-9956-ffa450edef68"
de0d6cc8ab95c2f4d54ca62788e0c9a5ce7b4941,"Synch SuballocatedByteVector with changed SuballocatedIntVector


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335142 13f79535-47bb-0310-9956-ffa450edef68"
ef676e6dad16f10757d36ae72958c88060795965,"Revert back to throwing a shutdownException if (arg == null) in co_yield.  I see this
occur if the parser is Crimson with output\output01, and it causes
a hang if the shutdownException is not thrown.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335143 13f79535-47bb-0310-9956-ffa450edef68"
2e40cbfd223b4e3dd516aa424b998bfbb470c877,"Make accumDefaultEntity and accumDefaultEscape non-final.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335144 13f79535-47bb-0310-9956-ffa450edef68"
6d96cad68aec5f9a4c7c0c773c280f8fac03028c,"Fix for John G. for the SQL extension: handle return types of
DTM and DTMAxisIterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335145 13f79535-47bb-0310-9956-ffa450edef68"
92100645900fcb3fcff30986745ec5dc698c3507,"Loads of small fixes and a good few comments added to the source code.
The major fixes are one fix for variable/parameter handlingi and one for
key/id index handling. XSLTC now correctly updates the value of parameters
with changing default values, such as with
<xsl:param name=""foo"" select=""current()""/>.
Also updated bit-arrays to correctly return single node ids, so that the
key() and id() functions return the correct number of nodes (they would
sometimes skip the first node in the defined node set for the key/id).
Added some structure and loads of comments to the Translet base class.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335146 13f79535-47bb-0310-9956-ffa450edef68"
49643e119fd07a1a0f297a9d0c73a43b83f87885,"In executeChildTemplates, somehow there was a popMode without
a corresponding pushMode.  The pushMode was added.
Addresses bug posted by Stephane Bailliez <sbailliez@imediation.com>
on the xalan-dev list on 07/09/2001 07:28 AM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335147 13f79535-47bb-0310-9956-ffa450edef68"
a157b87dc88b06722831d950c4da7f105d5caba0,"Correct typos reported by Alexey Mahotkin <alexm@hsys.msk.ru>


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335148 13f79535-47bb-0310-9956-ffa450edef68"
6462fdc0fa14ed7d36b46bc717d3c8e87efee103,"Resolve bugzilla 2355 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2355>.  To make the functionality clearer, I've changed the method name from getVariable to getVariableOrParam since the routine will pick up either one.  Also fixed a bug  where top level variables and parameters were not getting marked as such.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335149 13f79535-47bb-0310-9956-ffa450edef68"
95b230e919f89364bdb8c0ca3df2c28e85eee840,"Resolve bugzilla 2523 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2523>.  evaluate extension function was not refactored with DTM.  Also need to add function to XPathContext.XPathExpressionContext to allow an extension to obtain the associated XPathContext.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335150 13f79535-47bb-0310-9956-ffa450edef68"
32d05a2ffa70483c7a2078892265f790e0d61b52,"Fix problem with descendant-or-self and from root pattern. When from root, descedant or self was not recognized.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335151 13f79535-47bb-0310-9956-ffa450edef68"
733920dd568e9311fbec31f9b62977367a7b3366,"A wide range of fixes provided by Erwin Bolwidt.
 o) fix for long IF and GOTO instructions inside translets.
    'wide' GOTOs are now used (GOTO_W) instead of plain GOTO
    to allow longer jump offsets
 o) fix for illegal field/method names in the translet.
    Methods and fields no longer contain the '.' or '-' characters
 o) source filenames (and if possible also line numbers) are now
    provided with error and warning messages
 o) external functions that are not supported by XSLTC do not cause
    compile errors. They will still cause a warning message at
    compile-time if they are not wrapped in proper <xsl:if> or
    <xsl:when> elements that test on the availability of the function,
    and will cause a runtime error if the function is attempted called.
 o) added type cast from reference-type to node-type
 o) some other smaller fixes to prevent null-pointer exceptions
Other changes:
 o) code cleanup and some added comments
PR:		n/a
Obtained from:	n/a
Submitted by:	Erwin Bolwidt <ejb@klomp.org>
Reviewed by:	Morten Jorgensen <morten@xml.apache.org>


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335152 13f79535-47bb-0310-9956-ffa450edef68"
96f16febc73bc23250c5f2f7932b21ca6346b318,"Quick patch to handle case where someone wants to build a DTM from
an Element rather than from a Document. The Attr handling might want to
move down into addNode.

This opens several cans of worms -- what if the next user wants the
root of their DTM to be an EntityReference node, which has no DTM
node equivalent -- but we'll eat those when we get to them.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335153 13f79535-47bb-0310-9956-ffa450edef68"
aa59253a64f34db76688592bb49b1c75bb3da0d5,"Modify distinct() extension so that it no longer relies on DOMHelper which is deprecated but uses ExpressionContext.toString().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335154 13f79535-47bb-0310-9956-ffa450edef68"
1055b59edbbfc7481e92df7395d0f71bfc08958a,"Application of patch submitted by Ovidiu Predescu <ovidiu@cup.hp.com>
for file, line, column number information for XML source document.

[A made one change: m_sourceSystemId, m_sourceLine, and
m_sourceColumn are not created with the member variable
initializer, since they are initialized in setProperty.]

The following patch is a rework of a previous patch I've submitted on
May 24 against the Stree model, current at that time. This time the
patch is against the DTM model, and makes use of DTM features to
optimize the lookup time and storage requirements. I hope this time
the patch gets incorporated in the CVS repository, before any major
rework happens again ;-).

As with the previous patch, there is no overhead in space or time if
source information is not needed.

From a user perspective, this feature can be turned on by passing the
-L flag to Xalan when invoking it from the command
line. Programmatically you can also enable it by invoking the
setProperty method on the TransformerImpl:

  TransformerImpl impl = ((TransformerImpl) transformer);
  impl.setProperty(org.apache.xalan.transformer.XalanProperties.SOURCE_LOCATION,
                   Boolean.TRUE);

A Transformer ""property"" is different from a ""feature"": while a
feature is specific to all the transformer instances and usually
refers to an implementation aspect, a property is a runtime capability
that is set per Transformer instance. Currently the only property
added by this patch is the source location in the XML source document.

The patch adds two methods to the DTM interface:

  public void setProperty(String property, Object value);
  public SourceLocator getSourceLocatorFor(int node);

The second method is used to obtain the source location given a node
handle.

There are two ways you can make use of the source location. The first
one is from within a stylesheet, where you can have something like
this:

<xsl:stylesheet
  xmlns:xsl=""http://www.w3.org/1999/XSL/Transform""
  xmlns:nodeinfo=""xalan://org.apache.xalan.lib.NodeInfo""
  version=""1.0"">

<xsl:template match=""*"">
 //node <xsl:value-of select=""name()""/>
 //file <xsl:value-of select=""nodeinfo:systemId()""/>
 //line <xsl:value-of select=""nodeinfo:lineNumber()""/>
 //column <xsl:value-of select=""nodeinfo:columnNumber()""/>
 <xsl:apply-templates/>
</xsl:template>

</xsl:stylesheet>

If no arguments are passed to the systemId(), lineNumber() or
columnNumber() functions, the corresponding information of the current
context node is returned. A node can be passed as argument to the
above functions, in which case the corresponding information about
that node is returned. If a node set containing multiple nodes is
passed as argument, only the information of the first node in the set
is returned.

The second way of obtaining the source location is
programmatically. Given a Node instance, one can obtain the owner DTM
and the node handle (an integer) that represents the
node. Unfortunately I didn't see any way of hiding this: if you find
one please let me know and I'll fix it.

The following example is extracted from PrintTraceListener and
illustrates the API:

      Node sourceNode = ev.m_sourceNode;
      int nodeHandler = ((DTMNodeProxy)sourceNode).getDTMNodeNumber();
      SourceLocator locator = ((DTMNodeProxy)sourceNode).getDTM()
        .getSourceLocatorFor(nodeHandler);

      m_pw.println(""Selected source node '"" + sourceNode.getNodeName()
                 + ""', at "" + locator);


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335155 13f79535-47bb-0310-9956-ffa450edef68"
f142a7403cd9349e2e9eabdaa5dc6b7b08fc0373,"Fix bug 2175 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2175> by adding the current time to the method key to ensure method key uniqueness.  Multiple Compilers were getting the same hashCode, particularly in Visual Age for Java, due to aggressive garbage collection.  Added the current time in mills to distinguish between the different functions being compiled.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335156 13f79535-47bb-0310-9956-ffa450edef68"
d50734f48582156531ee0f2f0a950bc5e8280242,"Resolve bugzilla 2355 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2355>.  Added code to populate m_index for global variables and parameters.  If the backward search for templates reaches the top level, use the list of composed top-level variables and parameters from StylesheetRoot.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335157 13f79535-47bb-0310-9956-ffa450edef68"
683b8e5a8420f4001dfd165190546562b3f26cb9,"Now implements DocumentFragment.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335158 13f79535-47bb-0310-9956-ffa450edef68"
35d79777b8e3c6b92afa5cb8cb73a17212f6d24c,"Updated version property to 2_2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335160 13f79535-47bb-0310-9956-ffa450edef68"
9f467f3306098e43f3348a9c56a493ab6959fd0d,"Updated version to 2.2.0 and removed traxsamplenote about
requirement for a JAXP 1.1 parser..


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335161 13f79535-47bb-0310-9956-ffa450edef68"
53aff944ea5c43564d53f8ccfa39697186841e75,"Updated version to 2.2.0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335162 13f79535-47bb-0310-9956-ffa450edef68"
b1018cfbf5395ecc75991bb62149ec6c36134d0e,"Updates for 2.2.0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335163 13f79535-47bb-0310-9956-ffa450edef68"
eee170b1c4c84cfb5cdcb3017263452b41c83946,"Update from Notes agent for 2.2.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335164 13f79535-47bb-0310-9956-ffa450edef68"
0671316a1262ac0fcc9b2389d52a59bf85c264c1,"Adjusted placement of history of XSLTC updates, to be integrated
with the overall XSLTC release notes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335165 13f79535-47bb-0310-9956-ffa450edef68"
95820dd7559452d420fdf17dbc7143136f1f86ca,"Fixed very ugly bug, left-over from DTM1, in getValue, where +1 was being added per the old attribute structure of DTM1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335166 13f79535-47bb-0310-9956-ffa450edef68"
ebb57e12746d4c549ee2522ca4ce97a74fce6006,"First round of changes to port DOM mode to DTM Mode
PR:
Obtained from:
Submitted by:	John Gentilin mailto://johng@apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335167 13f79535-47bb-0310-9956-ffa450edef68"
8854de53f16706f2a9427eeaaf9a1e0bdc56a469,"Cleaned up the XSLTC compiler class in an attempt to make it more flexible.
This class was originally written as a command-line interface, but it has
now grown huge and messy. I separated the command-line stuff from the
methods that make up the actual functionality and made some methods public.
This is part of the preparation for our new implementation of the JAXP
Templates object.
PR:		n/a
Obtained from:	n.a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335168 13f79535-47bb-0310-9956-ffa450edef68"
140b0ddfed0a2d3b8316c8cff2b177a892c6aaff,"Extracted the command-line stuff from the core XSLTC packages. The command-
line handling is now in xalan.xsltc.cmdline.Compile and
xalan.xsltc.cmdline.Transform. The command-line stuff is still left in
xalan.xsltc.compiler.XSLTC and xalan.xsltc.runtime.DefaultRun for backwards
compatability. This should be removed shortly.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335169 13f79535-47bb-0310-9956-ffa450edef68"
1aa5ad987cad689453757f99690f9af5fc15bcfc,"Moved the org.apache.xalan.xsltc.util.getopt package to
org.apache.xalan.xsltc.cmdline.getopt. Also added some skeleton
code in a new org.apache.xalan.xsltc.trax directory.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335170 13f79535-47bb-0310-9956-ffa450edef68"
a3447871e56d52c08da9b4950421b9db20deb7a3,"minor adjustment
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335171 13f79535-47bb-0310-9956-ffa450edef68"
1f7048fab973ee7c6cb9d4b892808bb866b98d86,"removed obselete try/catch


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335172 13f79535-47bb-0310-9956-ffa450edef68"
fa2c2ec1656221c4708255743e3f0108d05350b7,"A first stab at our new TrAX design.`
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335173 13f79535-47bb-0310-9956-ffa450edef68"
ec9fa42a50ae15061908df69a9409e310ed886fd,"Fixed typo in instruction for running second extension sample (thanks, Paul!).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335174 13f79535-47bb-0310-9956-ffa450edef68"
26ed9f658165f8c9dc03251e59158952bed6f82c,"Check if locator property is set before trying to use locator fields


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335175 13f79535-47bb-0310-9956-ffa450edef68"
80d15fc7b578e99fc72c728222ea33ec6262e6d7,"Don't print locator message if locator is null


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335176 13f79535-47bb-0310-9956-ffa450edef68"
7d960d301352bf76ca1e7582dc9e84cef2ed7218,"Fixed link errors found by Dave Marston.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335177 13f79535-47bb-0310-9956-ffa450edef68"
2ac03ec79648604b6ddcb1624a3dfe5f8d329f36,"In startDocument, run m_contentHandler.startDocument before you start the thread.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335178 13f79535-47bb-0310-9956-ffa450edef68"
f55b013e7270ca54db71756ff5f7840c887fe216,"Call wait for initial events before the the transform is started.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335179 13f79535-47bb-0310-9956-ffa450edef68"
e63eef2af16417bf96069b3b57a51d603ea10422,"Allow co_yield to be called after the parse has finished.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335180 13f79535-47bb-0310-9956-ffa450edef68"
6047548d5ce90f9e4d44caa4211237ea683630d6,"Added setProperty and getSourceLocatorFor empty methods.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335181 13f79535-47bb-0310-9956-ffa450edef68"
b38fc3e834fd1c3b9715db812fe11d37c0cdc994,"Fix problem reported by Carsten Ziegeler <cziegeler@sundn.de>.  Using ApplyXPath (or doing a transformation) with DOM input was resulting in an NPE due to declareNamespaceInContext() being called before setting m_exptype which is needed by declareNamespaceInContext().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335182 13f79535-47bb-0310-9956-ffa450edef68"
3420e1cf875e99efe05fc3bcd2defda236df203c,"A few minor adjustments to yesterdays JAXP/TrAX implementation. These is one
change in the way the compiler (XSLTC) generates bytecode arrays, and the
rest is basically a cleanup of error reporting and a few added comments.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335183 13f79535-47bb-0310-9956-ffa450edef68"
e29f0254fbb9bade79c5bcaacfa7357bb75b93ca,"Added another directory for examples on how to compile and store translets
using our new TrAX design/implementation.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335184 13f79535-47bb-0310-9956-ffa450edef68"
025db179e7620116b340af14ce16bce37e767a5b,"Add pauseForTransformThreadStartup.  Call this in startDocument just
after starting the transform thread.  This should get rid of any variability
with racing threads.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335185 13f79535-47bb-0310-9956-ffa450edef68"
a83ad6deccaa6f50bf6fb727ddbb5dd0f44f9999,"Fix problem reported by jason heddings <Jason.Heddings@Sun.COM>.

""In v2.0.1, I was able to pass a Node to this function and have the node
be copied to the result tree (as expected).  In the source code for
XSLProcessorContext, it appears that the only objects that can be sent
to the result tree are XObjects.  Everything else is converted to a
String.  So for instance, I can no longer create a ProcessingInstruction
and pass it to the result tree via this method since the PI is simply
converted to a String.""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335186 13f79535-47bb-0310-9956-ffa450edef68"
fd61802f0947b9dd3f4a7b19f97e36f84ad88b7c,"Application of patch submitted by Benjamin Riefenstahl <Benjamin.Riefenstahl@ision.net>

Motivation: We are using Xalan to generate HTML pages.  We have the
requirement to integrate code for ad banners.  The ad server provider
has written the code to use with compatibility to NetScape 4 in mind.
The code uses the NetScape proprietory <LAYER> element and <IFRAME>
elements for other browsers.  The SRC attributes of these elements
contain URLs with several URL parameters separated by '&', as is the
common convention.

Problem: The code is integrated in our XSL stylesheets.  In the
stylesheet the '&' has to be written as the entity '&amp;'.  That's
ok.  The problem is that in the output the '&' is also written as
'&amp;' which is not ok, because NetScape doesn't understand that.
OTOH the same URL is written with '&' when used in an <A> element.

Solution: This goes down to a different handling of attribute values
in the class SerializeToHTML, depending on whether the attribute in
question is known to contain a URI or not.  Xalan knows this for <A>
but not for <LAYER> and <IFRAME>.  When I compare the list in
SerializeToHTML.java with the HTML specs, I find a couple of other
missing URI attributes in SerializeToHTML.java.  When I add the
missing pieces, the generation works fine.

Patch: Here is the patch (diff -c) for xalan-j_2_2_D6.  I also have
one for xalan-j_2_0_1 which is the version I actually tested this
with.  Please let me know if this is insufficient or the patch is
wrong or if there is something else I can do to fix this problem.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335187 13f79535-47bb-0310-9956-ffa450edef68"
57fb9b45b12bca3b0647a2f62141d829025b35de,"On code review of previous checkin from Gary P., we determined there
was a problem with the point at which type was declared a
DTM.NAMESPACE_NODE.  So that part was moved back up (actuall
a bit higher than where it was before),
and the call to declareNamespaceInContext was moved a bit
further down.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335188 13f79535-47bb-0310-9956-ffa450edef68"
105b9e04f89e137e7e845c808636eb7559ca96be,"Add section to explain processing of return values from extension function calls.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335189 13f79535-47bb-0310-9956-ffa450edef68"
b1b11537eccfcd53f25e22a48491573b5459b8bd,"Correct bug 2589 <http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2589> to cause ApplyXPath to build namespace-aware DOM documents.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335190 13f79535-47bb-0310-9956-ffa450edef68"
a6f8416dba9fdbba54b14f983e32ef902c209b2f,"Project Update
PR:
Obtained from:
Submitted by: John Gentilin mailto://johng@apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335191 13f79535-47bb-0310-9956-ffa450edef68"
2f826b5967a6b293b4618ccd67c35589c8760708,"Project Update
PR:
Obtained from:
Submitted by:	John gentilin mailto://johng@apache.org

Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335192 13f79535-47bb-0310-9956-ffa450edef68"
adb4b60b3a0fdf7998409f023dda9d49fe6d1ed2,"Fixup from previous check-in, defined new
functions.
PR:
Obtained from:
Submitted by: John Gentilin mailto://johng@apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335193 13f79535-47bb-0310-9956-ffa450edef68"
2fae918665edc2d2b5fdcc0eaf470ad1ef42b529,"Project Update
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335194 13f79535-47bb-0310-9956-ffa450edef68"
63e74ecb7f112ed3caba4e56d6f0f60cb242f11d,"reduced Attribute's for testing
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335195 13f79535-47bb-0310-9956-ffa450edef68"
71651a28648714d76f1f16f0f98a237b375af287,"Fix for XSLTC sample programs to force namespace awareness of parser. This
feature should be set by default by all JAXP compatible parsers, but that
unfortunately is not the case.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335196 13f79535-47bb-0310-9956-ffa450edef68"
739cab0c5059472bfece276aac7eeb88d7d34efe,"Reduced the refresh rate of the DocumentCache to 1 second.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335197 13f79535-47bb-0310-9956-ffa450edef68"
d8c70b96fe8cb069309e1149f8be4affb9141c04,"Minor hack to catch an attribute value being null.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335198 13f79535-47bb-0310-9956-ffa450edef68"
3e7c32a15e081dd831175c731ba741faf13b3483,"Exclude samples/extensions/sql/ext-connection from the samples
build until that sample uses the new sql api.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335199 13f79535-47bb-0310-9956-ffa450edef68"
0ff0d37130ee5ab4548fe859a1b1b5be16ce9cae,"replace resource-refs to TrAX with standard links, now that trax.xml
is in xdocs/sources/xalan.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335200 13f79535-47bb-0310-9956-ffa450edef68"
798482dec82f55ee9998fef86fb3d0211d27eb6c,"replace resource-refs to TrAX with standard links, now that trax.xml
is in xdocs/sources/xalan.
Also committing (for 2nd time), new question/answer on output encoding.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335201 13f79535-47bb-0310-9956-ffa450edef68"
abb41e4da4e63b36affda28b4705abeb01d9dd5c,"Fixed a bad link and some misplaced anchors.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335202 13f79535-47bb-0310-9956-ffa450edef68"
d2d09f38cd24c407d6c40d410485344a9aea87ee,"PR:
Obtained from:
Submitted by: Tom Amiro
Reviewed by:
Fixes bug 1591. Changed the lastModified() method to return
the correct timestamp for local files beginnig with the ""file:""
protocol. Incorporated Brian Ewin's suggestion to use URLdecode.
Todd Miller and Morten Jorgensen


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335203 13f79535-47bb-0310-9956-ffa450edef68"
b22373b9a7980357c4f2f298f905ca3ea8cc16d6,"Added some javadoc comments to our trax stuff. Added preliminary support
for getting/setting output properties, and for getting/setting URL resolvers.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335204 13f79535-47bb-0310-9956-ffa450edef68"
18425c0b3df4264559ce6a62dad35e289d459f0b,"Broke a stylesheet line into two lines to avoid print problem.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335205 13f79535-47bb-0310-9956-ffa450edef68"
685edd6185e318e5cf30e853e6555666e829673f,"Add new parameter to NodeSetDTM constructor. We need to have a DTMManager on hand. Change code to use the new constructors.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335206 13f79535-47bb-0310-9956-ffa450edef68"
5229be525d7074ff9c191821167b53896227296a,"OOps! Back out this last change. Old code on my machine!!!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335207 13f79535-47bb-0310-9956-ffa450edef68"
2c59aab8f3465c0c6d02a05862fa201d77b0dc82,"Updated for new SQL Extension
PR:
Obtained from:
Submitted by:	John Gentilin mailto://johng@apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335208 13f79535-47bb-0310-9956-ffa450edef68"
f3227156be1b100f039a9652c9713359283b8c52,"Fixed a few bugs, almost there
PR:
Obtained from:
Submitted by:	John Gentilin mailto://johng@apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335209 13f79535-47bb-0310-9956-ffa450edef68"
8f22d9ca7932d13c7708162c23a395889ec599eb,"Starting to phase out Coroutine*Parser* in favor of IncrementalSAXSource*.
The latter simplifies the code, and should help us avoid some of the
confusion that can arise in using the older tools.

Most importantly, it greatly simplifies the calling sequences, by discarding
the ""which file do you want to parse"" and ""do you want to parse any more
files"" transactions. These now operate _only_ as filters, and only as single
-use (though in fact the Xerces-specific version is reusable, and we may
reintroduce that feature in the generic filtering version at a later date).

Note too that we have swept the CoroutineManager completely
under the covers of the filter's API. There's no particular reason to expose
that implementation detal to the outside world.

Still to be done: Rework the rest of Xalan to use the new code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335210 13f79535-47bb-0310-9956-ffa450edef68"
75d43ba994898465ab0944e7b399569bdef91bbd,"Starting to phase out Coroutine*Parser* in favor of IncrementalSAXSource*.
See comment in previous check-in; I just missed this one....


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335211 13f79535-47bb-0310-9956-ffa450edef68"
14bc22a73f1cbfd6295953a12be9ba5bf546e975,"doc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335212 13f79535-47bb-0310-9956-ffa450edef68"
94a1959fd874b70b1e9922bec53ef9cbeef6eae4,"Add xsltc category to commits list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335213 13f79535-47bb-0310-9956-ffa450edef68"
6695cef09dbb5fedacafe44672c05e681291f66f,"2.2.D7


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335214 13f79535-47bb-0310-9956-ffa450edef68"
d4b4c1aa6195a674b2d0870b25cab02d20f37ae5,"2.2.D7


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335215 13f79535-47bb-0310-9956-ffa450edef68"
7b08eddb0f83ff0c3fd132708c1527357fd34fc5,"A series of changes to the XSLTC output handling to accomodate the
set/getOutputSettings() methods in the TrAX API.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335216 13f79535-47bb-0310-9956-ffa450edef68"
c33d0fd124e18deb1cafbfe2814c1062d3791305,"Added ext-connection back to the samples build.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335217 13f79535-47bb-0310-9956-ffa450edef68"
07ffe060ec5e91298e5dcb1ec309a2b86036b6b1,"Dont include XSLTC updates in the general list. Include in the XSLTC release notes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335218 13f79535-47bb-0310-9956-ffa450edef68"
72d0ef9c3af9eba15f68cd53c3ba614031b0edc4,"Use new NodeSetDTM constructor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335219 13f79535-47bb-0310-9956-ffa450edef68"
45dee8852f5aad3976b800ed6952e70e3175b5c7,"Obsolete


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335220 13f79535-47bb-0310-9956-ffa450edef68"
5812ba64ef7e43ebdaca65f1965e5b7ea57428d1,"Fixed the handling of the 'cdata-section-elements' attribute of the
<xsl:output> element. Previously we output the whole element, including
all contents, child elements and the start- and end-tags in one big
CDATA section. We now correctly output only immediate text child-nodes
as CDATA sections.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335221 13f79535-47bb-0310-9956-ffa450edef68"
ab86d51930fbba149ec2488293bfc5d6b2f49a7a,"Updated readme to reflect recent changes in the current XSLTC native API,
to mention the NAMESPACE_FEATURE constant, and to remove any anachronistic
mentions of the ""Preview"" distriubtion (that was pre Apache).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335222 13f79535-47bb-0310-9956-ffa450edef68"
5b318b3ad4c7ab921b0428771af4812c8428aba1,"Updated readme to reflect recent changes in the current XSLTC native API,
to mention the NAMESPACE_FEATURE constant, and to remove any anachronistic
mentions of the ""Preview"" distriubtion (that was pre Apache).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335223 13f79535-47bb-0310-9956-ffa450edef68"
e5617a16b910a8c6133896c711b24a7f8dae5f47,"Changed the name to README.ejb from README.servlet for consistency.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335224 13f79535-47bb-0310-9956-ffa450edef68"
2e7ebdd3ed830ea94db5bbd0a59f4d9acdf3dcee,"Removing README.servlet in CompiledEJB samples directory to effect
a rename to README.ejb for consistency with out XSLTC web services samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335225 13f79535-47bb-0310-9956-ffa450edef68"
00224ab8d582b4e0792fb7bff58ae6f344611e06,"Added implementation of get/setOutputProperties() of the Transformer
implementation.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335226 13f79535-47bb-0310-9956-ffa450edef68"
bf718214eeb6b9dceb2caa86b611bfa2030556eb,"Added (a rather brutal) handling of all Exceptions thrown in the
DocumentCache.getLastModified() method. This class is provided only
as an example/skeleton, but should still - for various reasons -
be provided in the base 'xsltc.dom' package.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335227 13f79535-47bb-0310-9956-ffa450edef68"
f445af5e84cd26f70dcfb786e338f1f1db4164ba,"2nd update for 2.2.D7


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335228 13f79535-47bb-0310-9956-ffa450edef68"
94aeb2c6ed293a4ab513d43450b27fa4ded928f1,"A few fixes to my last fix (ie. cleaning up). The last fix caused a
null-pointer exception in the output post-processor and had an ugly
debug print-statement in the AbstractTranslet base-class.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335230 13f79535-47bb-0310-9956-ffa450edef68"
52d957b2c4a4a3e45a0a38be31b375e68cdecde3,"Moved all handling of ErrorListener references to the trax code.
Completed support for StreamSource input to the newTemplates()
and newTransformer() methods of TransformerFactory. Also, added
support for SAXSource. The Parser, XSLTC, Import, Include,
Stylesheet and DocumentCall classes from the xsltc.compiler
package were all modified to accomodate this.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335231 13f79535-47bb-0310-9956-ffa450edef68"
7225160fecd540c84fb398407716540fa999772d,"Code Update
PR:
Obtained from:
Submitted by:John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335232 13f79535-47bb-0310-9956-ffa450edef68"
605845de31ff06ac310fd096ab9cd000b43e448d,"Fixed DTM.NULL compile error
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335233 13f79535-47bb-0310-9956-ffa450edef68"
f92c9af30d7cddfafde017bff53e2793fe50555d,"Added support for SAXSource and SAXResult in TransformerFactoryImpl
and TransformerFactory. I had to add a new consturctor the the
default SAX output handler (in the xsltc runtime library) to acommodate
the SAXResult TrAX output handler.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335234 13f79535-47bb-0310-9956-ffa450edef68"
f62fadbff35e54fba2a851e3f538362bf2b81ee6,"Redundant test removed, possibly redundant code flagged for %REVIEW%


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335235 13f79535-47bb-0310-9956-ffa450edef68"
4dda07f924b58a796ce57224060c4f4d89545098,"Added default error-reporting behaviour for our trax code (error messages
are dumped to System.err).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335236 13f79535-47bb-0310-9956-ffa450edef68"
a50bc3aeee5fca7f49472084d836eef0d46cc05c,"in progress, adding DOMSource support


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335237 13f79535-47bb-0310-9956-ffa450edef68"
a77aef7b17ceecfcda37481150e9874ff95ccd07,"new class, DOM2SAX, supports DOMSources, in progress


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335238 13f79535-47bb-0310-9956-ffa450edef68"
e0dda3e961eacb3ea0dcaefc8a464d0c9e247c90,"Added a SourceLoader interface to the compiler package. This interface can
be used to plug in an external document loader for imported and/or
included stylesheets. The trax.TransformerImpl class is updated to
implement this interface and act as an adapter between the internal XSLTC
SourceLoader interface and TrAX's URIResolver interface.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335239 13f79535-47bb-0310-9956-ffa450edef68"
74ae8dac9d8aab77a59e96c35ff05dfe38130a02,"Added the NAMESPACE_FEATURE constant. Checked to see if it was in
org.xml.sax first, but it wasn't. Since this constant is used both
at compile and runtime, it should be in the runtime Constants class
as well as the compile Constants class. Runtime code needs to be
kept separate from the compile time code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335240 13f79535-47bb-0310-9956-ffa450edef68"
36e2ca1edec1f0399597baa8bcf787be60d8bb34,"IncrementalSAXSource replaces CoroutineSAXParser -- simpler API,
hence less risk of programming errors introducing timing windows.

I hope.

A few performance-related tweaks are also included in this check-in.
Only very minor gains are expected.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335241 13f79535-47bb-0310-9956-ffa450edef68"
20193d3e360ca0168ddc088de440b0e52c4cc9fa,"Added import for org.apache.xalan.xsltc.runtime.Constants;
to the runtime classes that need to use the NAMESPACE_FEATURE constant
and had them reference it rather than define it themselves.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335242 13f79535-47bb-0310-9956-ffa450edef68"
f9d28b0a8d881f687225c03128736962375e28a6,"minor changes for DOMSource impl support


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335243 13f79535-47bb-0310-9956-ffa450edef68"
66574ab30e2862540b438e5096489472363b6130,"Added DOMSource support for stylesheet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335244 13f79535-47bb-0310-9956-ffa450edef68"
afce105206502b2622a26864d315ffe1c7e9f585,"updated convertor which supports DOMSource impl


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335245 13f79535-47bb-0310-9956-ffa450edef68"
9e0be1377e85b84005971b36b16027773c836115,"Project Update
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335246 13f79535-47bb-0310-9956-ffa450edef68"
bc7edd5ff3222d18ba08770ab59febf4c4d0ba52,"Added a small fix to the compiler (XSLTC.java) to make sure that the SAX
parser reference was not reset prior to compiling the translet.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335247 13f79535-47bb-0310-9956-ffa450edef68"
4eff93c98bd983b0d4968f0021837f80ce05a933,"Added support for DOMSource as input to our Transformer implementation


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335248 13f79535-47bb-0310-9956-ffa450edef68"
69d44516c15e5a0c92b4897976ace1809b7b3524,"Oops.Should have been checked in as part of the IncrementalSAXSource cutover. Sorry!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335249 13f79535-47bb-0310-9956-ffa450edef68"
4bf8e8798f06956f6ac94f90a2690da06eaea553,"For some reason I decided to optimise the <xsl:sort> functionaility. The
sort records we used has some global values stored behind methods, but are
now static fields. Somewhat faster.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335250 13f79535-47bb-0310-9956-ffa450edef68"
5f625f1db6bd5d3d46e94978c4a29198ef8744cd,"Fix for problem with import & include introduced with the latest updated
for TrAX URIResolvers.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335251 13f79535-47bb-0310-9956-ffa450edef68"
7cfc625249c93f818657ff46bc183ea9d2b5c729,"3 small fixes to the build process ( to make it work with jdk1.4 and crimson)

- exclude IncrementalSAXSource_Xerces if xerces is not detected
- comment-out the ""main"" in IncrementalSAXSource_Filter.java ( it is a
test, but has deps on xerces )
- don't try to load the compiler in syntetic/JavaUtils. This is a mess,
it was debated on tomcat-dev and ant-dev, as you may know some people
decided to remove the internal compiler class ( sun.tools.javac.Main ),
and that brakes jasper, ant and now xalan.

It seems right now the only portable way to run the compiler is via command
line call in a separate process ( jikes can easily make up for the
overhead of creating a new process and doesn't leave garbage ).

Question: is synthetic used ? Seems like a very usefull package, but if
xalan is not using it it might be better to move it to xml-commons or
jakarta-commons or some other place.

PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335252 13f79535-47bb-0310-9956-ffa450edef68"
50d126327f7e2627406819c6aad153c78e750789,"Don't set m_level anymore, as it looks like Joe commented out it's
initialization.  m_level is no longer called by Xalan, and the implementation
can calculate it when it is called.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335253 13f79535-47bb-0310-9956-ffa450edef68"
8df9073691f2ea595bc659e4cc7da6acafac7a23,"Fixed bug 2758 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2758).  The flag indicating that a call to startDocument() in the resultContentHandler was necessary was not being reset for multiple transforms.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335254 13f79535-47bb-0310-9956-ffa450edef68"
b838fdde7744b6945d749a7edf769c313a947c99,"Fix bug 2727 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2727).  Attributes which contain a namespace prefix are indicated by placing a negative number in the appropriate entry in the m_dataOrQName array.  The absolute value of this number is an entry in m_data.  However, in this example, there were no text nodes before the first namespaced attribute so the entry in m_data had an array index of 0.  This resulted in an entry of zero, not a negative number, in m_dataOrQName.  This situation got several routines which tested for < 0 confused.  I looked at several ways of fixing this but decided to just always allocate m_data.elementAt(0) entry to a dummy entry.  The other solutions involved runtime checking which could slow down this piece of code and I felt that wasting one entry was worth it to not slow down the run time.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335255 13f79535-47bb-0310-9956-ffa450edef68"
e775c0409566caa27445b4288503d07f9150fca8,"Fix bugzilla bug 2639 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2639) where buffer was overflowing because the expansion of the Unicode characters into multiple UTF8 characters was not being properly taken into account.  Many thanks to Gunnlaugur Thor Briem for his ""multiply by three"" trick.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335256 13f79535-47bb-0310-9956-ffa450edef68"
0c14b94a0bbebd537295799e72c4662d8a67d579,"Added placeholder for using native API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335257 13f79535-47bb-0310-9956-ffa450edef68"
edd07ba42b3f2fa5a066b9f8d80ebbc25ce1ccd7,"Commented out NumberFormat m_formatter = NumberFormat.getNumberInstance();.

Mukund reported:

a minor improvement for alphabetize.xsl is to comment out the line

//NumberFormat m_formatter = NumberFormat.getNumberInstance();

in NodeSorter.java. The variable m_formatter does not seem to be used anywhere, and the performance difference is:

Before: alphabetize         10    90    5108   196       156       34.58     OK
After    : alphabetize         10    70    4316   196       156       40.93     OK


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335258 13f79535-47bb-0310-9956-ffa450edef68"
935761661488451bea01a4ae3b62b9c5e0cf3d75,"Integrated fix for problem with count() function for certain iterators.
PR:		Bugzilla 1407
Obtained from:	n/a
Submitted by:	John Howard <johnh@schemasoft.com>
Reviewed by:	Morten Jorgensen <morten@xml.apache.org>


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335259 13f79535-47bb-0310-9956-ffa450edef68"
9286080668ebfb4895ef8622eb798650dd4af976,"2.2.D8


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335260 13f79535-47bb-0310-9956-ffa450edef68"
3cd00c6aaabdbdb5ee5ad2c13dbe0b673bfe9bb2,"Submitted fix for http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2851.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335261 13f79535-47bb-0310-9956-ffa450edef68"
72bca6122aacc383703eb620c05928044eae89f7,"Just added some stuff to diagnose bugs for flavor th.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335262 13f79535-47bb-0310-9956-ffa450edef68"
d6009c2be3a7191517ea685b22301a427413c6cb,"2.2.D8


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335263 13f79535-47bb-0310-9956-ffa450edef68"
855785e59741275681cce3f3817fd09f74a02d35,"These are changes submitted (offline) by Mukund Raghavachari/Watson/IBM@IBMUS.

This fixes a bug with match=""chapter//footnote[1]"" patterns.

The main change here is minor to remove the automatic attachment of parent::* to simple step patterns.

He has re-implemented executePredicates to be
more efficient. Given a pattern such as row[6], it
does not iterate over the entire axis until it reaches
the node to see if it is the sixth node. Rather,
starting from the current node, it works backwards
(preceding siblings) until it either runs out of nodes
or finds more than six nodes that match the
predicate [I can explain it better if desired].
This optimization improves performance slightly
overall. It helps decoy and patterns most (by
about 10%).

The other optimization that I implemented was the
following. For a pattern foo[][3][][4] ..., where more
than one predicate is a number (position check),
in checking the predicate [4], the fact that the
current node has passed foo[][3] implies that it is
the only node that is the third node among its
siblings that passes foo[]. Therefore, any
subsequent position checks can be true if and
only if the position is [1]. This optimization is not
used by the xsltmark benchmarks and so does
not offer any performance benefits.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335264 13f79535-47bb-0310-9956-ffa450edef68"
eb8298900b52c6d3c8f56c0d0709907697814733,"Xerces 1.4.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335265 13f79535-47bb-0310-9956-ffa450edef68"
a9bd3762795e0c906cda91f40e5626a018f7beb3,"We no longer include system property settings for the DOM and SAX
parsers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335266 13f79535-47bb-0310-9956-ffa450edef68"
95c8f4f895228f9c6d83b2ab1a553699def6106d,"Xerces 1.4.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335267 13f79535-47bb-0310-9956-ffa450edef68"
ad592c409c37bece549173e0809afcb012f35b7a,"Fix for http://nagoya.apache.org/bugzilla/show_bug.cgi?id=1336


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335268 13f79535-47bb-0310-9956-ffa450edef68"
6254371c14d4150fcaa80147e19924c9da0a036f,"2.2.D8


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335269 13f79535-47bb-0310-9956-ffa450edef68"
7774ebaf820c54dd6a69fe412f22d93caff40dd2,"Resize the m_patternMap if m_patternMapSize exceeds the bounds.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335270 13f79535-47bb-0310-9956-ffa450edef68"
0067029a433a5da1c78ee5862baadfb54b193a8b,"Getting all (almost all) error message strings into the resource bundle


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335271 13f79535-47bb-0310-9956-ffa450edef68"
abd20160f7d913c14824cdb2d78689b9a4893971,"Accidentally added. Now deleting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335272 13f79535-47bb-0310-9956-ffa450edef68"
5b29a28da7c3ac6e3af4ef34d17d28dd0070961a,"If a proximity predicate is a stable number (variable or number literal) then,
once the node is found, don't keep searching!  (since only one
node is possible).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335273 13f79535-47bb-0310-9956-ffa450edef68"
730d2783c976bf8b0281416c9f6df82c4b287114,"Added my public key.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335274 13f79535-47bb-0310-9956-ffa450edef68"
809bc1e1350a3d3417ec6c521678d2149cb9401c,"Added code that will speed up predicates such as //foo[@attr=$var],
//foo[bar = $var] and //foo/[@attr = 'str'].
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335276 13f79535-47bb-0310-9956-ffa450edef68"
8afff0ec0150034879fc9c6fd15268f3243a2d57,"In getNextNamespaceNode and getFirstNamespaceNode, was
sometimes returning a node without the DTM identity bits.
Fix for http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2878.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335277 13f79535-47bb-0310-9956-ffa450edef68"
86d8ec717e13ae9979992ba7965d55853d2f4165,"Throw real error instead of runtime error in getFirstPredicateOpPos
for better error reporting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335278 13f79535-47bb-0310-9956-ffa450edef68"
817147b316184071827caffa0850e4d4638a18e4,"Bit of a hack to make /descendant-or-self::north with getFirstPredicateOpPos
where getFirstPredicateOpPos was always throwing an error if
there was not a predicate (!! Should have been discovered before
now?!?!).  If -2 return -2 (instead of throwing an error), and
handle this case in PredicatedNodeTest#initPredicateInfo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335279 13f79535-47bb-0310-9956-ffa450edef68"
cf638a02de733bd39a56df0d6728b4bb875ae357,"Added the original pquery and streaming mode functionality
PR:
Obtained from:
Submitted by: John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335280 13f79535-47bb-0310-9956-ffa450edef68"
256c55dbdd6dc99d445e233971be9d7cf3c61336,"Added DTM Document, a common impl between SQLDocument and SQLErrorDocument
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335281 13f79535-47bb-0310-9956-ffa450edef68"
41f6589c579ce4267b2602aa4f7a7a1dc38acff2,"Fix addresses http://nagoya.apache.org/bugzilla/enter_bug.cgi?product=XalanJ2,
and a whole class of related problems.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335282 13f79535-47bb-0310-9956-ffa450edef68"
daaf59a9da4f2da390b5d787eb426977f2e4b5cf,"Fix for parameter and variable handling. This fix makes sure variable slots
are released once a variable goes out of scope. I have also extracted common
functionality from Variable and Param into VariableBase, and similarly
extracted some functionality from VariableRef and ParameterRef into a new
class VariableRefBase. This can potentially make some code more efficient as
one can test for 'if (blob instanceof VariableBase)' instead of testing on
both Variable and Param.
PR:		Bugzilla 2661 and 2699
Obtained from:	n/a
Submitted by:	John Howard <JohnH@schemasoft.com>
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335283 13f79535-47bb-0310-9956-ffa450edef68"
0ab6491d4487b1df98ffe269c984c219c3e298cf,"Forgot to add these two in my last putback.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335284 13f79535-47bb-0310-9956-ffa450edef68"
49c43a0a8076ee469e51fa2bccae8b88dcd4c964,"Removed type-cast error in Stylesheet.java
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335285 13f79535-47bb-0310-9956-ffa450edef68"
307739db8e1027f069ef8eb9c8df985f452d477f,"Detach expressions in match patterns.  Also, defined
numWithSideEffects and boolWithSideEffects (for lack of
better names) that will increment the iterator, and call these
for predicates.  The combination of these results in about an
18% performance improvement for decoy.xsl.
Credits to Mukund Raghavachari/Watson/IBM@IBMUS.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335286 13f79535-47bb-0310-9956-ffa450edef68"
de55c5cdf10f666c5fe5c68668623579e1360ede,"Removed some of the linefeeds we output in the default SAX output handler
to produce output more similar to Saxon (for testing purposes).
Added a test for null-pointers in the new VariableBase class.
PR:		bugzilla 2922 & 2598
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org`


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335287 13f79535-47bb-0310-9956-ffa450edef68"
4f54291237ae04377e90ecf4ea7b1b5083fdc7a6,"Added a small fix to prevent unwanted output when using the xsl:number
element.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335288 13f79535-47bb-0310-9956-ffa450edef68"
e2fe66952a9a65cd377d4f9e54649f925134adad,"Add support for external scripts (ie, the src attribute on a script element)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335289 13f79535-47bb-0310-9956-ffa450edef68"
64270317a585152cb3bc60c0cd96c0d1ecf1cabe,"In XPathContext#createDTMIterator(int node), call OneStepIteratorForward(Axis.SELF)
instead of DescendantIterator.  This addresses one of the bugs
in http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2925
(i.e. <xsl:copy-of select=""xalan:nodeset($stylesheets)""/>...
The DescendantIterator was enumerating all of the nodes in the RTF
rather than just the one.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335290 13f79535-47bb-0310-9956-ffa450edef68"
88718bfa2da7e0321d10e474ca90d80e7d686517,"Added Error Managment and javadocs
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335291 13f79535-47bb-0310-9956-ffa450edef68"
81d05f9359791dc164f127ee84bdc05a92a84773,"Fixed some major problems with position() and last() in secondary
predicates for match patterns.  Credit goes to
Mukund Raghavachari/Watson/IBM@IBMUS for flagging these.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335292 13f79535-47bb-0310-9956-ffa450edef68"
3d21b88b43825f7165eac3fba75500a78e0ab67f,"A few changes to make our output look more like Saxon's (to simplyfy
test diffs).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335293 13f79535-47bb-0310-9956-ffa450edef68"
465babd098ba30c22aded276bfb580248e2e795f,"Fix for Bugzilla 2930. Fix from Alexander Rudnev. Handle namespaced elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335294 13f79535-47bb-0310-9956-ffa450edef68"
d373e4c0465d315a7b35271a64933fcbfb5f50dd,"Added the new connect mechinism and error checking
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335295 13f79535-47bb-0310-9956-ffa450edef68"
6378efa9866d0a88bc561d9f322c848b13719ba7,"Added new connect method and error checking
PR:
Obtained from:
Submitted by: John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335296 13f79535-47bb-0310-9956-ffa450edef68"
01538514a439bd45c9c96d471244ed86b9ed864b,"dded new error test cases
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335297 13f79535-47bb-0310-9956-ffa450edef68"
ea49b93d6bf60ab5e2e83a6b7dff5db823327187,"dded new connect method and error checking
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335298 13f79535-47bb-0310-9956-ffa450edef68"
1f6d16c320da1ffcdf6c19e307bfbe2969e70531,"Added dbinfo, needed by -IN parameter for Process
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335299 13f79535-47bb-0310-9956-ffa450edef68"
b91d1f25a5e42bd794989c7c1379081ac2f5b255,"Added dbinfo.xml, needed by Process for -IN parameter
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335300 13f79535-47bb-0310-9956-ffa450edef68"
33c7313a00bc288b6d7b5d5dfeecfbcef0f0cb41,"Update after building Unit Test's
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335301 13f79535-47bb-0310-9956-ffa450edef68"
63218f389d8c39a18552345932c274bbf3ddbdeb,"add support for DOMResult handling


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335302 13f79535-47bb-0310-9956-ffa450edef68"
0def1ae311d456b39fa7e6401de6502dd0223f89,"work in progress, converted needed for DOMResult


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335303 13f79535-47bb-0310-9956-ffa450edef68"
bd98471c20e8a8b219bc1bb6991113c552db3e71,"Added Todd Miller diagram for UseXMLFilters.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335304 13f79535-47bb-0310-9956-ffa450edef68"
bf148923bff1d9792e97aafbd9302e86fa9f7bc8,"Addresses http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2945

Bug was caused by (redundent) cloneWithReset being called from
the UnionPathIterator, and the iterator in OneStepIterator not being
reset.  (Need to review: check other iterators for this.)

Call reset on the iterator in OneStepIterator#reset.  Reset the position
value in the ancestor iterator reset.  Define DTMAxisIterator#cloneIterator
to not reset the iterator position, and fix the implementations of
this to not call clone.reset().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335305 13f79535-47bb-0310-9956-ffa450edef68"
34261ec0d236afc3d991a169bedbe7f8aff04d38,"added setting of systemId in DOMSource handling


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335306 13f79535-47bb-0310-9956-ffa450edef68"
78ad8187e9edde58ee0c8f275e390004fa7b3b61,"Added an implementation of the TransformerHandler interface of TrAX/JAXP.
Implemented the 4 methods in TransformerFactory to instanciate this
TransformerHandler implementation.
Added an attribute of the TransformerFactory which contains the default
name for generated translet classes (the default name is GregorSamsa from
Kafka's Metemorphosis), but should be set by the user in cases where the
Templates implementation cannot get the systemId from the Source object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335307 13f79535-47bb-0310-9956-ffa450edef68"
37141375342cf0a6ebaf608e27b6db4d161b7ee6,"Added missing TemplatesHandlerImpl file (implementation of the TrAX
TemplatesHandler interface).
Added initial implementation of getAssociatedStylesheet() in
the TransformerFactoryImpl class.
Changed behaviour of TransformerHandlerImpl class with regard to
the setResult() method. This method now has to be called before
startDocument() is called, which gives XSLTC the same behaviour
as Xalan.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335308 13f79535-47bb-0310-9956-ffa450edef68"
707e29de5ef1b9b37767103b82c880ae6510453e,"Added support for the TransformerFactory's getAssociatedStylesheet()
method. Added similar methods to the native XSLTC API, as they can come
in handy.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335309 13f79535-47bb-0310-9956-ffa450edef68"
467ce82372d073ede85f22912932b97e0473c4fc,"Address http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2925

Create new XObject, XNodeSetForDOM, which is constructed
from a Node, NodeList, or NodeIterator, and acts the same as
XNodeSet, except it returns the original object for object(),
nodeset(), and nodelist().

Add XObject#create(Object val, XPathContext xctxt), which is
called from TransformerImpl#setParameter(s), and
FuncExtFunction#execute (for the return values of the
extension).

XBoolean and XNumber now also have Boolean and Number
constructors, in which case the original object will also be
returned from the object() method.

This should make the conversion from java object to XObject
consistent between function returns and setParameter.  These
changes should also fix a bug where NodeLists weren't being converted.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335310 13f79535-47bb-0310-9956-ffa450edef68"
954654bf674bf7f5ad5bb81a1d936b54a633c500,"Fix for the document() function. The code compiled by DocumentCall now
passes the context URI to the LoadDocument.document() method, and the
document() method resolves the base/new URIs and constructs an absolute
path/URI to the document to load.
PR:		bugzilla 2832
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335311 13f79535-47bb-0310-9956-ffa450edef68"
df8e59ba525430372106fe9f90fe410061a1c8a2,"new recursive parse(InputSource) implemented


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335312 13f79535-47bb-0310-9956-ffa450edef68"
13b68fdd00342cad51220d9cbf5b43dee735f445,"upated


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335313 13f79535-47bb-0310-9956-ffa450edef68"
df4ab5b6eedad709d8c11ad0b28bffa8b97cfcc1,"updated again


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335314 13f79535-47bb-0310-9956-ffa450edef68"
e1dfb22c1f4f02176e5a2f227b6b25fcfec8e61c,"Fix to get around problem with Crimson. Crimson does not like attribute-
nodes to be created with 'null' or """" namespace URI. Added an if-test to
invoke setAttribute(name, value) instead of setAttributeNS(uri, name, value).
Had to add a little test to DOMImpl$DOMBuilder.makeAttributeNode() to get
around an internal NPE problem.
PR:		n/a
Obtained from:	n.a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335315 13f79535-47bb-0310-9956-ffa450edef68"
449feb81df07859c3eb3539ddf78a6cf7e0e912c,"Fix for union-iterators wrapping one or more attribute-iterators.
Attributes should be wrapped in TypedAttributeIterator objects and not
SingletonIterator objects when they occur insude unions.
Fix for copying attribute nodes using <xsl:copy> and <xsl:copy-of>
PR:		bugzilla 2603
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335316 13f79535-47bb-0310-9956-ffa450edef68"
c1740fec220900cd016058a98c81270a55afa414,"Replacement for org.xml.sax.helpers.NamespaceSupport; extends
that API so it can be easily swapped in.

Current changes;

Minor code reorg. I'm sorry, but I find classes easier to read
if fields are defined before methods reference them rather than
at end, especially when inner classes are present.

Punt stack vector in favor of doubly-linked list. (It was already
singly-linked in parallel with the vector!)

The whole dirty-tables concept was broken, because Context's
ctor always called copyTables and thus always marked tables
dirty. It also wasted some time setting itself only to be reset by
setParent. I've fixed both by parameterizing the ctor and making
copyTables specific to prep-for-new-declaration. (Could be
moved back into the declaration method, for that matter.)

I'm dubious about the caches in processName. As far as I can
tell, Xalan per se never actually uses that method...

The use of Hashtables is questionable. Hashtable is
known to be inefficient and oversynchronized in older JVMs, and
the fact that this is a bidirectional mapping suggests that an
approach similar to our own String Pool -- lighter-weight, more
targeted, hashing without reduplicating the two column tables --
would be a win. Since these are typically short sets, even
simple linear search is worth considering!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335317 13f79535-47bb-0310-9956-ffa450edef68"
a9d5d47308f49da63604a67309dad11fd8d314e1,"Cutover to NamespaceSupport2, q.v.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335318 13f79535-47bb-0310-9956-ffa450edef68"
b56ddcf5f78e27a92c11ce5e412846332b70499f,"Continuing code review.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335319 13f79535-47bb-0310-9956-ffa450edef68"
09cc4761651ed065f41fd19ad1cbc0181223f184,"More efficient prefixes-for-specific-URI. This may wind up being
redone yet again if/when the underlying storage representation
changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335320 13f79535-47bb-0310-9956-ffa450edef68"
bdf9dad1a90cf4d32bda8e2db9114c26957ec40b,"PipeDocument extension element (the pipeDocument method).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335321 13f79535-47bb-0310-9956-ffa450edef68"
5c95e59190c7e829292ef1dbee6d6bd5479c3fba,"Added section on PipeDocument extension element


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335322 13f79535-47bb-0310-9956-ffa450edef68"
f97c7037f26c7aaeb10b17e5e5ac5486274a2883,"Bug fixed regarding the current() function in the root template
(related to bug#1269).  Bug was reported by David Marston
offline.  The test for this is conf/copy/copy29.

In TransformerImpl#applyTemplateToNode, create a NodeSetDTM and pass it to m_xcontext.pushContextNodeList(cnl);.
In NodeSetDTM fix getCurrentNode so that it doesn't use m_next-1
(which simply appears to be completely wrong).  Do the same for
NodeSet... though I don't think this will be called anywhere in
Xalan.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335323 13f79535-47bb-0310-9956-ffa450edef68"
acc4b3c311591c8c67b683712e80d7f370d1aa8b,"Provide method for DTMAxisIterator to get the current root node
of the iteration.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335324 13f79535-47bb-0310-9956-ffa450edef68"
c7867f157f0ffef7ad1ec40a43ce383cc9cc241c,"In response to regression posted on xalan-dev by John Gentilin <johnglinux@eyecatching.com>
on 08/03/2001 06:49 PM.  When the XNodeSet taks a DTMIterator, it
will call val.getDTMManager();, which will call LocPathIterator#getDTMManager,
which will call m_execContext..getDTMManager(), which means
that setRoot has to be called on the iterator before it is added to
XNodeSet.  Thus, call setRoot on the OneStepIterator in
create(Object, XPathContext) before it is added to the XNodeSet.
The regression was related to fix for http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2925.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335325 13f79535-47bb-0310-9956-ffa450edef68"
9ebf136ecb802a40510fe658199ea846b2706cf7,"For the OneStepIterator(DTMAxisIterator iterator) constructor,
initialize the node tests to DTMFilter.SHOW_ALL (duh).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335326 13f79535-47bb-0310-9956-ffa450edef68"
22d40c5d4eeef6d1e1c06684c4a2b1dd135a6451,"Move create methods from XObject to XObjectFactory, in response
to cyclic build problems encountered with javac 1.1.8.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335327 13f79535-47bb-0310-9956-ffa450edef68"
def249ba646f34fefefe69b57d6693259fd571ca,"Moved anonomous class to PrefixEnumerator, in response
to problems encountered with 1.1.8 build.
Joe may want to fix this in another way, as
I'm sure the anon class is probably a bit
cheaper?


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335328 13f79535-47bb-0310-9956-ffa450edef68"
29344055e9252490a61a46c099a98b99527bdf18,"Added -mx64m which seems to make the 1.1.8
build be able to work.  Also, use @echo on and
@echo off, instead of replicating the line.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335329 13f79535-47bb-0310-9956-ffa450edef68"
9fed1f071ec6e77d9544becff0868d7e39138028,"Updated basic connection and streamingNodes.xsl

PR:
Obtained from:
Submitted by: John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335330 13f79535-47bb-0310-9956-ffa450edef68"
dc91608b41dc91c66938eea0103bcb2089e92743,"Updated cahcedNodes.xsl to use new function calls
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335331 13f79535-47bb-0310-9956-ffa450edef68"
b913c9cb5e7c410fc0e0caef1a027ac41363ec6b,"Address http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2972,
where it was throwing a NPE instead of reporting that the variable
was being accessed before it was bound (i.e. the variable was being
accessed inside an RTF for that same variable).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335332 13f79535-47bb-0310-9956-ffa450edef68"
51d0e3ccacc0945b944671bba8456bf953aa8aa9,"Remove m_hasStarted variable and associated assertion.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335333 13f79535-47bb-0310-9956-ffa450edef68"
540b4cb155e7bdcd212f3475e7b76ecc51c2ae74,"Addresses bug http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3001.
In the cloneIterator function of PrecedingIterator, the cloned array
was being sized for _maxAncestors, which defaults to 8.  But if the
_stack was resized, it will copy more into the new stack than is
allocated.  The solution is to allocate the new clone._stack array to
_stack.length.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335334 13f79535-47bb-0310-9956-ffa450edef68"
adb745bfaf2ab55a2c9f92dfd951c9283be584c7,"Don't create caches unless used (which I don't think they are, in Xalan).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335335 13f79535-47bb-0310-9956-ffa450edef68"
5a9a22c8e6c9ca0a0e139f72711b39f12b34f4a9,"Made _maxAncestors not static, as this is
not compatible with 1.1.8 (reported by
Gary Peskin).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335336 13f79535-47bb-0310-9956-ffa450edef68"
68d59056fe4d8a332db9410a871d1d921f082c1f,"Playing a hunch, I moved the Context objects out of NamespaceSupport2.
They're now a second class in the same file rather than being an inner class.
That reduces the size of the Context2 object, and its initialization time, by
removing the need for it to carry a reference to the NamespaceSupport2
object that created it.

Performance seems significantly improved... even (surprisingly!) on the
getDeclaredPrefixes operation. Memory usage also seems better, as
expected.

NamespaceSupport2 is still acounting for about 5%
of the time spent in the ResultTreeHandler, according
to my latest trace. Apparently we are calling
getDeclaredPrefixes an obscenely large number of
times, and the Vector.elements call is adding up. We
may want to look at where this is being called from
and whether we can reduce the number of invocations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335337 13f79535-47bb-0310-9956-ffa450edef68"
d015312c0eb5e5f85061606b99c522a251479e0f,"Performance improvement; avoid scanning the same list twice.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335338 13f79535-47bb-0310-9956-ffa450edef68"
de6191d197797b62f88b10a4c36f3892f04123df,"This checkin hopefully fixes many problems with bad diagnostics lately, but
at the expense of a slight change in behavior.  The rule now is, the
DefaultErrorHandler never outputs location info for error and fatalError... this has to be done
by the catcher of the exception.  Convenience methods for this are
in DefaultErrorHandler#printLocation.  This method will unwrap the
exception as close to the originating source as possible.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335339 13f79535-47bb-0310-9956-ffa450edef68"
e0e9786a64faad43e2eca7f46cc1c94b106e16e2,"Added code behind the document() function to force the parser to be
namespace aware (Crimson is pr. default, Xerces is not).
PR:		bugzilla 2862
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335340 13f79535-47bb-0310-9956-ffa450edef68"
b2766721cd8775f03a8a8c224db86781f74b46d8,"Fix to prevent escaping of attribute values in HTML output.
PR:		bugzilla 3003
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335341 13f79535-47bb-0310-9956-ffa450edef68"
f68a480c500adb3115e671f3fc28cd8136c99a03,"Fix for grouping a sequence of text nodes inside one CDATA section.
PR:		bugzilla 3005
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335342 13f79535-47bb-0310-9956-ffa450edef68"
f43da4d02a700ccabd8747f36de165bdbdb90a47,"Fix for passing node-sets as parameters into a template with a for-each loop.
The ForEach class resets its node iterator by default. This behaviour is not
desierd for iterators that are passed in through a parameter, so I added an
it-test that checks if the iterator is of type 'Reference'.
PR:		bugzilla 2468
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335343 13f79535-47bb-0310-9956-ffa450edef68"
756602ef01c4e7cfab2a192d974e0476c494d64a,"Fix for a certain combination of absolute path patterns and ancestor patterns,
such as <xsl:template match=""/foo//*""/>.
PR:		bugzilla 2836
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335344 13f79535-47bb-0310-9956-ffa450edef68"
64f5d17dbed9068db72a4947e7a4dcf51e88fd23,"Fix for document() function. Prevents run-time error.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335345 13f79535-47bb-0310-9956-ffa450edef68"
1358ca535f45106ea65a519c16d4d2686d4f88c7,"Added Validate sample to build.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335346 13f79535-47bb-0310-9956-ffa450edef68"
c3d7c27b8d38f520309b719708dd4ff7d9a2b023,"Validate sample checks the validity of 1 xml file or all the xml files
in the specified directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335347 13f79535-47bb-0310-9956-ffa450edef68"
67867d12474b09ec8a826fc2a3e4242440797983,"Changes to allow some dynamic determination in WalkerIteratorSorted to
see if the nodes really need to be sorted.  Added isDocOrdered() and
getAxis() to both DTMIterator and AxesWalker, and implemented
appropriate overloads in derived or implementing classes.  In FilterExprWalker
return the contained DTMIterator's getAxis().  In WalkerIteratorSorted,
implement canBeWalkedInNaturalDocOrder() function that is called
from setRoot(...).  If this function returns true, than don't sort the nodes
in setRoot, and in all other respects treat this as if it is a simple
WalkingIterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335348 13f79535-47bb-0310-9956-ffa450edef68"
7ab4a0cc38f850d13dbfc8b51e6e368ea5dd0590,"Fix for bugzilla 1251. Make sure exceptions are thrown when we're on the main thread.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335349 13f79535-47bb-0310-9956-ffa450edef68"
54a181d0f371bae7d0d0e2c5d7ad5b2df0301dce,"Eliminate do/while check for duplicates in AxesWalker#nextNode()
by using WalkingIteratorSorted for cases where both the preceding[-sibling]
and following[-sibling]  axes are being walked, and for ""@*/foo"" patterns
(""@attr/foo"" patterns still use WalkingIterator).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335350 13f79535-47bb-0310-9956-ffa450edef68"
b5b7142e0dbf130eab653d5852c3fa8fc0b4e8ed,"Fix bugzilla bug 3036 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3036).  When no xsl:decimal-format element is supplied in the composed stylesheet, the defaults specified in the Recommendation section 12.3 should be used for the attribute values, not locale-specific defaults.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335351 13f79535-47bb-0310-9956-ffa450edef68"
a6e8cacbe660cf0c3d36bd72633bddda984b37b0,"Added a test to the <xsl:element> element to verify that the element name
given in the 'name' attribute contains something other than an empty string.
PR:		bugzilla 2794
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335352 13f79535-47bb-0310-9956-ffa450edef68"
5fa5fecac02dcd1073cf2cc5d5f91cd0a9dcf00b,"Applied a fix to our class for handling literal result elements. The only
attributes in the XSLT namespace we handle in LREs are exclude-result-prefixes
and extension-element-prefixes. We have a test to check if an attribute is
in the XSLT namespace, and if it is we ignore the attribute. This test was
placed before the test for the two XSLT attributes we do want to handle,
causing us to ignore all xsl:exclude-result-prefixes attributes in LREs.
PR:		bugzilla 1506
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335353 13f79535-47bb-0310-9956-ffa450edef68"
6875cfca25c74c82f5906da41ca86c499a56db76,"Fix and performance improvement for attribute sets.
PR:		bugzilla 2536
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335354 13f79535-47bb-0310-9956-ffa450edef68"
3e1c89f07ac27a3683d1d353a4233e4935ff0367,"Fix for use of attribute sets with the xsl:copy element. We were a bit too
restrictive in our tests to see if it was safe to send the attributes to
the output handler. We only compiled in a test to see if the copied node
was an elment, but should also have tested if the xsl:copy element's
parent node was a LRE or a xsl:element element.
PR:		bugzilla 2538
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335355 13f79535-47bb-0310-9956-ffa450edef68"
dff6683b3d791d009db2abd35e81acc2b89baa17,"Added Apache license.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335356 13f79535-47bb-0310-9956-ffa450edef68"
cf1703bbb1724ba94fc077d7910cb707208b9c08,"Added Apache license (trax.xml) and Validate sample (samples.xml).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335357 13f79535-47bb-0310-9956-ffa450edef68"
79c8f7c0bb3889084879ee0c87fab72f09be8233,"Specified that attempts to connect to a non-existant database.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335358 13f79535-47bb-0310-9956-ffa450edef68"
f935ab0048448e5756464aeb4d59d5d2617830c9,"SQL Extension libary working again!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335359 13f79535-47bb-0310-9956-ffa450edef68"
f4f8289a33059edbde45cf715e3900401beaf85f,"Update release number.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335360 13f79535-47bb-0310-9956-ffa450edef68"
82105d043e045084ea86e62723e83291bb1c2a0f,"Move changes to history to prepare for next release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335361 13f79535-47bb-0310-9956-ffa450edef68"
e30ffe20fa4062387c095bc6050d08b66454df06,"Fixed 2 typos.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335362 13f79535-47bb-0310-9956-ffa450edef68"
e64091aff47ff388f9acf974efef8652c7923bd9,"Fix for bugzilla 3060 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3060).  Prefixes and
namespaceURIs are kept in the same Vector, m_prefixMappings.  The entries are stored as pairs of vector elements.  The even elements contain the prefix and the odd elements contain the URI.  In two routines, getPrefix and endElement, the appropriate prefix or URI was being located in the Vector using an indexOf.  However, in this case where the prefix and the URI were the same, the routine was looking for the URI but finding the prefix instead of the URI.  It tried tried to back up one to get the prefix and underflowed the Vector size.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335363 13f79535-47bb-0310-9956-ffa450edef68"
b9aa2aba2df3a7ce85ba228131c7859fd6c6e8ab,"Implement ErrorHandler in ResultTreeHandler so that fatal errors can get passed in to the SAXHandler. Also change the code in TransformerImpl to call fatalError in case of an error instead of endDocument. (overlaps with URI handling fix...)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335364 13f79535-47bb-0310-9956-ffa450edef68"
1a498ceb7f26076434398546fb2d0a3afac275d6,"Fix code to handle absolute paths from unix systems. This fix is part of an ongoing process and is just meant to fix a few pending bugs. More changes are expected in this area.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335365 13f79535-47bb-0310-9956-ffa450edef68"
e03f7547c683427a2e8099662c59a7d826e571d1,"Periodic update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335366 13f79535-47bb-0310-9956-ffa450edef68"
0acdf06f02d7602eb43f28b12415c8c02f73283a,"Updates for 2.2.D9


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335367 13f79535-47bb-0310-9956-ffa450edef68"
2fdc81c6f05adc954d6f41e3ce70a4e5266693d8,"PR: 2593
Changed ""runtime"" to ""trax"" in org.apache.xalan.xsltc.runtime


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335368 13f79535-47bb-0310-9956-ffa450edef68"
e9dab4070afb8a270a4c0bf9d27e97b325dd0697,"Change version for xalan2.2.D9 build


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335369 13f79535-47bb-0310-9956-ffa450edef68"
bd4d8455668652757425e5d05ebc6451e9b31881,"ResultTreeHandler was pushing a new namespace context but failing to note that result in more pushes than pops.  Cleaned up the execute() method of ElemElement to make it more understandable (to me) and added a few comments.  The DefaultErrorHandler was not flushing Writers that it created.  Since the Writers are never closed (and cannot be as there is no close method), error messages were failing to appear.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335370 13f79535-47bb-0310-9956-ffa450edef68"
384cfed8152c850c7af40d357453b3a7385f8989,"PR: 2591
Obtained from: padraig
Submitted by: Tom Amiro
Reviewed by:
Fix references in doc to org.apache.xalan.xsltc.runtime where they should
be org.apache.xalan.xsltc.trax. The initial trax implementation was in
the ""runtime"" subdirectory, but later moved to the ""trax"" directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335371 13f79535-47bb-0310-9956-ffa450edef68"
c055910d0de17eec327d30b0d4a2d9d9395b68d5,"Updating these ""release note/readme"" files on xsltc for the next release.
They have become very rusty. The section on TrAX still has to be rewritten.
I updated the ""todo"" list based on the current bug list, but I'm not
sure we should have fixing-different-sets-of-bugs as 'todo' items, since
it is very hard to keep them up-to-date. Along those lines, I replaced
the ""Known Problems"" content with a reference to the bugs in Bugzilla.
After all, the reported bugs are the know problems.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335372 13f79535-47bb-0310-9956-ffa450edef68"
be37df5feecbf22cfa20fd54e9586f54b9b88e4b,"Increasing the number of bits used to identify DTM nodes, at the expense of decreasing the number of DTMs that a DTMManager can track simultaneously. Some other code has been updated to track this change (and to better track posible future changes), as have the IDKEY testcases.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335373 13f79535-47bb-0310-9956-ffa450edef68"
f223c8a82ad1f2027ff45d66a968e20fb410a431,"Try to support getRoot.  Fixes problem with TransformStateTest.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335374 13f79535-47bb-0310-9956-ffa450edef68"
5bc88efc35741547261a6b3485c505f8dac2f06e,"Fix problem with duplicate nodes produced from a walking iterator


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335375 13f79535-47bb-0310-9956-ffa450edef68"
6985bf36637e4d1d012e5ce06f0c28e49f9d7ae6,"Fix code so that NAN are always sorted as less than any other number


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335376 13f79535-47bb-0310-9956-ffa450edef68"
a1282ce5102c9273580a2fb151904f5f042cb6d5,"Inherited definition of NODEIDENTITYBITS went away.
Recreate it here.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335377 13f79535-47bb-0310-9956-ffa450edef68"
8f05085c818707c2a22e64c63cf906f4952b6d8c,"Fixes inspired by bugzilla bug 2308 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=2308).  The maximum number of DTMs is calculated based on the number of bits left over for the DTM number.  The m_dtms array is allocated only at this length to avoid generating a DTMId greater than the maximum available.  I changed a sign-extended shift to a non-sign-extended shift to allow access to the upper have of the DTMId range.  Also changed the -1 ^ x syntax to ~x which I find much more understandable.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335378 13f79535-47bb-0310-9956-ffa450edef68"
3d8d0318ee036abd6667806f6f7b9bd8df1d42f3,"Fix bugzilla bug 3056 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3056).  SAX2DTM now keeps track if it is receiving events inside a DTD and ignores comment events when inside the DTD.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335379 13f79535-47bb-0310-9956-ffa450edef68"
c1fcfb76206fe6b68b447695e531fafba34d5648,"I added a flag to the compiler/Parser class that is set if the outermost element
in the stylesheet contains a definition of the XSL namespace. The parser already
has a global variable '_target' that is set if the stylesheet contains a
<?xml-stylesheet?> PI or not. The compiler will now flag an error if neither
flags are set after the whole XSL/XML input document has been parsed.
PR:		bugzilla 1780
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335380 13f79535-47bb-0310-9956-ffa450edef68"
90f73ea695dc6b9c9cdd8a3ef7d74dbc952e2074,"Added a small fix that orders the expressions inside a union in such a way that
expressions with an attribute axis or attribute node type will be put first.
PR:		bugzilla 2921
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335381 13f79535-47bb-0310-9956-ffa450edef68"
5ef497b85eda4e655e80744c4837e7e593dbfc55,"A small fix that will allow top-level elements of an unknown URI.
XSLTC now ignored the element(s), while it previously reported an error
of an unsupported XSLT extension.
PR:		bugzilla 2840
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335382 13f79535-47bb-0310-9956-ffa450edef68"
ab98b880ef0d5ae7aec8578c2a1bd0f1aea2c966,"Added faq from Gunnaluger Thor Briem on loading extension element/function classes in a servlet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335383 13f79535-47bb-0310-9956-ffa450edef68"
6bf211720cbca9efac42256b2eb64a9944fb1ebd,"Revised email address for Jacek Ambroziak.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335384 13f79535-47bb-0310-9956-ffa450edef68"
02fffb7859332f44a1101c433da22a0b1cc177ac,"A start on a fix for output DOCTYPE declarations based on the attributes
of the <xsl:output> element. I also added a fix for bug 2863, to prevent
us from outputting namespace delcaration that point a prefix to the null
URI (such as 'xmlns:blob=""""').
PR:		bugzilla 2863
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335385 13f79535-47bb-0310-9956-ffa450edef68"
0654106b44ebd52468631bc34c212bdb954d63ef,"Update for 2.2.D9


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335386 13f79535-47bb-0310-9956-ffa450edef68"
c1d251d2b3f5bf5ad0471d040cac82461c703197,"bug 2553, fixes AbbreviatedAbsoluteLocationPath,
some relative location paths still give duplicates, will need to filter.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335387 13f79535-47bb-0310-9956-ffa450edef68"
24ceff3501be981672356947da53078ed59d1973,"Update version for 2.2.D9 build


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335388 13f79535-47bb-0310-9956-ffa450edef68"
afa5fa3b557698a53dbe421a3427c627a32b51be,"Update fdist version number to  2.2.D9


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335390 13f79535-47bb-0310-9956-ffa450edef68"
31f077468f6599814c4be9d5efdcb9b528cd9793,"Implemented support for the doctype-system and doctype-public attributes
of the <xsl:output/> element. The translet post-processor (TextOutput) can
now be instanciated with a ContentHandler and an optional LexicalHandler.
The LexicalHandler will receive notofications of the DOCTYPE declaration.
The default SAX output handler now implements both ContentHandler and
LexicalHandler. The LexicalHandler only handles the startDTD() method,
by outputting the DOCTYPE declaration, and all other methods are empty.
The trax.Transformer implementation has also been updated to use the
LexicalHandler, but I still have not found any way in which a SAX client
can set the LexicalHandler.
PR:		bugzilla 1504
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335391 13f79535-47bb-0310-9956-ffa450edef68"
ba96ac64b40d9349816ad24ffdad38800b7ec786,"A minor change to the class handling the <xsl:element> element to be more
in-sync with the XSLT 1.0 spec (and M.Kay's book). This in order to make
it more readable and maintainable. I was trying to debug the code for
something I thought was a bug, and it was just impossible to navigate.
This change was necessary, even though the code functioned as it should.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335392 13f79535-47bb-0310-9956-ffa450edef68"
06a7b109b3daf50d7080578bbcc6ea6587937789,"Fix for outputting all necessary namespace declarations with LREs.
PR:		bugzilla 2863
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335393 13f79535-47bb-0310-9956-ffa450edef68"
6f73bd8dedec1622a28c3f744556a10556387ac4,"A fix to allow reverse iterators to be reset (inside nested for-each loops).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@apache.org
Reviewed by:	morten@apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335394 13f79535-47bb-0310-9956-ffa450edef68"
433ed7170bc1869496df970a8c4ec51863027bc8,"Added pack.docs target to tar.gz all the doc for uploading to site.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335395 13f79535-47bb-0310-9956-ffa450edef68"
c5491bf773ec33fe892890371240d64a931a28a6,"Oops! targ.ga the right doc set (with index.html)!
Added pack.docs target to tar.gz all the doc for uploading to site.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335396 13f79535-47bb-0310-9956-ffa450edef68"
27f6b1e95f6b431ad4ddcb139283f7dd8d486b63,"Fixed bug in connect method where User and Password were not
correctly being passed to the JDBC Driver. Requires chnage in
ConnectionPool Interface
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335397 13f79535-47bb-0310-9956-ffa450edef68"
2c0add2f1f8617b43a11c215c172dc836890bfc6,"Updates including Dave Marston's additions to the XSLT reading list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335398 13f79535-47bb-0310-9956-ffa450edef68"
3143cc150398e94c1b49d5a334ee3f318840a04e,"Preliminary cutover to using test/build.xml to execute tests; note
this may take a day or two to shake out esp. with Gump or on unixy systems
'conf' target needs to be added back as well


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335399 13f79535-47bb-0310-9956-ffa450edef68"
9f650fb9b75497be8b515ee8373f0493a5be47d2,"Use defined constant DTMManager.IDENT_DTM_NODE_BITS for shifting DTM nodes, not hard coded value.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335400 13f79535-47bb-0310-9956-ffa450edef68"
87ff952f5bf6ae495efb244aee2e53969bf59e16,"bug fix 2553, new iterator to get rid of dups


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335401 13f79535-47bb-0310-9956-ffa450edef68"
f92c3442a1a2607acc9570e15655f018b6cdaba2,"bug fix 2553, new abs location path


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335402 13f79535-47bb-0310-9956-ffa450edef68"
cc8819756bd15ba33eb8ba7bda8b09af1a7c4623,"bug fix 2553, updated Constants for dup processing
and updated CUP rule for AbbreviatedAbsoluteLocationPaths


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335403 13f79535-47bb-0310-9956-ffa450edef68"
837e289ae585d5208f342d46543e9acb8b5b8d9e,"Fix problem with resolving a relative URI from a  processing instruction


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335404 13f79535-47bb-0310-9956-ffa450edef68"
af1db24530d01b45377710411da35e8afa95b94f,"Implementation of id() and key() pattern - finally!
Added a small fix to the DOMImpl$DescendantIterator to prevent NPEs.
PR:		bugzilla 1376
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335405 13f79535-47bb-0310-9956-ffa450edef68"
5ea3aadfe33ab30aad977ea04bad61105d039720,"Forgot an 'import' in DupFilterIterator
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335406 13f79535-47bb-0310-9956-ffa450edef68"
5d3c898bb4155dd4a4a2ceebbd4e8038e4b87765,"missing file
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335407 13f79535-47bb-0310-9956-ffa450edef68"
28f7e333779cc956c74e6eac7fa6d0cf014ed451,"Added another fix for the missing DOCTYPE declaration. XSLTC will now output
DOCTYPE declarations for HTML output if either doctype-system or doctype-
public is declared in the <xsl:output> element. XSL output will get a
DOCTYPE declaration only if doctype-system is declared.
PR:		1504
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335408 13f79535-47bb-0310-9956-ffa450edef68"
ee5a40a9c453ce84a3f62c7bcd0ad26c1ad12e65,"PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335409 13f79535-47bb-0310-9956-ffa450edef68"
99a0f129589671ff354b0a626561c122283d0248,"turning on filtering, bug 2553


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335410 13f79535-47bb-0310-9956-ffa450edef68"
e6e804d8b8b43eca596ead985b9c807366b35513,"Removed a bad optimisation in the duplicate filter iterator.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335411 13f79535-47bb-0310-9956-ffa450edef68"
be60972735dc72ea42ae9a13af0902b0d94e7e1f,"Major update for id() and key(). Patterns containing id() and key() are
now 100% supported (about time), and id() and key() expressions should
now work in all (at least most) combinations.
PR:		bugzilla 1376 (!!!) and 2624
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335412 13f79535-47bb-0310-9956-ffa450edef68"
aa9ccd3f686a5cf68775f4274348c06420adf7e8,"re-activated the no dups filtering, dont know how
this got reverted back to no filtering, but it is fixed again.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335413 13f79535-47bb-0310-9956-ffa450edef68"
f4c6001da817c1d66b4ac0b0b84bc021f33c8038,"Make sure base is not null before checking for its contents.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335414 13f79535-47bb-0310-9956-ffa450edef68"
3e52272e1e80630e2b0d0a35ed435d5592912e2b,"Fix document function so that if only one argument is passed and it is a nodetest, the base to be used to resolve relative URIs is the base of the each node in the nodeset.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335415 13f79535-47bb-0310-9956-ffa450edef68"
eef24d191de7d3fb90e287e9657bc4ae51187edc,"Allow multiple iterations of xsl:with-param within an xsl:call-template or xsl:apply-template


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335416 13f79535-47bb-0310-9956-ffa450edef68"
158228f0dc51b6b6d4ebbddb144df3a568e975fe,"A small fix for a cleanup I did in the basis library (it broke the
substring() function)>
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335417 13f79535-47bb-0310-9956-ffa450edef68"
faf1937f010c57c49f048cfebb65d811246cd2be,"Added small fix to prevent NPE in output handler.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335418 13f79535-47bb-0310-9956-ffa450edef68"
b49d8887b2fd85f8d0792533d90234dfe84e004b,"Added element/attribute prefix information in the internal DOM.
This should fix some problems we have had with the copy and copy-of
elements. Added a few lines of code in an attempt to speed up the DOM builder.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335419 13f79535-47bb-0310-9956-ffa450edef68"
55f41edabead4dda1f221b12fd3e19989652c031,"Added getCurrentNodeList() for getting the current node list as defined
by http://www.w3.org/TR/xslt#dt-current-node-list.
This looks up the stack of the SubContextLists to find the top-level
LocPathIterator.  I'm fairly unhappy with this fix, and hope to restructure
the context list stuff a bit to avoid the casts in the getCurrentNodeList(),
and to fix getCurrentNode() so that it properly defines the current
node as defined by the XSLT spec.  As a matter of fact, I would
like to break up XPathContext into an XSLTContext.
Part of the http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3031
fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335420 13f79535-47bb-0310-9956-ffa450edef68"
be69971b81d69b6c20849e125be3d33892498947,"Call new XPathContext#getCurrentNodeList.  Fixes
http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3031.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335421 13f79535-47bb-0310-9956-ffa450edef68"
a5d12600a1b6d189cde7e787a6a28cbf68d18bb9,"Fix for problem reported by Mike Starr <mike.starr@air2web.com>,
where the transformation hangs for ""foo[2] | bang""
patters, i.e. unions with positional predicates.  The fix
is to have the iterators#nextNode() set m_lastFetched to DTM.NULL
when m_foundLast is found to be true on function entry
(after the cache check).  This allows getCurrentNode() to
fullfill it's contract of returning null if the last fetch was
null.  The bug occured after an optimization for positional
predicates to have them not continue searching once
the positional node was found, by setting m_foundLast
to true.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335422 13f79535-47bb-0310-9956-ffa450edef68"
610436ae31839c1e88acd67c1a8951e134e574d6,"An attempt to optimise the building of the ID index. The previous version of
this code would traverse the DOM once for each type of element that had a
defined ID attribute. The new version traverses the DOM once, and looks up
each element's type in a hashtable to determine its ID attribute type (if any).
The new version of the code does not use string comparisons, like the old one.
This update was done to compensate for the possible performance degradation of
having implemented an element/attribute prefix array in the internal DOM.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335423 13f79535-47bb-0310-9956-ffa450edef68"
f5cc482997998a8a1192c3d74720aafbee42b045,"Protected some methods in our TrAX code that are not defined in the TrAX API.
These methods were never intended for public use and should have been defined
as ""protected"" to begin with.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335424 13f79535-47bb-0310-9956-ffa450edef68"
894e8576e7043433f4ffd9df9e214c347f84df6e,"Fix for a problem with some combinations of <xsl:element> and namespace
aliasing. The output lacked the necessary namespace definitions when an
element created with <xsl:element> was given a qname with a prefix that
was mapped to some other prefix.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335425 13f79535-47bb-0310-9956-ffa450edef68"
dd8e48b97c508ac2c10c3b0cc132fd70e7c38e95,"removed typeCheck(), uses the base classes method now


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335426 13f79535-47bb-0310-9956-ffa450edef68"
63dffebeb6564f3844b4495aa5e8a46ad26b0bfb,"added default typeCheck() to this base class


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335427 13f79535-47bb-0310-9956-ffa450edef68"
8ef00603e94671cb54334995f8ad0d154cb59a21,"bug fix 2838, cast to type real if both operands are
ResultTreeType


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335428 13f79535-47bb-0310-9956-ffa450edef68"
8f5731c1ae1a3caa87ba9caa01eb02e27d718648,"Updated for streaming mode changes
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335429 13f79535-47bb-0310-9956-ffa450edef68"
91729743811a060b90551d0bb967dbae347ffa2b,"Upated for Streaming mode changes
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335430 13f79535-47bb-0310-9956-ffa450edef68"
a25c7cb6d39a39b11a5f13ebf35b0e07900520ae,"Updated for Streaming Mode Changes
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335431 13f79535-47bb-0310-9956-ffa450edef68"
3d0d382e155654a2347ff5509070145872fc8ac5,"Fixed Streaming Mode
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335432 13f79535-47bb-0310-9956-ffa450edef68"
291f698627fce47d0e9f0e30d878da714ab5a074,"added document registration and release events to the DTM interface
PR:
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335433 13f79535-47bb-0310-9956-ffa450edef68"
a394e20c18330ed410fec22b876d64afc492e5e9,"Removed debug flag
PR:
Obtained from:
Submitted by:John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335434 13f79535-47bb-0310-9956-ffa450edef68"
d031c203f0b1ea9368f8a08265d24f4b239de970,"Fix bug 3112 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3112).  Fix tokenize to work with DTM by obtaining a new DocumentBuilder and not using the document from the context node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335435 13f79535-47bb-0310-9956-ffa450edef68"
8967f362489d7c11fab7a79468fabaf2c0f18c3b,"Fix bug 3265 (http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3265).  Using an expression in the evaluate extension function that contains a top-level variable was cause an NPE.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335436 13f79535-47bb-0310-9956-ffa450edef68"
08249651659b82cf34b4010108fd9a9657c78736,"Fixed two bugs, one in getChars and one in charAt where the m_start
offset wasn't being used correctly.  This manifested itself in some
stuff I was doing with the startsWith function, but likely caused
many other bugs with other functionality.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335437 13f79535-47bb-0310-9956-ffa450edef68"
13b60fae1229f3e6199778199f643f12e6de6007,"Changes all calls from the compiled translet code to the DOM to be calls
to the DOM interface (and not to a specific DOM class). I did this to make
it possible to plugi in any DOM implementation.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335438 13f79535-47bb-0310-9956-ffa450edef68"
a4d1d4719922c520f63a281599a0d36b491dd13a,"Forgot to add this file in my last putback.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335439 13f79535-47bb-0310-9956-ffa450edef68"
c98e10d09e11989532c855f16d3bca54bdecd6d1,"Added an <xsltc:output> extension to allow for multiple output files. I know
that this is not a prioritised task, but I need this for a little project I
am working on.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335440 13f79535-47bb-0310-9956-ffa450edef68"
61af9c5713955e954f02a5c7c93ce30b66c3713b,"A few fixes for the regression caused by my last (huge) putback.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335441 13f79535-47bb-0310-9956-ffa450edef68"
704b63af803f42eb8a84ecc0917781433ec28f61,"A fix for the position() function when using duplicate filter iterators.
PR:		n/
Obtained from:	N/A
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335442 13f79535-47bb-0310-9956-ffa450edef68"
3ba75005ee677c2795b53da60f5674b64956850b,"added dumpNode method, convenience for debugging.

We might want to move this function up to DTMDefaultBase, or
 perhaps to the DTM API itself.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335443 13f79535-47bb-0310-9956-ffa450edef68"
1ad89683e61cc0fd3e333714d440d3e6900d7457,"Fix http://nagoya.apache.org/bugzilla/show_bug.cgi?id=3131 by
overriding writeNormalizedChars and writeUTF16Surrogate to
not do any XML escaping.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335444 13f79535-47bb-0310-9956-ffa450edef68"
832db7a2365fdc72b66def98be94830014a3d5c7,"The index was being stored as opposed to the node handle when we were replacing namespace nodes. Store the actual node handle.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335445 13f79535-47bb-0310-9956-ffa450edef68"
593109b1bd93a0b2037391ceec2ee4cb6a21a586,"periodic update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335446 13f79535-47bb-0310-9956-ffa450edef68"
bbdf929ee622a1e33b095b805db301997a329610,"Updated version to 2_2_D10


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335447 13f79535-47bb-0310-9956-ffa450edef68"
207b76f6fde02fd0a5481a50e25e582c0e90cecc,"Updates for a potential 2.2.D10


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335448 13f79535-47bb-0310-9956-ffa450edef68"
e8ebf3a4cdcaa682d1c7fb046cbf1d0669d8c6ec,"Updated version number to 2.2.D10


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335449 13f79535-47bb-0310-9956-ffa450edef68"
e65a77177ec41b0f1b5dabe036f2fd66619dd9cb,"Xerces 1.4.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335450 13f79535-47bb-0310-9956-ffa450edef68"
9809e17924082bfa0eefbc8b9ea083c9dd65ef32,"Fix for Bugzilla 2684 StringIndexOutOfBounds Exception. Check if we are at the end of the pattern string.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335451 13f79535-47bb-0310-9956-ffa450edef68"
1c2be938a4ecad22b802e233bfc1eacc3e3d8e15,"Submitted by: Tom Amiro
Reviewed by:

I just added an empty close method to resolve the build problem.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335452 13f79535-47bb-0310-9956-ffa450edef68"
7c1d59a6539b79fa748638c162f9ab64ceb286c9,"Adding my PGP key


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335453 13f79535-47bb-0310-9956-ffa450edef68"
502b32f0fa3a44e2154cb75798f9ee0e79d30ea9,"Removed the code which precalculated node levels
(depth in tree). This has been IFed out for some time, but
was retained in case we wanted to go back to it. Since it
seems we're happy with this choice, zapping it entirely
saves a few more cycles.

It's simple enough to recreate if we change our minds later.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335455 13f79535-47bb-0310-9956-ffa450edef68"
03421bf0bb77e0c3d1e3d577c471ecdbc3fb4618,"bug fix # 3424, memory retension fixed, John Howard contributed fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335456 13f79535-47bb-0310-9956-ffa450edef68"
17dce4ee584b565ee5fcfc8162d5c6070bb12707,"bug fix 2807, seth ford's fix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335457 13f79535-47bb-0310-9956-ffa450edef68"
719e993d33fe3e56276bbbc1b136da4bfc1f71fb,"bug fix 3426, gunnlaugur briem's fix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335458 13f79535-47bb-0310-9956-ffa450edef68"
208b3df3d72da1d1228e1daf69038ecd3096996a,"bug fix 3320, gunnlaugur briem's fix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335459 13f79535-47bb-0310-9956-ffa450edef68"
569f441c6e174cbbcf47ce06af8cf29a6c40ae49,"updated comments from bug fix 2553


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335460 13f79535-47bb-0310-9956-ffa450edef68"
0133ca503015569d52460fa164d5be6e4b58c5ae,"Added faq on the ""Namespace not supported by SAXParser""
exception.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335461 13f79535-47bb-0310-9956-ffa450edef68"
4b1630064a5bf028855487f83a0689f7d87d52c3,"Added link to JAXP FAQ in faq on setting the namespaceAware
property.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335462 13f79535-47bb-0310-9956-ffa450edef68"
a54da6361c2a2f2158749ac6f6e10fd90bd9840f,"Minor cleanup and updates in preparation for extension function;
note SAX portion isn't complete yet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335463 13f79535-47bb-0310-9956-ffa450edef68"
aa18fbcb8e34061e5cb208cad87e7f726ba615e4,"bug fix 3360, predicate handling added


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335464 13f79535-47bb-0310-9956-ffa450edef68"
4213681cfa74a4c3a12e66ac0611c13980b908fc,"Update EnvironmentCheck service with SAX checking; better method organization;
Add checkEnvironment to xalan: built-in Extensions class


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335465 13f79535-47bb-0310-9956-ffa450edef68"
8c86c1b7dc98f7ec7f6842447b02da0315f5ec40,"Update lots of documentation, GUMP: comments, target descriptions; clarified some variables;
Add/update targets to match 'Standardizing build.xml files';
change print.docs to printerdocs, added install/uninstall/distclean/all etc targets;
Update smoketest target to call ../test/build.xml smoketest.dev target


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335466 13f79535-47bb-0310-9956-ffa450edef68"
7c898d4862fafb77df05e05f77e595e9f9a2f485,"I have updated out output handler to treat this in the same manner as XT does.
We allow AVT's to create namespace mappings between some prefix and the null
URI. But, whenever an attribute or element uses a prefix that maps to the null
URI we replace the prefix with the default prefix. So insead of outputting an
illegal namespace declaration xmlns:ns1="""" and ns1:Attr1=""Whatsup"" we simply
output Attr1=""Whatsup""
PR:		bugzilla 1518
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335467 13f79535-47bb-0310-9956-ffa450edef68"
197ea6928e777d020e05a11533df16aac935fcd1,"Modified some of the error messages that are reported by this command-line
tool to include full and correct error messages.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335468 13f79535-47bb-0310-9956-ffa450edef68"
5e782ddba2c4f5c8d4fbb3e944693cbfa56b5a08,"Added support for comment nodes in the DOM. This support disappeared when
we upgraded the DOMBuilder's interface from SAX to SAX2. Added a new
interface for the DOMBuilder that includes SAX's ContentHandler _and_
LexicalHandler.
PR:		bugzilla namespace30
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335469 13f79535-47bb-0310-9956-ffa450edef68"
0ff434bba675600a6dde478ea09f6afd189d5c68,"Updated the output handler to URL encode href attributes in HTML output.
I used the URLEncoder class in java.net
PR:		bugzilla 1512
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335470 13f79535-47bb-0310-9956-ffa450edef68"
5c7229ae60c117a5531d235dcb11ab580b7637c9,"Fixed the default output SAX handler so that it does not indent empty HTML
tags such as <col> and <br>
PR:		bugzilla 1525
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335471 13f79535-47bb-0310-9956-ffa450edef68"
bc6f2655872cf459278fe9a276086471dcf2e0c3,"Fix to prevent character escaping inside <script> and <style> elements in
HTML output.
PR:		bugzilla 2517
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335472 13f79535-47bb-0310-9956-ffa450edef68"
6481d4d148ea9c36246f946ecebab69139db17f4,"Fix to always return 'true' when result tree fragments are converted to
boolean values (because a result tree always has at least one node - root).
PR:		bugzilla 2595
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335473 13f79535-47bb-0310-9956-ffa450edef68"
3797ffcd85158cc9fdcf44623662d1aa45515606,"Added some code to the DOM builder to make sure that text nodes are not
broken up into smaller fragments.
PR:		bugzilla 3506
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335474 13f79535-47bb-0310-9956-ffa450edef68"
10dd7eda3c359abef674cc9d34fac92302540836,"Fix for the count() function and union iterators. Union iterators would not
reset all the iterators it contained, and it needed a reset() method.
PR:		bugzilla 3504
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335475 13f79535-47bb-0310-9956-ffa450edef68"
0bffae23632b9dd0a96369574437cedefe4020c7,"bug fix 3312, //xx/descendant works now


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335476 13f79535-47bb-0310-9956-ffa450edef68"
84cd2e7c6515d786741a16428717fb9ab6f873f0,"Bug 2140: Catch index out of bounds exception


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335477 13f79535-47bb-0310-9956-ffa450edef68"
cc99b893db033a14c3c69d5ce95b996cca124af7,"Bug 2130: Check for null data to avoid NPE


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335478 13f79535-47bb-0310-9956-ffa450edef68"
86c235a96f9e029d5be87eef2b6fa6b66e7a9943,"Bug 3421: Issue an error if namespace attribute is used with an empty string in xsl:element


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335479 13f79535-47bb-0310-9956-ffa450edef68"
d6971b94a4e007e0e07c280544dc3e5c5df61e74,"Backing out this change. Some conformance tests need to be updated first


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335480 13f79535-47bb-0310-9956-ffa450edef68"
e91c808efaad6d408bbddbb8201be1b711fda795,"Removed a debug statement that was left in here by mistake. Bad, bad, bad!
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335481 13f79535-47bb-0310-9956-ffa450edef68"
fc080c944659dd6a3909c11c487ea405bcada12c,"added test for ParentLocationPath instance


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335482 13f79535-47bb-0310-9956-ffa450edef68"
60b69c3d018830ce4b694f5ac98c5e683e8f9cfe,"bug fix 3312 completed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335483 13f79535-47bb-0310-9956-ffa450edef68"
76cee4790aac2d31c37102c9506394dce0b27853,"Bug 3421: Issue an error if namespace
attribute is used with an empty string in xsl:element


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335484 13f79535-47bb-0310-9956-ffa450edef68"
a76ef58e78fbbc4aa803a8861072f7e3c9e68750,"Bug 3442: when building the prefix table for an element, just override prefixes defined in parent element with uris that have been redefined by the element instead of keeping both uris in the table.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335485 13f79535-47bb-0310-9956-ffa450edef68"
2091987bf62237c07d7e445aaeb002a2350cb3af,"Fix Bugzilla 3491: updated error message text; also updated Javadoc to
reflect @throws; note that the Javadoc is still somewhat contradictory
about returning a null on error (it appears to throw exceptions instead)
PR:3491
Submitted by:Julian.Birch@ranplc.co.uk


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335486 13f79535-47bb-0310-9956-ffa450edef68"
60fb3a77480d564f44248f3465d542b0c3ac33be,"Fix Bugzilla 3423: documentation updates for proper class, property names
(one of two checkins)
PR:3423
Submitted by:gthb@dimon.is


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335487 13f79535-47bb-0310-9956-ffa450edef68"
ccf83d0596fe049d1b579f16e938977438597b03,"Fix Bugzilla 3423: documentation updates for proper class, property names
(two of two checkins)
PR:3423
Submitted by:gthb@dimon.is


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335489 13f79535-47bb-0310-9956-ffa450edef68"
9039865c369bb2d581ac54e2b1d37951c87104cc,"Fix Bugzilla 2637: documentation updates for constructor functionality
PR:2637
Submitted by:gthb@dimon.is


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335490 13f79535-47bb-0310-9956-ffa450edef68"
9407e2a16f2ba6b2b5350f6d3a28cbeefd2a4f78,"Several bugfixes and fixes for regressions recently introduced by other
bugfixes.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335491 13f79535-47bb-0310-9956-ffa450edef68"
c6a8e52995cc4123fe51f704036c966a2d49302e,"Fix for parameter references used within predicates.
PR:		bugzilla 3405
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335492 13f79535-47bb-0310-9956-ffa450edef68"
5ebd1476e698c5d1a4cd5191180cb2aadfc99b7f,"Bug 2548: Combine attribute sets with the same name but process them in order of precedence.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335493 13f79535-47bb-0310-9956-ffa450edef68"
390bb6477dcef9f8454360ecce7b462002087c68,"Bug 3533: Check for null m_iterators before trying to use it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335494 13f79535-47bb-0310-9956-ffa450edef68"
40cd321304d4939361edaa75f6481bcb7ed03b97,"Added '-s' option to command-line compilaton tool to precent calls to
System.exit(); This is needed when the command-line tool is invoked by
our Java-based test harness.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335495 13f79535-47bb-0310-9956-ffa450edef68"
6c2444287beb572891c9392c9d20ac71720cd500,"Added test in the method that handles stylesheet PIs in embedded stylesheets.
This method did not properly test for the existence of stylesheets referenced
in these PIs (ref. Sun's test embed09).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335496 13f79535-47bb-0310-9956-ffa450edef68"
81a40728b41f41ec63da2fd9d3bc1842fed9361a,"Bugzilla 3618: Check cache before anything else when getting the next node in the iterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335497 13f79535-47bb-0310-9956-ffa450edef68"
76a31ba5a5fdafd2bd9ef441d8c59d891799ad7e,"Changed the TransletException class so that it inherits from SAXException
and not from Exception. This should make it possible for us to avoid
testing for both SAXExceptions and TransletExceptions. Exception handling
is one of the things that JVM takes its time with, and we should try to
avoid using them when we can, and use as few of them as possible otherwise.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335498 13f79535-47bb-0310-9956-ffa450edef68"
09cdc7db20706dcde0cfa7ba5f89ac976668ec03,"Fix for predicates used in complex match patterns. The compiler failed to
produce code that would match on patterns like ""blob/*[@attr='str']"". It
would also fail to identify some position predicates such as ""blob[$param]"".
Nested parameters were not handled properly either. A pattern such as
""foo[bar[starts-with(@attr, 'baz')]]"" would be broken up and actually
compiled twice - the outer predicate would be compiled first and the inner
one after that. This fix makes sure that the predicates are handled together
as one test, and not as two separate tests.
PR:		bugzilla 1376 (was an id/key problem, now predicates)
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335499 13f79535-47bb-0310-9956-ffa450edef68"
a2a68defb838d4c5a7719ed0db9fb7fa6d36a62a,"Modified the output handler and SAX handler to produce proper HTML output.
Special characters in <script> and <style> elements are no longer escaped,
and end-tags are properly produced (sometimes we would forget the last '>').
PR:		bugzilla 2517
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335500 13f79535-47bb-0310-9956-ffa450edef68"
21b6a66362c10ad6ec27ea86d2ab865e9a8a1206,"Verious fixes for iterators.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335501 13f79535-47bb-0310-9956-ffa450edef68"
9320bf0948bc65a766e8dfeaf563a9c7dfe8013c,"A fix in the duplicate filter iterator to ensure that the iterator can be
reset properly. The iterator was using its own variable for tracking the
current node (not the base class' _position variable) but did not
implement the reset() method).
PR:		bugzilla 1430
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335502 13f79535-47bb-0310-9956-ffa450edef68"
2481c7733db5e4b02a62e8167abc064774089b06,"Forgot to add this file with my fix for bug 1430.
PR:		bugzilla 1430
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335503 13f79535-47bb-0310-9956-ffa450edef68"
152daf6d2e003815b0f5709caf9db77d7a4c0124,"Bugzilla 2332: Implement getAttribute() method to return the values for incremental and optimize


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335504 13f79535-47bb-0310-9956-ffa450edef68"
55e23e3661175d8e847c413ee59266189a7c7eda,"Fix for combination of wildcards and position predicates in match patterns.
PR:		bugzilla 1532
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335505 13f79535-47bb-0310-9956-ffa450edef68"
7476ba174424dde510be3249568501c6f0f63646,"bug fix 2838, (namedtemplate test)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335506 13f79535-47bb-0310-9956-ffa450edef68"
f85e30d1dc02264d6522eb8d9462d6fe02adc707,"Fix to prevent escaping of the '""' character. This character should only
be escaped inside attribute values, and not in text nodes.
PR:		bug 2952
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335507 13f79535-47bb-0310-9956-ffa450edef68"
ddabdba832cf10fca584e8a4856965fae711a0fb,"Fix to prevent complaints about illegal namespace declarations in output.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335508 13f79535-47bb-0310-9956-ffa450edef68"
014268e48d98642c320ac740242b1d5303234a20,"Fix for ChildrenIterator to speed up last() and position() calls.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335509 13f79535-47bb-0310-9956-ffa450edef68"
9750b8e09534de39809448a6d22a88753b723f75,"This fix may affect a series of bugs. The AbsoluteIterator (/foo/bar/... etc.)
did not update its _position variable, causing position() to return wrong
values if called more than once.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335510 13f79535-47bb-0310-9956-ffa450edef68"
43c5b731ef714872df347acd7e8150c1043abe32,"Added shortcut to call the reset() method on any iterator.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335511 13f79535-47bb-0310-9956-ffa450edef68"
e6660d62aef54e70171cb4cd76050a410661d7c7,"Fix to ensure that node iterators stored inside parameters are clones for
each time the parameter is referenced. If this is not done then the node
iterator will be in an unstable state after it has been referenced once.
PR:		bugzilla 3238
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335512 13f79535-47bb-0310-9956-ffa450edef68"
30288ac6c8b151ebc552949791db65d6d4a3ebfe,"A fix for layers of parent location paths and steps representing an
XPath pattern/expression like /foo/*/bar
PR:		bugzilla 3311
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335513 13f79535-47bb-0310-9956-ffa450edef68"
b965c96dca75d313915bb2cbc57751ad313f6f8d,"Removed a change from yesterday that caused a pretty bad regression in
the position() and last() functions. Also changed a line un Param.java
to add more information in debug outout.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335514 13f79535-47bb-0310-9956-ffa450edef68"
b40085f75b01dab99ee4d6eb24b37a0a92132460,"Corrected &xslt4c;  entity ref to &xslt4j;.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335515 13f79535-47bb-0310-9956-ffa450edef68"
28be0aecf025f57d2fe6011589611b227887a0b3,"Added escaping of special characters in parameter names when passed to a
template using <xsl:with param/>.
PR:		bugzilla 3324
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335516 13f79535-47bb-0310-9956-ffa450edef68"
afb0132fa083b8e213bdf345425920283cf3ca13,"Enable Attr.getOwnerElement()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335517 13f79535-47bb-0310-9956-ffa450edef68"
9d0445186de38c680054d11bc26a42e0b8d6b0eb,"minor edit to usuage for -s option


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335518 13f79535-47bb-0310-9956-ffa450edef68"
654a0e9991a3656bee1bd9cfa3939c47b480d2c5,"Bugzilla 1803: Handle version attribute on a litteral element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335519 13f79535-47bb-0310-9956-ffa450edef68"
ad28548bbc8cca7816e69a5b43dd3683dbea56b7,"Added functionality behind the '-s' flag in the Transform command-line tool.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335520 13f79535-47bb-0310-9956-ffa450edef68"
52d801bc9b283503ad3b2db372d16e81e2f8a235,"Fixed two compile errors (bad, bad, bad).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335521 13f79535-47bb-0310-9956-ffa450edef68"
55c7e7b1d0d253233427e97e19ee63ad1f81ba31,"Fixed the getTypedPosition() and getTypedLast() methods of the DOM. These
were used to implement XPath patterns such as /foo/bar[8]/baz.
PR:		bugzilla 2803
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335522 13f79535-47bb-0310-9956-ffa450edef68"
f5a4ea2fe1497546ab920d6584ad465c8581f8bf,"Added a little method to the output post-processor to replace whitespaces
in URLs by ""%20"" sequences. This is all the escaping I think we should
bother our heads doing.
PR:		bugzilla 1512
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335523 13f79535-47bb-0310-9956-ffa450edef68"
3b76ccf0fb42918c762d62aa3697cbd60b3a686c,"Two fixes in this one. One to make sure that the context-node is set correctly
when applying templates using an iterator that has a predicate that tests on
'.' (the current node), such as select=""foo/bar[. = 'blob']"". The other fix
is for the nth position iterator, that failed to count to n backwards in
cases when the underlying iterator was reverse.
PR:		bugzilla 2954 (two bugs in one, really)
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335524 13f79535-47bb-0310-9956-ffa450edef68"
5bc4c50752bad6e01c54b5d2da68b1fbd7e1972f,"A fix for CDATA elements. The tags of CDATA sections were passed through the
output post-processor's character escaping function but should be passed
directly to the SAX handler.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335525 13f79535-47bb-0310-9956-ffa450edef68"
f128e5b22eb660a330f1b87e71ff7c569064de85,"The fix for 2954 introduced a regression, so I am pulling out the fix.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335526 13f79535-47bb-0310-9956-ffa450edef68"
94a40f4a96f35194e8bed78a96e5204776e0535c,"A revised fix for bug 2954, that does not cause the regressions previously
sown by some tests.
PR:		bugzilla 2954 (revised fix)
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335527 13f79535-47bb-0310-9956-ffa450edef68"
6021f1692977fbcd4494d5cb78a84dfa5196984e,"A fix for the last() function for children iterators.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335528 13f79535-47bb-0310-9956-ffa450edef68"
c9c11381045be9b0fafd5874d1404c65d0dedf56,"Fixed the descendant iterator so that it does not return text-nodes
for descendant::*
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335529 13f79535-47bb-0310-9956-ffa450edef68"
9a12e2d0ca5b7ff7e34fec5a9f76512594a2b407,"Fix for resolving mutiple defined global parameters and variables. The
Import class has been fixed to set import precedences properly, and the
Param class has been changed to use the import precedence to resolve
between multiple definitions of the same variable/parameter.
PR:		bugzilla 3404
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335530 13f79535-47bb-0310-9956-ffa450edef68"
07316604138d735217e595142929ddb0b4584d68,"Forgot this file in my last update.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335531 13f79535-47bb-0310-9956-ffa450edef68"
cfe6a75f2f55ab885e4a2b7af3ac14b4a02c323f,"Another fix for the preceding-sibling iterator. It appeared that this
iterator returned its nodes in the wrong order, and this was the reason
why the position iterator (used to implement preceding-siblling::*[n])
did not return the correct node. It is quite amazing that this iterator
has been returning nodes in the wrong order for so long without any of
us notising, and hopefully this fix will help eliminate a few of our
open bugs.
PR:		bugzilla 2954
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335532 13f79535-47bb-0310-9956-ffa450edef68"
3876872609fb0e4cb95e94981744c2eb9ee22d32,"Fix to resolving multiple defined global variables or parameters.
PR:		bugzilla 3404
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335533 13f79535-47bb-0310-9956-ffa450edef68"
d874bd3374444ce7e927d651e059f43dae8a66b9,"Optimisation for string-2-int and real-2-int conversions.
PR:		bugzilla 3448
Obtained from:	n/a
Submitted by:	John Howard (johnh@schemasoft.com)
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335534 13f79535-47bb-0310-9956-ffa450edef68"
3991a1632dba881559a42e63a4f65fc27d83bc5e,"Fix for nth-position typed descendant iterators (previously not fully
implemented).
PR:		bugzilla 3468
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335535 13f79535-47bb-0310-9956-ffa450edef68"
06d8360167187fe56ef6fd18b19da9b638e0e27a,"Fix for our handling of the <xsl:comment? element.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335536 13f79535-47bb-0310-9956-ffa450edef68"
3c5770ec8eb5d1d60e98da4dc56fc39527a67477,"Removed previous attempt to fix forward references in globar vars.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335537 13f79535-47bb-0310-9956-ffa450edef68"
a02e980dd4905b5a36b912033ee39a969b51293f,"Fix for allowing LRE as top-level elements in the stylesheet (they will be
ignored).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335538 13f79535-47bb-0310-9956-ffa450edef68"
b55cf291bb84bd47342b46b8bc7e6f9edb09ce2c,"release 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335539 13f79535-47bb-0310-9956-ffa450edef68"
91cb52ea326322e40dd2945d9184af2c384d1bd8,"Fix to make sure all num-numeric values are grouped last in numeric sorts.
PR:		bugzilla 3517
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335540 13f79535-47bb-0310-9956-ffa450edef68"
a385992e60f5ec524791b66eee4becec2eccd32a,"updates to history sections for release 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335541 13f79535-47bb-0310-9956-ffa450edef68"
aca6f2daeaa7122288670355e4e01109072ded5d,"A fix to ensure that the current position of any iterator is always kept
updated. The returnNode() method of the NodeIteratorBase base class updates
the _position variable for each returned node. This method should be called
by the next() method of any iterator, except for next() methods that call
super.next() (because this method calls returnNode() and so _position
would be incremented twice or more for one returned node).
PR:		bugzilla 3816
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335542 13f79535-47bb-0310-9956-ffa450edef68"
e247eed80ec568af199a04cadf46da2a1636bd8e,"interim update for release 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335543 13f79535-47bb-0310-9956-ffa450edef68"
d7028db5c3bbed5aed364a2bb8baf2d18ca30dea,"Updated the information returned by the system-property() function.
xsl:verision returns ""1.0""
xsl:vendor returns ""Apache Xalan XSLTC"" - must be different from Xalan!!!""
xsl:vendor-url returns ""http://xml.apache.org/xalan-j""
PR:		bugzilla 3470
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335544 13f79535-47bb-0310-9956-ffa450edef68"
46dd295dbb099c15b44234ea0e690156b39d61ef,"Fix to allow indentation to be turned off XML/HTML output.
PR:		bugzilla 3469
Obtained from:	n/a
Submitted by:	Douglas J. Sellers (douglasjsellers@hotmail.com)
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335545 13f79535-47bb-0310-9956-ffa450edef68"
86764e21c0e77b974f45d6200c3435cc039ca1e1,"Added version information and sections to manifest file;
Updated build script to filter manifest for version info;
Copy over xml-commons DOM/SAX/JAXP sources a'la crimson's method (thanks Edwin)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335546 13f79535-47bb-0310-9956-ffa450edef68"
85bb124589dfcfc34112207cf0b5083f5964d8ba,"Fix to make sure the one, and only one, xsl:output element is compiled
per translet (import precedence taken into account).
PR:		bugzilla 3099
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335547 13f79535-47bb-0310-9956-ffa450edef68"
23de77592e91770871777305c82d027741a70e67,"Changed BasisLibrary.formatNumer() (this is the implementation of
format-number()) so that it correctly formats NaNs into ""NaN"".
PR:		bugzilla 2890
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335548 13f79535-47bb-0310-9956-ffa450edef68"
1e435ccb0550817516163c070c373c3c38e179f1,"Another little update to format-number() to make sure it returns
""Infinity"" and ""-Infinity"" for infinite numbers.
PR:		bugzilla 2889
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335549 13f79535-47bb-0310-9956-ffa450edef68"
728cacaf9e1f62f66a6bbe4bd97eb084123c278e,"Changed the order in which a stylesheet parses its top-level elements.
PR:		bugzilla 3812
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335550 13f79535-47bb-0310-9956-ffa450edef68"
9e9caf23dda94ad42aba404f01b1f27eb6be3692,"Removed a bug in the NthIterator iterator that prevented the iterator from
properly being reset. This bug manifested itself if the Nth iterator was
wrapped inside a step iterator.
PR:		bugzilla 3419
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335551 13f79535-47bb-0310-9956-ffa450edef68"
9a0b5193a01eafdbb0ec3936a582ca77c1cebda4,"Added node-ordering for preceding iterators when used in apply-templates
or value-of elements.
PR:		bugzilla 3463
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335552 13f79535-47bb-0310-9956-ffa450edef68"
a5b90223dac8436b9741a341ee08821ef524292f,"Removed debug statement in Step.java
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335553 13f79535-47bb-0310-9956-ffa450edef68"
b347f1b967810633b9f89446dadd0600d5947230,"Modified the DupFilterIterator so that it also orders nodes.
PR:		bugzilla 3466
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335554 13f79535-47bb-0310-9956-ffa450edef68"
69800359f305d9211d80ea66097e28d9075f6c14,"Fix after a regression for preceding-sibling::* iterator.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335555 13f79535-47bb-0310-9956-ffa450edef68"
940e3bbdbb1094488729433863bd3f4c66b25b93,"Mark xsl:template as containing ordered elements. Fix for no error when xsl:param not first child of xsl:template


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335556 13f79535-47bb-0310-9956-ffa450edef68"
8f40c194c7d45615a346ab9199567ff45b3a4185,"changed sql/row-set/column-header to sql/metadata/column-header.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335557 13f79535-47bb-0310-9956-ffa450edef68"
5650f1d1803e651e5dba7722237c45e7199d515f,"Updates for 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335558 13f79535-47bb-0310-9956-ffa450edef68"
8d4359004c441a70dab41b84bbfa4b192f2d323b,"Updates for 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335559 13f79535-47bb-0310-9956-ffa450edef68"
218ee17fc1f603a259cb7e7c42066e933eb06c13,"interim update for release 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335560 13f79535-47bb-0310-9956-ffa450edef68"
cfa5a1396169cbb55c6015705f3c004be307495e,"A fix for the problem with loading auxiliary classes for sorting when
called from TrAX API.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335561 13f79535-47bb-0310-9956-ffa450edef68"
f919f17345e52a08ba88bf01c5d7aec9649f1aa4,"Bugzilla 3800: Make sure that when looking for excluded prefixes, we check the URI associated with the prefix, not the prefix in the excluded list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335562 13f79535-47bb-0310-9956-ffa450edef68"
64867b7c15be4398fb2f49f9d7b93f71f6bcfcf5,"Corrected path to xalan2jdoc.jar -- ${doclet.jar}, not ${doclet.jar.name}.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335563 13f79535-47bb-0310-9956-ffa450edef68"
dea5c36a352e821614e299f9c64abea6628d4ba0,"interim update for release 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335564 13f79535-47bb-0310-9956-ffa450edef68"
c29b02ef88b64445721c7c1e070846f755272c12,"interim update for release 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335565 13f79535-47bb-0310-9956-ffa450edef68"
d6fab584dcb6f5f3ee31b131ea0292bbb2d7f0aa,"Updates for 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335566 13f79535-47bb-0310-9956-ffa450edef68"
4ccf29e4c57d8c5cf94ea69132444b7832a78625,"changed sql/row-set/column-header to sql/metadata/column-header.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335567 13f79535-47bb-0310-9956-ffa450edef68"
0921becb6e3e66bb96fa1f57e274aa47d6640592,"Do not reorder or strip duplicate nodes when converting a DOM nodelist into a DTM nodelist


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335568 13f79535-47bb-0310-9956-ffa450edef68"
b865c1035aa16edb733af7bb53a6d53378257cea,"Catch for unwrappered StopException (apparently not all parsers generate
a SAXException wrapper).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335569 13f79535-47bb-0310-9956-ffa450edef68"
0309ff9b66cd06a4061d70256d3b50a1ae9682bc,"Added readme for this demo


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335570 13f79535-47bb-0310-9956-ffa450edef68"
35730ccffea227e6336b9df0a333290f3c13c631,"Creating the implied Namespace Node for xml:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335571 13f79535-47bb-0310-9956-ffa450edef68"
d8135fe1912c9ba49d55c1e5ebaf1efdc25a2aa6,"Updates for 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335572 13f79535-47bb-0310-9956-ffa450edef68"
cb2460717641e1d48bb04766aca449bf43a2b425,"Beginning update for 2.2.D12


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335573 13f79535-47bb-0310-9956-ffa450edef68"
2ba4c6d171fd7624d536c0f9bdd1877a1146e833,"corrected version to 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335574 13f79535-47bb-0310-9956-ffa450edef68"
f7e5f8d379d6f0cae5247a6f810bd25f831aa0a8,"Developer release 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335575 13f79535-47bb-0310-9956-ffa450edef68"
85c69f6d084979bc690431ebeb2641de3062832d,"Fix to ensure that plain filenames can be passed in to the Transformer
and TransformerFactory. Up until now only URLs were accepted by the
TransformerFactory.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335577 13f79535-47bb-0310-9956-ffa450edef68"
218fffef1d42c9f6200540932aecffa365538529,"A few fixes to speed up output processing.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335578 13f79535-47bb-0310-9956-ffa450edef68"
872e17c5380c13f7bc34e8008015d7d388db54b5,"handle StreamResults that start with file: protocol


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335579 13f79535-47bb-0310-9956-ffa450edef68"
e04fb88f8e8edbd205a43fdb19d310c626b5342a,"corrected version to 2.2.D11


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335580 13f79535-47bb-0310-9956-ffa450edef68"
e5e624b5e0979bf689ba4d10d2b4e0b5db533a53,"Adding support for XSLTC-specific DOM caching in JAXP. The XSLTCSource
class implements JAXP's Source interface, and it encapsulates XSLTC's
internal DOM so that it can cached be passed to a Transformer multiple
times without having to re-parse the source document.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335581 13f79535-47bb-0310-9956-ffa450edef68"
c6f12e7ee79c09f71adb943bc5e9762008caffbe,"Fix to recently added XSLTCSource (DOMImpl wrapped in a TrAX Source).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335582 13f79535-47bb-0310-9956-ffa450edef68"
f26d93d4d31b21dc0291b62d318a20f51e4590bd,"Fix for a rarely occuring NPE in handling of <xsl:output> elements with
no 'method' attribute/
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335583 13f79535-47bb-0310-9956-ffa450edef68"
2cc11c0dff878f28fcc5727b759f886aea62e986,"Fixed a regression after an update to the descendant and descendant-or-self
axis.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335584 13f79535-47bb-0310-9956-ffa450edef68"
f8d660125dcbd5887983232c29cabb00db9e0ade,"Fix for a regression in a string-value function in the DOM.
The string returned from <xsl:value-of select=""/""/> included PIs.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335585 13f79535-47bb-0310-9956-ffa450edef68"
a4d33b62807a38bc478f317bfb62e329695295f3,"Made a global data-structure static (it should have been in the first place)
to make instanciation of this class a bit faster. Also, made it implement
the Externalizable interface to ensure that the DOM can be serialized.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335586 13f79535-47bb-0310-9956-ffa450edef68"
706695bb745afd0f8ce5340c5e9a23c2e11db914,"Fix for the abbreviated descendant axis in combination with the child axis.
The problem with this combination manifested itself in test axis82 and
Sun's tests zv038. This bug was a regression introduced after other fixes
to the // and descendant iterators.
PR:		bugzilla 3313
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335587 13f79535-47bb-0310-9956-ffa450edef68"
fea89ea7bed3525ce39fbcf4206cbf8b785c3858,"Bugzilla 1549 -- resolve xml: prefix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335588 13f79535-47bb-0310-9956-ffa450edef68"
ea9af57fbb777d211780fbd0b19763a47f6472c6,"Bugzilla 1102 :Fix Null Pointer Exception. Thanks to rainer@gtt.me-park.com.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335589 13f79535-47bb-0310-9956-ffa450edef68"
ef51bd5dbc2119ca71a89b80d50351bf30961d15,"Bugzilla 1165: Fix Null pointer Exception by checking for a null input param.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335590 13f79535-47bb-0310-9956-ffa450edef68"
465cca04ee3aad93bf8a4fd39a804c964647ae92,"Bugzilla 1549 -- resolve xml: prefix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335591 13f79535-47bb-0310-9956-ffa450edef68"
b7455ac2782b66e851c516874d61573919d0dc3a,"Added note on TransformerHandler (cannot reuse) in response
to Bugzilla SPR #1205.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335592 13f79535-47bb-0310-9956-ffa450edef68"
38eaf0f9240cd5f2e1da4b61dfbf992261a648bf,"Bugzilla 1165: Fix Null pointer Exception by checking for a null input param.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335593 13f79535-47bb-0310-9956-ffa450edef68"
fd3d61e355f3446d7220bb8dc4a12a2d37b148a8,"Bugzilla 1060 -- convert null nsuri to """" on output to match SAX conventions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335594 13f79535-47bb-0310-9956-ffa450edef68"
ff9ad25819bbf81f84c23539cc42568a14a475f5,"Added notes about handling of redundant namespace nodes when
traversing the namespace axis (bugzilla 2650), and incorrect order
of startDocument and setTransformState events (bugzilla 1800).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335595 13f79535-47bb-0310-9956-ffa450edef68"
efda2df94fd0086d9302f9aaaa7629f419df58fd,"Bugzilla 1132: changed getNamespaceForPrefix to also look for the default namespace


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335596 13f79535-47bb-0310-9956-ffa450edef68"
e9e9c7b79e4090538c6c7c07f1e19512a3e79bc3,"Bugzilla 3722; documenting known issue with simplest approach


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335597 13f79535-47bb-0310-9956-ffa450edef68"
a2138e689a4e31dc68fda40001705ed3a55053ed,"The TransformerFactory.setAttribute() method now throws an exception whenever
it receives a value for an attribute it does not recognise.
PR:		bugzilla 3859
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335598 13f79535-47bb-0310-9956-ffa450edef68"
9b536f940a22c648639d926bdaf6f01b62e99e93,"Fix for the getTransformer() method. Should return a reference to the
Transformer object, but always returned null.
PR:		bugzilla 3873
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335599 13f79535-47bb-0310-9956-ffa450edef68"
afe48a2eef74d3d078de7564e5643c1db2600a35,"Properly arranged the output properties in a three-layer Properties
structure. Properties were previously passed to the translet as they should
be, but only properties set through the TrAX API were returned by calls
to getOutputProperty() and getOutputProperties()
PR:		bugzilla 3948
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335600 13f79535-47bb-0310-9956-ffa450edef68"
46d28425015e4846d24d5162f4a364aa754652ce,"Changed the way in which we eliminated duplicate nodes returned by some
iterators. We had two iterators we used to lay on top of other iterators
that we suspected could produce duplicate or out-of-order nodes. These
iterators were DOMImpl$OrderedIterator and DupFilterIterator. I chose to
keep the latter as it both filters out duplcate nodes and puts nodes in
correct document order.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335601 13f79535-47bb-0310-9956-ffa450edef68"
06642ab01878fc8398552d4e812380e168004f17,"Fix for ordering of certain node sets.
PR:		bugzilla 3766
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335602 13f79535-47bb-0310-9956-ffa450edef68"
cbd76a2697cde0279a13be6791c287dcc6b3db6a,"Implemented a proper loadTranslet() method for the NodeCounterGenerator class.
The method was incorrectly names aloadTranslet(), and did not override the
desired method in the parent class. Also, the translet reference stored in
the '_translet' field of the compiled class' parent class (NodeCounter)
was not cast to AbstractTranslet before it was used.
PR:		bugzilla 3410
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335603 13f79535-47bb-0310-9956-ffa450edef68"
77e30dba094616ad5546d579306f32d42acd451c,"Fixed ordering of some node sets.
PR:		bugzilla 3816
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335604 13f79535-47bb-0310-9956-ffa450edef68"
9efc0812ff1cced086287f6288be2632d5876c9c,"Fix for a bug that was caused by the way we set the default data-type for
sort elements. The default data-type was always set to ""text"", and the natural
data-type of the set to sort was not taken into consideration. In this case
the sort data was generated by the position() function (ie. the data-type was
""number""), but XSLTC still sorted the data as if it was text
PR:		bugzilla 1410
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335605 13f79535-47bb-0310-9956-ffa450edef68"
1f9ebf18213f13f0ccd36dbd64835d359bce05df,"Implemented default ErrorListeners for the Transformer and TransformerFactory
implementations. The two classes are both changed to implement the
ErrorListener interface and will by default use themselves as ErrorListener.
PR:		bugzilla 3858
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335606 13f79535-47bb-0310-9956-ffa450edef68"
050995ffcbbdd85f170d1dccf296d8631c04e798,"A radical fix for how the abbreviated descendant iterator is handled by
the XPath parser. The previousl implementation could misplace/ignore
prediates and did not properly handle .//@* style expressions.
PR:		bugzilla 3314
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335607 13f79535-47bb-0310-9956-ffa450edef68"
0ea7d2fdfad14044511637ea460ab37aa7c12d2c,"A fix for a recent regression in our internal error handling.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml/apache/org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335608 13f79535-47bb-0310-9956-ffa450edef68"
bb4fec8a5f590f747b9dbe3fe5a1bab2df25b4b3,"A fix in the setOutputProperties() method
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335609 13f79535-47bb-0310-9956-ffa450edef68"
6b03791c8582c583a155127e7c9142fc3fca8547,"Marked the DOM2SAX and SAX2DOM classes as 'friendly' so they cannot be
used outside of the 'trax' package.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335610 13f79535-47bb-0310-9956-ffa450edef68"
507d0e45044627cf116ca39dbdb3e710694a4284,"Made sure that bogus output properties cannot be set for a Transformer.
PR:		bugzilla 3967
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335611 13f79535-47bb-0310-9956-ffa450edef68"
267d4c58fc68830ab8560316951d139880506bec,"Another fix to prevent NPE in setOutputProperty()
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335612 13f79535-47bb-0310-9956-ffa450edef68"
4c2f32335e0ce3f0fd5c7251e63ede98f8fac8fa,"Removed a few regessions from yesterday's fixes and cleaned up the Step
class a bit.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335613 13f79535-47bb-0310-9956-ffa450edef68"
fdb0b018ee1e9da659219ffabb4e955d41a1e01e,"Partial response to Bugzilla 3438: make getDTM(DTM.NULL) return Java null.
This is arguably a more appropriate response to that specific case.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335614 13f79535-47bb-0310-9956-ffa450edef68"
ec82b71e38e88ee149593b07e66f48aab891fad6,"Bugzilla 1009: Catch NoSuchElementException from java.util.StringTokenizer


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335615 13f79535-47bb-0310-9956-ffa450edef68"
a68e493ba001182744eb524ef1e5f82ba84168f6,"Made the preceding iterator reverse (as it should be) and cleaned up some
more code. Added some code to handle specific combinations of iterators.
PR:		bugzilla 2572
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335616 13f79535-47bb-0310-9956-ffa450edef68"
9d629a0cd80e140cd952211a5818ca181331ef93,"Updated our iterators so that they can be initialized with an attribute node.
The behaviour is different depending on the nature of the iterator (an
attribute does not have siblings, but it has following/preceding nodes etc.).
PR:		bugzilla 2551 (not all tests are OK, but some are)
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335617 13f79535-47bb-0310-9956-ffa450edef68"
59801b61d284e7e25ce89f28f947e561dd523aff,"Updated the XPath parser. Unprefixed elements that were referenced in the
expressions in a stylesheet were given the default namespace instead of
the null-namespace.
PR:		bugzilla 3343
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335618 13f79535-47bb-0310-9956-ffa450edef68"
12fb3cf411881dfc025048ab8b02a92ea380636e,"If context node is a DOM attribute, we need to get to its parent using getOwnerElement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335619 13f79535-47bb-0310-9956-ffa450edef68"
f4c4b33a64b07416be8d208c9613ce0e0fbdd014,"Fix for the formatting of PIs and comments output by the copy element.
PR:		bugzilla 2599
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335620 13f79535-47bb-0310-9956-ffa450edef68"
d84c719f2c3b809be85ebea831b9ca67e9bebbe0,"Added setNamespaceAware for .xsl file parse, as should have been needed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335621 13f79535-47bb-0310-9956-ffa450edef68"
223a347f7914eae7090444d561efaad5b87832db,"Updated the absolute location path's branch instruction to allow for long
code branches. This is a common problem with large stylesheets. Some code
fragments similar to:
    IFEQ(target)
Must be replaced with:
    IFNE(skip)
    GOTO_W(target)
skip:
    NOP
This allows for branches with large branch target offsets.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335622 13f79535-47bb-0310-9956-ffa450edef68"
8fd72f666dd439673a34b20e02452429d2bd0803,"A small glitch in yesterdays putbacks caused a regression for
predicates applied to attributes.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335623 13f79535-47bb-0310-9956-ffa450edef68"
1a44b4ff3ef0c64e5c05bfa26f5ef0e299a3441a,"Fix for a regressions caused by the fix for bug 3343.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335624 13f79535-47bb-0310-9956-ffa450edef68"
22d56d81b03328650d9f8d5fb914b6c42259a36b,"Fix for using compound predicates testing attribute values in
expressions (not patterns).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335625 13f79535-47bb-0310-9956-ffa450edef68"
757f9273dc19d279c118b16102eb5b2bb4f71f9b,"bug fix 4040, UTF vs. uft


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335626 13f79535-47bb-0310-9956-ffa450edef68"
a91ef98413f8e25be706904770e1bce12bed9bf8,"Oops. Debugging shouldn't have been on when checked in.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335627 13f79535-47bb-0310-9956-ffa450edef68"
0a78401d9691a724d7b7181ba817cfd85e650fe1,"Checkin xml-commons versions of DOM/JAXP/SAX files to xml-xalan tree;
previous Xalan copies were tagged 'before-commons'


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335628 13f79535-47bb-0310-9956-ffa450edef68"
77690c00cd4eef4092289cdb848400fe41ad63a9,"Restoring support for the (highly limited) <?xalan:doc-cache-off?>
processing instruction. This can _only_ be used within an
<xsl:for-each> whose select is based on a document() call, but
within that limited case can be useful for minimizing memory use
by discarding each document after you're done with it. You can think
of this as being a kind of ""pruning"" for the DTMManager, as
opposed to pruning subtrees out of individual documents.

The current implementation isn't safe, which is why it isn't published as a Xalan feature.
Use _entirely_ at your own risk.

The Right Answer here involves merging the SourceTreeManager
logic directly into the DTMManager (rather than having two separate
caches of open documents), and developing some heuristics that
enable us to determine when a DTM can/should be discarded. I
expect that's going to involve explicitly managing reference counts
and the like, whch may in turn push us toward developing a ""smart
pointer"" flyweight object to replace the current integer DTM Node
Handle. We need to do a lot more design work in this area.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335629 13f79535-47bb-0310-9956-ffa450edef68"
931626c257eff7b46b95f8406578d54cb491da8b,"Fix for bugzilla SPR 3159.
1. Revised SerializerToXML.init to attempt to create a CharInfo
with the entitesFileName from the output properties file (or
supplied by user) before turning the reference into an absolute
URI.
2. Removed paths to entitiesFileName from CharInfo constructor,
and adapted newer procedure (from TransformerFactory)
for loading stream resource.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335630 13f79535-47bb-0310-9956-ffa450edef68"
28333beb22f5fb9f5cf35e8c3260935d90daa13a,"Fix for bugzilla SPR 3159.

1. In output_html.properties, added path to HTMLEnties.res.
2. In output_xml.properties, added ref to XMLEntities.res (with path).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335631 13f79535-47bb-0310-9956-ffa450edef68"
524b8a5badafe95ea87e840bdb5023fc388102d0,"Added referemce/link to bugzilla SPR 2291 on issues surrounding
use of default character encoding to read META-INF/services.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335632 13f79535-47bb-0310-9956-ffa450edef68"
cf47101d5d37a1cae98c18b40cda58bf2bda016d,"Partial fix for Bugzilla1133 (LRE10 testcase, declare atttribute's
explicitly-referenced NS despite being an Extension Namespace)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335633 13f79535-47bb-0310-9956-ffa450edef68"
737dbd92fa58efa565bdd85c0606a6e22292ebe2,"Comment tweak. Independent of the serializer issue, we Really Should output
the namespace both ways.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335634 13f79535-47bb-0310-9956-ffa450edef68"
54d783ca7e6dae869ff323993dd0e554773b5397,"In response to Jess Holle <jessh@ptc.com>. put try/catch
blocks around System.getProperty(""user.dir"") calls. If
SecurityException occurs (from applet sandbox), supply an
empty string ("""").


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335635 13f79535-47bb-0310-9956-ffa450edef68"
4776bfd6f4ba80258ac64583d3114b143d1ac126,"Update javadocs to warn more explicitly that the DTM API is not yet cast in concrete.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335636 13f79535-47bb-0310-9956-ffa450edef68"
7de8e8dc2fd8ec2a35534d48aed3de783cd86ed2,"Put try/catch block around System.getProperty(""user.dir"") call. If
SecurityException occurs (from applet sandbox), supply an
empty string ("""").


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335637 13f79535-47bb-0310-9956-ffa450edef68"
68211fa901049cfbbf571ac5923cbc0b2646e433,"Bugzilla3722;  implementation of DTMNodeProxy.getChildren()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335638 13f79535-47bb-0310-9956-ffa450edef68"
29f73c1310c819a70d518f8c18b45eb5ca99e109,"Changed the values for the output properties ""OMIT_XML_DECLARATION"" and
""INDENT"" from ""true"" and ""false"" to ""yes"" and ""no"".
PR:		bugzilla 4039
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335639 13f79535-47bb-0310-9956-ffa450edef68"
9b43954a54690c832cecae42bb76afe86825b626,"Updated the getAttribute() method to throw an IllegalArgumentException
for unknown attributes.
PR:		bugzilla 4046
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335640 13f79535-47bb-0310-9956-ffa450edef68"
8544d3ac947640a6b837ec12dcb148d3a0dbee08,"Fixed a bug in the name() and local-name() functions. The functions would
use the current node and not the context node when no arguments were given.
PR:		bugzilla 3322
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335641 13f79535-47bb-0310-9956-ffa450edef68"
22803cfc62cffbb96da808a38b41c454adbb0b20,"Updated Mode.java to properly handle patterns matching on node(), comment() and
processing-instruction(). Also had to make a small change to the setStartNode()
method in the FollowingIterator (inner class of DOMImpl.java) to properly
handle attribute-nodes as start nodes. Also, I had to change ParentLocationPath
to remove duplicates that can be produced by the FollowingIterator when
started with an attribute node.
PR:		bugzilla 2551
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335642 13f79535-47bb-0310-9956-ffa450edef68"
09567c8a98701c7a115ebe3dfab80427e7a7bd27,"A small for for the output property OMIT_XML_DECLARATION
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335643 13f79535-47bb-0310-9956-ffa450edef68"
f754691aef9b363732d525773b82788c0e2234a3,"Fix to the transformer implementation to allow for namespace-prefixed
output properties (output property extensions).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335644 13f79535-47bb-0310-9956-ffa450edef68"
687eb9f984afc3b1b12b42b194531dc0aa7d0ed2,"included a more portable way to create an URI from a File


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335645 13f79535-47bb-0310-9956-ffa450edef68"
02ddb6c94258354e407552e5737fd7b9620745be,"ncluded a more portable way to create an URI from a File


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335646 13f79535-47bb-0310-9956-ffa450edef68"
5127854fdd4cdaf5e82896a69c78b8e7ba78396d,"ncluded a more portable way to create an URI from a File


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335647 13f79535-47bb-0310-9956-ffa450edef68"
448538ea9a9b53871f62644157cd101b16c18e64,"Bugzilla3995: Removed ""final"" keywords. That doesn't by itself
provide the requested enhancement, but it makes prototyping one
a bit easier.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335648 13f79535-47bb-0310-9956-ffa450edef68"
3fd332ab5a8a1ab1c906142b64216b2b7930d773,"Checkin Ant from jakarta-ant-1.4.1b1-bin


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335649 13f79535-47bb-0310-9956-ffa450edef68"
6fc1af1808faccf2ffdb9a609b53337ad309944a,"A fix for a few regressions.
PR:		n/a
Obtained from: 	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335650 13f79535-47bb-0310-9956-ffa450edef68"
f8e5983792a25dc8f6df037c26fb128ea7e6b8bf,"Fix for the ""*"" pattern. Made it include comment and PI nodes.
PR:		bugzilla 4050
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335651 13f79535-47bb-0310-9956-ffa450edef68"
e3017ef41ad7e1d1a9bbf930c5fb0c18407aa78d,"Fix for the last fix.
PR:		bugzilla 4050
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335652 13f79535-47bb-0310-9956-ffa450edef68"
5de659da0267d7abc7d66dd394c7f41e79dfcd54,"Fix for the last fix.
PR:		bugzil.la 4050
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335653 13f79535-47bb-0310-9956-ffa450edef68"
4b8c6f8ff4c3eb4eeee3390658da956f0cfc2493,"Bugzilla 3384. See comments in the toDouble method; I suspect this may be wasted micro-optimization.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335654 13f79535-47bb-0310-9956-ffa450edef68"
872eba7e8fb4aa4ba2c5889a502b975cf2a69942,"Is "" 12 34 . 56 78 "" really considered acceptable?
Or should whitespace within the value be treated as NAN?


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335655 13f79535-47bb-0310-9956-ffa450edef68"
5566d8ede658487932df461640a8ddc2e60ee55c,"Remove extraneous build.compiler default; add bootclasspath entries for
most javac calls to compile under JDK 1.4b2
Submitted by: rubys


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335656 13f79535-47bb-0310-9956-ffa450edef68"
45ace94559b97b1604b4e523c764a79d8d6ca1fb,"Information about running applets from Netscape 6.
See bugzilla spr 3231 (from <Stuart.Connell.@compuware.com>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335657 13f79535-47bb-0310-9956-ffa450edef68"
e5c8d8321cff2169255c5b0fe0b008b6b76d0c59,"Updated build number to 2.2.D12.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335658 13f79535-47bb-0310-9956-ffa450edef68"
688cfa02adc28b78d1e7f505adf7bab180068597,"added catch for malformed url


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335659 13f79535-47bb-0310-9956-ffa450edef68"
6af7bebd5301100dc0ff07649c68cff64ed88c4f,"Fix for Bugzilla1133, LRE21: xsl:extension-element-prefixes should be considered an exclusion


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335660 13f79535-47bb-0310-9956-ffa450edef68"
81ea7d698600b2692c0984243bf5a50eb1be64bc,"Added preliminary info about binary and source distributions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335661 13f79535-47bb-0310-9956-ffa450edef68"
c531301edc92348b0a64d0ec785a7d7f125cfe2f,"Fix for Bugzilla 3464. Exposes errors in conformance tests namespace93 and 94.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335662 13f79535-47bb-0310-9956-ffa450edef68"
7efa35b422e778524fa423f48b01f4e5e94a28c0,"Split distros in half: -bin for end users, -src for developers


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335663 13f79535-47bb-0310-9956-ffa450edef68"
a662668529a985dbbf8d9a2690ed19d5abb0e949,"Modified error handling to extract messages from SAXException. This tool
will also print the stack trace of the SAXException if the '-x' flag is
specified (debug turned on).
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335664 13f79535-47bb-0310-9956-ffa450edef68"
deb5ea41b366c18c3d032f58e871e6ac27e163c4,"Added code to prevent index-out-of-bounds exception in the output handler.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335665 13f79535-47bb-0310-9956-ffa450edef68"
76070678d4247dd00bc9b34a01a6164c6d3c73e9,"Added support for the namespace axis.
PR:		bugzilla 1379
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335666 13f79535-47bb-0310-9956-ffa450edef68"
429291a62d8d01916430d6e862899ad94a029ce9,"Missing file from last putback.
PR:		bugzilla 1379
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335667 13f79535-47bb-0310-9956-ffa450edef68"
5c3452cc88442b2633ca3131fdbade5d91be0a8d,"A few add'ons to the namespace axis implementation. Added support for
the namespace-uri() function when applied to namespace nodes.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335668 13f79535-47bb-0310-9956-ffa450edef68"
cdce02c0c84820906b93b06c258be40341001c42,"Code cleanup.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335669 13f79535-47bb-0310-9956-ffa450edef68"
a7a766df782928b4ac940a4cc75381159a2b3694,"Fix to prevent attribute nodes to be included by the node() pattern.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335670 13f79535-47bb-0310-9956-ffa450edef68"
d23d2c1a79004ccb3579cffd3b489a0f104a0b48,"Fix for the following:: iterator when started with an attribute node.
PR:		bugzilla 2551
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335671 13f79535-47bb-0310-9956-ffa450edef68"
888412ff4dcd41cb6857d455ab3710ad241e7051,"Revised binary and source distribution file names to match
names in build.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335672 13f79535-47bb-0310-9956-ffa450edef68"
2199584e86debad2175e2949510be42acfc1346a,"Preliminary updates for 2.2.D12


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335673 13f79535-47bb-0310-9956-ffa450edef68"
af6f17001f9ecb09e063774a9819a5dddf3371a4,"Manual transformation of xsltc commits into XSLTCDONE, which
is declared in readme.xml and pulled into xsltc_constraints.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335674 13f79535-47bb-0310-9956-ffa450edef68"
1aa496ae5af8cc44eb9ac973f45a32ef0d31f6a1,"1. Modifed prepare.docs and done.xsl to redirect XSLTC commits
to XSLTCDONE.
2. Periodic update of list of commits since last release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335675 13f79535-47bb-0310-9956-ffa450edef68"
5f738911835085b08985750b98060b06261a1876,"redirect XSLTC commits to XSLTCDONE.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335676 13f79535-47bb-0310-9956-ffa450edef68"
5df500fa9db5859e46c2535cc242170b35e7a17e,"Fix Bugzilla#4000, force reading of *Entites.res to be in UTF-8; added comments
PR: Bugzilla#4000


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335677 13f79535-47bb-0310-9956-ffa450edef68"
f58fd688a0985f9ab33e5557944152acd62eb584,"A fix to a recent regression after a fix for some axis iterators.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335678 13f79535-47bb-0310-9956-ffa450edef68"
eab4453e3cc1e107212ceff5f9632642fcd77dd0,"Added 4 symbols to the lexiographical analyser (xpath.lex) to recognise
name-tests with whitespace between the NCName and the ""()"" brackets.
PR:		bugzilla 4208
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335679 13f79535-47bb-0310-9956-ffa450edef68"
e0eb447619086ce16a3a11f4981c406621e31bd8,"Added note about binary and source distribution files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335680 13f79535-47bb-0310-9956-ffa450edef68"
2db9129f3b32883ae93fdbf6b74098d956545b81,"Fix to prevent xsl:attributes from not compiling itself into the translet code.
PR:		bugzilla 4175
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335681 13f79535-47bb-0310-9956-ffa450edef68"
8aaa3ef7519b7df81b22cfcd5cd8fd51cb5c2db8,"Enabled node ordering for certain filtered parent paths.
PR:		bugzilla 4178
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335682 13f79535-47bb-0310-9956-ffa450edef68"
c92c9cfe79a72bc00720fe2eac380b8500522688,"Changed the node sort record base class so that it places NaN values first
in the sorted list/node-set.
PR:		bugzilla 3517
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335683 13f79535-47bb-0310-9956-ffa450edef68"
2c615bf9a370566ef068f60bf5f22c2f662729bd,"Avoid overgenerality of isDigits
Combine most character tests into a single switch for performance
Reject values with embedded (as opposed to leading/trailing) whitespace.

Note that this is ""more correct:"" than the old solution of calling Java's
toDouble, since (I think) XSLT doesn't officially accept leading + or
scientific notation. If folks want to accept those notations, an
extension function specifically for that purpose seems the
simplest/safest/most-portable solution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335684 13f79535-47bb-0310-9956-ffa450edef68"
95944ab187ccf2b1ec8b57622051789f780f7d59,"Changed the DOM's copy() function to always copy the necessary namespace
declaration to the output handler.
PR:		bugzilla 3409 (not complete fix)
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335685 13f79535-47bb-0310-9956-ffa450edef68"
1f5c01f14bdbf6ca82b4dc518df8adf6c362df0c,"Gaaah. Typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335686 13f79535-47bb-0310-9956-ffa450edef68"
6fc100783fab2982987137a620a44c5348d0332c,"Added new org.apache.xalan.Version class for better versioning info;
Deprecated org.apache.xalan.processor.XSLProcessorVersion;
Updated EnvironmentCheck with this info


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335687 13f79535-47bb-0310-9956-ffa450edef68"
065f34d84c6f31fcbfbdf4fbef7629f6328022df,"Added compilation of new org.apache.xalan.Version class


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335688 13f79535-47bb-0310-9956-ffa450edef68"
e3296098c50df9e4a5c3e7109a406fe731973984,"Cleaned up the compiler's symbol table. Added support for detecting multiple
defined decimal formatting symbols.
PR:		bugzilla 3872
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335689 13f79535-47bb-0310-9956-ffa450edef68"
f31f7c9ac01c4b5dd47d6884efa0e48b6df196c9,"Added/checked proper escaping of template/variable/parameter/attribute-set/etc.
names. Occurances of the characters '.' and '-' are replaced by '$dot$' and
'$dash$' respectively in method/variable names. The characters are both
replaced by an underbar ('_') in the translet class name.
PR:		2399
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335690 13f79535-47bb-0310-9956-ffa450edef68"
9510af9283ffd75541d231d2b7f306b84cdfa281,"Fix for getting all attributes from the Xerces parser. Xerces and Crimson
report attributes differently, and we have to take that into account.
PR:		bugzilla 2465
Obtained from:	n/a
Submitted by:	Douglas Sellers <douglasjsellers@hotmail.com>
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335691 13f79535-47bb-0310-9956-ffa450edef68"
3cd012d9b612e3cf31dadf347d935251a35bed01,"Added node ordering to FilterParentPath
PR:		bugzilla 4248
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335692 13f79535-47bb-0310-9956-ffa450edef68"
5f5006ea4e8f1ec08683313cec1ba23703a50bf1,"Changed one of the compare() methods in the basis library to properly
compare node sets.
PR:		bugzilla 4242
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335693 13f79535-47bb-0310-9956-ffa450edef68"
aa7e594602c96f670e4e9a88b894cd93e6e2458d,"Fixed the registerAttribute() method so that it always uses the same
id for an attribute name.
PR:		bugzilla 4243
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335694 13f79535-47bb-0310-9956-ffa450edef68"
5234bbd4b9dcf679f72a36b6b97705b52145799d,"Removed file Param.java.orig
PR:
Obtained from:
Submitted by:
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335695 13f79535-47bb-0310-9956-ffa450edef68"
b434df6ee963b62958f0c48d3f497847540ec642,"Changed the variable base class to allow variables to be re-defined in
a different scope.
PR:		bugzilla 3268
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335696 13f79535-47bb-0310-9956-ffa450edef68"
ce720099035129e6a04a9e039538a83edbbfb52d,"Added a node-value iterator to the DOM multiplexer to allow for predicates
in combination with the document() function.
PR:		bugzilla 3402
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335697 13f79535-47bb-0310-9956-ffa450edef68"
31e9cb668a6266231b36e8ff40b4df8f3ada677c,"Be careful with parentheses when using ?: operator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335698 13f79535-47bb-0310-9956-ffa450edef68"
a18f7b20aa3d9a01b371e0d362cc672386291697,"CoroutineParser API was replaced by IncrementalSAXSource; dropping obsolete code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335699 13f79535-47bb-0310-9956-ffa450edef68"
39f35f6085760d6f68bb4bbe8a7b66cdd9dadfbc,"Whups; sloppy: Actually, problem was that the latter two arguments to ?:
must agree in datatype. Dropped in a quick-and-dirty int-to-string hint.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335700 13f79535-47bb-0310-9956-ffa450edef68"
5df134ee4386b3fe7a25901bbab68a177fdbe20a,"Preliminary Xerces-2 support. Doesn't leverage Xerces-2 incremental features
yet, but should at least compile and run under the new parser without
breaking support for the old one. Still working on improving this.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335701 13f79535-47bb-0310-9956-ffa450edef68"
00d6a2d3bc8fb38a5f42c2f335169c4a42bcba6a,"Fix for variables and parameters containing node sets in stylesheets that
use the document() function. This fix completes the cloneIterator() method
of the axis iterators returned by the DOM multiplexer.
PR:		bugzilla 3501
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335702 13f79535-47bb-0310-9956-ffa450edef68"
4f417041304f3fecf8a247e7afe0b81b0690a1ab,"Added the default xml=http://www.w3.org/XML/1998/namespac namespace
declaration to the root node of our internal DOM.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335703 13f79535-47bb-0310-9956-ffa450edef68"
9cb7904b95578cfc5a61632a0fb5fbb899443a2a,"Bugzilla 4218: Make sure that the stack frame gets restored to the frame that was previously set. Just calling unlink() may restore to the wrong frame, and get us out of synch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335704 13f79535-47bb-0310-9956-ffa450edef68"
9ef58ce8ba95a0eefba086325f7ce2a1537eabe0,"Java 1.1.8 back-compatability requires not using Java 1.2 collection calls.
(Still waiting for community consensus before abandoning 1.1)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335705 13f79535-47bb-0310-9956-ffa450edef68"
3fb1a4eef450e3ba05e6b9caaf28ec4e45d5c86f,"Bugzilla 4218: Make sure that the stack frame gets restored to the frame that was previously set. Just calling unlink() may restore to the wrong frame, and get us out of synch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335706 13f79535-47bb-0310-9956-ffa450edef68"
d6a9dfaf8bfa8e5803ee3e4d2d9cae1d1130a23f,"A fix for determining the current working directory when loading XML
documents using the document() function. The base URI (that gives you
the CWD) should normally be taken from the context node, but can also
be determined by the node/node-set defining the document URI.
PR:		bugzilla 3471
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335707 13f79535-47bb-0310-9956-ffa450edef68"
a1d3fa6181844b1cacf40fb2a198e3cb9215a57b,"Gave the parent/sibling stacks in the DOM builder dynamic length.
PR:		bugzilla 3066
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335708 13f79535-47bb-0310-9956-ffa450edef68"
1a8bbf8a4809eb786322c066b0081e054dd760ac,"Added a '-i' option to the command-line compiler to allow stylesheets to be
passed in through stdin. The '-i' option must be used with the '-o' option
to specify a translet name.
PR:		bugzilla 4253
Obtained from:	n/a
Submitted by:	johnh@schemasoft.com (John Howard)
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335709 13f79535-47bb-0310-9956-ffa450edef68"
b4ce5ccab196d2e0505ac4281df394c3d42f4366,"Cleaned up the include/import precedence code in Import and Include
PR:		bugzilla 2695
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335710 13f79535-47bb-0310-9956-ffa450edef68"
ade746ab070f508ee89979f46a517ace7fa77cfe,"Fixed output formatting of some floating point numbers.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335711 13f79535-47bb-0310-9956-ffa450edef68"
a9e9a0f4288bb8ca6abd07224753d170af913ba9,"Fix for logical expressions that have combinations of not() and ""and"".
PR:		bugzilla 2351
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335712 13f79535-47bb-0310-9956-ffa450edef68"
4fa438064bab43d6f4d94b3f04225981145d2da6,"added a empty string systemId in cases where it was
set to null, slight rearrangment of StreamSource handling code as well.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335713 13f79535-47bb-0310-9956-ffa450edef68"
d5de783a71d8b8f8c18691eb79d75e424fdb07b2,"In Xerces2, SAXParser no longer seems to inherit from
XMLReader; explicit casts needed to work around that.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335714 13f79535-47bb-0310-9956-ffa450edef68"
0851693807a13f1626cdfa2f57a6975078aa31c2,"Fix for names templates. Dashes and dots in template names are now
escaped using '$dash$' and '$dot$'.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335715 13f79535-47bb-0310-9956-ffa450edef68"
9b6a1678b4203b47220e5559d99cfcff965f4c83,"A fix for a recent regression. A no major change. Just a one-line if to
test for a potential NPE.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335716 13f79535-47bb-0310-9956-ffa450edef68"
bc390effdd40ec5b7de40681eef6fe9993085d13,"Remove javax.xml.parsers package from xalan sources since we no longer ship with these files


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335717 13f79535-47bb-0310-9956-ffa450edef68"
afe86c64d28c9a68013db04fe7c7ef18bc79ec72,"A major fix for <xsl:apply-imports/>. This element was previously treated
as <xsl:apply-templates/> but is now handled similar to Java's 'super()'
method. Note that this is not a complete fix. The rest will come tomorrow
or the day after. I just wanted to make sure that today's efforts were not
lost and that they are tested overnight.
PR:		bugzilla 1397
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335718 13f79535-47bb-0310-9956-ffa450edef68"
a443e1d3e0517689d24be745ce8e5e4054f47f31,"Microsoft VJ++ workaround. Should never arise in any reasonably
standards-compliant Java environment, but VJ++ isn't...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335719 13f79535-47bb-0310-9956-ffa450edef68"
6a9dab969ae2263724bbda132a926ca1404545e4,"Additional ""big scary"" docs for Microsoft VJ++ workaround.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335720 13f79535-47bb-0310-9956-ffa450edef68"
615492694b66ab4cf0befd5966bb3bf1e608e9cc,"Fixed the document() function so that it will load documents relative to
either the currently loaded document, or if that fails, relative to the
location of the original stylesheet.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335721 13f79535-47bb-0310-9956-ffa450edef68"
d966c54389163e886fdcbff08de61acc579624f9,"Fixed the TransformerHandler so that it's Transformer instance can be used
separateely from the handler itself.
PR:		bugzilla 3873
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335722 13f79535-47bb-0310-9956-ffa450edef68"
8d1b92ba5e06514856976f1d1fa5d7ab113deba1,"A fix for resulving relative URIs when using <xsl:include/> and <xsl:import/>
through TrAX without using a URIResolver.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335723 13f79535-47bb-0310-9956-ffa450edef68"
3cb3f154b724c2756d0e7d3b9f57b76a7266c029,"Fix for a bug that seemed to be triggered by the sequence in which Xerces'
lexical handler and content handler were set. The lexical handler must be
set before the content handler, otherwise Xerces will keep generating the
first startElement() event over and over again.
PR:		bugzilla 2465
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335724 13f79535-47bb-0310-9956-ffa450edef68"
1da5ce5705b6576a6bc6a92e35ee67693402d028,"Fixed the general handling of the XML namespace mapping.
PR:		bugzilla 4331
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335725 13f79535-47bb-0310-9956-ffa450edef68"
4f4fe7e8da055ffdadeb83a165a95eb77f945047,"Added fix for bug reported by Myriam for match=""//x/a"" patterns.  On the
second ""/"" on ""//"", the parser wasn't swallowing the token, which caused
the ""x"" pattern to be ancestor instead of parent.  If you don't have this fix,
it will cause 'a' to be matched when it has any ancestor that is 'x'.
This fix should be localized to only match patterns.  The reason this probably
wasn't reported before, is because ""//"" at the head of a match pattern is
pretty useless, ""x/a"" being equivelent.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335726 13f79535-47bb-0310-9956-ffa450edef68"
2aaa6b7d040215e95660a9cdb92f7f1e65fced5d,"By longstanding request, don't URL-escape spaces.  This is consistent with the
specification, and the opinion of the right thing to do by several people on the
XSL working group, including Mike Kay, and by the LotusXSLTeam.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335727 13f79535-47bb-0310-9956-ffa450edef68"
41f6bc210504efb8169fa03762616f7bcdcd58c5,"A fix for setting the scope of templates for an <xsl:apply-imports/> element.
This fix allows for proper ""multiple inheritance"" in XSLTC.
PR:		bugzilla 1397
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335728 13f79535-47bb-0310-9956-ffa450edef68"
a42386890e3cb4781fbda1c773590f881e9d4e30,"Fix to ensure that the order of the -o and -p command line options is
not significant.
PR:		bugzilla 4343
Obtained from:	n/a
Submitted by:	johnh@schemasoft.com (John Howard)
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335729 13f79535-47bb-0310-9956-ffa450edef68"
7cc83e37386a3d95f93f91b588386ec539e8c51a,"Changed our extension for calling external static Java methods to allow
both the ""http://xml.apache.org/xalan/xsltc/java"" namespace and the
""http://xml.apache.org/xslt/java"" namespace (Xalan's namespace for Java
function calls).
PR:		bugzilla 3994
Obtained from:	n/a
Submitted by:	after numerous requests/suggestions on xalan-dev
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335730 13f79535-47bb-0310-9956-ffa450edef68"
25449704ed64b431bedf0dfe7d59ed9e6348ee46,"Implemented code to resolve forward references and dependencies between
global variables and parameters.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335731 13f79535-47bb-0310-9956-ffa450edef68"
e0c081d5e142a7e12a304b632b526374d856d10b,"Changed properties ref from com.sun.tools.javadoc.resources.standard.properties
to xalanjdoc.resources.properties, which is in xalan2jdoc.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335732 13f79535-47bb-0310-9956-ffa450edef68"
90289e53d44882a1791e5121c0eaa1802f76fbc6,"Missing file from last putback.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335733 13f79535-47bb-0310-9956-ffa450edef68"
1e438f98e5528c1657d5de78084dca52cf0276b3,"Moved all error messages from the various source files into the ErrorMsg
class in the compiler/util directory.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335734 13f79535-47bb-0310-9956-ffa450edef68"
518bd03526eff7ee7017aad9abd389a296b62c09,"A first stab at i18n'ing XSLTC. Error and warning messages from the compiler
and TrAX are handled by the compiler/util/ErrorMsg class, while messages
from the DOM and runtime/translet are handled by the Basis Library class.
Only the ErrorMsg class has so far been updated to dynamically read its
messages from a ResourceBundle. Bundles for British English and Norwegian
are implemented.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335735 13f79535-47bb-0310-9956-ffa450edef68"
6e602e82cb8778febfc318a51a9d16b09553c292,"Code cleanup.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335736 13f79535-47bb-0310-9956-ffa450edef68"
187e921c1cfe2cedf8101a81a23d972609fac97e,"Final code cleanup after i18n work.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335737 13f79535-47bb-0310-9956-ffa450edef68"
1e2a943c7c1efa919bd79fde5c94dbe3022e9bf4,"Removed a typo in console output.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335738 13f79535-47bb-0310-9956-ffa450edef68"
2ffc9b6c8df2bf7e1afa6c6ee61c55fd81a72145,"Added ""Compiler Warning"" text to output.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335739 13f79535-47bb-0310-9956-ffa450edef68"
71d2735d4e5c777a6a1e596fd77155c726039667,"get the xalanjdoc.resources.standard ResourceBundle from within ConfigurationStandard, and use
it to instantiate a MessageRetriever.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335740 13f79535-47bb-0310-9956-ffa450edef68"
2a4c3e48771f5cd022ef7aa9259c906211cd9307,"Improved safety net: When running with Xerces2, the ""uri"" field may be null.
(Also reordered tests to encourage optimization of code.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335741 13f79535-47bb-0310-9956-ffa450edef68"
5d0df1b4da38521316c82526dd5bb7b0ebef9805,"Localised the runtime/dom packages into Norwegian. This proves that the
internationalisation work is completed. I also fixed a regression that
was caused by the error handling being changed.
PR:		n/a (i18n and l10n work)
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335742 13f79535-47bb-0310-9956-ffa450edef68"
62c93e0edf633e66f20c347ecea6be5c25e253d8,"Integrated a fix from John Howard for forcing forward slashes in file paths
in JAR files and in manifests in JAR files.
PR:		bugzilla 4464
Obtained from:	n/a
Submitted by:	John Howard (johnh@schemasoft.com)
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335743 13f79535-47bb-0310-9956-ffa450edef68"
fef9d1aa49d57cd576f76be6342c92a5756935a2,"Fix for simplified stylesheets. A namespace declaration on the root element
in the stylesheet (xmlns=""http://www.w3.org/TR/xhtml1/strict"") caused XSLTC
to try to match elements in this namespace instead of elements in the null
namespace.
PR:		bugzilla 3664
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335744 13f79535-47bb-0310-9956-ffa450edef68"
14d28012779a3e379ed6f43775ecb8f01a290a75,"Removed a regression from yesterday ('version' attribute missing).
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335745 13f79535-47bb-0310-9956-ffa450edef68"
1f283b0003235831b68ee62d27e8418055443746,"Removed default behaviour of text() and ""*"" in <xsl:apply-imports/>.
(this element should not invoke built-ins).
PR:		bugzilla 1397
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335746 13f79535-47bb-0310-9956-ffa450edef68"
b8ca55cb53016a35ec4e805b699f95f529b8dc60,"Updated the SAXAdapter used to build result tree fragments to handle comments.
PR:		bugzilla 4172
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335747 13f79535-47bb-0310-9956-ffa450edef68"
53ba170c1daf074d3dee314c55d3972d25f1e8de,"Fix for the XPath substring() function.
PR:		bugzilla 4201
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335748 13f79535-47bb-0310-9956-ffa450edef68"
64e8e51d2880b1c28ff42d5875a0d62c7fa2e5e6,"Removed the last putback - should never have been done. Big mistake!!!
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335749 13f79535-47bb-0310-9956-ffa450edef68"
79709f33c1363a80b5913b220d479aec8d2e6ff6,"Fix for generating IDs for implied attributes.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335750 13f79535-47bb-0310-9956-ffa450edef68"
cb3831bdc42738b7200d99e6e49320cb38a29fa9,"Enabled character escaping by default for HTML output. We are now able to
generate the XSLT and XPath specs without any errors at all.
PR:		bugzilla 3065
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335751 13f79535-47bb-0310-9956-ffa450edef68"
006f9c51625d80e9824ae679ffd729f2d5533ca0,"Missing resource bundles for error messages for XSLTC's dom and runtime lib.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335752 13f79535-47bb-0310-9956-ffa450edef68"
a054c51bbdaac57a91cf271b74d8e59665c386fe,"Fixed pattern matching on namespace qualified wildcards, such
as match=""@blob:*"".
PR:		bugzilla 2582
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335753 13f79535-47bb-0310-9956-ffa450edef68"
baec0ca60786ec7feaeba879c9f47767110077a9,"Add command-line switches for the options introduced at same time as DTM, to make testing those features easier.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335754 13f79535-47bb-0310-9956-ffa450edef68"
ad1b8a8a82ffeb814fb1cf4884d6730aceecb103,"Bugzilla: 4538 -- Replaced ""aring"" character with ""&#229;""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335755 13f79535-47bb-0310-9956-ffa450edef68"
81a613d320a6d7a68c9131d418200d9c9fdd0905,"Added a fix for predicates that test on node values, where the value to
test agains is stored in a variable or predicate.
PR:		bugzilla 3501
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335756 13f79535-47bb-0310-9956-ffa450edef68"
baac3af23e6e5bd01be53728cd895cfd849bc823,"Fix for re-definitions of variables inside templates (in different scopes).
PR:		bugzilla 3406
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335757 13f79535-47bb-0310-9956-ffa450edef68"
97d00b0b029b1efc26296bc9985c6ccae3d766d9,"Potential fix for bug 3416. Will not integrate for performance reasons.
Code change is commented.
PR:		bugzilla 3416
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335758 13f79535-47bb-0310-9956-ffa450edef68"
fd7aa66a079ceee58e4b53cc12433f6fb8cd58c9,"Removed a desperately bad piece of code that caused XSLTC to misinterpret
some combinations of parent location paths and predicates.
PR:		bugzilla 4249
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335759 13f79535-47bb-0310-9956-ffa450edef68"
299b9936434fc68df86a90e2dd406e4719542185,"Fix for the formatter used with the xsl:count element.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335760 13f79535-47bb-0310-9956-ffa450edef68"
25b890726b2dcd56c12a27157709df4e9b40afd2,"Fix for sort-elements used with apply-templates elements with no select
attribute.
PR:		bugzilla 3519
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335761 13f79535-47bb-0310-9956-ffa450edef68"
5ed77913eff3d6f3d21adef934828882d095d520,"A fix for the <xsl:number> element.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org / todd.miller@sun.com
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335762 13f79535-47bb-0310-9956-ffa450edef68"
88f09b95401742ec284f1596b292d867534a4b58,"Bugzilla 4575: Add the EOL character to the list of token delimiters.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335763 13f79535-47bb-0310-9956-ffa450edef68"
ea30aadd1f5cff0b827083cb1879c348b95714c0,"Leverage Xerces-2 incremental parsing feature, when possible,

Making this compile _and_ run under both the old and new versions of
the parser involves a lot of reflection... especially since Xerces-2
no longer provides a way to directly request incremental delivery
of SAX events; we now have to assemble that concept ourselves,
using XNI components.

Note that if you pass an existing Xerces-2 SAXParser into the
IncrementalSAXSource_Xerces wrapper, there is currently no way
for us to access its incremental controls. In that case, we are
forced to fall back on the _Filter solution and coroutines.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335764 13f79535-47bb-0310-9956-ffa450edef68"
658dd9d8b3e6e0574df41774d8ef657f6773b1e5,"Bugzilla 4396:  Defaulting to the super hashCode(). This causes us to create a string, but at this point this only seems to get called in key processing. Maybe we can live with it?


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335765 13f79535-47bb-0310-9956-ffa450edef68"
1a02ad4d0be97fbf47a7a5a345797d7c3a8e8646,"periodic update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335766 13f79535-47bb-0310-9956-ffa450edef68"
7cdc0a5d3800cb923db31b65bc0d612960b35952,"Sample validates XML input.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335767 13f79535-47bb-0310-9956-ffa450edef68"
9c65d7c48650d38a5d9e8f203d1c3869c3776262,"Information on new sample: ValidateXMLInput.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335768 13f79535-47bb-0310-9956-ffa450edef68"
f9fd006cfb8036b53068ccbec734fae1ac7d4a75,"Exclude org.apache.xml.utils.synthetic.*; no longer used
Cleanup a few properties and property names
Default build.debug to on, per upcoming standards


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335769 13f79535-47bb-0310-9956-ffa450edef68"
1e4e6cf99f52418ca41f9c9254b468605ac0c4de,"Use appropriate context class loader as done in JAXP's FactoryFinder;
Added various new jars; added checkAntVersion()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335770 13f79535-47bb-0310-9956-ffa450edef68"
b9037981e3c126919454f6828237eb23b025ea91,"Commented out mainly greek entities that Netscape seems not to handle.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335771 13f79535-47bb-0310-9956-ffa450edef68"
398fe9c7f928617a760f46d56ae65052dcf4fe77,"Progress on Bugzilla Bug 1639 : Xalan escaping characters for ISO encodings other than ISO-8859-1.

The problem is that you can't tell from the Java Writers if they can encode
a character, and you can't tell which character they are going to encode to.
So...

Do a one-time-only reflection to see if a sun.io.CharToByteConverter for the
specific encoding is available.  I'm hoping this will work for most or all
platforms... but only some extensive testing will tell for sure.  If the
CharToByteConverter is not available, it falls back to the old behavior.
If it is available, use the canConvert method to see if the UTF-16 character
can be encoded.  If it can be, just send it to the writer, otherwise escape it.
This doesn't need to be done for < 128, so I'm suspecting the performance
hit won't be too bad.

The alternative is to create lookups for all the encodings that tell which
blocks of characters can't be encoded.  Too much work for me this
weekend, though it remains a possibility.  I want to try the use of
CharToByteConverter.canConvert first.

One problem I've encountered is that CharToByteConverter.canConvert
returns true for (utf-16 code points) 127-159.  And so they go unescaped.
How bad of a problem is this?  This seems like a bug in the Java
CharToByteConverter for ISO-8859-7.

It remains to be seen if this problem exists with other encodings, or if this is
the best approach.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335772 13f79535-47bb-0310-9956-ffa450edef68"
9b3980e830dcafaee491d12247a961cb207b1e9d,"Fixed the number formatter.
PR:		bugzilla 2901
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335773 13f79535-47bb-0310-9956-ffa450edef68"
7bd86303d7ded292d5d3d83c3b13fa76321c671e,"A fix for ancestor iterators that are started using an attribute node.
PR:		bugzilla 4602
Obtained from:	`n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335774 13f79535-47bb-0310-9956-ffa450edef68"
a1b405d7c45563a37ffaf7cfc7c9bd7d9dc2af48,"Changed the 'order' and 'data-type' attributes of the <xsl:sort> element
from plain attributes to attribute value templates. This required a change
not inly in the way we interpret these attributes but also in the time at
which these attributes are intrepreted. Since these are not treated as AVTs
we need to wait until runtime before reading the values of the attributes.
PR:		bugzilla 3835
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335775 13f79535-47bb-0310-9956-ffa450edef68"
31755b153059ba673b814133fe2c433b83743a97,"Fix for patterns on the format ""/foo/*/bar"" and ""/foo/*[n]/bar"".
PR:		bugzilla 4604
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335776 13f79535-47bb-0310-9956-ffa450edef68"
879a2f98d8ed3c4aa846bc398f02ffa45907cf95,"Fixed the last() function for the typed and untyped ancestor iterators.
I also updated our node list iterator (used to implement some predicates)
to handle the last() function properly for reverse-order axes.
PR:		bugzilla 4602
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335777 13f79535-47bb-0310-9956-ffa450edef68"
25ae3975a79c523da1664d24177ce0f6252f0b76,"Simplified ValidateXMLInput per Scott's bug fix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335778 13f79535-47bb-0310-9956-ffa450edef68"
86c334ede58988fe18579e9dedee863d28401d5e,"Simplified, now that Xalan is no longer preventing XMLReader
from passes warnings and errors to an error handler during a
transformation (fix submitted by Scott Boag).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335779 13f79535-47bb-0310-9956-ffa450edef68"
3f4bdd531049a7710266176239d73eddbb7b2762,"Check for control characters for canConvert, and return false if it is a control
character, so that it will be escaped.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335780 13f79535-47bb-0310-9956-ffa450edef68"
3913a89c45aa2432b207c451b7ca7e729f73397f,"Don't set the ErrorHandler if it is already set.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335781 13f79535-47bb-0310-9956-ffa450edef68"
b182472566c872a14e9f76d52f215f6abf29ad63,"Fix for compound predicates used in patterns.
PR:
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335782 13f79535-47bb-0310-9956-ffa450edef68"
cce83c7d0d947d3e0e9cc031b029ce28ed837301,"A fix for a regression after a previous fix for bug 3320.
PR:		bugzilla 4656
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335783 13f79535-47bb-0310-9956-ffa450edef68"
c375a6d952887c0b401418387bf5389450787098,"Editorial cleanup, including try/catch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335784 13f79535-47bb-0310-9956-ffa450edef68"
4cf4236821f0189a792669203c7f5323ecd1f65e,"Minor fix to JavaDoc for setRecursionLimit.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335785 13f79535-47bb-0310-9956-ffa450edef68"
61171857616b1e8e4bfafb5a1944824e91f9211b,"Bugzilla 4679: Accessors for left and right operands


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335786 13f79535-47bb-0310-9956-ffa450edef68"
c8d78ee70309d25a44cad48ade5ee9193ec6d955,"Do not escape the percent '%'  character anymore.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335787 13f79535-47bb-0310-9956-ffa450edef68"
048f78e70a44be64d1e3817ce53a9ed9f356097f,"Bugzilla 4638: When we are in a subcontext we need to clip off the predicate when evaluating. If not, we end up with the wrong nodeset. This also relates to test position68.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335788 13f79535-47bb-0310-9956-ffa450edef68"
ffe3a479948270d8700267be64a85418611dd93a,"Added info about xml-apis.jar and link to xml-commons repository.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335789 13f79535-47bb-0310-9956-ffa450edef68"
6ba4a77c29b777dd80a4bd83365508442612f3a9,"Bugzilla 4607; allow explicitly cloning namespace nodes rather than
throwing exception.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335790 13f79535-47bb-0310-9956-ffa450edef68"
44d9103ffcc5f49d505ce64d7239d5cee1520369,"Remove services/javax.xml.parsers.* references; we assume parsers have their own


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335791 13f79535-47bb-0310-9956-ffa450edef68"
e5e39773d8ee841570f771c2bc53748930f16257,"Use a condensed copy of xml-commons sources instead of individual sources


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335792 13f79535-47bb-0310-9956-ffa450edef68"
27d82b297ee51c4442a1a7fbe3aed02f5cd16c46,"Use a condensed copy of xml-commons sources instead of individual sources;
update build script to untar condensed copy; remove copy-commons-src stuff


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335793 13f79535-47bb-0310-9956-ffa450edef68"
f434c11de01aaa4ab0a97412a2900b4eee62831b,"Use a condensed copy of xml-commons sources instead of individual sources;
remove xalan-specific copies of commons files


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335794 13f79535-47bb-0310-9956-ffa450edef68"
4b301e009c511a91c716362ea7d5c711b75d8895,"A bit of a code cleanup. I also added a small fix for ensuring document order
of node sets returned by union expressions.
PR:		bugzilla 4677
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335795 13f79535-47bb-0310-9956-ffa450edef68"
d8d1188f24a2d9766ed7e7a3abf1b07996cc950f,"Added a test to verify that <xsl:sort/> elements are only used within
<xsl:apply-templates/> or <xsl:for-each/> elements.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335796 13f79535-47bb-0310-9956-ffa450edef68"
ab1bef60364a22a6038cac410b342a314017a37b,"Added an array to the Axis class to give an easy indication to the direction
of an axis.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335797 13f79535-47bb-0310-9956-ffa450edef68"
7f52a5046e65e15b2941f8e1e723f51cabd6dace,"Added a new TransletLoader class to the runtime package. This class will
be used only when the default Class.forName() call fails. The forName()
call will fail if XSLTC is packed in a JAR and installed under
$JAVA_HOME/jre/lib/ext. This is because the extensions class
loader is used instead of the bootstrap class loader, and that the
extensions class loader does not load classes for the default class path.
But, if the extensions class loader is being used, then we know two things:

  (1) XSLTC is running on Java 1.2 or later (when extensions were introduced)
  (2) XSLTC has access to the ClassLoader.getSystemClassLoader() method

This class takes advantage of this and uses a privileged call to this
method to get a reference to the bootstrap class loader. It then uses this
class loader to load the desired class.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335798 13f79535-47bb-0310-9956-ffa450edef68"
4a55c14e2acd1e66448bacbf5b54858245a2e0b9,"Added a ""debug"" attribute to the TransformerFactory implementation.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335799 13f79535-47bb-0310-9956-ffa450edef68"
76a25a7bfda10a090214adfd5131fc0b191e8265,"Bugzilla 4601: Change ElemNumber to use a long integer for the value of the number. This will allow us to format bigger numbers. As far as japanese multipliers, we decided to document as a xalan limitation the fact that the last 2 japanese multipliers will not be supported. If anyone has a strong and valid user case for this, we will reconsider. For now, we could not justify the expense of moving to BigInteger to support these multipliers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335800 13f79535-47bb-0310-9956-ffa450edef68"
8d242b5900be63e9ab3ca254007b443dc39e6f61,"Added faq on returning line/column numbers for errors in XML/XSL
input.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335801 13f79535-47bb-0310-9956-ffa450edef68"
6be42b76360b03f0cf66707b42bf47317904ea59,"Periodic update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335802 13f79535-47bb-0310-9956-ffa450edef68"
3f6c28981a196b6e9ec7bd67b5f610eba2ed6a60,"Bugzilla 4735: We should at least report an error when we overflow DTM addressing...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335803 13f79535-47bb-0310-9956-ffa450edef68"
2209688e1956b6926cc72b0a87dafba638dd3ee5,"Added entity for Xerces-Java 2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335804 13f79535-47bb-0310-9956-ffa450edef68"
226d4910e5f956b0f8e6695171d08cb460324f42,"Added info on xml-apis.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335805 13f79535-47bb-0310-9956-ffa450edef68"
e770c581fca0dfc2f057f3805309cf5e727321de,"Added info on xml-apis.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335806 13f79535-47bb-0310-9956-ffa450edef68"
ff34dc56b8ded0e7e5a0d7759ea10488295fac96,"Bugzilla 4355: Make sure that when finding out if a stylesheet imports itself, we use the resolved href.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335807 13f79535-47bb-0310-9956-ffa450edef68"
20d68a1156cc79dd3296cea45995d8b6c1519203,"Copy new build.xml-apis.jar into dist area


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335808 13f79535-47bb-0310-9956-ffa450edef68"
55eea6344a40ed54b3d3fb9c9ae32476f3d8102c,"OK, now we're finally using the new build.xml-apis.jar in the classpath in
all the places we need it.  Really.  I promise.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335809 13f79535-47bb-0310-9956-ffa450edef68"
14880ca5858718f66d8b7b3256204790e8126d7c,"Bugzilla 4158: Make sure we get the current, not the node pointed to by m_next, which has been already incremented.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335810 13f79535-47bb-0310-9956-ffa450edef68"
0be1db8d38e29a498307e7ca0f56c42689bbdb20,"Removed a debug statement that was left behind after last putback.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335811 13f79535-47bb-0310-9956-ffa450edef68"
daa6f82b709e7cc2a45188062e896cd0926f8b18,"Added support for processing-instruction() with a literal parameter for
use in node tests in expressions and patterns.
PR:		bugzilla 2583
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335812 13f79535-47bb-0310-9956-ffa450edef68"
89dea40d27625316716d1d217cf9fa26cd2d5768,"Forgot this in last putback.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335813 13f79535-47bb-0310-9956-ffa450edef68"
6de4477cf94090f8205a335235691fabbabe58fb,"Updated for 2.2.D12.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335814 13f79535-47bb-0310-9956-ffa450edef68"
3d8cad6520edf722bdb5629b9db7db996bdd4cd4,"Updates for 2.2.D12.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335815 13f79535-47bb-0310-9956-ffa450edef68"
e3786a55f3e861467f9afcb402b9687d14273a98,"bug fix 3592, new class to handle Long expresssion


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335816 13f79535-47bb-0310-9956-ffa450edef68"
fe7e5d6d1a401f88512776704a1cef33dc7b0fdf,"bug fix 3592, handles long now


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335817 13f79535-47bb-0310-9956-ffa450edef68"
0b2792d486311575079f390b07713bca59295e8a,"bug fix 3592, added new class for Long types


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335818 13f79535-47bb-0310-9956-ffa450edef68"
f7d37860433ce77fc0cb5d577010113f57eef91d,"bug fix 3592, handles Long types


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335819 13f79535-47bb-0310-9956-ffa450edef68"
093b86e9434bb4064e1dc27393b95edb171004c0,"Bugzilla 4344: discard attrs which don't have an element to belong to


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335820 13f79535-47bb-0310-9956-ffa450edef68"
2c574ccb9bcd4c4316dc98dea0960671616cb737,"Update for 2.2.D12.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335821 13f79535-47bb-0310-9956-ffa450edef68"
724c204028b52a2d250a0c059586df2961733ea8,"Bugzilla 4344: more efficient.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335822 13f79535-47bb-0310-9956-ffa450edef68"
61dbbe7bd17addb98d6aa341df18e6813fd9b1b2,"Adding public key to list


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335824 13f79535-47bb-0310-9956-ffa450edef68"
57d660f262b4837f1ff644bd7f5421431ef986b2,"Fixed bug for xsl:attribute
PR:		4175
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335825 13f79535-47bb-0310-9956-ffa450edef68"
444c42b2ea701cb0c422d1ce2025d2e207712d6e,"Fix distro patternset error; we now actually include the new xml-apis.jar
file in the actual distro .zip/.tar.gz files; only change between D12 and D13


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335826 13f79535-47bb-0310-9956-ffa450edef68"
a38bc64d90639b1a8d24c3bbd6fae5249b90857f,"Update build number to D13


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335827 13f79535-47bb-0310-9956-ffa450edef68"
36599396b400415bf6d171dfc9a754fab6cf6c42,"Reorder slightly and add test to not synthesize xmlns:xsl declaration
if one was already present on the DOM's root element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335828 13f79535-47bb-0310-9956-ffa450edef68"
fba5c6636b259fec5841d760adfb8d05d2eac702,"Fix for properly creating a SAX InputSource from a TrAX InputStream for
encapsulating a stylesheet before it is compiled.
PR:		bugzilla 4711 (I hope to God)
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335829 13f79535-47bb-0310-9956-ffa450edef68"
82f178bd1bcc8d71ad38510ca59ab091ea892b9c,"Fix for last putback.
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335830 13f79535-47bb-0310-9956-ffa450edef68"
ee7e136e803bf12bfdc4e3b7d3cfdaffe02bc9f4,"This fix should take care of a regression introduced by the code that was
added on the 29.10.2001 to take care of forward referenced variables.
This little patch ensures that variables that do not have any dependencies
are kept in order.
PR:		bugzilla 4779
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335831 13f79535-47bb-0310-9956-ffa450edef68"
08e19477421db6d2fc8261c5bb925906bc8a04b2,"D13 internal version number update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335832 13f79535-47bb-0310-9956-ffa450edef68"
2206663aaf220b05b57fbe53c54876221356d692,"2.2.D13


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335834 13f79535-47bb-0310-9956-ffa450edef68"
226ed540395fa8b29ca5dfd8d984a8cbfed6bcc2,"Bugzilla4842, secondary complaint (glitch in getChildren)... <blush/>


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335835 13f79535-47bb-0310-9956-ffa450edef68"
a654e31a7a8991520c0bb3389c05c77f7b16b00a,"Fixed a minor regression after the fix for 3592. A literal number zero was
always interpreted as an integer zero and never as a double -0 opr 0.0.
PR:		bugzill 4810
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335836 13f79535-47bb-0310-9956-ffa450edef68"
9090964e9fff26cae13bd374161ee36be0d0cac4,"Fixed the code that prevents escaping of text inside <script> and <style>
elements in HTML. The code did not handle upper case element names.
PR:		bugzilla 2517
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335837 13f79535-47bb-0310-9956-ffa450edef68"
dbf6dbd3dafe7db46d53b2b9767cb9893f6bb113,"Bugzilla4842: Expand the proxy layer to support more of the DOM API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335838 13f79535-47bb-0310-9956-ffa450edef68"
89e373a4bbe0989d7c582695bb0172337b7bad37,"Namespace decls are themselves not namespace-aware, in the
Namespaces 1.0 REC. Use the qname.Grumble.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335839 13f79535-47bb-0310-9956-ffa450edef68"
41e1becec3e7e825718a34a0a2606fced7fef5fc,"bug fix 4906


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335840 13f79535-47bb-0310-9956-ffa450edef68"
36c5830408579bfc9a98bf5a9a65edeab6468b48,"Fix for nested parent location paths / filter parent paths with key() or
id() root. These paths would in some case returnt he root node when they
should not.
PR:		bugzilla 4781
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335841 13f79535-47bb-0310-9956-ffa450edef68"
d64f7da9c9ed530ab13fe6deb7626d04f9746f8c,"""Tupograflica eror"". Sorry 'bout that!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335842 13f79535-47bb-0310-9956-ffa450edef68"
8b9037dc198587452a42cfc67dc5435d24b5056d,"Fix for a big in the <xsl:sort> implementation. The element would not always
work properly in the innermost loop in nested <xsl:for-each> elements.
PR:		bugzilla 4921
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335843 13f79535-47bb-0310-9956-ffa450edef68"
44d4c97fba3538fdcfc55bed26c4423e14cbe556,"A fix for a regression introduced by a fix for <xsl:sort/> and nested
<xsl:for-each/> elements.
PR:		bugzilla 4921
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335844 13f79535-47bb-0310-9956-ffa450edef68"
e74cbc0aa1fefdee6acc2693f7a648a65f3c768f,"Fix to ensure that double quotes are escaped inside attribute values in
HTML output.
PR:		bugzilla 4845
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335845 13f79535-47bb-0310-9956-ffa450edef68"
a0647ae52ff5456e2a31b05b0e73bf71a037f934,"Fix for a bug caused by <xsl:apply-templates/> not always passing parameters to
the invoked template(s). Parameters would not be put on the stack if the
'select' attribute contained wildcards.
PR:		bugzilla 4718
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335846 13f79535-47bb-0310-9956-ffa450edef68"
264446f8f31ee123e81ad141faac742189e826f9,"Fixed conversion between strings and numbers. Empty strings should return
0 and not NaN.
PR:		bugzilla 4783
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335847 13f79535-47bb-0310-9956-ffa450edef68"
24672cfd65c52bcd28004e465c645f60020a25f3,"Fix for a whole wack of bugs related to text-nodes and handling of whitespace
and special characters.
PR:		bugzilla 1403, 1520, 3005, 3418 and 3690
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335848 13f79535-47bb-0310-9956-ffa450edef68"
033f1520b6a37cdb5f8db5d854ba51af1a4f7fdc,"Prevented the namespace-uri() from returning anything for namespace nodes.
PR:		bugzilla 4896
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335849 13f79535-47bb-0310-9956-ffa450edef68"
f1191448a6f9e00d8cae7dcba176a493a80ce144,"Added test in <xsl:element> to verify that the local name of the created
element is legal (must have contents, but no whitespaces or colon).
PR:		bugzilla 4894
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335850 13f79535-47bb-0310-9956-ffa450edef68"
e3268e8ee1801b66c1a7cfc85ac756217f8e31c6,"A small fix for the substring() function to output an empty string if the
start index is an infinite value.
PR:		bugzilla 4813
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335851 13f79535-47bb-0310-9956-ffa450edef68"
a3d7dadd2f01b76c7fb965225d1240ccc8dbf9ff,"Fix for XHTML output.
PR:		bugzilla 4904
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335852 13f79535-47bb-0310-9956-ffa450edef68"
bd4cdf0d0b87ff176112273a057484ae77286045,"A cleanup in the Message class. Making way for a fix for 4874
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335853 13f79535-47bb-0310-9956-ffa450edef68"
e9fdacee8f6cada8a3edfaab1f67e7e27abe0b88,"A fix for position predicates used within parameters and variables.
PR:		bugzilla 4783
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335854 13f79535-47bb-0310-9956-ffa450edef68"
8accda59b993e2115e7c02ed13cf648b36c3d67b,"A small fix needed after a fix for stripping/preserving text nodes. The fix
for text-nodes caused us to insert text nodes before <xsl:attribute> elements
in the AST, which again caused the XslAttribute class to complain.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335855 13f79535-47bb-0310-9956-ffa450edef68"
010f3f395230add6104a1c48dccb0ebd45361589,"Added a new method to the DOM interface for retrieving the DOM as a single
string. This method is different from the existing getStringValue() in the
way that it generates element brackets and copies PIs and comments.
PR:		bugzilla 4874
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335856 13f79535-47bb-0310-9956-ffa450edef68"
f17824f3975b003fae3cdcfaba16bf99c4ada0ca,"Bump D version number just in case; update handling of patternsets for
xml-commons related files; fix 'clean' target to delete (most) xml-commons related files;
update BCEL and JLex Ant propertynames to be all lower case


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335857 13f79535-47bb-0310-9956-ffa450edef68"
71439d2aa1aba00d150b7842ded66bbac1d2bd2d,"Sigh. The XML Namespaces spec it itself imperfectly
namespace-aware. While there's a plan to fix that, it's
safer for now if we test the QName when looking for
explicit instances of xmlns:xml in the source document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335858 13f79535-47bb-0310-9956-ffa450edef68"
2d102c245a54c9167bd2255d2b93ba5f3b7667e8,"Another fairly large change in the DTM architexture (sic)....

We've changed DTM's internal behavior so it can now assign
more than one ""DTM ID"" to a single document, cascading from
one ID to the next. This means that the size of a single DTM is
no longer limited by the bits available in the low part of the DTM
Node Handle. This means we can support larger documents.

That has allowed us to reduce the number of bits reserved
for that portion of the node addresing scheme... which in turn has
increased the number of bits available for use in the DTM ID. This
means we can now have many more documents active at once.

The trade-off is that huge documents will require more than one
DTM ID and thus cut into the number of documents, But since we
now have 16 bits of DTM ID space, I don't think we're really likely
to run into both limits at once. And the changes are essentially
limited to the DTM layer; the rest of Xalan should be unaffected.

In the process of making this change, I've also encapsulated the
conversions between DTM API node handles and DTMDefaultBase's
internal node indices. That should be safer all 'round.

NOTE: One side effect of this change is that the strings
generated by the key() function have changed again.
I've updated the IDKEY testcases to reflect this.

Smoketest is currently passing everything except
axes109 and the API's TraceListenerTest . But I believe
those failures are due to a glitch in my test directory
since they also happen when I run the D13 code there,
whereas D13 runs fine in the directory where I built it.
I'm going to assume that ""same result is no new bug""
for now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335859 13f79535-47bb-0310-9956-ffa450edef68"
dc52ba8ca6897ebccbc09513a23313b41edeac41,"Found the glitch causing the axes108 bug -- exptype/type.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335860 13f79535-47bb-0310-9956-ffa450edef68"
61ddaf85858b506ab9b862333d4c02da77dc8ce7,"Updated the StepIterator and FilteredStepIterator's cloneIterator() and
reset() methods so that the _isRestartable flag is set correctly.
PR:		bugzilla 4905
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335861 13f79535-47bb-0310-9956-ffa450edef68"
3d11a47112b397f255274cb6c919b65660474a0a,"Another fix for 3005 (special characters inside CDATA).
PR:		bugzilla 3005
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335862 13f79535-47bb-0310-9956-ffa450edef68"
7006c5ca6b2041c9cc28e6bba32e8ad7e87af427,"A fix for decimal formatting
PR:		bugzilla 4901
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335863 13f79535-47bb-0310-9956-ffa450edef68"
394e1f927b4683edf8645b1ff28b3dc415810e32,"A fix for a regression introduced by a fix for whitespace handling.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335864 13f79535-47bb-0310-9956-ffa450edef68"
68b6b4a94329b95e02322673e9160af29d87c654,"A fix for trees of step iterators stored inside variables.
Also some fixes for recently introduced regressions.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.iorg


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335865 13f79535-47bb-0310-9956-ffa450edef68"
276bbb205c8741a9dfa1d7a070d3c8ba1250a3b5,"Added option to set the recursion limit (which we're having trouble with
right now; the code that supported it seems to be disabled...) and
selfdoc for this and a few other newer options.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335866 13f79535-47bb-0310-9956-ffa450edef68"
872f0ddbb070e777970d78adb9f62ade3b1cec60,"removing xml.jar from xml-xalan/bin because it is nolonger used by XSLTC


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335867 13f79535-47bb-0310-9956-ffa450edef68"
320789e96c70529353162272cd2ee554e81e4158,"Include new org.apache.xmlcommons.Version file;
implement a manifest for xml-apis.jar with impl.version filtering


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335868 13f79535-47bb-0310-9956-ffa450edef68"
163c62ee0b46628e0c1bbca4dae8ec7c56aef026,"Update xalan.jar manifest to only include implementation classes;
also update classpath for -jar option with xml-apis.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335869 13f79535-47bb-0310-9956-ffa450edef68"
3a1b2c27c22d0a8e77ff157a95d60a86715a4023,"Manifest file for xsltc.jar; only includes implementation version info


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335870 13f79535-47bb-0310-9956-ffa450edef68"
766bec487b51701152fdcfc89d80d1994a1ec70e,"- Attempt to add <classpath...> elems for use when compiling xalan.jar
with an installed copy of Ant rather than java/build.bat/.sh; however
I'm not sure this is fully working yet
- Added xsltc.java_cup and xsltc.jlex targets in an attempt to
only generate these sources if needed; however the <uptodate>
task isn't quite working yet, so they're still always generated
- Add use of new manifest.commons from xml-commons-src.tar.gz
- Add use of and filtering for new manifest.xsltc
- Remove references to xml.jar
- Clean up the clean task a little


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335871 13f79535-47bb-0310-9956-ffa450edef68"
369e3d4199b94704358d94f978f3d483c13c3d5a,"xerces.jar version 1.4.4 from Xerces-J-bin.1.4.4.zip


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335872 13f79535-47bb-0310-9956-ffa450edef68"
4f0256aa56c4c3a4cbdda302ec8fa646cad05f33,"Catch exceptions from the output content handler in flush(), and throw a
SAXParseException with line numbers filled in.
If we don't do this, and the exception is a RuntimeException,
good line numbers of where the exception occured in the stylesheet
won't get reported.  I tried just catching RuntimeException, but
for whatever reason it didn't seem to catch.
Fix for Christina's DOMException error problem.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335873 13f79535-47bb-0310-9956-ffa450edef68"
37fe2d82fc4fdd7de1760c7490c6f7260e7b85a7,"A fix for the TrAX API when used from within an environment that does _not_
use one of the standard classloaders.
PR:		bigzilla 5130
Obtained from:	n/a
Submitted by:	Jochen.Cordes@t-online.de
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335874 13f79535-47bb-0310-9956-ffa450edef68"
289c71cbc4838c51e7406338192668c4ed101302,"A fix for multilevel sort-keys. If a set of translets (representing different
stylesheets) are running one the same JVM, and two or more of these translets
use NodeSortRecord objects to represent <xsl:sort/> elements, then the number
of sort keys would be set in the NodeSortRecord _class_ constructor instead of
being set locally for each occurance of <xsl:sort/>.
PR:		bugzilla 4755
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335875 13f79535-47bb-0310-9956-ffa450edef68"
93d225fbedb7592509cdc9759acb2a99029890ec,"A fix for resetting the source iterator of a node-value iterator.
PR:		bugzilla 5152
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335876 13f79535-47bb-0310-9956-ffa450edef68"
09b66fe8f0c37136b9e26511d7369ab6f34cb0df,"A fix for a few regressions from yesterday.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335877 13f79535-47bb-0310-9956-ffa450edef68"
171ffbdd9e3a67b19ef74df04fe7b867b6af1bd9,"Moved default namespace declaration node object out of its ""inner
class"" status, since I think I want to perform an instanceof test on it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335878 13f79535-47bb-0310-9956-ffa450edef68"
ab9388a99203d9026aa7f24d9874e47ca3630ea5,"Bugzilla 4336 -- fix for presenting symptom (since the implicit
xml: declaration pseudo-DOM node is resynthesized in each
DTM, find the _corresponding_ node), and a first draft of
CachedXPathAPI which should be a fix for the larger symptom
(XPathAPI creates a new DTM every time, which is potentially
very ugly for applications that want to run XPaths repeatedly
on a single document).

Also caught and fixed another node-handle/node-identity confusion.
The fact that DTM.get...() allowed us to be sloppy about that
distinction in the past means there may still be a few others lurking
in the code. Ye gods, I _wish_ Java had typedef!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335879 13f79535-47bb-0310-9956-ffa450edef68"
7f600ff863181735cf5602b84958628290a5673d,"Minor tweaks


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335880 13f79535-47bb-0310-9956-ffa450edef68"
67034d71061f73579764f9903e5cf707fab3a64e,"Patch to enable optional 'append' attribute on redirect:open and
redirect:write elements to append to file; note that behavior may
not be what you expect when using xml output, since the xml decl
will currently be output *each* time you newly write to the file
Submitted by: jpvdm@iafrica.com


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335881 13f79535-47bb-0310-9956-ffa450edef68"
be9b83703a1cabad47b03d3b9b6b82a3092ad778,"Implement getDocumentElement. If the DTM doesn't represent a
wellformed Document, this call is undefined and throws an exception...
which isn't DOMlike but that's a non-DOMlike situation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335882 13f79535-47bb-0310-9956-ffa450edef68"
a78c98df107ca23f6dcd2382bcc3b42904a0b6b1,"update for 2.2.d14


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335883 13f79535-47bb-0310-9956-ffa450edef68"
88d37db73114913c617cb382fb92336e7ed2d7f1,"Added note on CachedXPathAPI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335884 13f79535-47bb-0310-9956-ffa450edef68"
60b2f887ff5d7a29a51b31922755b7a2d57f582a,"Bugzilla4908, patch courtesy of mschilling@edgility.com


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335885 13f79535-47bb-0310-9956-ffa450edef68"
7bb261c527b3474114f93d964d1d8d63476d605b,"A fix to the XPath parser to make sure (again!) that non-prefixed elements
in XPath expressions/patterns are not assigned the default namespace but
rather the null namespace.
PR:		bugzilla 4904
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335886 13f79535-47bb-0310-9956-ffa450edef68"
a06186bb034245d045d942098fe3db4138675d95,"Modified the order in which top-level elements are parsed. This to make sure
that xsl:namespace-alias elements are parsed before xsl:import and include,
so that namespace aliases are global to all included stylesheets.
PR:		bugzilla 4876
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335887 13f79535-47bb-0310-9956-ffa450edef68"
e1dd9c4429927c3dc2f10ca48b28292c68bc4a68,"another update for 2.2.d14


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335888 13f79535-47bb-0310-9956-ffa450edef68"
c9c9a4c9e9a5feed84073ca30b80f23948c3db77,"updated version number to 2.2.D14


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335889 13f79535-47bb-0310-9956-ffa450edef68"
212bad78112714d8659b2d94212fa3efc07eb7b8,"Bugzilla 5242: Special-case initializing iteration from Document node -- one-liner wasn't safe.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335891 13f79535-47bb-0310-9956-ffa450edef68"
111d399eeaa1b7daa11e6c80b1746485fac54c3f,"PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335892 13f79535-47bb-0310-9956-ffa450edef68"
034886e5f6ec29f11082ab8e79d465f81140dbef,"A fix for the various node iterators cloneIterator() method. This method
should clear the _isRestartable flag to prevent iterators contained within
variables and parameters from changing their value. This flag is now wrapped
inside a setRestartable(boolean flag) method so that the call can be
propagated down a stack of iterators. This seems to solve many of our
iterator problems.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apaceh.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335893 13f79535-47bb-0310-9956-ffa450edef68"
42aa28b999e632bc90f31f0f49057f7e9f1b7e8d,"Added a method to the SyntaxTreeNode base class that can be used to check
the existence of an attribute in the input document: hasAttribute(String name).
This method is used in the XslElement class to verify the existence of a
'namespace' attribute with an empty value.
PR:		bugzilla 4983
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335894 13f79535-47bb-0310-9956-ffa450edef68"
ad70b6e9d32009da76f21e0301ba144672bad84f,"new class to version xsltc software


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335895 13f79535-47bb-0310-9956-ffa450edef68"
50f7bcd044827b51115b7b553194af74732e867e,"Updated the realToString() method in the runtime library to always output
numbers on decimal form (and not on Java's ""computerized scientific notation.""
PR:		bugzilla 4199
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335896 13f79535-47bb-0310-9956-ffa450edef68"
e97b1782e03631c6a3704c88087ecfce6ecc3fe8,"Changed the return-type of the round() function form int to double. The result
is still rounded (of course), but it is returned as a double to be able to
return NaN and infinite values.
PR:		bugzilla 2805
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335897 13f79535-47bb-0310-9956-ffa450edef68"
b597f21586aa77b5e36f2cba2970485faecbcbf8,"I am still fiddling around with predicates containing variable references
and position filters.
PR:		n/a
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335898 13f79535-47bb-0310-9956-ffa450edef68"
cd59d8f1dfc8df6148f4f7f9460494f6466c721f,"Reverting previous putback.
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335899 13f79535-47bb-0310-9956-ffa450edef68"
6f558549fbd067d9431d58043aef691c07162152,"Added a warning message for unsupported output encodings.
PR:		bugzilla 5139
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335900 13f79535-47bb-0310-9956-ffa450edef68"
bd812936d1bef8fd01aef4663ea26cb2026cf4ae,"fixed typo
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335901 13f79535-47bb-0310-9956-ffa450edef68"
04127a8a48aa19d3f8443df6f7c7ca2a74f984c8,"Additional debugging printouts, added while analysing Bugzilla 5272 but generally useful.
No functional change, and should be optimized away when DEBUG is set false.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335902 13f79535-47bb-0310-9956-ffa450edef68"
ef5aeb0fbf6178c2962889fd64a5ddcacb258349,"A fix for global parameters whose names contain dots or dashes.
PR:		bugzilla 5328
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335904 13f79535-47bb-0310-9956-ffa450edef68"
dc52a25b15df4cfe7b7128f22a5ce1330494d856,"A fix for a bug in the XPath parser. The parser would choke on some XPath
expressions that contained references to element names that were identical
to axis names.
PR:		bugzilla 3502
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335905 13f79535-47bb-0310-9956-ffa450edef68"
a71a8d69595634ded8e7e247933c368b0e482e43,"Added another fix to properly convert ver small floating point numbers to
strings.
PR:		bugzilla 4199
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335906 13f79535-47bb-0310-9956-ffa450edef68"
90e7fa180c4489bf99c6f1c4deffe1ed0fc8526d,"Added a fix for global variables declared in included/imported stylesheets.
PR:		bugzilla 5327
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335907 13f79535-47bb-0310-9956-ffa450edef68"
6f7f9079e2727268824279a349538cdbb69100b7,"Fix for use of XPath expressions in contexts where there is no 'current'
node (ie. in top-level elements such as variables and attribute sets).
PR:		bugzilla 5194
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335908 13f79535-47bb-0310-9956-ffa450edef68"
17d8661843ffd07517de29e808b587b7a5cddfe5,"Removed version and author information.
Version is in readme.xml and author is the Xalan developer
community.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335909 13f79535-47bb-0310-9956-ffa450edef68"
9955073ee9411eb797e533998be295b1b43b006b,"Removed the ""magic"" default which causes us to switch into incremental
processing mode whenever we were writing to Standard Output (ie,
-OUT had not been specified). If you want incremental processing,
please use the (relatively new) -INCREMENTAL switch to explicitly
request it.

(The automatic switchover was causing some confusion
when testing against Xerces2. )


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335910 13f79535-47bb-0310-9956-ffa450edef68"
630e5b4910c273ca1fb1edd66c71d4513983ec60,"Efficiency improvement to the new DTM ""overflow addressing"" scheme.
In some tests, this one alteration shaved about 30% off the runtime.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335911 13f79535-47bb-0310-9956-ffa450edef68"
94da6d4e1e3749bdfc03e24c9040c499ec60b78f,"A fix for '//' expression trying to extract a node set relative to root.
PR:		Bugzilla 5325
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335912 13f79535-47bb-0310-9956-ffa450edef68"
3585b3195ef8a9f6f34042818ce4bcd5a6389e22,"A fix for passing result tree fragments and node-sets to external Java
methods. Node sets and RTFs can both be handled as org.w3c.dom.Node or
org.w3c.dom.NodeList in the called method.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335913 13f79535-47bb-0310-9956-ffa450edef68"
1896e2d1970d40e99ba04a615cdcb061ee971372,"new prototype class, work in progress


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335914 13f79535-47bb-0310-9956-ffa450edef68"
abaa7b28ff86db60a4606d5a018bcaa52eb6eeeb,"added factory creation methods and checks


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335915 13f79535-47bb-0310-9956-ffa450edef68"
34bc6a294ef92d587fa2fb465d5a4cbfb637e55d,"Changes requested by the xml-security group:

1) Provide something a constructor that allows sharing  the
XPathContext object between CachedXPathAPI objects

2)  Add getXPathContext(). I'm just a bit nervious about this
method, but they assure us they need it and the field isn't
private. We may need to discus this one further.

3) Make the XPathContext's m_dtmManager member
protected rather than private, so their subclass can get to it.
We may want to work with them to understand why they're
accessing this directly and whether there's a better solution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335916 13f79535-47bb-0310-9956-ffa450edef68"
f29ea6798b3e3dee0d92b788abb2c2c0325edb0a,"look for xsltc specific attributes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335917 13f79535-47bb-0310-9956-ffa450edef68"
79ef43baca3afe6621f870bc5c5c3b179eb08beb,"store error listener and or uri resolver locally
set in real factory when needed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335918 13f79535-47bb-0310-9956-ffa450edef68"
b5064d7ca437b028296b4117c3f3114a0273cef6,"Bugzilla5272 patch suggested by Sandy Gao.

This startup sequence for incremental SAX parsing under Xerces2
really is excessively complicated and excessively fragile as a result.
Not to mention being underdocumented. We really need to push the
Xerces folks to provide a simple incremental SAX API, similar to that
in the Xerces1incremental prototype.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335919 13f79535-47bb-0310-9956-ffa450edef68"
3b7c836bc8c5f27d9aa4378c8c7236bbf69bdec0,"Part 1 of 2: Reducing initial space requirements of a DTM. This may
involve a slight performance hit, but should help stylesheets which
generate a lot of Result Tree Fragment. Part 2 of this change will be
checked in after I resolve a bug in whitespace normalization.

Note that a better long-term answer will be to reduce the number of
DTMs tied up as RTFs, by doing a better job of discarding or reusing
them when we're done with them. There are some issues regarding
exactly what their lifetimes will be when assigned to variables,
especially when one variable is used to build another, which we
need to address before we can make that change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335920 13f79535-47bb-0310-9956-ffa450edef68"
dd37bed098255dcab19c232b62f6b7e62f466750,"fixed scope of internal method


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335921 13f79535-47bb-0310-9956-ffa450edef68"
a1f5d31b123d74022d498650c373244f9f59f131,"Part 2a of 2: Reducing initial space requirements of a DTM. This may
involve a slight performance hit in some circumstances due to
smaller and more complex subdivision of FastStringBuffers,, but
should help stylesheets which generate a lot of Result Tree
Fragments.

Note that a better long-term answer will be to reduce the number of
DTMs tied up as RTFs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335922 13f79535-47bb-0310-9956-ffa450edef68"
2a9ebc98c6b2f730ff09c8141f0318753f2217f3,"Part 2b of 2: Reducing initial space requirements of a DTM. This may
involve a slight performance hit in some circumstances due to
smaller and more complex subdivision of FastStringBuffers,, but
should help stylesheets which generate a lot of Result Tree
Fragments.

(Leveraging FSB's features more strongly exposed a bug in
whitespace normalization, which I've fixed.)

Note that a better long-term answer will be to reduce the number of
DTMs tied up as RTFs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335923 13f79535-47bb-0310-9956-ffa450edef68"
98aecc13e438f019840eee3923a7dce71531e2a2,"Update of the XSLTC design documents
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335924 13f79535-47bb-0310-9956-ffa450edef68"
27955050bb04b5beaac649fcc6979c0f3d023787,"An update of XSLTC's runtime environment design document.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335925 13f79535-47bb-0310-9956-ffa450edef68"
3b95a1504727b156c8d9da91fa785495092e03f2,"Two goofs: Forgetting to use the namespace-aware DOM call, and
forgetting to check for a returned null before dereferencing.

How long has _that_ been lurking in the undergrowth?!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335926 13f79535-47bb-0310-9956-ffa450edef68"
7f9499569e579571eec892d7091495a9955a71ab,"Finally following up on an old hunch, I switched from /% addressing
to shift-and-mask. Big improvement!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335927 13f79535-47bb-0310-9956-ffa450edef68"
428b21ffe6e7305c2a9d1c534a3d57eefe4d8c67,"Performance improvements; Some changes to better leverage the
DOM's existing code, others to avoid some call-and-return overhead.

Combined with other recent changes, we've now got a significant
speedup over D14 on some tests. We may want to drop the scheduled
December 17th 2.2 release and instead bring 2.2 out on 1/14  (which is
when we'd planned 2.3) with performance gains and Xerces2 support.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335928 13f79535-47bb-0310-9956-ffa450edef68"
81eb92753b6ccbaf0b0672db5bb7344cf00115e8,"Removed some stupid debug timing-loop in the command line Transform tool.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335929 13f79535-47bb-0310-9956-ffa450edef68"
29285831c757c6d7835ec1e2a737d72076b5f79a,"Removed the main() method from the XSLTC class. This class represents the
native API of the compiler.
PR:		none
Obtained from:	n/a
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335930 13f79535-47bb-0310-9956-ffa450edef68"
c56e266295d062b550b6acd83bcca5a64daa02de,"A small cleanup in our native API.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335931 13f79535-47bb-0310-9956-ffa450edef68"
73914adc75d5227ec3709b3daf1c36484e70e746,"Added a description of XSLTC's native API. Update the compiler and runtime
command-line READMEs.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335932 13f79535-47bb-0310-9956-ffa450edef68"
135edc44280929a7badee03aad6c56b5a9824caf,"Added user DOC for our TrAX API extension. Not much really. Just a
description of the XSLTCSource class - a wrapper for the internal DOM
and DTD handler that implements the TrAX 'Source' interface.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335933 13f79535-47bb-0310-9956-ffa450edef68"
4d26b90c7326e43c5b7b38f79030e590106c7b3d,"Added design document for node iterators (not 100% complete yet).
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335934 13f79535-47bb-0310-9956-ffa450edef68"
411739dfe8c61685fc8ddda023a53ed8b621405a,"Completed the node iterator design document.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335935 13f79535-47bb-0310-9956-ffa450edef68"
c40c56be1f05a4af27b7c1bd78ce04bda88fb773,"A few more subtle performance tweaks, and an actual bug.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335936 13f79535-47bb-0310-9956-ffa450edef68"
8462d9759b59a87ce40acb96ecb0083ad17af08a,"Update for the node iterator design doc. Added a design doc for predicates
(not finished).
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335937 13f79535-47bb-0310-9956-ffa450edef68"
c1f31207b1295faa7bff7ef931b8e3984635f55a,"fixed parsing bugs in doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335938 13f79535-47bb-0310-9956-ffa450edef68"
c118fe26657a2497d3833fbe7b9873509e175d11,"fixed parsing bugs in doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335939 13f79535-47bb-0310-9956-ffa450edef68"
2779c15e3341e3287e8660ccbdb74928fa8e8850,"fixed parsing bug in docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335940 13f79535-47bb-0310-9956-ffa450edef68"
fc39cd2078f2785c44437d0c0091c4de5a9d1121,"fixed parsing bug in doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335941 13f79535-47bb-0310-9956-ffa450edef68"
97a38e2a17d2b897baba1e8d14697936b7e1a5f5,"added link to xsltc_predicates doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335942 13f79535-47bb-0310-9956-ffa450edef68"
03db24ac64249ed7e0d6616c00b346ed226ce1b6,"added link to xsltc_iterators doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335943 13f79535-47bb-0310-9956-ffa450edef68"
3ac86aeb705e5b8bbc1cbb7299e45aece03ad182,"fixed parsing bug in doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335944 13f79535-47bb-0310-9956-ffa450edef68"
6436d0710bcea93ec575694a1943e9b6d81d025c,"added links to build native and trax api docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335945 13f79535-47bb-0310-9956-ffa450edef68"
2755b52feb3d7f7d0c28f20fb516091ff0c52a43,"fixed parse bugs in doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335946 13f79535-47bb-0310-9956-ffa450edef68"
1adb21669648b37f3c2ec094520c3af662c668c0,"Alternate ErrorHandler/ErrorListener implementation that allows
configuration and prints errors out similarly to javac


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335947 13f79535-47bb-0310-9956-ffa450edef68"
cdfb4d0ff532968435b79ef48b5643a3a804b1d0,"Bugzilla 5496; previously unimplemented functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335948 13f79535-47bb-0310-9956-ffa450edef68"
e81bf32684d5c0ee8f85489cabf48ec849062a05,"[Bug 5528] DOMBuilder mixed DOM Level 1 and 2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335949 13f79535-47bb-0310-9956-ffa450edef68"
aa9f775d0865f910f8e908eab5665fbc59030e0a,"An update for XSLTC's design documents. Updated the designdoc2html
stylesheet to allow for a few more styling elements.
PR:		none
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:	morten@xml.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335950 13f79535-47bb-0310-9956-ffa450edef68"
0a806d37718e68b90437c1b73e8633ef5898b4fe,"Added some new XSLTC design docs.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335951 13f79535-47bb-0310-9956-ffa450edef68"
89814c44d49d9d6ef2c069b15d793d086391e1a5,"Removed the xsltover.xml design doc (unused, empty file).
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335952 13f79535-47bb-0310-9956-ffa450edef68"
f140c1155e27b99a127caa3c9a766bc776aa7678,"My final XSLTC design document update.
PR:
Obtained from:
Submitted by:	morten@xml.apache.org
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335953 13f79535-47bb-0310-9956-ffa450edef68"
fc535bc07f5b41e2109c512b4e30346b143ea3db,"fixed problem with output content handler creation
(while running xalan conf tests) in method getOutputHandler(Result).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335954 13f79535-47bb-0310-9956-ffa450edef68"
f293855569e23754c1e4e11f6f3f52527716d7ce,"chged fork attribute to 'yes' in the xsltc subtargets


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335955 13f79535-47bb-0310-9956-ffa450edef68"
2c35b2833e63fdb931a45919fbf748233b45d1e0,"interim update for next release


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335956 13f79535-47bb-0310-9956-ffa450edef68"
2defe5b51e7364336240cebff175dbb71fa6af98,"updated release number to 2.2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335957 13f79535-47bb-0310-9956-ffa450edef68"
ad462527319fa9186d8a9411cf6f19c850d79522,"DOM, SAX, JAXP interfaces from xml-commons-1.0.b1 release


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335958 13f79535-47bb-0310-9956-ffa450edef68"
767a6e9e522c92b3bc83681aa1e0ee0e83c235b7,"Add new xml-apis.jar to classpath so Ant can still find JAXP classes
after we update to Xerces 2.x impl jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335959 13f79535-47bb-0310-9956-ffa450edef68"
56c934a97a2f3747d02cab73d6afd637165d6c93,"Reference new bin/xml-apis.jar file; skip compiling the xml-apis code;
added skipcompat flag to ignore building 1.x compatibility-related items;
bumped version number to 2.2.0 for possible release next week


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335960 13f79535-47bb-0310-9956-ffa450edef68"
16c4a8fb059df025ffbee2c2b6c749f9ad04fd88,"Fix Bugzilla#5701: incorrect resolution of certain kinds of absolute file: URIs
Note: This definitely seems to be more correct in terms of resolving URIs
vis-a-vis RFC 2396 than it used to be. The only user case which might now
fail where it used to work is a user that supplies an incorrect
'file:subdir/blah' that they intended to be a relative URI (technically
it is an absolute URI no matter which way you look at it); this might
lead to a change in behavior in this particular case, although the behavior
before was incorrect.
The major risk factor could be if there are other parts of Xalan code that rely
on the previously incorrect behavior, but I can't find any, and the whole test
suite runs and passes normally.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335961 13f79535-47bb-0310-9956-ffa450edef68"
c6d2f1ad7e625ad34e1167c945e0125993734220,"Fix Bugzilla#4678 and Bugzilla#5533: call setSystemId on StreamResult
in Process command line class; ignored if using System.out
This should enable the redirect extension to properly put it's redirected
output in a location relative to the output if possible; previously it
always put redirected output relative to the input since it
never had the systemId of where the output should be


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335962 13f79535-47bb-0310-9956-ffa450edef68"
054674a2c8189be0200dc24177ebabcc12ce7239,"fixed style problems so xsltc doc would build


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335963 13f79535-47bb-0310-9956-ffa450edef68"
f3ec3c51a4c8a4f70284c1fa527ada2b6c87e9ff,"added new target xsltc.bundledjar that creates a
single jar file containing xsltc impl and support jars (bcel, java cup, etc)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335964 13f79535-47bb-0310-9956-ffa450edef68"
40b4d65886bd5f0b592d3b693a1b5663eee283bd,"Updated instructions and my key


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335965 13f79535-47bb-0310-9956-ffa450edef68"
9f16c0ecc583665c2ff675e3174b86afb63b55cb,"Updates for 2.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335966 13f79535-47bb-0310-9956-ffa450edef68"
3307b487e41fea03e02e77787238c52cbba07fa2,"Updated copyright to 2002


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335967 13f79535-47bb-0310-9956-ffa450edef68"
63b0cd86dc94a680b5b9c1a78d84ccf2f4c97d61,"Corrected refs to XSLTCDONE


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335968 13f79535-47bb-0310-9956-ffa450edef68"
5a404ef8819ce8a148c709955eb634b113f99a16,"Replaced DOMParser with an identity transormation to produce
input DOM objects.
This change required to sidestep a problem that appears with
Xerces-J2beta4 and the JAVAX 1.1 DocumentBuilder. Works
with Xerces-J1.44, Xerces-J2beta4, and presumably Crimson.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335970 13f79535-47bb-0310-9956-ffa450edef68"
973bcc8035a217c4b93f251aa99963a469cc341c,"Removed todo.xml, which is completely out of date and useless.
Purged commits.xml, which needs to be recreated with post 2.2
changes.
Purged transformation of todo.xml from build.xml - docs.prepare.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335971 13f79535-47bb-0310-9956-ffa450edef68"
f61e79a5a1ee487bb1d27a10decfb209ee37e6a9,"No longer looking for changes to the  Xalan-J1 compatiblity API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335972 13f79535-47bb-0310-9956-ffa450edef68"
518f321918041e33a76254c239f250c02676eadb,"Fixed second connection problem


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335973 13f79535-47bb-0310-9956-ffa450edef68"
891225950e56b44e83a85fc0b285562a8fab729b,"Update for new DTM Model


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335974 13f79535-47bb-0310-9956-ffa450edef68"
05859609a9ac081640f5cdbeb1dd98409a3d02f6,"Removed Debug


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335975 13f79535-47bb-0310-9956-ffa450edef68"
9e7f2dd774ed849ea6457618301f2cf1ddebbe0c,"Removed references to Xalan-J1 compatibility API and to
the out-of-date (now purged) todo list.
Separated core release notes, xsltc release notes,
core history, and xsltc history into 4 files to avoid forcing
users to load a huge readme.html.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335976 13f79535-47bb-0310-9956-ffa450edef68"
89b2a0adbdf61be3755f57b8c310e253cf77c041,"Xerces implementation jar from Xerces-J-bin.2.0.0.beta4.zip


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335978 13f79535-47bb-0310-9956-ffa450edef68"
6d0d19aed3edae7c709942cc590a917e9b7aae50,"Fix parsing error (temporary: file to be updated with real data)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335979 13f79535-47bb-0310-9956-ffa450edef68"
3e915876f0073b54ad283cb0a0f13794c1a8e5f2,"Update to use Xerces 2.x xercesImpl.jar file;
build.xml also remove other references to todo.html, ""todo"" target, etc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335980 13f79535-47bb-0310-9956-ffa450edef68"
36ed4fe14e6bd091cde5dc3aa817854c9ba4e81a,"1.Replaced get-todo.html with get-trax.html (i.e.replaced todo.xml/todo.xsl
with trax.xml/spec.xsl.
2. Updated applet archive setting in sample applets to point to xalan.jar,
xml-apis.jar, xercesImpl.jar (for Xerces-J2) and xerces.jar (for Xerces-J1).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335981 13f79535-47bb-0310-9956-ffa450edef68"
dfddb20637319adf1d183b521f323a775defa4ed,"Replaced get-todo.html with get-trax.html (i.e.replaced todo.xml/todo.xsl
with trax.xml/spec.xsl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335982 13f79535-47bb-0310-9956-ffa450edef68"
c4085acd2f9959df148f16b661772503e6019a62,"Replaced  todo.xml/todo.xsl with trax.xml/spec.xsl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335983 13f79535-47bb-0310-9956-ffa450edef68"
4733714e7939c1f562d4b123bff0184d695e10d8,"In applet and servlet samples, replaced  todo.xml/todo.xsl with trax.xml/spec.xsl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335984 13f79535-47bb-0310-9956-ffa450edef68"
396f3012aac57f2f1f26549083fbd06fe35a97a0,"fixed the xml apis variable XML-APIS_JAR that was not expanding properly


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335985 13f79535-47bb-0310-9956-ffa450edef68"
77042d36cd94b76cc562033054d46f9d918c0ab8,"Whups. There's a possible reentrancy problem when data
is being serialized from an FSB, thru Sax, back into a new
chunk of the same FSB; if the append causes a rechunking,
the serialize loop may break.

TEMPORARY PATCH; permanant fix to follow. See comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335986 13f79535-47bb-0310-9956-ffa450edef68"
792b384ad6ce202621e31ad4ccaee3942efae3df,"<blush>Wrong side of the fencepost...</blush>


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335987 13f79535-47bb-0310-9956-ffa450edef68"
9e68081de6e5d89d4151b1b89a0efd92680dbe7c,"Fixed typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335988 13f79535-47bb-0310-9956-ffa450edef68"
cdb2fc1957fd4d003fcf2dce596041147d200a44,"Nighly GUMP jar from http://gump.covalent.net/jars/latest/xml-xerces2/
dated 20-Jan-02 13:08; although not an official Xerces-J release, this
jar works much better with Xalan-J than the 2.0.0beta4 does


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335989 13f79535-47bb-0310-9956-ffa450edef68"
2d0c61846b6b0bdd419627ba897a42699d9d0d80,"Doc updates for 2.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335990 13f79535-47bb-0310-9956-ffa450edef68"
c12f3a2cc4ec9331ecdd5ce8189f797bdb4c93a2,"For XercesParser, use JAXP DocumentBuilder to parse XML documents and return a
Document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335991 13f79535-47bb-0310-9956-ffa450edef68"
f7c7d888be64ab87498ed3105dc254342764d927,"Interim update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335992 13f79535-47bb-0310-9956-ffa450edef68"
458dd1a6a904f6374c9b5bd42ee23460365d8a22,"These changes allow us to store multiple Result Tree Fragment (RTF)
document trees (used when an XSLT variable contains a constructed
set of nodes)  into a single DTM object rather than using a new DTM
for each RTF. They also permit ""tail-pruning"" this shared DTM to
reuse that space as the variables go out of scope.

The result is a slight performance improvement, and a much more
significant improvement in storage efficiency. Stylesheets which
use RTFs heavily should now run in much less memory; in
one testcase, our ""working set"" heap size (storage actually in
use, not counting objects released but not yet GC'd) dropped
from 12-15MB down to 3-6MB, and heap churn (how quickly
storage was being allocated and discarded) also reduced
substantially.

The code changes needed to support this new scheme are
surprisingly small. And I believe it may be possible to reduce them
further, if we're willing to merge the SAX2RTFDTM subclass back
into its SAX2DTM superclass.  I believe that could be done with
very little adverse impact on other uses of SAX2DTM... but I felt it
was safer to defer that decision for now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335993 13f79535-47bb-0310-9956-ffa450edef68"
efc5a1e511d20262017d00ca6c5aeb9383b74c32,"bug 1520 fix, escape chars over 0080 instead of 00FF


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335994 13f79535-47bb-0310-9956-ffa450edef68"
ff30afccbd5d82ed2426b1c52c760252ba24d1c3,"Update xml-commons sources to 1.0.b1 to match our copy of xml-apis.jar;
these sources are no longer used for compiling but are used in building a
full set of Javadocs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335995 13f79535-47bb-0310-9956-ffa450edef68"
9530884faa03fb30af6c9293eec3c50c8b44f92d,"Expand xml-commons-src.tar.gz into source tree for inclusion
in Javadoc build.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335996 13f79535-47bb-0310-9956-ffa450edef68"
bdb7dc7389b89a94e608b099de7f57fdd49bdbaf,"Updates for 2.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335997 13f79535-47bb-0310-9956-ffa450edef68"
11b680bc6cbf8c8be460a7585022e61c229c2d4f,"bug 1520, adjusted 0080 to 007F in ASCII cutoff


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335998 13f79535-47bb-0310-9956-ffa450edef68"
a700d3245a3f09d6c569923b6ba0dabd6f6d4ca0,"Begin updating version numbers to 2.3.D1;
Remove building of samples from most targets; remaining ones are unsupported
Remove copying of old xerces.jar to distro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@335999 13f79535-47bb-0310-9956-ffa450edef68"
944db81caf1eb7769e032d7aa2ed3f0593a3070e,"Bug 5982 and 6022. The variable stack was not being cleared accross transforms so that when the transformer is reused, we were using nodesets from the previous transform which were using a different DTM. Note that we want keep any variables that have been set externally by the user (using Transformer.setParameter()).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336000 13f79535-47bb-0310-9956-ffa450edef68"
96bbe6671530acc056da93d476cd58015db9ade9,"Removed InstantDB and added info on how to get and use the ""Developer license"" copy.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336002 13f79535-47bb-0310-9956-ffa450edef68"
e5d768fc16207b942b1664a8ac76510f53b98e1b,"Updated JDBC driver for Lutris InstantDB 4.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336003 13f79535-47bb-0310-9956-ffa450edef68"
9a4cfc661e8874671d3078a4a843d5f8cb092e0b,"Removed InstantDB and added info on how to get and use the ""Developer license"" copy.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336004 13f79535-47bb-0310-9956-ffa450edef68"
351826634bbefebc9faf39b67cd7edee0103211f,"Updates for 2.3.D1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336005 13f79535-47bb-0310-9956-ffa450edef68"
326b3e87d3848bd2b6babbbcad6acb5f6cf31594,"Added links to information on performing incremental transformations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336006 13f79535-47bb-0310-9956-ffa450edef68"
375af2f142bf97852e2144b6f52aa1e05bd3a9a8,"Updated Xerces current-build identifier.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336007 13f79535-47bb-0310-9956-ffa450edef68"
53df95dab12a777b2a4861d9b5df64ff2b806d9c,"From xml-xerces/java CVS on 2002-01-25 14:00


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336008 13f79535-47bb-0310-9956-ffa450edef68"
9d71e42ac85281ab0ab008df412203162033586a,"bug 4762: Fixed the duplicate error message in XPATH.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336010 13f79535-47bb-0310-9956-ffa450edef68"
0987e59a843f756ef63f1e6bf7e20e94951f50f4,"Bugzilla 4054: Retain previously set output properties when adding new ones.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336011 13f79535-47bb-0310-9956-ffa450edef68"
97b63b4f7f6338f6d1e2b7c035072bf62f12fa28,"Bug 5872. We were using a constructor of TranformerException without the locator information. Changed to code to use a locator if info is available.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336012 13f79535-47bb-0310-9956-ffa450edef68"
9d1f17e7d6002fc9c965c3238bb1048042009952,"Remove idb.jar due to potential licensing issues; dleslie is updating the
samples and docs to explain to users where to get a copy themselves
so they can see how the SQL extension works


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336014 13f79535-47bb-0310-9956-ffa450edef68"
58f0984808533f64d5f280c68d316261e2536a74,"Changed ""system id"" to ""public identifier"" in javadoc
comments for publicId() methods.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336015 13f79535-47bb-0310-9956-ffa450edef68"
d1204d24ceee62f9430cd68df50bbe2f7b820312,"1. Added features.xml.
2. Updated faq on StackOverflow with recursion.
3. Added NodeInfo extension functions to extensionslib.xml


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336016 13f79535-47bb-0310-9956-ffa450edef68"
8e9fddb89982b0d2b78a6de2c725b48215407c5e,"From Xerces-J 2.0.0 binary distribution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336017 13f79535-47bb-0310-9956-ffa450edef68"
32a09e44ceb604e9a553d08bfe7583bc71b285b7,"1. Added note to readme.xml about doc changes.
2. Corrected 256MG to 256KB in faq.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336018 13f79535-47bb-0310-9956-ffa450edef68"
8679df97f2c94c7cbe9e92d3cebd85b4f45deb43,"Bugzilla 2617, part 1: Construct the data structures and access them correctly.
Ignore too-late-to-be-safe requests to enable this feature.

This doesn't resolve how to rewrite higher-level code so it makes the
request early enough to be useful.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336019 13f79535-47bb-0310-9956-ffa450edef68"
3b494db1d183c9d27e41d217ea361d41996311b4,"Bug 4987: Changed Apply-imports logic to only apply imports to stylesheets that are direct imports. The logic for includes has not changed, we will apply-imports to any stylesheet that is imported as a result of an inclusion. Note: had to change the order when includes and imports are recomposed!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336020 13f79535-47bb-0310-9956-ffa450edef68"
18e9a468d9113670bf816f5e0bdecf9c3f060cb1,"Updates for 2.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336021 13f79535-47bb-0310-9956-ffa450edef68"
dfbcabcbe2927c2bd66c06854411b14152d3717b,"Updates per Joe Kesselman's 'source_location' revisions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336022 13f79535-47bb-0310-9956-ffa450edef68"
da07d77b0945c8a2b9d69da6c4fec40f6e5f7cd0,"Bugzilla 2617: Recreated missing code, changed controls to ensure
that this mode gets set early enough to be useful and can't be broken
by being turned on and off during execution.

NOTE: Current implementation relies on a global static flag in
TransformerFactoryImpl. We need to rearchitect our APIs slightly
so configuration hints of this kind can be passed down from top-level
objects to the back-end code more elegantly. Revisit in future
releases.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336023 13f79535-47bb-0310-9956-ffa450edef68"
696de30b12b2304daa6e7933b373f316230acc09,"Bug 5505: Need to resolve params before we do anything else, so move code that does that above the code that sets up the different node stacks.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336024 13f79535-47bb-0310-9956-ffa450edef68"
17f8871cd9e26345c4646ef48791c96049e1693a,"1. Removed copying of todo.html from build.xml.
2. Regenerated commits list (commits.xml).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336026 13f79535-47bb-0310-9956-ffa450edef68"
350ffd96173991fc892183a3e874961836b04253,"Updated release Xalan release number to 2.3, and Xerces version
number to 2.0.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336027 13f79535-47bb-0310-9956-ffa450edef68"
aac1d7e821dc8c0cbd99de90858aa7741b2d2085,"Removed copying of Xalan-J1 compatability Javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336028 13f79535-47bb-0310-9956-ffa450edef68"
f8817bf455bdf7033707a54b890ce1d373bffd5a,"Remove SBOAG_BRANCH_OPTIMIZATION2 from the commits list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336029 13f79535-47bb-0310-9956-ffa450edef68"
0d80ab60f7dd53c33fcb056ffdd71bf4be996f16,"IBM Public License for bsf.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336030 13f79535-47bb-0310-9956-ffa450edef68"
a6847d0f45b55fb517feaddc0387411b79784700,"license file for java_cup.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336031 13f79535-47bb-0310-9956-ffa450edef68"
ec1444c49653e03b2223eb87c094b7453cb07f3f,"license file for runtime.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336032 13f79535-47bb-0310-9956-ffa450edef68"
c4315ca35b746c0e5b95c2654490311da5909956,"license file for JLex.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336033 13f79535-47bb-0310-9956-ffa450edef68"
2e0a34cc91ccfcfc2676d44e862db7be4d39787b,"license file for BCEL.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336034 13f79535-47bb-0310-9956-ffa450edef68"
4537e43a26572dc6ae5742aa0c33a4cb4fb184bd,"README file for BCEL.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336035 13f79535-47bb-0310-9956-ffa450edef68"
ee54d6a0c86dbccf13f5e56c01e223c8531b3286,"README file for JLex.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336036 13f79535-47bb-0310-9956-ffa450edef68"
ec4ca56131851ea59aa9ff2791dadc2741754f86,"README file for java_cup.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336037 13f79535-47bb-0310-9956-ffa450edef68"
94d139658e8d01a5bc0525b87fd13b3e9dfdb096,"README file for runtime.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336038 13f79535-47bb-0310-9956-ffa450edef68"
2ad3a5718ca92734573e996345c96dd8ef4b25c0,"Editorial cleanup for 2.3.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336039 13f79535-47bb-0310-9956-ffa450edef68"
7b38b8b8306e1df062290567e4d1ae9dbf7ae140,"README (pointer to license) for bsf.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336040 13f79535-47bb-0310-9956-ffa450edef68"
d34a0af5e09ce8f8d7a6d035913e10fb06461c36,"stylebook license.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336041 13f79535-47bb-0310-9956-ffa450edef68"
e63ddbc4fc89dc2226a66dcede6973f9d8abf242,"xercesImpl.jar license info.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336042 13f79535-47bb-0310-9956-ffa450edef68"
d058631079faa1d39bdeec392aec0738fbeea4e8,"Editorial cleanup for 2.3.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336043 13f79535-47bb-0310-9956-ffa450edef68"
ec4f5deccd2808934a024acf8497c926d209a377,"Remove old 1.4.4 version of Xerces; please use xercesImpl.jar instead


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336044 13f79535-47bb-0310-9956-ffa450edef68"
6834fcab1dfbc0f8e1d41859d0cf83bfa332bb4c,"LICENSE and README information about ant.jar from jakarta.apache.org


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336045 13f79535-47bb-0310-9956-ffa450edef68"
6b588eee73a4e15ef20c78a765e81349f1e4f4b1,"Oops, include antRun and antRun.bat too


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336046 13f79535-47bb-0310-9956-ffa450edef68"
3ddc8c15b086b366dbf467127255451399b85f0e,"Editorial cleanup for 2.3.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336047 13f79535-47bb-0310-9956-ffa450edef68"
e4c3b4d132b42d140a20a00066f6c2f91f1bb317,"changed de.fub.bytecode to org.apache.bcel


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336048 13f79535-47bb-0310-9956-ffa450edef68"
e128adb4072c2a2518a3429300c4f49cff16ca73,"new BCEL used jakarta regexp rather than gnu regexp


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336049 13f79535-47bb-0310-9956-ffa450edef68"
8458bc4657f92d57fbb956a801173c227fb2109b,"removing old BCEL.jar (de.fub.bytecode) will replace


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336050 13f79535-47bb-0310-9956-ffa450edef68"
42b26e3c5e3eae7553b1d1ef5ba1316e198ceb92,"Bugzilla 6182. Darned fence posts; always either too many or not enough... <grin/>


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336051 13f79535-47bb-0310-9956-ffa450edef68"
2ff7a146ee609c0ef1ec17138555dd670ebf83b6,"this is jakarta BCEL v5.0, the new BCEL


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336052 13f79535-47bb-0310-9956-ffa450edef68"
c5265fb2101c3a5b0c88dcafb9f1341294b30e05,"changed de.fub.bytecode to org.apache.bcel


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336053 13f79535-47bb-0310-9956-ffa450edef68"
70723c6ebdcf3373536d873974b4c1ea58de02e9,"added license and readme for jakarta-regexp jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336054 13f79535-47bb-0310-9956-ffa450edef68"
b4f87d49978d7b8e92a36cf75b5223bb72438ac7,"Bug 6156: Change variable stack reset to just get a new object. Also make sure that the stack of result tree fragments is also cleaned ot during a reset.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336055 13f79535-47bb-0310-9956-ffa450edef68"
98f0df70e61f3bff30b777ca32cb50fa70b590aa,"Update for 2.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336056 13f79535-47bb-0310-9956-ffa450edef68"
02f618ef0cc397180fbadaff34d709a632cad35c,"Bug 5851: Make sure that the equal operation is evaluated by order of precedence of the operands, as defined by XSLT.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336057 13f79535-47bb-0310-9956-ffa450edef68"
fc846d9008227a86da15e41e5c654e1a2f6651e1,"Bugzilla 5346: Prevent mantissa overflow when converting string to double.
There is still a possible edge-case, since I detect overflow on decimal digit
bounds rather than on bit bounds; I'm not sure what the IEEE spec calls for.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336058 13f79535-47bb-0310-9956-ffa450edef68"
f6285a9f152710ee8e34a4cb1b5a7fccd23d1a6d,"Bugzilla 5346: My first-cut messed up fractional values. This one is
somewhat better.

There's an open issue w/r/t numbers with many digits after the
decimal point, regarding limits on how large a power of 10 can
be contained in a long. In that one case I'm falling back on successive
divisions (though as few as possible), and some loss of precision
may result.

Need to find a better algorithm...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336059 13f79535-47bb-0310-9956-ffa450edef68"
3669ae6fabda63aa918264d19acac7ef1bd10f97,"Bugzilla 5346: Oops. Forgot to take out a debugging printout.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336060 13f79535-47bb-0310-9956-ffa450edef68"
16347f9b962b55537b9178806c523bd794fbb315,"Remove get-trax for samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336061 13f79535-47bb-0310-9956-ffa450edef68"
310a95d115163de15cd16b7119f023a3e103f5d6,"version 2.3.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336062 13f79535-47bb-0310-9956-ffa450edef68"
7df89c17097d43eba58e6e4aa2df3a2b2afbc30f,"ASF license for xml-apis.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336063 13f79535-47bb-0310-9956-ffa450edef68"
79dabf90b55f106768e356688ef89c6842e1196e,"Bugzilla 5346: Responding to the re-open; more direct and reliable
edge-case test. This does lose a few low bits on many-digit values,
so it is not the best long-term solution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336064 13f79535-47bb-0310-9956-ffa450edef68"
9fdb4ffade3281b730a6dea4ae9841602a15321f,"Bug 5346: One more (last, I hope) edge case.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336065 13f79535-47bb-0310-9956-ffa450edef68"
201a1764ec01679904a4668aaf05067d0b09d669,"Bug 5346: Gaaah. This regressions was just plain foolish flailing. ""Less haste, more speed.""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336066 13f79535-47bb-0310-9956-ffa450edef68"
015417300c938b6ee530b3beec74c14e8ff3a927,"bug 1520, spec chars in href attributes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336067 13f79535-47bb-0310-9956-ffa450edef68"
4f9d8f60aeb7755e828c43195afd7bfac3ea8484,"Bug 5857: Reusing objects that reuse objects has threading concerns.
Three possible solutions: Don't reuse, synchronize reuse, or rewrite
to avoid using the objects in the first place. See comments in code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336068 13f79535-47bb-0310-9956-ffa450edef68"
c74a1364b6ae9bbe2500d73c14c3e386c99e091a,"Updated xml-commons-1.0.b2 build


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336069 13f79535-47bb-0310-9956-ffa450edef68"
9156df11c7328d5c5ad19d5a05dbf4a7ba2710ca,"Bug 4244: Incremental wasn't setting up correctly for the
DTDHandler stream. It never occurred to me that XSLT would
ever have a use for unparsed entities...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336070 13f79535-47bb-0310-9956-ffa450edef68"
aeb13b315b6c3e2fcd570f8b6615e02a917c5347,"Whoops! Never updated release number to 2.3 in these version files!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336071 13f79535-47bb-0310-9956-ffa450edef68"
97a05c0abd2ef19e1845cabb9660b166c6fd8b22,"target xsltc.bundledjar now includes the jakarta
regexp classes (for new BCEL) and all license and readme files for jars


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336072 13f79535-47bb-0310-9956-ffa450edef68"
38faecf50d8c02b30a309bea708f7b46a082eef7,"updated version number to 2.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336073 13f79535-47bb-0310-9956-ffa450edef68"
cc3c5760916c5c307cd3b9f8c22a92d86cbcb24b,"Bug 6304: Remove print stacktrace


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336074 13f79535-47bb-0310-9956-ffa450edef68"
fcad3482283ee72263412de11a3c5fa51e72289e,"bug 1520, updating href attr spec char handling


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336075 13f79535-47bb-0310-9956-ffa450edef68"
305ae85c58716846b12ea2905b409e11a3f6e8cd,"another update update, maybe final for 2.3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336076 13f79535-47bb-0310-9956-ffa450edef68"
04dcb9c863ca0385e2db1c30cd60d1ad16bd56de,"Adjust build.xml not to include jaxp, dom.sax in dist and to
remove the same during clean.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336077 13f79535-47bb-0310-9956-ffa450edef68"
5effd521501ce2ef3f46e23c9d592d9368e4fdd7,"Corrected typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336078 13f79535-47bb-0310-9956-ffa450edef68"
3f5f56eeb13b99e2d7fb9169e88b0ad5de8c27e1,"Added 0 to build number (2.3.0)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336079 13f79535-47bb-0310-9956-ffa450edef68"
8efb7a3b735823c1935fe6e6ee83ceecff8fe583,"added xmlapis.jar to xsltc class path


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336080 13f79535-47bb-0310-9956-ffa450edef68"
fbbe38efada9e5b161d5b264ff5a0a3507f2bc0a,"Cleanup of use of ""Xalanxx"" and equivalent entity refs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336081 13f79535-47bb-0310-9956-ffa450edef68"
25dcceeac7ea8b42992963b041f413ddc433981d,"Added ref to xml-apis.jar as a requirement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336083 13f79535-47bb-0310-9956-ffa450edef68"
3f95055575eaaa07510973aadd163f4f10846f2b,"Added xml-apis.jar to list of requirements and switched ""Xalan""
to the corresponding entity ref.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336084 13f79535-47bb-0310-9956-ffa450edef68"
5a794d7dfbbd54e36bb65e2919cee46d14cc344c,"Cleanup


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336085 13f79535-47bb-0310-9956-ffa450edef68"
8a0ea40ddc59582b7c2084b169f225e4029bee38,"Bugzilla 6314: Additional support changes for multiple RTFs per DTM.
Many files affected, but the basic change is that dtm.getDocument()
with no arguments is meaningless when there are multiple docs in
a single DTM object; instead, folks should use the new getRootNode()
method or getOwnerDocument(), both of which take a node as input
and thus more clearly identify which document we're referring to.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336086 13f79535-47bb-0310-9956-ffa450edef68"
0833b5dbc52cda23c6546e061a873a8c7f1c2b8b,"interim update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336087 13f79535-47bb-0310-9956-ffa450edef68"
a057fd27e1040cd3c64bc8ba08ae1478cd76ed3b,"version 2.3.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336088 13f79535-47bb-0310-9956-ffa450edef68"
8798e1bf9ab65e21b042dc6b87a0eaf24e3d1575,"editorial update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336089 13f79535-47bb-0310-9956-ffa450edef68"
5ede5a7f8b48ba247e9a05e44770992ae680560c,"extended use of &xslt4j; entity ref.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336090 13f79535-47bb-0310-9956-ffa450edef68"
be2bf9a114869b3062d79fe320e60132260754f5,"chged jakarta-regexp-1.2.jar to regexp.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336091 13f79535-47bb-0310-9956-ffa450edef68"
148cdfef455492960d1b69d28387489f95f9615e,"chging name of this file


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336092 13f79535-47bb-0310-9956-ffa450edef68"
d56e47a5eb2f5066451d506f71835cef0a0ded7d,"new name for file


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336093 13f79535-47bb-0310-9956-ffa450edef68"
a509e4c76ef02de5765acdc85779a2643ca03cbe,"chging name


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336094 13f79535-47bb-0310-9956-ffa450edef68"
51d840b251d6a4afd1d1de7c165bbdee51ef31fd,"new name


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336095 13f79535-47bb-0310-9956-ffa450edef68"
b73d1eb5f2ad69c3e259e27c956058e91341f402,"updated docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336096 13f79535-47bb-0310-9956-ffa450edef68"
0b044b8c37fa8980dc216f4d8a005974d197f955,"Bugzilla 6328, whitespace normalization. Late fix, but it was a genuine regresion.
This code could still do with a rationalization pass; I think it can be made slightly
a touch faster.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336097 13f79535-47bb-0310-9956-ffa450edef68"
04569437c02f2b359216238200c7f942ac0f6ff4,"periodic update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336098 13f79535-47bb-0310-9956-ffa450edef68"
d7ea1ffe4f63937d3e8e0ba10534d813740af920,"update docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336099 13f79535-47bb-0310-9956-ffa450edef68"
a8cf2b9e49631942fc0eb93aca8ae13b25b742b1,"update docs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336100 13f79535-47bb-0310-9956-ffa450edef68"
6a39ca1542edcbaaa625b62cbed4e5a4b4c52db3,"udpated doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336101 13f79535-47bb-0310-9956-ffa450edef68"
03f67fda693924680bc19dfde2afc4e6b713e9d9,"updated doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336102 13f79535-47bb-0310-9956-ffa450edef68"
cec420727b26ee845aeb7f884e0fbb9be1412f18,"fixed html links to README files


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336103 13f79535-47bb-0310-9956-ffa450edef68"
a98ab65f540ad452a670cd444b9b74e8af49e10e,"updated menu


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336104 13f79535-47bb-0310-9956-ffa450edef68"
615f4725e13006840693ca98584180699c2497cf,"added performance doc to build and menu


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336105 13f79535-47bb-0310-9956-ffa450edef68"
50821c160990abc4436a481a57f9cc2195eb0d6f,"updated menu


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336106 13f79535-47bb-0310-9956-ffa450edef68"
f93ad4fe468d3f59101d11d94ca759841f65bedd,"updated doc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336107 13f79535-47bb-0310-9956-ffa450edef68"
08c5f8908a74b39dfeda2e4fdcca276546cbb808,"udpdate release notes with known problems from bugzilla and a little description of the smart transformer switch


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336108 13f79535-47bb-0310-9956-ffa450edef68"
a8b2a75f60c239818ac353734b152bfbf1f3628e,"bug fix 6189, ArrayIndexOutOfBoundsException, contrib
by Mirko Seifert


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336109 13f79535-47bb-0310-9956-ffa450edef68"
0448eb90096622f4bf3feddcddcfc29a8d61b68a,"add release note for bug 6417


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336110 13f79535-47bb-0310-9956-ffa450edef68"
6c90eff96c567ef26b27507f79dc5ebdc44f8a40,"upadte for 2.3.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336111 13f79535-47bb-0310-9956-ffa450edef68"
77b3f8fbd70fdad3f7ed13cfbc0a74d087121aee,"Ville's eagle eye caught a mistake where we should not have changed compiler.XSLTC to cmdline.Compile


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336112 13f79535-47bb-0310-9956-ffa450edef68"
cfd36487f79205556d5e0fdd31238d80710a8f06,"corrected the Main class: changing compiler.XSLTC to cmdline.Compile and adding the Transform class. XSLTC has two main classes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336113 13f79535-47bb-0310-9956-ffa450edef68"
610c4d55214618241a275d09a280524efaa057c0,"added a service provide source file to be copied into
xsltc.jar (bundled jar)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336114 13f79535-47bb-0310-9956-ffa450edef68"
efcc41ff65e6b6731de7bba68e4985d8075ecc62,"added steps to xsltc.bundledjar to make META-INF and
services directory with a service provider for xsltc


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336115 13f79535-47bb-0310-9956-ffa450edef68"
f9ad418075242dd736bf89c6eb99dd59e9080bb0,"remvoed Main-class line since we have two main classes (Compile, Transform)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336116 13f79535-47bb-0310-9956-ffa450edef68"
8a658220251d178ca75812767899f6b0e0d2b0c9,"added name sections for support jar software


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336117 13f79535-47bb-0310-9956-ffa450edef68"
534c8fc395388c6ed3f1ca2340866673742b72e2,"fixed typo


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336118 13f79535-47bb-0310-9956-ffa450edef68"
3f2b696971486a59523ebac90607e95c26979c6b,"use manifest.xsltc when making xsltc.bundledjar target


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336119 13f79535-47bb-0310-9956-ffa450edef68"
5b18934d372def0e04a97d94f2c3446656565b61,"removed classpath line


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336120 13f79535-47bb-0310-9956-ffa450edef68"
d2fd7265b5d9ec9dea3c40c2273f049f58f77c53,"Added xml-apis.jar to required classpath for running samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336121 13f79535-47bb-0310-9956-ffa450edef68"
8a890b645eaf6f0310d4164d51d49a1f855306ca,"Update various .jar sizes for recent builds and 2.3.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336122 13f79535-47bb-0310-9956-ffa450edef68"
1217cd4a0afe65e2738f3417ffeeca3d3caaf16f,"link and editorial fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336125 13f79535-47bb-0310-9956-ffa450edef68"
b8a99f370f822e01d803663c4f1767ded52968e1,"Corrected reference number from current to 2.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336126 13f79535-47bb-0310-9956-ffa450edef68"
1b3fb057decd39787fdcb1d59889c55d721b1247,"Removed ref to to-do list.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336127 13f79535-47bb-0310-9956-ffa450edef68"
f0173752d5fd8a85571d1f7ca62f4811972dd50c,"added jakarta regexp.jar to xsltc dependencys


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336128 13f79535-47bb-0310-9956-ffa450edef68"
e7a826f8b7fda919de03f89194d44e768b24d7fd,"fix typo on xsltc_performance id, removed the .xml from it


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336129 13f79535-47bb-0310-9956-ffa450edef68"
958125a5a168f92f2efd382fcebb76b5db65de67,"v 2.3.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336130 13f79535-47bb-0310-9956-ffa450edef68"
6ecdae52e001a92e2c83683ce1b8ea59783c7af6,"v 2.3.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336131 13f79535-47bb-0310-9956-ffa450edef68"
3044d3d07636fe2c56b4b727dd7856f75f6cd6ab,"reclassified an xsltc commit


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336132 13f79535-47bb-0310-9956-ffa450edef68"
d9c49ce3dc3b55273ef97d49f18aa8e02aa12f7a,"edited explanation of change for 3.2.1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336133 13f79535-47bb-0310-9956-ffa450edef68"
183ea642a6903a466d35f6984453bb1024c92fe0,"removed the META-INF/services service provider
implementation from bunlded xsltc.jar for jaxp


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336135 13f79535-47bb-0310-9956-ffa450edef68"
e548328be9f5dfaa65be1e07afb2b1981fde7a45,"bug fix 6417, removed extra root element in DOM,
contributed by Tim Elcott


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336136 13f79535-47bb-0310-9956-ffa450edef68"
3cba598a4fe80c953ba0fa62c299a97dfb42451e,"Make synchronized to address potential reentrancy issue in
XRTreeFrag.finalize(), as discussed in the Javadoc. This may
solve several outstanding bug reports regarding reuse of
Transformers and cache suppression in for-each.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336139 13f79535-47bb-0310-9956-ffa450edef68"
481c52cb9c5cd414e5bc4b56b1fbb8938d638b06,"Well, _that_ was dumb... Forgot one ""don't dereference if null"" test.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336140 13f79535-47bb-0310-9956-ffa450edef68"
3b0effdde5f3db068884c4450fdb86a88ea16428,"renamed former xsltc.bundledjar target to xsltc.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336141 13f79535-47bb-0310-9956-ffa450edef68"
bd0054448d81bc10ca08a4d7bedbd9b112568eae,"bug fix 6636, Transformers forgets output properties
fix contributed by Tim Elcott (bigfoot.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336144 13f79535-47bb-0310-9956-ffa450edef68"
2047bba0709febd5bd7c9d13bdc5bab45b6450b0,"updated classpath discussion refer to bundled vs.
unbundled xsltc.jar use and relation to what users must set on classpath.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336145 13f79535-47bb-0310-9956-ffa450edef68"
453221e6454d936bceeb33d46e14219ba4ef58fd,"bug 6699- edits contributed by Ville Skytta- thanks.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336146 13f79535-47bb-0310-9956-ffa450edef68"
ae715efc47dac999b744dd3f7a36cfc2c1ee928d,"Just comment


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336147 13f79535-47bb-0310-9956-ffa450edef68"
309814d916d7fc595cdf5b1ca39555ee82a76440,"We weren't handling the case where no default-value handling was specified.
This didn't generally bother us because XSLT never produces an element
declaration as output... but it did affect TransformerIdentityImpl when the
source document had an internal subset.

See xalan-j-users archives, under subject
""Differences between explicit and implicit parsing for docs with  DTDs?""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336148 13f79535-47bb-0310-9956-ffa450edef68"
8162c1f8bdbb2efbc5e13bea4d07319d4f60e059,"bug 6751, null properties are now set properly,
fix contributed by Derek Sayeau- thanks Derek.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336149 13f79535-47bb-0310-9956-ffa450edef68"
1665bda6e0d4d04b0ff4e3e7fcc3bf0b43f7ddf1,"Tomcat 4.x external Java class bug fix, Tomcat 4.x
could not find external java classes, contrib by Santiago Pericas


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336150 13f79535-47bb-0310-9956-ffa450edef68"
73761278ac3af0c7a60aafc3fb00ed8fe0ab045a,"bug 6693- fix by Santiago Pericas, implement a
iterator clone method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336155 13f79535-47bb-0310-9956-ffa450edef68"
03a20ef89f957003109b27c92a9a5abb77b0dbb2,"Variable64-66 and a number of variable-related Bugzilla reports: Global
variables may have their resolution deferred. This was causing their
content to be placed on the normal variable stack, where it could be
popped off (arggh) and later overwritten (double arggh). This change
gives them an independent storage space which is not subject to
those risks.

While I was at it, I've also made the VariableStack class a trifle more
self-documenting by giving some of the fields more meaningful names.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336156 13f79535-47bb-0310-9956-ffa450edef68"
6160d9504a8e83653f32899bcaca20fccbb1ffab,"Bugzilla 6854: Return the stack exception, as documented.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336157 13f79535-47bb-0310-9956-ffa450edef68"
841721776d49447bc9091250576e9eaf79b985fa,"bug 6620 fix: DOMSource no longer requires
Document nodes, fix contrib by Santiago Pericas-Geersten


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336158 13f79535-47bb-0310-9956-ffa450edef68"
ee27963f170f5e85f3fc8a069f7485d7ef064a95,"re-entered bug fix 6751, last putback inadvert.
removed this fix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336159 13f79535-47bb-0310-9956-ffa450edef68"
c6cae3783c268bf93a8b355d56b5925b8899b8f0,"bug fixes for 6257,6851,6665,6809; Santiago Pericas-Geerston


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336160 13f79535-47bb-0310-9956-ffa450edef68"
d8bda1ccc74b7fbd49b2f2d7f5a87fe76b17f4ca,"bug fix 6850, Santiago Pericas-Geerston


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336161 13f79535-47bb-0310-9956-ffa450edef68"
dd0a6ddfea825401bcffb7dd8864837a082ae550,"bug 6312, TemplatesHandler and XMLReader, fix
by Santiago Pericas


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336162 13f79535-47bb-0310-9956-ffa450edef68"
e596657100d268c9838a3e211b8d5cb58d93b3f2,"just minor change to syntax


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336163 13f79535-47bb-0310-9956-ffa450edef68"
593cc600b24c04e8caf674929dda3e214d509fcb,"fix 5573 for XSLTMark alphabetize test


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336164 13f79535-47bb-0310-9956-ffa450edef68"
544dd5204377c6dbb9351e861270a95dbba69c9e,"fix bug 5577 XSLTMark trend test


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336165 13f79535-47bb-0310-9956-ffa450edef68"
e769195afd9b3936c3621b7f2f19d42cb57232e1,"got rid of call to forceNaturalOrder code, Santiago Pericasgeersten


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336166 13f79535-47bb-0310-9956-ffa450edef68"
cd5614518bc3cfdcd0db5fceb0633704113b2697,"fix XSLTMark test dbonerow slow performance, Santiago P.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336167 13f79535-47bb-0310-9956-ffa450edef68"
e09002123063618b22ede152a2a0c0341c4b6d18,"Bugzilla 6156 reopened: Same symptom, different disease -- rather than
a late finalizer, we simply forgot to reset one field between invocations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336168 13f79535-47bb-0310-9956-ffa450edef68"
2e30d6b37c647bbabc869f484e8109e3ee1443ea,"bug 6692, fix by Santiago Pericas-Geersen


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336169 13f79535-47bb-0310-9956-ffa450edef68"
2928b74b56fe01add8f70bfbc59a5b2d0ccc0171,"bug 5141, fix by Santiago Pericas-Geersen


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336170 13f79535-47bb-0310-9956-ffa450edef68"
12403cf863bd841e3ccf609c0c73148f847e7abc,"bug 6413, fix by Santiago Pericas-Geersen


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336171 13f79535-47bb-0310-9956-ffa450edef68"
a08196f4651f6cf0cb9ca023a213baa6b83cce6a,"bug 6963, omit header needs to be set before output
occurs, fix by Santiago Pericas-Geersen


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336172 13f79535-47bb-0310-9956-ffa450edef68"
07d1be93b69562411ca2c7361a65b54afae0198c,"bug 5576, had to add a new test case in translate()
to set includeself for step iterator, thanks to Santiago Pericas-Geersen


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336173 13f79535-47bb-0310-9956-ffa450edef68"
107b407be114e75a0786768673af11e9e14c91d4,"bug 6819, variables translated before attrs to fix
problems with dependency, fix by Santiago Pericas-Geertsen


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336174 13f79535-47bb-0310-9956-ffa450edef68"
ad8117b6d6d9e2a0dd00a09293d5bbd0ff980d2c,"bug 6935, fixed char escaping in non-URL HTML
attribute case; also added recognition for URL escaping in HTML4 cite attrs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336175 13f79535-47bb-0310-9956-ffa450edef68"
e36d02f5a4358d3175359b9a8710927b1c5c806f,"fix for unit test customer/murphy3.xsl


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336176 13f79535-47bb-0310-9956-ffa450edef68"
e429e12d050d8d058176b7fbbbe8c2532008310c,"Replace old version, which was specific to particular implentations of
DTM, with one which is specific only to DTMManagerDefault and which
can be generalized more easily to conduct other tests.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336177 13f79535-47bb-0310-9956-ffa450edef68"
a66c1284cb40066cfd3c0ddf76ee788052e6e444,"No longer in service.

This supported the old version of TestDTM. New version has
a node-dumper as an internal subroutine. (If we're going to do
a display method for  other debugging purposes, it should be
both applicable to all  DTMs and -- probably -- built into the
DTM system.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336178 13f79535-47bb-0310-9956-ffa450edef68"
6fa664a2d0b84c101f073ffba852f05bddce6771,"Add Apache header, remove import of discarded TestDTMNode.
At some point, we should consider moving this class to the tests
directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336179 13f79535-47bb-0310-9956-ffa450edef68"
7cd6ffe99737ade6225ebe31bea1c5f3cff27cb8,"Properly catch exception from CharInfo constructor, and try again.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336180 13f79535-47bb-0310-9956-ffa450edef68"
15fb863845a84dd4e2ea677c5ad24b0aa26d19e0,"Put extra check for getAbsoluteURI(String urlString, String base) for absolute
file paths with no protocol... I think one of the last check-in's wiped this out.
So now, if the path is the form of ""x:/x"" or ""/x"" then ""file:///"" is added to it.
I don't see how this can screw anything up... but I'm sure it will.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336181 13f79535-47bb-0310-9956-ffa450edef68"
a55f0f65486e4c072949b5a05626b0b42b7de6e5,"Merge from redundent expression elemination branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336182 13f79535-47bb-0310-9956-ffa450edef68"
a44bfb08b6536a049db65f0d29e5af15cf5a2d18,"Redundent Expression Elimination branch merge.

Major architectural changes
1) Rip out cacheing in all iterators, and move the caching into XNodeSet (actually NodeSequence where the caching is done derives from XObject and XNodeSet derives from NodeSequence).Lots of other changes went into this, including rewriting of some of the xsl:key stuff.

2) Implementation of a Visitor mechanism for the stylesheet and xpath components.Each component for an XPath event is passed an ExpressionOwner, which just has a getExpression and setExpression method, which allows us to create a list of these, and then be able to do rewrites.This should be a generally useful mechanism for all sorts of stuff, and should be considered a public API.

3) Implementation of deepEquality methods for all XPath components, which allows us to see if two components are equal.

4) Implementation of RedundentExprEliminator, which is a derivative from the new XSLTVisitor class, which runs over the stylesheet collecting xpaths within the same scope, and absolute xpaths that are not context dependent.These are then each reduced by walking the list and checking for deep equality (though global paths are always reduced).Reduction takes place by creating variables that have a special namespace and a non-legal local name.Both full and partial path reduction done.

Not done yet: Add back in the xsl:key caching that I ripped out (not a big deal).Could be skipped, with some risk.

Not done yet: Implement isLast function.With the new stuff, the last() function will be slower, so, since most cases are just checking to see if an item is the last, I want to rewrite foo[last()] patterns to foo[xalan:isLast()].Could be skipped, with some risk.

Davanum performance test result: 4x increase in performance.

Datapower performance suite results: very slight decrease in overall performance.:-(

Smoke test results: All clear when run with Xerces 1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336183 13f79535-47bb-0310-9956-ffa450edef68"
432ed51d3aeed2c28fe30a8b5c4d20f147d29f74,"The Node identity test in isNodeAfter()
(ie., node1 == node2) does not work in some cases,
so I added a routine to use DTMNodeProxy equals()
if that test fails.
This was required to support the new EXSLT
leading() and trailing() extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336184 13f79535-47bb-0310-9956-ffa450edef68"
22de44b8828cb9c7e25bef3f5bc932cd6af1bfe1,"1. Registered the EXSLT 'common', 'sets', and 'math'
namespaces ExtensionsTable.

2. To handle extension functions (e.g., some EXSLT
functions) that include a dash in their name, added
a routine in MethodResolver that maps abc_xyz to
abcXyz.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336185 13f79535-47bb-0310-9956-ffa450edef68"
cc93b73bfc1b17143aa74f10225ef0d02df7d331,"Preliminary set of EXSLT extension implementations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336186 13f79535-47bb-0310-9956-ffa450edef68"
765e050dc729c0acbf9b73bace2d7dc442311559,"Added Apache license.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336187 13f79535-47bb-0310-9956-ffa450edef68"
312d0337aef7bd7377dcfaf9b9f0f4bad34aa988,"Implemented TraceListenerEx2, which extends TraceListenerEx to add
the traceEnd event.

Modified all existing templates that call fireTraceEvent to also call
fireTraceEndEvent at the appropriate time.

Note that there was a bad incompatibility between xsl:for-each and
xsl:if, which was called whether the test was successful or not.
With the current logic of xsl:for-each,
if the node-set is empty trace will not be called at all.
So I've changed xsl:if to match the xsl:for-each behavior.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336188 13f79535-47bb-0310-9956-ffa450edef68"
10b908fd940289af28967df8db4e7cee9576ba3e,"Set the DEVELOPMENT number to 1, in prep for a developer's release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336189 13f79535-47bb-0310-9956-ffa450edef68"
c30e0f1d38217616df02a4c46f875d8308c04386,"Make sure the current element is nulled out if debug mode so that
TransformerImpl#getElementCallstack works correctly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336190 13f79535-47bb-0310-9956-ffa450edef68"
9dfe0755c547700538b840c086af2b375eadefa3,"Added fire trace events, which seemed to be missing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336191 13f79535-47bb-0310-9956-ffa450edef68"
7204a909eff30a57ef4f9761d09fe53201b0fb1e,"Added getElementCallstack() and getTemplateCallstack() methods, for support
of xsl debuggers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336192 13f79535-47bb-0310-9956-ffa450edef68"
4084f5668b41462c7c8d30de168426ba43e3383b,"Changed the release number to 4, since new functionality has been added.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336193 13f79535-47bb-0310-9956-ffa450edef68"
e6d4c9c33036398896f3374d1195ba0d297cda9a,"Changed the release number to 4, since new functionality has been added,
and specified a dev release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336194 13f79535-47bb-0310-9956-ffa450edef68"
1d82fed6cefa5ca412bdff65c2f75655aba9a788,"bug 2951, new class


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336195 13f79535-47bb-0310-9956-ffa450edef68"
003d0aba987ffde7cdedb8c7be2902bdc171e630,"bug 2951 fix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336196 13f79535-47bb-0310-9956-ffa450edef68"
27916dd2e043742826e67a62e35feb3ad7e0ff5e,"Fix Frank Weiss bug, which has to do with the currentFrameBottom not being
restored properly when inside a with-param.

Fix Cristina bug where the traceEnd event was being passed the wrong template.

Fix problem with RTF pruning where push/popRTFContext wasn't being called
for xsl:apply-templates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336197 13f79535-47bb-0310-9956-ffa450edef68"
8747053a573cafebd75197e06f256e374ff94820,"Fix JavaDoc comment.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336198 13f79535-47bb-0310-9956-ffa450edef68"
1129a4bcdc3970aaeca31ffee7dc4546cc6b372e,"Handle TraceListenerEx2, even though we don't do anything with the extra methods.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336199 13f79535-47bb-0310-9956-ffa450edef68"
777d11cd22928dceefdd3600f49d9f61a0d8e78b,"Fix problem with the SAXSourceLocator not getting the line number info.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336200 13f79535-47bb-0310-9956-ffa450edef68"
8ce6f4d0afcf274ef20936afdf9af4fd4795331f,"Add a constructor that takes a SourceLocator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336201 13f79535-47bb-0310-9956-ffa450edef68"
c13a36d940c3d068ecbd97f0f8cb87c624ad2b2c,"bug fix for output31, output32 tests, esc chars


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336202 13f79535-47bb-0310-9956-ffa450edef68"
f6b02b7ebff0e356cc8c3fd87f6fe0b88ce19858,"Added getOwnerXSLTemplate method, a convenience function.
Implemented getLocalName().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336203 13f79535-47bb-0310-9956-ffa450edef68"
9f6c1f3713800cc6c657f5fe2c4215a7d0c266bd,"Addressing http://nagoya.apache.org/bugzilla/show_bug.cgi?id=6752.
Make the processor more robust against multiple failures during compilation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336204 13f79535-47bb-0310-9956-ffa450edef68"
c9cb01e72c52c68285f84085443adaab2dd1534c,"Change derivation to XNodeSet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336205 13f79535-47bb-0310-9956-ffa450edef68"
0dc02cb565228285c1dbe6eb454f8fe593b4026c,"Pass in the parent ExpressionNode, so that more context information can be
set.  For the moment, I've added methods that are dependent on the
XSLT module, to set the source stylesheet node.  I'll deal with this more when
I deal with the proper breakup and packaging of the XPath package, in a
few days.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336206 13f79535-47bb-0310-9956-ffa450edef68"
89d37c6a23abd00f88aae9ac5013d12806141097,"Pass this as ExpressionNode to the XPathException object on error, which
helps us to establish context information for the exception object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336207 13f79535-47bb-0310-9956-ffa450edef68"
2023c1c1cabce8c915932854870251b4a5d05ef0,"Add constructor that lets us set the owning ExpressionNode.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336208 13f79535-47bb-0310-9956-ffa450edef68"
628ed030ab3c84e1ee316041f1d67ef97e3e1766,"For getCurrentElement, add some protection for access when there is no
current element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336209 13f79535-47bb-0310-9956-ffa450edef68"
4b8eb088eb31d067b4825e70b4bd2057fe252f20,"Pass the template to the XRTreeFrag constructor, so we can establish
better context.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336210 13f79535-47bb-0310-9956-ffa450edef68"
50c4d41dae7e99484fe890ba59914ed192a61ebb,"Set the ""StylesheetNode"" to the ElemTemplateElement instead of the
DOM backpointer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336211 13f79535-47bb-0310-9956-ffa450edef68"
ddbb116b3a67f82e811ca92d303beb50ad9fcf76,"Severlar problems fixed in relation to namespaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336212 13f79535-47bb-0310-9956-ffa450edef68"
34df847192f3e3df5227a521ed722aa58e529117,"bug 7679, xsl:vendor fix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336213 13f79535-47bb-0310-9956-ffa450edef68"
c8fb4280e3692f65a364244c387a30550621f573,"Wrap runtime exception in TransformerException, so we'll get line number info
when NPE and the like.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336214 13f79535-47bb-0310-9956-ffa450edef68"
867e108b4ff47dac768402ff5cc68ebac27f0ab2,"Fix for http://nagoya.apache.org/bugzilla/show_bug.cgi?id=7622.
1) Transform#1 creates an XRTreeFrag.  This has a reference to a DTM, that in turn is registered with a DTMManager.  The DTM will need to be deleted from the DTMManager when the XRTreeFrag is deleted.  The XRTreeFrag  also contains a reference to the XPathContext.
2) Transform#1 completes.  The XPathContext is reset... namely the a bunch of structures are reset or rebuilt, including DTMManagerDefault#m_dtms.  BUT, the XRTreeFrags are still hanging around, waiting to unregister themselves.
3) Transform#2 starts humming along.  It builds a XRTreeFrag and installs that RTF DTM into DTMManagerDefault#m_dtms[2].
4) The finalizer thread wakes and decides to delete some of those old XRTreeFrags from Transform#1.
5) The XRTreeFrag#finalize() method references through the XPathContext, and deletes what it thinks is it's DTM from  DTMManagerDefault#m_dtms[2] (via getDTMIdentity(dtm)).
6) Transform#2 tries to reference DTMManagerDefault#m_dtms[2], finds it is null, and chaos results.

...so, before calling xctxt.release, etc., check to make sure the DTM is actually
entered in the current DTMManager.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336215 13f79535-47bb-0310-9956-ffa450edef68"
db1faca79c9764ff6651cb7829b91e8dcee99dbf,"Fix for attribset24.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336216 13f79535-47bb-0310-9956-ffa450edef68"
dbe3314a9ed1d949d82f334e69cadd57b9b002e1,"Adding text nodes (even if they are just whitespace) as children of root
causes a DOM006 exception in the document builder. Hence, these text nodes
are now ignored.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336217 13f79535-47bb-0310-9956-ffa450edef68"
c11e905d9dbbfb1eba8636e8b34122de907b0af0,"Fixed problem with attribute URI


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336223 13f79535-47bb-0310-9956-ffa450edef68"
841bc98d5cc1e14c6dec8fe766f05bfe94a68300,"Add Document Object Model (DOM) Level 3 XPath Specification.
(Temp until it's added to xml-commons.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336224 13f79535-47bb-0310-9956-ffa450edef68"
f1fd9e3ca8493a7b4a8def3b8050ae7e2148094a,"Fix for bugzilla 7721


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336225 13f79535-47bb-0310-9956-ffa450edef68"
317aab617d21314bcbae62d2a0ca59dc59533183,"Fix related to bugzilla 7721


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336226 13f79535-47bb-0310-9956-ffa450edef68"
a2be8966c4c18eb43d34eab1b3e61ce0cf1b005e,"On entry, set the document base URI in the DTM.  Fixes bug reported
by Christine.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336227 13f79535-47bb-0310-9956-ffa450edef68"
8149839700efe348186093efbae1c1e81e09042c,"Add support for user-specified root node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336231 13f79535-47bb-0310-9956-ffa450edef68"
54d49361673d20ea04926525d6ca9a23f4d2aa14,"Fix inconsistancy in handling returned DTM IDs. (There's room for
debate about whether the current value -- expressed as the
NodeHandle for Node 0 in that DTM -- is the best possible
representation, but this is what we're currently using...)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336235 13f79535-47bb-0310-9956-ffa450edef68"
5c5a506c58cf12094522f0b14bb49236e84b2625,"Clean-up of dumpDTM method, some code clarity changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336236 13f79535-47bb-0310-9956-ffa450edef68"
396f9098c83e2fb2addada1bf35a448e6d4b4985,"Regression fixed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336237 13f79535-47bb-0310-9956-ffa450edef68"
b9e9c1449bdb815c6b01a80f3c257a5b72df1ca4,"Yeowch. Didn't mean to check in the XNI experiment.
Disabled, probably belongs on a branch. (And probably
needs to be rewritten fairly intensively, since the current
hook is something of a kluge!)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336238 13f79535-47bb-0310-9956-ffa450edef68"
f7a92536ee0aa3ad9df19f6e4e25083326e1d005,"(nitpicking)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336239 13f79535-47bb-0310-9956-ffa450edef68"
bf11aca3bc64c7d864a17bac572fcf29eb769a26,"Moved into Test directory


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336240 13f79535-47bb-0310-9956-ffa450edef68"
a631ac8daa60abb5c8c6942536d9ea9255b0a876,"Cleaner disabling of experimental code. Sorry 'bout that.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336241 13f79535-47bb-0310-9956-ffa450edef68"
ebb08b2ec583e4696161aa10749de465f94ca8b4,"Change extended types to be an integer and use a structure with a localname, a namespace and a nodetype to represent the node extended type. We no longer need to do the shifting left and right that we did for the previous extended types.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336242 13f79535-47bb-0310-9956-ffa450edef68"
968f7defdc83e9aecb08abfcf52590e9de2f8b29,"Creating a new branch, Xalan3, for experimentation with XPath2 support.

Currently the changes are limited to org.apache.xml.dtm -- enabling
datatype support by tying into Xerces' low-level XNI layer, which
includes experimental support for  post-schema-validation Infoset
(PSVI) information. Eventually we'll be patching other portions of
Xalan to actually retrieve and use this data.

The code I'm now checking in is NOT in final form. Known issues:

1) The logic in DTMManager which enables this behavior is
something of a kluge -- it only kicks in if you parse incrementally
from a StreamSource. The getDTM() method really wants to be
rationalized somewhat, which will make adding XNI easier.

2) The storage for datatype information currently adds another
column to the DTM table. We really want to switch to associating
the datatype with the Expanded Type table, and using some form
of sparse array to record local overrides.

3) The XNI code won't compile without Xerces2. We need to think
about whether we want to accept that as a dependency, or use
reflection to bind at run time rather than compile time.

Note that typed values are currently computed on demand, with the
DTM storing only the sting values. An argument could be made for
precomputing some or all of this information and instead generating
strings on demand (see the XPath2 Data Model spec for discussion
of that alternative). But that's a considerably larger change, and
would affect non-type-based users of XSLT as well since it would
present values in their normalized form rather than as entered; I'd
rather not go that route until we have a string-based alternative
fully functional.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336244 13f79535-47bb-0310-9956-ffa450edef68"
15dcd144769127edac07fc62dc08a73e1d4fcfde,"These should only be on the Xalan3 branch, not the main branch.
I _hope_ I can split this successfully...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336245 13f79535-47bb-0310-9956-ffa450edef68"
3f579ae61a5065c1e44a209ffd12d02568bd97a3,"bug 8017, translet class name fixed in getTemplates


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336249 13f79535-47bb-0310-9956-ffa450edef68"
ca0aeb02eabc9e829d70b0f852c32a1b31aca2bb,"bug 7835, integrated patch by Stefan Kost which
better handles empty strings and local paths in xsl:include


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336252 13f79535-47bb-0310-9956-ffa450edef68"
f7615820c5f832c6f730f696a05420075bd9bb6f,"Improve recovery if user's error handler insists on trying to
continue past a fatal error in the XPath syntax.  Ideally, this
mechanism should be cleaned up and applied across the
entire XPath grammar. But for now, I'm addressing the one
specific complaint in a way that can be expanded later, and
doing so in a way that minimizes costs.

(In fact, one can argue that since this is a rare event, we
shouldn't be minimizing the cost quite so much, and should
be throwing new exception objects rather than reusing a
preconstructed one.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336255 13f79535-47bb-0310-9956-ffa450edef68"
a59654dc5648ed8bcdba431206c16ac3ae11396e,"Decided I _was_ overoptimizing.

Saving memory in tne non-error case trumps saving it in the error case.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336256 13f79535-47bb-0310-9956-ffa450edef68"
83e8700bc206e8bf0aa4a16e03978ba13e3a7878,"Bug 4546 -- thanks to Wolfram Eisert for tracking this down and
proposing the patch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336273 13f79535-47bb-0310-9956-ffa450edef68"
868fc06885e61aa2a9872752b81bd3e0e1278363,"Commit after syncing trunk with branch jaxp-ri-1_2_0-fcs-04.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336279 13f79535-47bb-0310-9956-ffa450edef68"
412cf98ea7d26e94eda25d5b62d17bb47c3aadcb,"added xsltc compilation target, xsltc.fcompile, for
fast compile- this target does not recompile JLex, JCUP stuff


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336280 13f79535-47bb-0310-9956-ffa450edef68"
93329f59e79727ea5dc9581232762fa37a977d55,"removed other customization that I did not want
to putback, sorry about that


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336281 13f79535-47bb-0310-9956-ffa450edef68"
e219d4999d4ee3b90a5e7a986de551c73db5802a,"Added -n option to disable template inlining. This is useful to avoid
getting very long methods (the limit set by the JVM is 64K). The same
option can be passed to a TransformationFactory via Trax using
the ""disable-inlining"" attribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336282 13f79535-47bb-0310-9956-ffa450edef68"
bb20b344f6a3aeb08f717fa0bdadeeb30825d7be,"updated compiler usage statement


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336283 13f79535-47bb-0310-9956-ffa450edef68"
71a1629add1f5e2859a35004731b2f166dc46e6c,"added a -v option to compiler,prints out version


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336284 13f79535-47bb-0310-9956-ffa450edef68"
f62e193bf45fd59ffacec0dda8e36b4b143b3a9c,"updated cmdline.Transform usage statement


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336285 13f79535-47bb-0310-9956-ffa450edef68"
34413aa9517bb8b515d39a892b230c5b3eec44be,"Added support for the full Unicode char set.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336286 13f79535-47bb-0310-9956-ffa450edef68"
eaf8ef4eb5953c4d46406c60b9a75c73476726ab,"Replacing '/' by '$slash$' and ':' by '$colon$' in escape() (bugzilla 6289)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336287 13f79535-47bb-0310-9956-ffa450edef68"
34f6bf73ae2b2cc1de239635e055db177be94e9c,"Added check to avoid duplicate dependencies.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336288 13f79535-47bb-0310-9956-ffa450edef68"
285bebb3c0856f68f125f1c07e2f7d92548400d9,"Replaced STEP_ITERATOR by NODE_ITERATOR_BASE when calling includeSelf().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336289 13f79535-47bb-0310-9956-ffa450edef68"
81fdafb91b489d829e0409b7aeb0e68de32c5af7,"Ensured that global vars are initialized in the order in which they
were defined, whenever possible. This order may be altered due to
the existence of dependencies between the vars.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336290 13f79535-47bb-0310-9956-ffa450edef68"
f4880d4261b9bacfe3065ed9a8217a84c93ac373,"Added a type mapping between 'reference' and 'java.lang.Object' and
vice versa. With this addition, a stylesheet can pass a parameter
to an external Java function without getting a type check error.
(see Bugzilla 8595).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336293 13f79535-47bb-0310-9956-ffa450edef68"
af35a8eaa419992244e25288c94a936d8a4acb5a,"fixed null ptr exception with sax sources that did
not specify an xml reader


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336294 13f79535-47bb-0310-9956-ffa450edef68"
f53a76e050b38b2dcd351c1385dc3e5f491723e1,"Fixed Bugzilla 8489.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336295 13f79535-47bb-0310-9956-ffa450edef68"
148e5ce5c708bcd171a5911446b25fc2a6513c87,"Fixed a bug in replace() by writting a new (and more efficient) version.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336296 13f79535-47bb-0310-9956-ffa450edef68"
25790c5ce511b8792b819415883cc0712f9d9537,"Adjusted placement of information about XSLTC samples and related links.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336299 13f79535-47bb-0310-9956-ffa450edef68"
5a6b512e423e85a3aeecce0c8d861cd7163745e5,"Fixed file-not-found problem with flavor=trax.sax by propagating
the systemId.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336300 13f79535-47bb-0310-9956-ffa450edef68"
a8946a727c6102856363dcabeed239ea78acd49e,"Fixed for Bugzilla 2886 (node15).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336302 13f79535-47bb-0310-9956-ffa450edef68"
c133114ae2cc61bd00e78a1f728617d0983d0c49,"Disabling template inlining for included stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336303 13f79535-47bb-0310-9956-ffa450edef68"
083eaace62cd6fcce3d2397a96cc5cd1000e7fd1,"Fixed a few problems with ancestor patterns (//) and patterns with
explicit priorities.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336305 13f79535-47bb-0310-9956-ffa450edef68"
523a8c50190d4262e4db5672fe5fcfedf36d3189,"Rewrote a couple of if statements as if expressions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336306 13f79535-47bb-0310-9956-ffa450edef68"
0475524598f5d6b5c7d06a6c05ad903f2c692182,"Better error reporting for syntax errors in XPath expressions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336307 13f79535-47bb-0310-9956-ffa450edef68"
2e2862c75e4ec86f5595e59e9eb58319bcb2bf6c,"Fix for Bugzilla 8041.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336308 13f79535-47bb-0310-9956-ffa450edef68"
f1ee64d8d7bd0a393271fe9ae289c2f31a99cd40,"Remove the duplicated ;;

( which broke the JDK1.4 compilation which in turn broke all the gump
 deps ).


PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336309 13f79535-47bb-0310-9956-ffa450edef68"
eab0f9973d75b6702e7b57282bafb99994167f08,"Fix for Bugzilla 2836 (modes15).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336310 13f79535-47bb-0310-9956-ffa450edef68"
719b796b11647e5a017c3b3c7086cdc03f1785ba,"Bugzilla 7159 -- Just an access-permission change, for improved
toolability.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336311 13f79535-47bb-0310-9956-ffa450edef68"
d16e2f8b3665b4736617b053ff7c45de16e0a1d5,"fixes a set of trax.dom conf tests


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336312 13f79535-47bb-0310-9956-ffa450edef68"
34372f57373e7bc457cbcd9e53d4525812b0b688,"Bugzilla 8358 -- bad method signature. I've created a new method
with the correct signature. The old one may or may not be entirely
superfluous, but I don't want to muck with it right now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336313 13f79535-47bb-0310-9956-ffa450edef68"
092979aa8dd7a79650d1cc23dab456bbfddc6e81,"Updated Xalan version to 2.3.2 and Xerces to 2.0.1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336314 13f79535-47bb-0310-9956-ffa450edef68"
8d4dcd16c295f5d3e04c25c5e21a64387550222e,"Added classpath information pertaining to xercesImpl.jar and xml-apis.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336315 13f79535-47bb-0310-9956-ffa450edef68"
535f5997d064424390ea0321dff34b8c0ceed40f,"Added pointer to xml-apis.jar MANIFEST for version information.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336316 13f79535-47bb-0310-9956-ffa450edef68"
8795fbd5e061e82ac8cd51ff4e9dda0942d3601b,"Updates for next version (release notes to history)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336317 13f79535-47bb-0310-9956-ffa450edef68"
d122545286daf9ce8fa006bf6a3e82be04e3a6e7,"Pieriodic update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336318 13f79535-47bb-0310-9956-ffa450edef68"
cc0d24826372b54b209958802181127ee88a5760,"Added info on Xalan implementation of EXSLT common, math,
and set extensions, and ongoing work on the function and result
elements and datetime extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336319 13f79535-47bb-0310-9956-ffa450edef68"
274452ac04e639d4872e85c53885bab501006517,"Added support for EXSLT extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336320 13f79535-47bb-0310-9956-ffa450edef68"
4c2245823174dfbac257fcf257f8e9e4db1ae340,"Fix for Bugzilla entries
	6833
	7023
	7123
	7410

Basic summary of logic error: It is possible for multiple RTF DTMs
to be pushed onto the stack between the start of a template and
return from it. I hadn't anticipated that, so my pop logic was
inadequate.

I'm still not 110% sure I understand the case where this situation
arises... I have a general intuition that it makes sense, but also a
suspicion that there might be a way to avoid creating one of these
DTMs. We should review that someday.

Meanwhile, this fixes a whole batch of related bugs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336321 13f79535-47bb-0310-9956-ffa450edef68"
858ad86b40acf6e35482e9e49cf29dae1e05f521,"Performance improvement. Instead of looping through the ExtendedType objects, use a hashtable and go directly to the correct object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336323 13f79535-47bb-0310-9956-ffa450edef68"
617c41af54ce85b195e62d210e5572fc8f0dcd96,"Bugzilla 6356: Add support for ""windows-1251"" and use a properties file to store all the supported encodings. Patch from Sergey Ushakov.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336324 13f79535-47bb-0310-9956-ffa450edef68"
77cfe716611fef3d684e7a8f8ee1d6cf47123dde,"added new method 'setDocumentLocator()' to TemplatesHandlerImpl so that SAX parser can inform handler of doc location- thanks to Scott Boag and Shane Curcuru for the insight into this


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336325 13f79535-47bb-0310-9956-ffa450edef68"
f84d34b2aa33fd9756d1b1914291bd1589f121b3,"Assigned type to _type.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336326 13f79535-47bb-0310-9956-ffa450edef68"
94a2961f21b821e4d2d6b72efe2dce6a1bd4deae,"Fixed problem with default namespace in XPath expressions and XSLT's
named objects (e.g. templates, keys, variables, etc.).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336327 13f79535-47bb-0310-9956-ffa450edef68"
21c5072255a4883fb35ead93c0afa4bb68009f34,"Fixed StepPattern production to include named PIs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336328 13f79535-47bb-0310-9956-ffa450edef68"
1a79bf37b198559961c2260ff946d5fad318fb0c,"Add basic DOM nodetypes to our hashtable of extended type IDs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336329 13f79535-47bb-0310-9956-ffa450edef68"
9f4671b0331a651aaadfe50d66d0877a9a6f4a02,"Optimized calls to setEscaping().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336330 13f79535-47bb-0310-9956-ffa450edef68"
461a70a66b7873c1baf93bd07f6ca47741c3ed6b,"Simple code optimizations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336331 13f79535-47bb-0310-9956-ffa450edef68"
2ebb8ccdff8b6f06ef8ea44c4aee8f402e017b19,"Use PropertyResourceBundle instead of ListResourceBundle, and put error
messages into property files, for easier localization.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336332 13f79535-47bb-0310-9956-ffa450edef68"
7b06aca8d178ac4fd90d1687bc086841f8bec539,"In mightBeProximate, there was a bug that assumed a variable would not be
be a numeric result.  It is now fixed to assume a number may be a number, which
may cause a small performance penalty.  In the future, it should be possible to
chase this down a bit more to rule out more variables as non-numbers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336333 13f79535-47bb-0310-9956-ffa450edef68"
904ef0ef0c1107b47bc71fd204597443e930840b,"Bugzilla 7157. Updated Javadoc comment to note that the XPath.installFunction() method currently does not
use the name parameter.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336334 13f79535-47bb-0310-9956-ffa450edef68"
8cdf9ce0372c3036ef599e9c561e55b9736e2b5c,"Bugzilla6284: New function added to position() and last() that will help us determine whether we are executing a top-level expression and therefore, not inside a predicate


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336335 13f79535-47bb-0310-9956-ffa450edef68"
2fb9c76371c86a4de3a3c659f94df056377ebbb5,"Add a null constructor for resource files and fix XSLMessages to use the correct error resource file


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336336 13f79535-47bb-0310-9956-ffa450edef68"
dd9f235357e553a3051603805302a592af3eb03c,"Add meta file for DTMManager factory and make sure it is read as UTF-8


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336337 13f79535-47bb-0310-9956-ffa450edef68"
d851067a6c13f315adfc924128a30c5c2baf5d54,"Pick up all meta files


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336338 13f79535-47bb-0310-9956-ffa450edef68"
f8c018376b3360d953439c3916a0ad51d691410a,"Back out this change!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336339 13f79535-47bb-0310-9956-ffa450edef68"
fe12cf68762cc3ca24867a8cf1c211f6d61158d2,"m_last was not being set correctly. See comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336340 13f79535-47bb-0310-9956-ffa450edef68"
c05793f3d02b8d6d876e2b7d466fd14e7841e6e2,"Replaced Vector by ArrayList (synchronization is not needed here).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336341 13f79535-47bb-0310-9956-ffa450edef68"
e35d892fed8f09da4c98e0fcc01cb274364dc9c7,"Fixed looping problem reported by Girish.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336342 13f79535-47bb-0310-9956-ffa450edef68"
2486a8c6fac2bb8388d2af1edfca9c0251ebfba1,"Added characters(String) to TextOutputHandler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336343 13f79535-47bb-0310-9956-ffa450edef68"
5654cb74c9850511b5e3e396adc69721918bf6ae,"avoid printing standalone attr if it is set to 'no'


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336344 13f79535-47bb-0310-9956-ffa450edef68"
4cf0ffaba41335d0474231869b42a973f4bc166f,"Bugzilla 7118: Variable set via RTF may have
local variables within it; need to push a new
context.

(This anonymous-pseudotemplate thing has
caused us more confusion....)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336345 13f79535-47bb-0310-9956-ffa450edef68"
f65c36b7a3a69b8f33c9d6869fb630432901b9d6,"Fix for conf test axes113.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336346 13f79535-47bb-0310-9956-ffa450edef68"
ef1e78e6c06543e365b9a01abc0fb5a0680208d9,"Obvious typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336348 13f79535-47bb-0310-9956-ffa450edef68"
2037f73ef84a5c0a186a7e5ee29f660cd4a70192,"Missing safety net, mostly needed during stylesheet construction.

We really should change TransformerImpl to set parent _before_
starting to setPropertiesFromAttributes, so the error conditions
which might cause this test to be needed don't arise. Among other
things, that would produce more useful diagnostic messages.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336350 13f79535-47bb-0310-9956-ffa450edef68"
f739efb4d043a9194e83b50cf99850756d766f1d,"Bugzilla 8894: DescendantForRoot traversers needed to implement their own version of first(int, int) so that their context would be from the root.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336351 13f79535-47bb-0310-9956-ffa450edef68"
81ac8788b860f31858b87661769b1e1889bbb0c3,"fixed a regression in output66 test


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336352 13f79535-47bb-0310-9956-ffa450edef68"
d365e4cb5e5c4cbe83238187aa8794a9dce9417b,"Fix for attribset49.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336353 13f79535-47bb-0310-9956-ffa450edef68"
8b9e67b87b19bfe06ee6b88c3e0be5c4dbdef444,"Fix for axes127.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336354 13f79535-47bb-0310-9956-ffa450edef68"
e4ba54d276548a911b917da8ac8c40507bd2baed,"Fix for NullPointerException in SQL extension stuff. Just check for a NULL iterator...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336355 13f79535-47bb-0310-9956-ffa450edef68"
bec58b36c58b109d10a5abb1d652b53966ce789c,"Bugzilla 8324. This should have been checked into the main branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336356 13f79535-47bb-0310-9956-ffa450edef68"
420eb4031d219b59f54f05795409f1faa2c17af1,"Dumb of me -- fixed one edge case and created another, because
I forgot about subclassing Sigh. This version protects against both.

(And whitens your laundry, and keeps your car from rusting, and
kills crabgrass... It's a furnature wax! It's a dessert topping! ... Sorry.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336357 13f79535-47bb-0310-9956-ffa450edef68"
d347fd1aaa7a1eed2301fc816693375b67e422a1,"Do not add the standalone attribute to the XML header unless requested.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336358 13f79535-47bb-0310-9956-ffa450edef68"
999722d6d8d390d23c57abe8f32adabeefd79d14,"Fix for new tests Variable71 and Variable72.

When we went to the shared RTF DTMs, we forgot to update
PreceedingIterator to reflect the fact that the root of a DTM tree
may no longer have 0 as its internal Node Identifier. This change
corrects that situation, and does so without imposing a lot of
computational overhead since we need to scan the ancestors
anyway.

There appear to be similar hazards in some of the Traversers,
still to be dealt with. Coming up with testcases which will provoke
those bugs (and confirm that we've fixed them) is likely to be
harder than writing the fix itself...


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336359 13f79535-47bb-0310-9956-ffa450edef68"
f5f2671f88f60bb9b2b84385a9ec67d945d11d5f,"New output handlers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336360 13f79535-47bb-0310-9956-ffa450edef68"
9509e40bcab62977059ba7bffaf74b6958b6a256,"Fix bug in Attr iterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336361 13f79535-47bb-0310-9956-ffa450edef68"
37d3ed00dfa8213cce0750f41f539621cac3a7b2,"section on problems was way out of date. Also incorporated material from JAXP 1.2 release notes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336362 13f79535-47bb-0310-9956-ffa450edef68"
a21c65e03b3762f029761e6f3b158c06f095069a,"updated command option usuage. Some options have been added.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336363 13f79535-47bb-0310-9956-ffa450edef68"
96ad58a7820c90456a52402bd13d7828761c512e,"Updated first three sections.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336367 13f79535-47bb-0310-9956-ffa450edef68"
60270fba46bccc5464b190a905e44c36cd62a697,"Bugzilla 7118 REVERT -- This fix was provoking bug 9195, which
is more severe.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336368 13f79535-47bb-0310-9956-ffa450edef68"
63946199f8a7105b05653ccca9d6818906d0fe53,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336369 13f79535-47bb-0310-9956-ffa450edef68"
696efbdb3571a057848bcb35232184e927bcd2fe,"updated new code, on-going development


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336370 13f79535-47bb-0310-9956-ffa450edef68"
8fb50d10a646945810356480d22cf7528cd39965,"added new methods, on-going


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336371 13f79535-47bb-0310-9956-ffa450edef68"
4dfff89aca8cf639b28a52d166c1ba8e512cf0ea,"New methods added to the translet output handler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336372 13f79535-47bb-0310-9956-ffa450edef68"
2b9824c082190eb4b31f5ddbc469e2fa2795e431,"Renamed module.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336374 13f79535-47bb-0310-9956-ffa450edef68"
9e9db342088f26f2263905d1e6c8892c58d5a4e5,"Obvious mistake, apparently in a corner our regression tests missed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336375 13f79535-47bb-0310-9956-ffa450edef68"
b378df22ba2a027fe4e70447c8fbfd67849a3168,"Root node is not always 0 in an RTFDTM


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336376 13f79535-47bb-0310-9956-ffa450edef68"
65315252ecf5ecea44362302a255338efc20584d,"temporarily moved out of the way


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336377 13f79535-47bb-0310-9956-ffa450edef68"
9d720be147f0de8d8569dbe99f086e99bff38018,"updated namespace support


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336378 13f79535-47bb-0310-9956-ffa450edef68"
d4fe33ae81fd6da0253ee02df8a9ce7ab0e16213,"fixed uninitialized stack


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336379 13f79535-47bb-0310-9956-ffa450edef68"
e1d4e447482b85103950565d48ec1a989053b155,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336380 13f79535-47bb-0310-9956-ffa450edef68"
9eaac857364c0fd3d51436c83fe5d3a3228add8f,"Experimental output system.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336381 13f79535-47bb-0310-9956-ffa450edef68"
9575906bfa50416c2564aa22f524a3f62757bcfc,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336382 13f79535-47bb-0310-9956-ffa450edef68"
2747f91c4f37dc1e43876c9817d97e5462a1acb2,"Fixed hard coded string for timing diagnostics.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336383 13f79535-47bb-0310-9956-ffa450edef68"
5d571640fb6f2b6a7bd428a41e5870b4f91955c4,"Experimental output system.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336384 13f79535-47bb-0310-9956-ffa450edef68"
c499cf95d338509c1eee56b3afbbbd6f155b016b,"Added ""-n"" option to Transform.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336385 13f79535-47bb-0310-9956-ffa450edef68"
0a30f3993c71b9f2b4ced2418097be9df64fb32b,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336386 13f79535-47bb-0310-9956-ffa450edef68"
c3751cd7d3d39a058c707f2f8a7ea89daa0d9a58,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336387 13f79535-47bb-0310-9956-ffa450edef68"
6db38f92f0dc0a255756b578da46d5c2b8d9c2b7,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336388 13f79535-47bb-0310-9956-ffa450edef68"
314da25d402750d4441744c71ecf8f1dcf7abc63,"Insert XML header at the beginning.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336389 13f79535-47bb-0310-9956-ffa450edef68"
b932bc9956f58513a54c3407e7d3cc795a08989f,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336390 13f79535-47bb-0310-9956-ffa450edef68"
57682ed3a2e5e4bfd426a01541e5646b0fae592c,"added sax case support


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336391 13f79535-47bb-0310-9956-ffa450edef68"
46086778194e3f28055994aa223d7e0fb0256cbd,"updated


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336392 13f79535-47bb-0310-9956-ffa450edef68"
3dd5280adbda1c50a1eaea329407e82a492fac7d,"Added 'experimental-output' attribute to transformer factory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336393 13f79535-47bb-0310-9956-ffa450edef68"
4610752e82a05ddb2d9cb138f33c9490cc6eb69d,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336394 13f79535-47bb-0310-9956-ffa450edef68"
a87857ad9f4edc358a279d9058a5fb52e01a5d41,"added processing instruction support


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336395 13f79535-47bb-0310-9956-ffa450edef68"
efa3e6e94b916a7bf7cc9d12b04c1889c4e6e6d4,"Bug fixes after testing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336396 13f79535-47bb-0310-9956-ffa450edef68"
823e9b39fcbc2c949f42eb167fc95f0b8a4972ca,"Added DOCTYPE.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336397 13f79535-47bb-0310-9956-ffa450edef68"
c182aaab554bb87686974c81c803a41313917745,"Fixed problem with 'xmlns' reported as attribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336398 13f79535-47bb-0310-9956-ffa450edef68"
dc9eb266fb5954b1baf460e51c38edff4d4c42de,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336399 13f79535-47bb-0310-9956-ffa450edef68"
a936ca33a35e2471cef6a02e84ecac1594f7e988,"Prevent an external DTD from being inlined when using the built-in
identity transform.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336400 13f79535-47bb-0310-9956-ffa450edef68"
ee679b88ee2a536a2ff0d75055bee0b7de9d4489,"Fixed problem with offset in characters().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336401 13f79535-47bb-0310-9956-ffa450edef68"
7b568df104778a710dcf18f6d356c2337da2d6c9,"Starting branch for Xalan3


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336402 13f79535-47bb-0310-9956-ffa450edef68"
d2dc94eebbc8646b2b428cdc809bdee7752d4dc9,"Just comment


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336404 13f79535-47bb-0310-9956-ffa450edef68"
85ae9c1cd83f28277971b5a8b0394d3a51754702,"Put back main-branch version. Not sure how it got overlaid with the
XALAN3-branch copy.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336414 13f79535-47bb-0310-9956-ffa450edef68"
7c92c98bf2a0ac6a0973ffbe92c20f22db36ac3a,"Moved common methods to base classes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336415 13f79535-47bb-0310-9956-ffa450edef68"
f8f6950d853946829792eb689d8f4ca525cd7f6c,"updating work in progress


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336416 13f79535-47bb-0310-9956-ffa450edef68"
5bc2f17c530a3d881436b7c41dcd847f93e6bdc9,"Updated.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336417 13f79535-47bb-0310-9956-ffa450edef68"
3d993da92429bf0ff235bbd5efc35304386bf229,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336418 13f79535-47bb-0310-9956-ffa450edef68"
9f5d55a001de00dd12d79acb988020beb621566f,"Updated.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336419 13f79535-47bb-0310-9956-ffa450edef68"
69a845bc696d53ed2afb1dcec65c3673beac269a,"XSLT 2.0: stylesheet function, result-document, and
principal-result-document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336420 13f79535-47bb-0310-9956-ffa450edef68"
a3d62017449ba521dd9db41b76e6db8013a3b855,"Xalan3 branch: Check in temporary version of Xerces. This predates
the most recent changes to Xerces, and supports the older ""light
weight"" PSVI APIs. Current Xerces has replaced those with a heavier
version, but in the process lost the derivedFrom() method which
we need; when they restore that functionality, we'll cut over.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336421 13f79535-47bb-0310-9956-ffa450edef68"
b0c893765d33a1c6aafcaeeb3012f0e9ab28c8a1,"Mistake! These files belong on the Xalan3 branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336422 13f79535-47bb-0310-9956-ffa450edef68"
67b195f2a3a8216a0db741e9ca150542ee72128d,"Mistake! This file belongs on the Xalan3 branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336424 13f79535-47bb-0310-9956-ffa450edef68"
b5ae7f28ec2079614308680de6424fe233f827dc,"Fixed problems with id/key.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336431 13f79535-47bb-0310-9956-ffa450edef68"
0c9069b00d488d1be43f0041526d93620bd16d86,"Updated.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336432 13f79535-47bb-0310-9956-ffa450edef68"
a09612a5a092192ed40bd8a9865aba8198eb3d75,"Updated.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336433 13f79535-47bb-0310-9956-ffa450edef68"
7c27b20b9e1bc4f182c93fe3a070d0065ad2a428,"reset output flag


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336434 13f79535-47bb-0310-9956-ffa450edef68"
df7b34cf11eea0c1843d21ea0dc98026b014b048,"Restored pre-Xalan3 source file!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336435 13f79535-47bb-0310-9956-ffa450edef68"
023097446b07a4342cf79aab691231d5655de805,"Core EXSLT dates-and-times functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336438 13f79535-47bb-0310-9956-ffa450edef68"
504fce8bd3a8854ed5dd4c2cc61d04543b886f3e,"updated xsl:vendor string


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336439 13f79535-47bb-0310-9956-ffa450edef68"
a71799e1f14642b688e13d94a9bb884d639baff6,"updated xsl:vendor string


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336440 13f79535-47bb-0310-9956-ffa450edef68"
ed36c0cd30be7d736a3ca5de41db254ce8331778,"bug fix 9179, leading zero in localized formatting


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336441 13f79535-47bb-0310-9956-ffa450edef68"
cf2a18f50c7ab783f3212f29cc3341211537065e,"Restored correct version for Xalan 2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336442 13f79535-47bb-0310-9956-ffa450edef68"
3d643c6d473aad1909b4dcf30099846478b44c7a,"Include attributes in xsl:message template body.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336443 13f79535-47bb-0310-9956-ffa450edef68"
30165948ab5bd0ba1dc3333190b5aaa2b20c1511,"Fix bug 7118.  In XUnresolvedVariable, treat the RTF variable much more like
a template that has to count it's variables at compose-time, and link and unlink
when the lazy variable is resolved.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336444 13f79535-47bb-0310-9956-ffa450edef68"
e8552839342245d3894e4bfff5e94ead004013f4,"Integrated some removal of hard-coded error messages.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336445 13f79535-47bb-0310-9956-ffa450edef68"
bbf7e883a999a5fd5a66c8c5ed29dd6046e24c5a,"Set a new buffer size.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336446 13f79535-47bb-0310-9956-ffa450edef68"
62e0d15b472d5f15c439bc0f6600f5879b4df58f,"Fixed memory leak in AbstractTranslet and moved replace() method
to BasisLibrary.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336447 13f79535-47bb-0310-9956-ffa450edef68"
4b68e624cd64a4991ef368332aab9c90b97bb508,"Add resets for m_contextNodeLists, etc.  It might be possible that these are
redundent with the same thing being done somewhere else, but given
http://nagoya.apache.org/bugzilla/show_bug.cgi?id=6021 I suspect
that this really does need to be done here.  It would explain any problems
that might have been reported after an exception has been thrown, and
the Transformer is being reused.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336448 13f79535-47bb-0310-9956-ffa450edef68"
a577d6037ba190df93fe9a41606b7ca5034ce899,"Add back a certain amount of StackGuard functionality.  Instead of checking
counts where both the node and the xsl:template are the same... (we would
really need also to check that parameters are the same), just check for recursion
of templates.  We can make it fancier over time to also check for same params,
but checking of the current node may be harder.  I was only able to set the
recursion limit to about 475 before I would get stack overflow errors anyway.
I also did some stuff where the error messages should be more consistent by
making sure some of the arrays are reset in XPathContex, which may address
some of the inconsistency problems that Christina reported.
may address part of the problem that Christina was having.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336449 13f79535-47bb-0310-9956-ffa450edef68"
fbd72d221747253e55ef198abb7097b32de60971,"Moved hard coded strings for StackGuard error message to properties file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336450 13f79535-47bb-0310-9956-ffa450edef68"
875d1855ad25af915e09fd833f32cb0dd7ec6ceb,"Fix bug for optionV.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336451 13f79535-47bb-0310-9956-ffa450edef68"
229bb62e95ae78888b2b0960a4b0845850163506,"New class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336452 13f79535-47bb-0310-9956-ffa450edef68"
b5fe89eb4f17d8016e834bfb3ab1c18fb9010855,"fixed processing instruction call


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336453 13f79535-47bb-0310-9956-ffa450edef68"
fb820627cd48d2050ffe8342a9d9673122da5e64,"Updates to Xalan extensions: (1) EXLST function and (2) architectural modifications.
This is a merge of the ExtensionEnhancements branch into Main.

1. EXSLT function
We are well underway in our progress towards providing support for EXSLT extension functionss and elements. The EXSLT function and result elements (see http://www.exslt.org/func/func.html) require some fairly substantial additions.
XSLTSchema includes new XSLTElementDefs for a top-level exslt:function element, which, along with other items, may contain an exslt:result element. These definitions specify a new element class and processor for both of these elements, and a new extension handler. I have tested the implementation with the 6 test cases that EXSLT provides (including recursive calls), and it passes these tests.
Note: These additions/updates also provide the infrastructure for the XSLT 2.0 stylesheet function.
2. Architectural changes
During styesheet composition, Stylesheet Root assembles a vector of ExtensionNamespaceSupport objects. This object contains the information required during a transform to instantiate the required ExtensionHandler. If the stylesheet includes no extensions, this vector is null.  I.e.,  it does not include handlers for the default extension namespaces (of which there are currently 7, and which the Xalan currently loads for each transformation).
The presence of an extension is detected as follows:
Compilation of an expression that contains a FuncExtFunction. StylesheetHandler.createXPath()  uses an XPathVisitor to locate any FuncExtFunctions embedded in the expression.
Final composition of a component element  -- ElemExtensionDecl.compose().
Final composition of an extension component for which no component exsits -- ElemExtensionCall.compose().
Final composition of an exslt:function element -- ElemFunction.compose().
During StylesheetRoot.recompose(), any extension namespaces that are not predefined and for which no component or function element exists, are defined as java class (if a java class is found) or java package. In the current implementation, this last stab is made during the transformation, repeatedly if the element or function cannot be processed and is called more than once.
At the beginning of each transformation -- transformNode() --  if any extensions exist, TransformerImpl instantiates an ExtensionsTable with a hashtable containing an ExtensionHandler for each of the ExtensionNamespaceSupport objects defined during stylesheet assembly. XPathContext  no longer creates or has any direct knowledge of the ExtensionsTable. The ExtensionsTable does not contain handlers for predefined namespaces that are not being used.
TransformerImpl implements the org.apache.xpath.ExtensionsProvider interface. The relevant XPath functions (FuncExtFunction, FuncExtElememntAvailable, and FuncExtFunctionAvailable) call this interface, via XPathContext.getOwnerObject(). The implementation contains 3 methods that call through to the ExtensionsTable, which passes the call on to the appropriate ExtensionHandler..


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336454 13f79535-47bb-0310-9956-ffa450edef68"
6c42eb9cd981ede1fde6b7f4135e79f6f0ba7d8a,"Use ContextClassLoader - Use full Encoding file package name - Merge new patch from Sergey Ushakov


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336455 13f79535-47bb-0310-9956-ffa450edef68"
38e381e0ed40cb321cc898a055704382c3fcff23,"added text case for SAX


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336456 13f79535-47bb-0310-9956-ffa450edef68"
08c1848cf4da06ad8b2825917f0e42ba4a32e60d,"Patch submitted by Henry_Zongaro@us.ibm.com:

To summarize what I did, the Function class and its subclasses have two
methods that check the number of arguments:  setArg and
checkNumberArgs.  The former checks whether too many arguments are
specified, and the latter checks for too few (or too many, redundantly).

In the case where there are optional arguments (as in substring), the class
for the function (FuncSubstring, in this case) derives from a class that has a
fixed number of arguments (Func3Arguments, in this case).  If too few
arguments are specified, the FuncSubstring.checkNumberArgs method
reports that the function only allows 2 or 3 arguments; if too many arguments
are specified, the Function3Arguments.setArg method reports that the
function only allows 3 arguments.

To fix the problem, I added reportWrongNumberArgs() methods to the
Function class and to its subclasses, as appropriate, and I added code to
call that from checkNumberArgs and setArg - that way, the correct number
of arguments is always reported in the error messages.

Alternatively, I could have changed the setArg method in all the classes that
have optional arguments to report correctly the number of arguments, but I
didn't like the idea of having it redundantly perform the same check that the
setArg method of its base class was going to perform just to get a better
message out.  A third possibility would be to have setArg call the
checkNumberArgs method when it detects too many arguments are
specified; that would guarantee that setArg would report the same message,
and avoid introducing a new method, as long as checkNumberArgs always
checks for both too few and for too many arguments.  A fourth possibility
would be to report two different errors:  the minimum number of arguments
required in checkNumberArgs and the maximum permitted in setArg.

I also noticed that the message produced for FuncSubstring when too few
arguments are specified actually indicates that 0 or 1 arguments are required,
 so I fixed the XPATHErrorResources.properties file.

I don't see the NPE that Dave Marston mentions in Bugzilla, so I assume
that's been fixed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336457 13f79535-47bb-0310-9956-ffa450edef68"
aa4506726a7b8732a80b8b6ebb7bf4ebc4b04448,"Typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336458 13f79535-47bb-0310-9956-ffa450edef68"
1b536478641ceec7cb7f650b704426a37769b546,"Patch submitted by Ilene_Seelemann@us.ibm.com for Bug 6798:

Added a method (handlesNullPrefixes) to the PrefixResolver interface so
that the resolver can indicate whether it supports null prefixes.  Then, in the
tokenizer, if the prefix is null, and the resolver supports that, it continues
processing as if the prefix had a value.  In Lexer.java, methods that have
changed are: tokenize, mapNSTokens.

In ElemNumber#getCountMatchPattern, pass MyPrefixResolver instance to default
psuedo match patterns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336459 13f79535-47bb-0310-9956-ffa450edef68"
1f91f6a547835cb4f1ffc5f15c9b19740f8c1425,"Do not insert <META>.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336460 13f79535-47bb-0310-9956-ffa450edef68"
d84682a1bdc201412b15359c7363b960b7f42e91,"Fixed problem in the implementation of setOutputProperties().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336461 13f79535-47bb-0310-9956-ffa450edef68"
ce5f2a1b3fe49bf645f5b7058711b7a3312cfdf8,"Purged for upcoming developer releases.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336462 13f79535-47bb-0310-9956-ffa450edef68"
e7ccd8ef172723168d767960f3e66a4f33850e76,"Moved 2.3.2 core and xsltc updates into the history files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336463 13f79535-47bb-0310-9956-ffa450edef68"
b69d1b14b11bd415e1b1c82e2a5661d56fc60431,"xercesImpl.jar from Xerces-J-bin.2.0.1.zip (for upcoming Xalan-J 2.4.D1)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336464 13f79535-47bb-0310-9956-ffa450edef68"
a4e1be8d0688dec7dbf5305472d3ef1e364dc257,"Update xerces.jar to be xercesImpl.jar; this should have been
done quite a while ago.  Note the Class-Path: entry needs review
in general at some point.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336465 13f79535-47bb-0310-9956-ffa450edef68"
92af55338a8547ddaa9141f09d89934756ec7ad5,"Brief documentation about developer standards and official build processes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336466 13f79535-47bb-0310-9956-ffa450edef68"
f5add9fd5d0b460128b64c063183483dd3be5886,"Add builds.xml; perhaps should also be added to xalan-jsite.xml as well


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336467 13f79535-47bb-0310-9956-ffa450edef68"
334caa0cbf334b2219c2c6df3c5b6c3f312d3575,"Added comment() support.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336468 13f79535-47bb-0310-9956-ffa450edef68"
afe90512714ff53450ac6e18a459fb160ab01f78,"added support for comment handling in DOM


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336469 13f79535-47bb-0310-9956-ffa450edef68"
fa3b9e66e891fe5bc9e0f974898a1bbcf4194bf1,"Fixed getTemplates() to return null when compilation fails.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336470 13f79535-47bb-0310-9956-ffa450edef68"
b4885fe4ac2e6973f29df784d74d94a060534076,"From Ilene Seelemann:
Added the following in blue to line 395 of Lexer.java

     if ((-1 != posOfNSSep) ||
         ((m_namespaceContext != null) && (m_namespaceContext.handlesNullPrefixes())))

I'm also including ElemNumber.java which really doesn't need to
explicitly state that it implements PrefixResolver.
Without these updates everything does run fine.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336471 13f79535-47bb-0310-9956-ffa450edef68"
5fe30b12860e72ef2402823fbb7203fb75b4740e,"Commented out a debug print line.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336472 13f79535-47bb-0310-9956-ffa450edef68"
a9e8429bfae542e6f18763b21b679d90707a1a0a,"No longer in use.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336473 13f79535-47bb-0310-9956-ffa450edef68"
5f3416bb8ab9b689a896215376bfd0a0101336e0,"New output system installed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336474 13f79535-47bb-0310-9956-ffa450edef68"
ee01b2d81b796f90b43f9f3fc0315c474cf47dbf,"bug fix for copy32.xsl unit test; cdata handling


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336475 13f79535-47bb-0310-9956-ffa450edef68"
fa4141ed420546d4144bfec65155d8eb20cf0cdd,"Fixed file creation for xsltc:output extension.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336476 13f79535-47bb-0310-9956-ffa450edef68"
f35449336fc25b6b48022e0c1c9bcbf5f44f4ab4,"Added default constructor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336477 13f79535-47bb-0310-9956-ffa450edef68"
50c8444cd604423d15844f32baa24ca04e015c23,"Fixed insertion of META when HEAD is empty.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336478 13f79535-47bb-0310-9956-ffa450edef68"
d6d9e22d6a56f308090cad64f77d84b906e369fa,"Replaced eager by lazy computation of last.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336479 13f79535-47bb-0310-9956-ffa450edef68"
0ca7fe8ed758ec97ff6fa0d7fafe109fccccc3b0,"Very minor optimization.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336480 13f79535-47bb-0310-9956-ffa450edef68"
8359ccf1077d98e237f7c4e520b83da74e76d6fc,"Simple hand optimizations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336481 13f79535-47bb-0310-9956-ffa450edef68"
fb674214ab0d1f0558d5e1f2347bb5ccb8e5f197,"updates for developer's release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336482 13f79535-47bb-0310-9956-ffa450edef68"
288db7eefd4f4507672ccb1f2c6ec956c92cb962,"Patches for developer's release from Sarah McNamara.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336483 13f79535-47bb-0310-9956-ffa450edef68"
4b06533f8b83632e5af94216f5f44f7d2b2db19b,"Updated version # for developer's release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336484 13f79535-47bb-0310-9956-ffa450edef68"
ea400697128a3a7663707d182673615e6ba3c1db,"Update .jar file sizes for 2.4.D1 release


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336485 13f79535-47bb-0310-9956-ffa450edef68"
06494ba52f6cdf458be3efaa0aa4422cfeb40df5,"Remove extraneous slash char on path
Submitted by: mcnamara@ca.ibm.com


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336486 13f79535-47bb-0310-9956-ffa450edef68"
ec9fc44c6b4eb0b49d1541dfe0172cffd36c2331,"Fix Bugzilla #9137; don't toLowerCase() the filename (not really needed anymore);
remove line for xalan.jar for 2_4_D1 because .jar build size is not determinate


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336487 13f79535-47bb-0310-9956-ffa450edef68"
db9ee685af2eabb72781908ce61a3dc934018f14,"Add pointers to info on new EXSLT extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336488 13f79535-47bb-0310-9956-ffa450edef68"
ee5f7629a90e982a1395486f1cb4e74a3269d07f,"Fixed layering of output properties in Trax.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336495 13f79535-47bb-0310-9956-ffa450edef68"
8b0dfd4ea4bac1ef5d2160d2cf2a5fb239587038,"Changed Vector.get(int) to Vector.elementAt(int) to maintain
compability with Java 1.1.8.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336496 13f79535-47bb-0310-9956-ffa450edef68"
acd81f7a31a198815a59813469cfe6ad55ea0f26,"Replaced getProperty() by get() in setOutputProperties().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336497 13f79535-47bb-0310-9956-ffa450edef68"
f7c0fb286ea790d4059948aa9beddbabb725c17d,"Modified leap-year functions to use arithmetic logic rather than relying
on a Calendar method that doesn't exist in Java 1.1.8.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336498 13f79535-47bb-0310-9956-ffa450edef68"
99dd81295de9815fb99092a9ecb22a3b4b5ff789,"catching file not found exception fixed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336499 13f79535-47bb-0310-9956-ffa450edef68"
ad0362941105be4e5d9bd2ff0c4e99db950212e5,"added ability to detect/flag superfluous attributes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336500 13f79535-47bb-0310-9956-ffa450edef68"
c5d0e150da09513d4e8befdff7f9f0f3803bb9aa,"removed commented out code


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336501 13f79535-47bb-0310-9956-ffa450edef68"
7441df2c450cc841d3326eb3be438321aaf8f134,"fixed bug that passes warnings to listener


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336502 13f79535-47bb-0310-9956-ffa450edef68"
4734e49c0c354d5310b02f7b62691656efb3ca32,"Added support for XHTML in output system (c.f. embed04).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336503 13f79535-47bb-0310-9956-ffa450edef68"
20b31646a181bf5da7b6dd88369b3b75863df8cf,"Added RTFIterator (extends OneStepIteratorForward);
created fromRTFFragment so EXSLT object-type function
can identify an RTF with certainty.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336504 13f79535-47bb-0310-9956-ffa450edef68"
67b32fb165bc844b54966ffed39a243220c7f769,"fixed bug with number formatting, richmark test


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336505 13f79535-47bb-0310-9956-ffa450edef68"
7fa6244b4bbfab816e0eeddc568ec951dde45937,"fixed escaping of quote in href attribute


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336506 13f79535-47bb-0310-9956-ffa450edef68"
2554df94b1722e265a25bc014cec347ad84796d2,"Fixed problem in creation of output handler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336507 13f79535-47bb-0310-9956-ffa450edef68"
79057bfc4d78d380b2116a2ebbf758174d949010,"Removed duplicate implementation of several EXSLT ""Set""
functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336508 13f79535-47bb-0310-9956-ffa450edef68"
2020cc97fda0ad3b72c9400c671509953f215c77,"Fixed problem with cdata-section-elements in xsl:output and namespaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336509 13f79535-47bb-0310-9956-ffa450edef68"
71e53c1d6a88e90f4114a7136cba5311a908dfa0,"fixed nit for Tom


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336510 13f79535-47bb-0310-9956-ffa450edef68"
b9f5ec74be866bd87512ccbcc0dbc237b881b8c1,"fixed unescaped quote in attribute, namespace110 unit test


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336511 13f79535-47bb-0310-9956-ffa450edef68"
d073f70f1290d59c4257f5f54a2175eb1085404d,"Ignore default properties in setOutputProperties().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336512 13f79535-47bb-0310-9956-ffa450edef68"
df50531db51a5fa9cad006233a9865aaa813a7bb,"Fix to set output properties correctly in the new output system.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336513 13f79535-47bb-0310-9956-ffa450edef68"
a04b84ab8949f9f8062d9eb337777e27c6981698,"Fixed indentation when output method is HTML.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336514 13f79535-47bb-0310-9956-ffa450edef68"
84cb3498b0c4aa57cac6d4eea819064b31682bc3,"Fixed indentation when output method is HTML.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336515 13f79535-47bb-0310-9956-ffa450edef68"
c55134f0c45a64aa5cffc1d5a961b650bbba6cd5,"Rollback to revision 1.39


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336516 13f79535-47bb-0310-9956-ffa450edef68"
648a0e8d140dfbb9a4f672af531e4420c3df071c,"whitespace13.xsl fix for trax.dom case


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336518 13f79535-47bb-0310-9956-ffa450edef68"
e47f02ea13840d59300f8bcabf8229732b4d6a79,"Fixed regression.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336519 13f79535-47bb-0310-9956-ffa450edef68"
07cae09924513f83194e15bb190a071b07545639,"_type renamed to _paramType to avoid shadowing of protected vars.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336520 13f79535-47bb-0310-9956-ffa450edef68"
f7685ef29a715c8a0a86929ee163e62e048e9fcb,"Replaced _type by getType().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336521 13f79535-47bb-0310-9956-ffa450edef68"
b550b08c5438f232c406be13f0ade5c31d012bf7,"adding Jtidy for use with test harness to parse html


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336522 13f79535-47bb-0310-9956-ffa450edef68"
4aa23b0bc1ce10ab3b39632f4f7008180eed49e4,"Fixed evaluation of ""parent::*"" with multiple DOMs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336523 13f79535-47bb-0310-9956-ffa450edef68"
fa2bc92cc6fd6d49976233b8acef71a03f59235d,"Simplistic static utility to convert a Hashtable of items (either
Hashtables or anything else cast to (String)) into an Element tree


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336524 13f79535-47bb-0310-9956-ffa450edef68"
c02f61cfbc79379989aa52fe80ef7030def30273,"Update checkEnvironment to attempt to call org.apache.env.Which first
by using reflection; Which provides better output data than
EnvironmentCheck.  If reflection doesn't work, then we
fallback to EnvironmentCheck as before.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336525 13f79535-47bb-0310-9956-ffa450edef68"
eb8757b4dfd9948665c549a2a1804ecb607db42c,"Add doc about calling checkEnvironment as a stylesheet extension


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336526 13f79535-47bb-0310-9956-ffa450edef68"
6ff63b43974e5c407fa30ce2d7038f0162e74d83,"Fix for Bugzilla 9068.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336527 13f79535-47bb-0310-9956-ffa450edef68"
01da35f56b2104f475152fb5b3892b87bd4ade4e,"bug fix for bugzilla 9572, fix by Pavani.Mukthipudi@sun.com


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336528 13f79535-47bb-0310-9956-ffa450edef68"
6498608284472b90d6897a98c96e33b5b071b032,"Better fix for Bugzilla 9068.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336529 13f79535-47bb-0310-9956-ffa450edef68"
a8d079dad5be1aa9500155682a7b89b38dd3c30c,"Fix for Bugzilla 8551.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336530 13f79535-47bb-0310-9956-ffa450edef68"
1bf09878115d0def1a35f85f48521d49a143781c,"Fix for Bugzillas 3238 and 10137.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336531 13f79535-47bb-0310-9956-ffa450edef68"
34486191c1ada28d8d947711e46774aeb32c72c4,"Fix for Bugzilla 6925.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336532 13f79535-47bb-0310-9956-ffa450edef68"
ef3818e95de33216590f388fc579fc83c0d6fb73,"fix check for extension functions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336533 13f79535-47bb-0310-9956-ffa450edef68"
966629f14c7be619ead3f6113373781eac5f8578,"Fix for function-available() needed to handle XSLTC's extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336534 13f79535-47bb-0310-9956-ffa450edef68"
82b02eddb786f407d76767d1b55c49d24f680063,"Fix for axes122.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336535 13f79535-47bb-0310-9956-ffa450edef68"
536cf809dd35db3e8e816817d74ea0a6947672e8,"Fixed regression.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336536 13f79535-47bb-0310-9956-ffa450edef68"
308afd675f13c4363da02cf234e3b17b712924a8,"Update docs.class.path to include XSLTC-dependent jars
Submitted by:	Henri Gomez hgomez@slib.fr


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336537 13f79535-47bb-0310-9956-ffa450edef68"
8ca76592db8d9e16ecee5cc76aca3b8738aa62a5,"Add error resources pulled out from code


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336538 13f79535-47bb-0310-9956-ffa450edef68"
6f3ed23ddb33fc2f94b92fbb8485526532ba7dfa,"Fixed bug in clone().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336541 13f79535-47bb-0310-9956-ffa450edef68"
cb563489c397c78fbc2e55c2a2fd405ad14e3b11,"Added support for function-available()/element-available() in logical
expressions (note that these functions are resolved at compile time
in XSLTC).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336542 13f79535-47bb-0310-9956-ffa450edef68"
58246a28873d849aafdccbeabc4b7cd803c809a6,"Added 'indent-number' attribute to the transformer factory. The value
of this attribute is the number of spaces that will be used by the
output system when indentation is turned on.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336543 13f79535-47bb-0310-9956-ffa450edef68"
9aa541db87c39077011b605729ee1b9c4931a61b,"Pull out hard coded messages


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336545 13f79535-47bb-0310-9956-ffa450edef68"
67fd2df633055a34ab46318e9b0cd581b7e6167c,"Fix for node21 and some position tests.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336546 13f79535-47bb-0310-9956-ffa450edef68"
fba915a090bded8ee04dde53525ed451ed560361,"Bugzilla 5016: Patch from Henry Zongaro... Fix XPATHParser.java to prevent matching empty RelativeLocationPath and Step expressions, prevent a LocationPath from preceding a Predicate in a FilterExpr, check for valid NameTest in NodeTest()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336547 13f79535-47bb-0310-9956-ffa450edef68"
8dbb608b135a39e1d612650fa7ed90357a80b444,"Fix problem in copyElement().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336548 13f79535-47bb-0310-9956-ffa450edef68"
d8be9a8105c8c6f5a9a638052abd1c72726ca599,"Use doubles instead of longs for big ints.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336549 13f79535-47bb-0310-9956-ffa450edef68"
7750779518c871115c55f34ad2887ea4899a8074,"removed unused class, compiler will now use doubles


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336550 13f79535-47bb-0310-9956-ffa450edef68"
7653ce8d33b2dff2bbabb4dfee36c9fd61f5f70d,"Fix typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336551 13f79535-47bb-0310-9956-ffa450edef68"
6fa4d6605e436917b83d7b8d1b161afc8027e73c,"removed references to the LongExpr classes that were removed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336552 13f79535-47bb-0310-9956-ffa450edef68"
f831f2c73da29679bd76a9bd84222de8095131a1,"Copy namespace nodes of an element in xsl:copy.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336553 13f79535-47bb-0310-9956-ffa450edef68"
b82e1acf38d12cd02481b02006aa01e41438b6e5,"Better error reporting when argument is not a literal.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336554 13f79535-47bb-0310-9956-ffa450edef68"
c68f737a0ed3b3a3115b85d781c13f89ee5fff38,"Use a BufferedOutputStream to write classes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336555 13f79535-47bb-0310-9956-ffa450edef68"
dfb64bc23ddc614472886483ae676c26e8bb7975,"fix typo in SmartTransormerFactoryImpl pointed out by Tobias McNulty


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336556 13f79535-47bb-0310-9956-ffa450edef68"
f7c6f6fc964db13c3b340327c2a3a4dab401f8f4,"Bug6268. Patch from Ilene Seelemann. Fix Grouping separator. If no grouping separator is specified but a gouping size is, number is not formatted. If grouping separator is """", warning is issued and number is not formatted. If grouping separator is more than one character, warning is issued and number is not formatted.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336557 13f79535-47bb-0310-9956-ffa450edef68"
86a87f4daa7cd40ebbe467797d79899767bc5709,"fixed conf tests copy21, copy22, expression02, idkey04, numbering91 with introduction of setSystemId on InputSource


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336558 13f79535-47bb-0310-9956-ffa450edef68"
9b836db04bdc239e2aed205c07926d2d840dc9e1,"resource error messages


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336560 13f79535-47bb-0310-9956-ffa450edef68"
775cb0c0a7bbad337e0dad17aa423d1470164590,"Updated XSLTC's version number from 1.0 to 1.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336561 13f79535-47bb-0310-9956-ffa450edef68"
f269d84d5a1ab95f0853159f2b944615205e7fba,"Fix for Bugzilla 4603 (thanks to Henri Zongaro)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336562 13f79535-47bb-0310-9956-ffa450edef68"
bdb2365d0405cd95cb8a9e385641e00676239401,"Print warning message for superfluous attributes that have a null URI only.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336563 13f79535-47bb-0310-9956-ffa450edef68"
33fb4ccf15ef62179475fabf8e7951d34d8a7e4d,"bug 5941 fixed, <clinit> access chged to ACC_STATIC from ACC_FINAL


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336564 13f79535-47bb-0310-9956-ffa450edef68"
24e9e48ff438546502d53b30fd9e53ba9f7d107f,"Bugzilla 5013: Validation of QName attribute values. The patch will also fix the missing validation described in bugs 792 and 793


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336567 13f79535-47bb-0310-9956-ffa450edef68"
ba795bd8dbd70232703c8fb6a41c7e8ebb91864d,"Bugzilla 5013: Validation of QName attribute values. The patch will also fix the missing validation described in bugs 792 and 793


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336568 13f79535-47bb-0310-9956-ffa450edef68"
e11af2a0bab5a5789c7cf41a21e3ea7f0f022522,"bugzilla 9575: Fix AncestorIterator counting root node twice. Patch from Henry Zongaro.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336569 13f79535-47bb-0310-9956-ffa450edef68"
e046f14be67108cf37b66c9d75192493ffc59692,"<Blush>

This was still trying to switch between setAttribute() and
setAttributeNS(). Correct usage of DOM Level 2 would be to
always use setAttributeNS(), and simply set a null URI when the
node is not namespaced. (Basically, the L1 versions of
createElement, createAttribute, setAttribute and setAttributeNode
should be considered deprecated with the sole exception of
manipulating a DOM intended to be viewed *only* as Level 1.)

I could swear we fixed this a VERY long time ago...
Good catch, thanks for calling it to our attention.

</Blush>


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336570 13f79535-47bb-0310-9956-ffa450edef68"
15630776a3159776da20f47b288c5c1eb55bdd5f,"Enhanced error reporting in calls to external Java functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336571 13f79535-47bb-0310-9956-ffa450edef68"
9ee8ccef7a83300691651fd07d41c2bb39d802a9,"bug 10832 fix, relational expressions with RTFs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336572 13f79535-47bb-0310-9956-ffa450edef68"
44e30452db6dad6cb68d165edcd789692589832e,"Fix for Bugzilla 9174.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336573 13f79535-47bb-0310-9956-ffa450edef68"
2ab222f30679ece2f25424cc03e58e41937ff99d,"Fixed error message in defineTransletClasses() method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336574 13f79535-47bb-0310-9956-ffa450edef68"
81fb1cb5e3bcf91f9d86367146bdf045a93216fc,"Fix for Bugzilla 9171.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336575 13f79535-47bb-0310-9956-ffa450edef68"
2e2f58c947c70c817d3c64f76d737045c255cb15,"testing commit


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336576 13f79535-47bb-0310-9956-ffa450edef68"
ab023f6808d347fa245221eaf1e7b81f8542da91,"Fixed problem in error reporting code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336577 13f79535-47bb-0310-9956-ffa450edef68"
55a680aae3407d9924c7975a391be80546434bb6,"Ignore default NS when expanding calls to position().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336578 13f79535-47bb-0310-9956-ffa450edef68"
45adb4470d8dd45d4751f11a9ecccada0576c3f6,"Morris Kwan's patch for bugzilla#10306

The problem is that the namespace declaration is not added to the attributes if there are other leading attributes. There is a check for whether the namespace
 has already been added. That check is commented out because multiple namespace declarations can exist in one element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336579 13f79535-47bb-0310-9956-ffa450edef68"
0675494a9be7e8f18fe177e105693a1d92ce13df,"Accept null as a possible return value from URIResolver.resolve()


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336580 13f79535-47bb-0310-9956-ffa450edef68"
440cc394c0d9bb98122f026ed9417302f9e134db,"Report a decent error when the URI cannot be resolved.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336581 13f79535-47bb-0310-9956-ffa450edef68"
764cc65c32e9a200ee3ab35d62c1836cbe36148b,"Added a few getters to this class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336582 13f79535-47bb-0310-9956-ffa450edef68"
f02ce79459d14521d7eb27313f497008bf14c0c4,"Use the superclass to determine the main class of a translet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336583 13f79535-47bb-0310-9956-ffa450edef68"
b7ae7a27d6f17d76fcf1e2e3bf3c2e4330045a14,"Applied patch from Morris Kwan for bugzilla #9753.

The bug addresses the problem that there is a build error with Xalan under JDK 1.4, because one of the classes uses assert() as method name.
 And assert is a keyword in JDK 1.4. The patch just changes the word ""assert"" to ""assertion"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336584 13f79535-47bb-0310-9956-ffa450edef68"
4dc6a25019349bdcf5d6405ef7aa5b4ad936177a,"Fix for Bugzilla 10715.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336585 13f79535-47bb-0310-9956-ffa450edef68"
b53c83e4b247754d0b469fd09e29aff77b788284,"Fixed a regression.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336586 13f79535-47bb-0310-9956-ffa450edef68"
9fa52c94bb58eefc8b27b300e34d85f640d7f869,"Fixed for Bugzilla 10625. URIResolvers were being dropped in several places.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336587 13f79535-47bb-0310-9956-ffa450edef68"
901c49e535591f7f4b361b664370054a35c3c1ae,"Util class for the TrAX package.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336588 13f79535-47bb-0310-9956-ffa450edef68"
eb3b7ad32bf35c1b5ba595d59692576869110adf,"Synchronize calls to Stylesheet.translate() using class' lock.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336589 13f79535-47bb-0310-9956-ffa450edef68"
bd85f8eb6fcd6a7875d71893a3a1d2c50de1f05b,"Ensure synchronization for Templates objects.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336590 13f79535-47bb-0310-9956-ffa450edef68"
0e195e9b515fbaa1e71d7efd07889f0ab342174a,"Added safety net to getDOM().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336591 13f79535-47bb-0310-9956-ffa450edef68"
18fa4318bc003a5458d08aaa955c4777a73e15cd,"Remaining updates for Bugzilla#5013.  

Some attributes that should have been handled as errors were getting
handled as warnings.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336592 13f79535-47bb-0310-9956-ffa450edef68"
c0a458d4beeeebdfa6f594bb61990f089b711fc6,"Check that recursionLimit is not negative before calling checkForInfinateLoop.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336593 13f79535-47bb-0310-9956-ffa450edef68"
51a1b1f9a368afdae3abd92244c71a75078c033f,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336594 13f79535-47bb-0310-9956-ffa450edef68"
cb9e826729c9cc9b86cda5af326e8786bdff246d,"added new type for support of ext java functions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336595 13f79535-47bb-0310-9956-ffa450edef68"
4619147667e6230f4b9acfa1c7eef5c4c52d429c,"bug fix 10837, support of ext java functions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336596 13f79535-47bb-0310-9956-ffa450edef68"
f379c5b5524a1b5d339b791f8798090952d917cd,"fix typo, java for Java in doc on xsltc and external java functions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336597 13f79535-47bb-0310-9956-ffa450edef68"
b77d165a96842a9a2ca6869d336145a24cdd6cc9,"Applying patch for bug#10839.

Try/catch block needed around System.getProperty call.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336598 13f79535-47bb-0310-9956-ffa450edef68"
e2a7824aebebb34d5adfabb960bff99b1dcddbe5,"Applying Paul Brown's patch for bug#6972.

xsl:output cdata-section-elements attribute was not handled correctly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336599 13f79535-47bb-0310-9956-ffa450edef68"
3c096208e3c6b8ca9bb9483cc9d387e8c3c60ece,"Committed patch for bugzilla#10323 (incorrect Javadoc 
in the extension code.)
Submitted by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336602 13f79535-47bb-0310-9956-ffa450edef68"
9e2fd28cf0f913b64e00798c6b91dd4c4537466c,"Committed patch for bugzilla#10914
( Need better error message for redirect select errors)
Submitted by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336603 13f79535-47bb-0310-9956-ffa450edef68"
3f17f0fef9dc13d94bb0040bf0b1a3733ea34e98,"Fix for Bugzilla 11166.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336605 13f79535-47bb-0310-9956-ffa450edef68"
964b46f809b4cc573fb09bb9929203e02f4e04bd,"Patch for bugzilla #9146

NullPointerException when attempting to build a stylesheet from 
a DOM Element instead of a Document node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336606 13f79535-47bb-0310-9956-ffa450edef68"
4a43259708568bb3df7a9d449b308fd1f98cd1fb,"Fixed loop exit condition in prepareTestSequences().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336607 13f79535-47bb-0310-9956-ffa450edef68"
b73ae01f38370d0b970f71d2ef725787a2555179,"Applying patches for Morris Kwan for bug 10519.  Changed condition in absoluteURI method to handle the case where the URI is the root of a file system - e.g., / or c:\


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336608 13f79535-47bb-0310-9956-ffa450edef68"
365db82785b4720cb328a2978a9f820baa7c58eb,"Applying patches for Morris Kwan for bug 10519.  In parse method, if SystemId of the returned DOMSource object is null, systemID is resolved using href.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336609 13f79535-47bb-0310-9956-ffa450edef68"
c052112521ab8ef6b38e572fa698c2c32be1fb3e,"Added type promotion from result-tree to object (used in call to nodeset()).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336610 13f79535-47bb-0310-9956-ffa450edef68"
25ff33f48a2dca4a589f6acf3d7965ad029aa8c0,"improved selection algorithm for overloaded methods and constructors in ext java funct calls


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336611 13f79535-47bb-0310-9956-ffa450edef68"
4689dc8ddacf80d448af9115ea2663e96d496089,"changed verbage to agree with new support of constructors and nonstatic external java functions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336613 13f79535-47bb-0310-9956-ffa450edef68"
15695c3999328678f3837a60b50cbf7ea02edfb6,"Applying patch for Bug 9683 for Morris Kwan.  If XRTreeFrag is constructed
without respect to an XPathContext, the object() method should defer to the
parent class's object() method to convert the fragment to the appropriate
representation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336615 13f79535-47bb-0310-9956-ffa450edef68"
54cbfb11bb04a1a041445a1f6e2c6f86ff8ad245,"Patch for bugzilla #6071.  Specifically, this patch allows line numbers to 
be reported when errors are discovered at runtime in a value-of attribute.
(See idkeyerr10.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336619 13f79535-47bb-0310-9956-ffa450edef68"
302ff47e5d06f33c4b1d05c143932d1dd8b9fa45,"Fixed regression of test function-available('xalan:nodeset').


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336620 13f79535-47bb-0310-9956-ffa450edef68"
3e37c1e4ce3cec2a830a6b2e2ffc554558bcc779,"Use factory class methods to instantiate default decimal formatter.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336621 13f79535-47bb-0310-9956-ffa450edef68"
b4acb54e8054a34f9892be1faa8a9fdb00c7351b,"1. Report attributes with non-empty local names.
2. Ignore attributes reported as content.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336622 13f79535-47bb-0310-9956-ffa450edef68"
44b546398a2927bcb31b7e5ba0ee10edbfdf9e18,"Use unmodified URI when retrieving the document via the DOM cache.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336623 13f79535-47bb-0310-9956-ffa450edef68"
2bfb51c430ebe38d3d6f8580540b8d496da801d3,"New implementation of identity transform. Fix for Bugzilla 11345.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336624 13f79535-47bb-0310-9956-ffa450edef68"
ca2831b4204439162d0f49391e0111b7a1e797c9,"bug fix for bugzilla 11221, MK053


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336625 13f79535-47bb-0310-9956-ffa450edef68"
15870fe5cdbcf4ffd49f257a7d102b4b92ef3de7,"For Bug#6547. Remove reference to old jar files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336629 13f79535-47bb-0310-9956-ffa450edef68"
761d6f34bca4eaa035f629f67025d14201e066cc,"bug 11704, fixed ErrorMsg to include name information


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336640 13f79535-47bb-0310-9956-ffa450edef68"
700f0734874cc61855e3d6ae71b644dcd166a8d2,"Patch for bug: ""The key() function throws an exception when called in the context of a 
local variable."" reported on xalan-dev.

Modified FuncKey.execute to use getDocumentRoot instead of getDocument.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336641 13f79535-47bb-0310-9956-ffa450edef68"
1d9fb2c0ddb8ff8070bd507a387cf04fdca24e00,"For Bug#11123. Fix infinite loop in union expression.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336647 13f79535-47bb-0310-9956-ffa450edef68"
33f05418f579cc0e8193bc40c5c3d74c8923fe9c,"For bug#7776. Fix argument passing problem for Java extension.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336648 13f79535-47bb-0310-9956-ffa450edef68"
8414269ac61eefdb98a4cf403d4e5344a5e94cba,"See bug#10945. Test if a node is a DTMNodeProxy before casting.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336649 13f79535-47bb-0310-9956-ffa450edef68"
6927eba24a8d1a86af86f351cf73fa3ee54ff452,"Patch for bugzilla#11834.  Replaced calls to DTM.getDocument with get 
DTM.getDocumentRoot.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336656 13f79535-47bb-0310-9956-ffa450edef68"
af6975d5773626f37b84364c10d030200c2c8270,"James Riordan's bug -- Attributes on elements returned from
extensions were not being processed successfully. Turns out
our copying logic had a minor sequencing error.

I don't see anything similar listed in Bugzilla.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336659 13f79535-47bb-0310-9956-ffa450edef68"
0ef2735092c702710e51d3e1d487ff7fe6f28a99,"fixed bug that was calling an inappropriate compare method when the right side of the comparison was a DOM


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336661 13f79535-47bb-0310-9956-ffa450edef68"
1eefa4182224462eda815358450a4cd26d418b2d,"fixes conf tests lre02, lre03, lre11, namespace125, namespace126


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336665 13f79535-47bb-0310-9956-ffa450edef68"
106bb1cc6a325c2764f97002e24f39dd50c8f47b,"Fix for bugzilla 11987. Missing case in typeCheck() method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336666 13f79535-47bb-0310-9956-ffa450edef68"
94c6c43abd23195cb7b7e3b76aadae522eff91b1,"Very minor optimization.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336667 13f79535-47bb-0310-9956-ffa450edef68"
ea844d8b70a8518dde6c83ecec34b10568bf78d8,"conf test string134 fix


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336668 13f79535-47bb-0310-9956-ffa450edef68"
1e6aa43dea12c81302b0dfe19c8eefca140e5766,"Fix for namespace102 (this test worked with Crimson but failed with
Xerces).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336669 13f79535-47bb-0310-9956-ffa450edef68"
82e515e956ba89bde0e7c3ce7e54265ce392da03,"Removed debugging message.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336677 13f79535-47bb-0310-9956-ffa450edef68"
00a93536f5d540e84d3bba1a356b60bc17fb7bef,"Fix for Bugzilla 11828. A new closure conversion algorithm has been
designed and implemented. The old algorithm did not work in some edge
cases (c.f. description of Bugzilla 11828). Closure variables in an
inner class are now accessed locally instead of via the AbstractTranslet
class. Also, we have set the new version to be ""XSLTC 1.2"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336678 13f79535-47bb-0310-9956-ffa450edef68"
b1ec530f2c4c5a06a2eb51803dcdf8d68e7f9b47,"Allow the default namespace to be redefined as """".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336681 13f79535-47bb-0310-9956-ffa450edef68"
12a45fccb370b38588d088a30aa9ca443aace980,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336682 13f79535-47bb-0310-9956-ffa450edef68"
7df4f20b43a9ef796fb6e5c069ae7cc729a92914,"bug fix for output13 conf test


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336684 13f79535-47bb-0310-9956-ffa450edef68"
ae4b342672492897416728cd108dadbc8871c24a,"Fix for Bugzilla 12075.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336685 13f79535-47bb-0310-9956-ffa450edef68"
cd25dd15b3b9d38336bff74669228e578d57c1d2,"Replacing xml-apis.jar with the version from the RIVERCOURT1 branch 
of xml-commons.   The xml-commons-1.0.b2 version does not pass
the TCK 1.1 or the TCK 1.2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336686 13f79535-47bb-0310-9956-ffa450edef68"
c78f494da85160e87af67764beacc2583aa9562c,"Small updates to the build documentation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336687 13f79535-47bb-0310-9956-ffa450edef68"
44ac9204d2b65f9779af875046c48e33cb7b063b,"Updating version numbers to 2.4.0 for new release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336689 13f79535-47bb-0310-9956-ffa450edef68"
f84343b78e90fb2ab36f6bc88dc9fe7e0fe80739,"New commits.xml for upcoming Xalan 2.4.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336690 13f79535-47bb-0310-9956-ffa450edef68"
041158be8bd312b979b45bab91cb5693f26706db,"New history.xml, xsltc_history.xml for upcoming Xalan 2.4.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336691 13f79535-47bb-0310-9956-ffa450edef68"
dcbef304e742d04383b2a923b3651cf7dcca619b,"Keep track of parameters for built-in identity transform (needed for
some TCK tests).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336693 13f79535-47bb-0310-9956-ffa450edef68"
14894e2d6cdda991b62fd7b76cbcdc09f865070b,"On behalf of Sarah McNamara, updated the developer list and list of changes since Xalan Java 2.3.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336694 13f79535-47bb-0310-9956-ffa450edef68"
66ed030d82aef79ec3c7b6f2abb8c95a840c45a1,"On behalf of Sarah McNamara, added resources for the new developers added to readme.xml


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336695 13f79535-47bb-0310-9956-ffa450edef68"
3a511a5ed63b8b1854b66f7de638387e5fc4c6bc,"On behalf of Sarah McNamara, removed 'developers release' wording so that this release is not flagged as such


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336696 13f79535-47bb-0310-9956-ffa450edef68"
6d232d50ca5b0847627dbf45c31d542da172b01c,"On behalf of Sarah McNamara, updated the core (non-xsltc) commit info for Xalan Java 2.4.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336697 13f79535-47bb-0310-9956-ffa450edef68"
68530981994fdf1236a5d7b5a93243104f2a9d84,"On behalf of Sarah McNamara, updated the xsltc commit info for Xalan Java 2.4.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336698 13f79535-47bb-0310-9956-ffa450edef68"
57f2d0917843d3530626700913c1b8b09d04b26b,"On behalf of Sarah McNamara, added a link to the new Xalan Java Builds information


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336699 13f79535-47bb-0310-9956-ffa450edef68"
a9d526cde0f124e289e9f9a9155466978535a981,"On behalf of Sarah McNamara, updated the list of commits to pick up the modified file information correctly


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336700 13f79535-47bb-0310-9956-ffa450edef68"
88691beec80a5512f237b9c0f5bc51f6d06d9b0a,"On behalf of Sarah McNamara, added entries for the Xalan Java 2.4.0 packaged jars


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336701 13f79535-47bb-0310-9956-ffa450edef68"
a5880554e8bfe05052dd808175d6d57c46deaaa3,"Updated to xercesImpl.jar from Xerces-J-bin.2.0.1.zip (for upcoming Xalan-J 2.4.0 release).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336702 13f79535-47bb-0310-9956-ffa450edef68"
c52d3f805399c103b00d62174e807d0f3c7a91b4,"Fixed XSLTCs implementation of XMLFilter


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336704 13f79535-47bb-0310-9956-ffa450edef68"
8317286e236b1d24e32bdc1d11a4d440b6d05796,"added some check for parents of filter chain


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336705 13f79535-47bb-0310-9956-ffa450edef68"
174c4b4e305ba26cfb2df6acf6e4101633827c64,"Fix for Bugzilla 12125.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336706 13f79535-47bb-0310-9956-ffa450edef68"
aef68bffe51c40f6a44295633fbd8aca37bda580,"bug 12148 fixed, xpath pred and relational expr


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336707 13f79535-47bb-0310-9956-ffa450edef68"
28309daea9d1b5b2084fa23c46766631b12bfd86,"Fixed Class loader Problem. Default Connection now uses context Classloader


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336708 13f79535-47bb-0310-9956-ffa450edef68"
e1e100657259e935313be0a10df85948d8771cbf,"Fixed problem where a query that returned zero rows would incorrectly return a JDBC
Exception. Note: This only occurs in streaming mode.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336709 13f79535-47bb-0310-9956-ffa450edef68"
7ab2794228a2412c858967454340df9099cdec04,"Add a convenient interface getStringValue() which returns the
string value of a node. It is used by the extension code
to get a node value without hacking into the DTM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336711 13f79535-47bb-0310-9956-ffa450edef68"
57177bfbab63c03432c164d2eec6cb9345270fe8,"Add strings for new extension namespaces. This includes new EXSLT
namespaces (dynamic and strings), namespaces for redirect, PipeDocument
and SQL extensions and new namespace for the Java extension. For
backward compatibility, the old Java namespace is still kept.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336712 13f79535-47bb-0310-9956-ffa450edef68"
5d2c1e7181dbb3ae2278c1360eab2909b0af37b6,"Register new extension namespaces, including two new EXSLT namespaces
(dynamic and strings), namespaces for redirect, PipeDocument and SQL
extensions and the new/old namespaces for Java extension.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336713 13f79535-47bb-0310-9956-ffa450edef68"
fba606f2fd65b2af357a899ebffe393472927621,"Reorganize the extension functions for new EXSLT extensions and
XSLTC integration. The implementation of some extension functions
(intersection, difference, distinct, evaluate and tokenize) are
moved to the corresponding EXSLT extension classes. We also put
a note to say that using these extension functions in the
Xalan namespace is deprecated. The signature of some extension
functions are changed to facilitate the XSLTC integration.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336714 13f79535-47bb-0310-9956-ffa450edef68"
56032b7c880c83aad21ef5c80c95fe22ea06bf1d,"The EXSLT math extension was rewritten for XSLTC integration. The
signatures of the existing functions (max, min, highest and lowest)
are changed. We use NodeList instead of NodeSet and NodeIterator
in arguments and return types, because it is the only node list type
recognized by XSLTC. We also got rid of the ExpressionContext
arguments in these functions. We implemented the toNumber() and toString()
interfaces as a replacement.

I also implemented all of the remaining math functions in the EXSLT spec,
e.g. constant, sin, random.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336715 13f79535-47bb-0310-9956-ffa450edef68"
96d0cc92a001a140e80f44d861ce5c6502962732,"The signatures of the sets extension functions are changed for
XSLTC integration. NodeList is used instead of NodeSet and NodeIterator
in arguments and return types. The implementation of intersection,
difference and distinct was moved from Extensions.java to this file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336716 13f79535-47bb-0310-9956-ffa450edef68"
3656ad278f466bca81c2933e533e03e45bc34564,"Add comments for the new namespace (http://xml.apache.org/xalan/redirect).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336717 13f79535-47bb-0310-9956-ffa450edef68"
6707bac38145ee8684582c6c1917c0805c27cf22,"Add comments for the new namespace (http://xml.apache.org/xalan/PipeDocument).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336718 13f79535-47bb-0310-9956-ffa450edef68"
fe9190e9559f3efaf62355062c02ab5bf46a7cc3,"Add comments for the new namespace (http://xml.apache.org/xalan/sql).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336719 13f79535-47bb-0310-9956-ffa450edef68"
f0c1e0eddfb26793fc8c47072be3342db243503f,"Add the ExsltDynamic class which implements the EXSLT dynamic
extension functions (max, min, sum, map, evaluate and closure).

The implementation of evaluate is taken from Extensions.java.
The Javadoc is copied from the relevant EXSLT page.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336720 13f79535-47bb-0310-9956-ffa450edef68"
6e428a88af45a0a6eee536a0ef48ffca6d3196ba,"Implement the EXSLT strings extension functions (align,
concat, padding, split and tokenize). The implementation
of tokenize is taken from Extensions.java.

The Javadoc is copied from the relevant EXSLT page. Three
functions (decode-uri, encode-uri and replace) are missing
due to ambiguous spec.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336721 13f79535-47bb-0310-9956-ffa450edef68"
99fbedaa236680bb9e41c1131be02e601392787a,"For Bugzilla 11809 and 10643. Fix the nextNode() interface so that
it returns DTM.NULL if the m_foundLast flag is true.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336722 13f79535-47bb-0310-9956-ffa450edef68"
958606d69d97606536d804a3ca0ac12d9263a7e4,"For Bugzilla 11073. Fix an extension namespace problem.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336723 13f79535-47bb-0310-9956-ffa450edef68"
b8616cd7a5223c514c499973bf539df9446e2d99,"For Bugzilla 11743 and 12298. Fix argument handling in
extension functions. Arguments now have non-null parents
and they will be visited by the XPathVisitor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336724 13f79535-47bb-0310-9956-ffa450edef68"
ffaa5a56a1abb76c11b1e4a15ef72aa3747040c3,"I had to get a new key after a hard drive crash.  This time, I backed it up!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336727 13f79535-47bb-0310-9956-ffa450edef68"
782101db4309847d97b2031849c724d44c1cdaf1,"Change committed on behalf of Igor Hersht: added -DIAG option similar to that
supported by org.apache.xalan.xslt.Process class (for bug 12261).

Also (on my own behalf) changed calculation of average transform time and
throughput rate for -n option to use floating-point division, rather than
integer division; latter yielded meaningless results.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336729 13f79535-47bb-0310-9956-ffa450edef68"
9fdd28bddee80f2ea6fcdfd9b389b7c9a4c7294a,"New buffering system for stream output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336732 13f79535-47bb-0310-9956-ffa450edef68"
0faa12be66a72137343ce677442ae6d2e4aa5e2d,"Support for Greek alphabet in xsl:number.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336734 13f79535-47bb-0310-9956-ffa450edef68"
400e74243d21d97d4c0b2ead45dd7823c05d9887,"Set a larger buffer size for Solaris.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336735 13f79535-47bb-0310-9956-ffa450edef68"
673d6f396abb1ab397b543a0373468afb285e851,"Copy the LICENSE and README files to the bin directory for the source distribution.
These files are needed by the xsltc.jar target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336736 13f79535-47bb-0310-9956-ffa450edef68"
70476c787e383888ce9bd6f4f4fad7f0c330c9b3,"Throw an IllegalArgumentException in the setErrorListener() interface
if the error listener is null.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336737 13f79535-47bb-0310-9956-ffa450edef68"
d34ec4cecaa58c59c6f45c4e2179217b9bb798a0,"For Bugzilla 9731. Convert an empty NodeList to a null Node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336738 13f79535-47bb-0310-9956-ffa450edef68"
d31a435cd20fcd0a37a1ad420bbd9333700bd553,"For Bugzilla 12379. Transformer.setOutputProperties() should throw
IllegalArgumentException if the property is invalid.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336741 13f79535-47bb-0310-9956-ffa450edef68"
adad63450cdc8fb0d41a0208ed9ed482640033a2,"For Bugzilla 12127. Throw a TransformerException if a prefix cannot
be resolved to a URI insteading of throwing a NullPointerException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336742 13f79535-47bb-0310-9956-ffa450edef68"
eadea5c74a6221b1134d9f1e4e8203aeb20e1ff7,"Correct a problem in the previous patch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336743 13f79535-47bb-0310-9956-ffa450edef68"
b9010e516e2a8ac8ba4875892a24c748971e60ba,"Set different initial sizes for DOMImpl arrays. The new values result
in better performance for the average case.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336747 13f79535-47bb-0310-9956-ffa450edef68"
60fd92236dfa4f75c25fa45a34c5eb80643ab46e,"Optimized evaluation of //RelativeLocationPath expressions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336748 13f79535-47bb-0310-9956-ffa450edef68"
04cfde7cb261fc6de674b09e54b3213a23ee536f,"Javadoc correction.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336749 13f79535-47bb-0310-9956-ffa450edef68"
3d234b4368ef49e903c47d6879608f2a96716acc,"Make the tokenize extension function different from the one in the
EXSLT strings extension. Reuse the Document object to reduce
memory consumption.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336750 13f79535-47bb-0310-9956-ffa450edef68"
4dbf933e4cb290121574b83dd4221c1f7322d9b4,"Make the tokenize function conformed with the EXSLT spec. Reuse
the Document object to reduce memory usage.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336751 13f79535-47bb-0310-9956-ffa450edef68"
895fcfca65d25f6b5a6bd371281eaa884c8cd60b,"For Bugzilla 11341. Let RTFIterator extend NodeSetDTM so that it is the kind
of DTMIterator expected by DTMNodeList. This also fixes the problem in
testcase JavaBugzilla3722.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336752 13f79535-47bb-0310-9956-ffa450edef68"
bc1473439c3584a96a968716ae4cf090c73910f1,"For Bugzilla 12077. Fixed problem with func:function in included stylesheet.
Add exsltFunction to the templateElements list so that we can detect the error where
func:function is embedded in another (e.g. xsl:variable) element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336753 13f79535-47bb-0310-9956-ffa450edef68"
84527d011e53d53efd883ffd654688bdd00ae81e,"For XSLTC extension integration. Support creating ObjectType from a Class
object. Add an additional field to store the Class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336754 13f79535-47bb-0310-9956-ffa450edef68"
5837bef120adfed89647fe956ea3674b4b83636d,"For XSLTC extension integration. Add more translation rules required by
extensions. Specifically, all types can be translated to a generic Java Object.
Numeric types can be translated to their corresponding Java types (e.g. Real to
java.lang.Double). Node, NodeSet and ResultTree can be translated to a Java String.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336755 13f79535-47bb-0310-9956-ffa450edef68"
af4cd6915246a0e5260732bc55280845db2fb330,"Support the append attribute in the redirect/output extension.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336756 13f79535-47bb-0310-9956-ffa450edef68"
91888448cc7768a71caf4bdac1c41851dcae487a,"For XSLTC extension integration. Implement the object-type extension
function in the EXSLT commons package. Change the behavior of the
nodeList2Iterator interface so that it will do a deep copy on the argument
NodeList, i.e. if a Node in the NodeList is an Element, it will not only
copy the Node itself, but also copy all children and attributes. This is
required to get any extension function that returns a NodeList to work in
XSLTC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336757 13f79535-47bb-0310-9956-ffa450edef68"
7c3b04e3632adf522e4b6aeeec9904b4c553af70,"Support the append attribute in the output extension element, so that
it behavior is more like redirect:write.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336758 13f79535-47bb-0310-9956-ffa450edef68"
431011f756b418f7fc33f164e778d07a7be145a0,"Add a constant string for the redirect namespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336759 13f79535-47bb-0310-9956-ffa450edef68"
a465d173b9dae0989c4b3085bd9edea40d3a32bb,"For extension integration. Allow numeric types to be casted to
Object type.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336760 13f79535-47bb-0310-9956-ffa450edef68"
a346f669a73791ff02011902e750ac940d1e564a,"For extension integration. Add the objectType extension function to the
Symbol Table. Maps the redirect:write element to the TransletOutPut class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336761 13f79535-47bb-0310-9956-ffa450edef68"
5ba9e686709e6d58a3f8d87c12da032663335a3f,"For extension integration. The nodeset extension function can be used as
node-set in the http://exslt.org/common namespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336762 13f79535-47bb-0310-9956-ffa450edef68"
47232583afae3c38e775458b08f99814218b34af,"Changes for Java extension and EXSLT extension support.
For Java extension:
- support 3 different namespace formats (Java, class and package).
- fix a bunch of type translation problems
- fix problems in class/method matching algorithm

For EXSLT extension:
- support the math, set, strings and datetime extension
- support using the nodeset extension in 3 different ways (xsltc, xalan and EXSLT commons)
- support the object-type extension in EXSLT commons as a native XSLTC function
- Maps the redirect:write element to XSLTC's output element
- extension function name translation (e.g. node-set to nodeSet)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336763 13f79535-47bb-0310-9956-ffa450edef68"
3bc7c3c75e642066f995ad8507cf6e49f82d742f,"Additional optimizations in expansion of '//'.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336764 13f79535-47bb-0310-9956-ffa450edef68"
c64205780c6484de5aefeb676f4c611db02e34ab,"Removed ""-DIAG"" option as it is similar to ""-n 1"". XSLTC's command line
options are single letters, so -DIAG does not really fit in the synopsis.
Morris K. is working on an extension for Xalan's Process class to allow
the compilation and execution of translets (once that work is completed
the -DIAG option will be available for XSLTC too).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336765 13f79535-47bb-0310-9956-ffa450edef68"
1abfd55de962b3cd369c57dcb5f69455e1d388d9,"New version of xml-apis.jar taken from xml-commons with tag:
factoryfinder-build.  It contains the JAXP FactoryFinder patch and some
SAX file updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336766 13f79535-47bb-0310-9956-ffa450edef68"
09c4e9d31053b763a6e53dfa798708189a9a3be1,"Change default policy for template inlining.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336774 13f79535-47bb-0310-9956-ffa450edef68"
d7e8ced82fbd8a4a3c46fc4ba0cb6dc963965d0d,"Replaced attribute ""disable-inlining"" by attribute ""enable-inlining"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336775 13f79535-47bb-0310-9956-ffa450edef68"
66324d30943c1fbe8e07c4521225cbdf7d4ba099,"XSLTC support - phase 1

Add the -XSLTC option to enable transforming using XSLTC

The following existing options do not work in XSLTC mode:
-TT
-TG
-TS
-TTC
-QC
-L
-INCREMENTAL
-NOOPTIMIZE
-RL

If any of these options is used with -XSLTC, a message is printed
and the option is ignored. All other existing options (e.g. -flavor,
-text, etc.) can be used with -XSLTC.

In phase 2, we are going to migrate the XSLTC specific options in the
XSLTC command lines (Compile and Transform) to the Process command line.
One of the new features would be generating translet class files from
the xsl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336781 13f79535-47bb-0310-9956-ffa450edef68"
8a3765ecebda9fd20c26b77b316b859d5a8079a6,"Extension work. A few Javadoc correction. Fix problems in math:max and math:min.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336783 13f79535-47bb-0310-9956-ffa450edef68"
65eb26d4336a732f094348f47f9cd1ee5ba282c4,"For Bugzilla 6181. Change the execute() interface to return the result
of executing the select expression.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336784 13f79535-47bb-0310-9956-ffa450edef68"
744c71d25462935a55117f83fcdbb9030027e864,"Updating to latest xercesImpl.jar, which contains org.w3c.dom.xpath interfaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336787 13f79535-47bb-0310-9956-ffa450edef68"
33ae841fd8e75108eb7fa590dc9c24848ac1f7ba,"Prototype implementation of DOM L3 XPath Specification.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336788 13f79535-47bb-0310-9956-ffa450edef68"
7706cfefafd6628415d4f1fcf4c210ef2cf1cd85,"Committing Gordon Chiu's (grchiu@ca.ibm.com) patch for bugzilla #6927.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336789 13f79535-47bb-0310-9956-ffa450edef68"
53d94a716663165c7f3969daa4d92edfed12fd41,"Lazy computation of mappings and reverse mappings.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336793 13f79535-47bb-0310-9956-ffa450edef68"
8e2e8af8e65e86ee9b42495f7a523d741ab44ccd,"(1) Synchronize access to static variable.
(2) Pre-allocate static objects for attribute and element types.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336794 13f79535-47bb-0310-9956-ffa450edef68"
09f0fd3969d85d00cef404c9cffc3037210a77d9,"Changed setting to speed up DOM building process.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336795 13f79535-47bb-0310-9956-ffa450edef68"
2b921354e3f63f4af5b70db2bf8363feb8233ac7,"compile -n option changed so inlining is now the default


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336796 13f79535-47bb-0310-9956-ffa450edef68"
24f44de42644d10656d493a0abffeb15f97ef959,"Extension cleanup.
Add an ExsltBase class as the super class for other EXSLT implementation
classes, so that the toString() and toNumber() interfaces can be easily
reused by all the subclasses without duplicating code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336797 13f79535-47bb-0310-9956-ffa450edef68"
fca9146e069fe2c5fad62106bb8458efb4c2054f,"The isNodeTheSame(node1, node2) interface should return true if node1==node2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336798 13f79535-47bb-0310-9956-ffa450edef68"
93c2989b37c17d0cc8b5152e878d4b9889e9ac22,"Return a fresh XMLReader for each call to getXMLReader(). Returning the
same instance is incorrect in multi-threaded apps where a single
transformer factory is shared by all threads.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336800 13f79535-47bb-0310-9956-ffa450edef68"
972752c81642cd873550d22cd39b119689c637bd,"For Bugzilla 12924. Add handling code for DocumentType Node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336801 13f79535-47bb-0310-9956-ffa450edef68"
9a95fce91f47237d2249e754514863ec9258aa09,"For Bugzilla 12924. In constructor SAX2DOM(Node), the Node might not always
be a Document. Add additional handling code so that SAX2DOM can work with a
non-Document root.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336802 13f79535-47bb-0310-9956-ffa450edef68"
24975ad79f86dab0a4fb0b0fb2d45ea1066ca082,"Patch for bugzilla #10384.  There's still a problem with attribseterr08 which
is covered in bugzilla #3969.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336803 13f79535-47bb-0310-9956-ffa450edef68"
7947f8fe8323701407aca5204ec33bfd7c60d561,"Since Xerces has decided not to build the org.w3c.dom.xpath interfaces into
XercesImpl I have created a temporary home for these interfaces, until
the specification becomes a recommendation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336804 13f79535-47bb-0310-9956-ffa450edef68"
ac759c8b02c800587ea47ef0ff1bad8d78765e87,"Updating import statements to use the interfaces in the temporary org.apache.xalan.dom3.xpath package.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336805 13f79535-47bb-0310-9956-ffa450edef68"
698b60352ec0929f6e9f64df061dc564fc4bb116,"Added some new error message strings.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336806 13f79535-47bb-0310-9956-ffa450edef68"
0e22fea6d4cb11fbfd5f00bb377e694b6cb2eb9b,"Patch for bugzilla #4344.  The testcases, copyerr04-07 were already
working correctly in that when an attempt was made to add an attribute
after child elements, or before an element was produced, the attribute was 
ignored.  However, Dave M.  said that a warning was also needed.  So,
I have added a warning message for these cases.  Also, similar behaviour
was being seen for testcases attribset19,35,36 and attribseterr08.  This
was being handled in ElemAttribute.execute, but I've commented out the
code there since it will get caught in  ResultTreeHandler.execute in the
same place the copyerr tests get handled.

The negative testcases, copyerr04-07, attribset08 should  be moved
to the positive bucket (possibly with a few tweaks) since they all run to
completion.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336807 13f79535-47bb-0310-9956-ffa450edef68"
0f6486510439e734e9f9b63566e9698bdc4bf8f0,"Patch for bugzilla #4344.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336808 13f79535-47bb-0310-9956-ffa450edef68"
b3b0ceb636fe2626900ac6b5eccdeb8094d367eb,"Gordon Chiu's (grchui@ca.ibm.com) patch for bugzilla #8473.  Thanks also
to Brian Minchau (minchau@ca.ibm.com) for the analysis of this bug.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336809 13f79535-47bb-0310-9956-ffa450edef68"
f3769554c128e550b60f000c48884da26bbbff5a,"Use a thread variable to cache an XMLReader.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336810 13f79535-47bb-0310-9956-ffa450edef68"
decb76587a6687073ccce6ab730044cd3dbd2fce,"For Bugzilla 7161. Add a public accessor to return the argument array.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336812 13f79535-47bb-0310-9956-ffa450edef68"
6e519d8623bfce301befdd3c87badd79c4328ecb,"EXtension work. Make function-available work with external Java and EXSLT
extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336813 13f79535-47bb-0310-9956-ffa450edef68"
439e450ddd078242c8c229398050729e593f8189,"Handle dots in the local part, e.g.
xmlns:ext=""http://xml.apache.org/xalan/java/java.lang
function-available('ext:Thread.currentThread') return true.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336814 13f79535-47bb-0310-9956-ffa450edef68"
59fe4728284504260c19a5d539bdaba7eff47a5e,"Minor cleanup in class name handling.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336815 13f79535-47bb-0310-9956-ffa450edef68"
54e4ec08e683afbc8a6d1fc47f5ad7b472ed88cb,"For Bugzilla 10414. Provide a getErrorListener() interface in the ExpressionContext.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336816 13f79535-47bb-0310-9956-ffa450edef68"
4473617fa216c19b3267795e28779382157eb199,"For bugzilla 13059. Fix typo width""0"" to width=""0"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336817 13f79535-47bb-0310-9956-ffa450edef68"
8eb25676e0b1e92e5a1f6bcc53da81d72f141a3b,"Committing changes from Gordon Chiu (grchiu@ca.ibm.com), with some tweaks from
me, to move some hard-coded XSLTC messages into the compiler and run-time
ErrorMessages classes, as appropriate.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336820 13f79535-47bb-0310-9956-ffa450edef68"
b782a0312a84e9b875b3e4025b7d15de923df594,"Committing changes from Gordon Chiu (grchiu@ca.ibm.com), with some tweaks from
me, to move some hard-coded XSLTC messages into the compiler and run-time
ErrorMessages classes, as appropriate.

Also, added copious comments to assist anyone who might translate these
resources in the future.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336821 13f79535-47bb-0310-9956-ffa450edef68"
f0579292aacfee47e2d3c7dba63f840d215c7660,"Removed a duplicate error message number I inadvertently entered.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336822 13f79535-47bb-0310-9956-ffa450edef68"
6c97feb31d9e0865cd422b78433169e6dc2c2183,"bugzilla 12813 fixed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336825 13f79535-47bb-0310-9956-ffa450edef68"
35f70c757258a6470a4a64acd55ecd31c4d44c87,"Messages for new options in the Process command line.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336831 13f79535-47bb-0310-9956-ffa450edef68"
00ce8136c8e0e8bb78830504c00128130f829120,"XSLTC support in the Process command line - phase 2
Migrate the options from the XSLTC command line (Compile and Transform)
to the Process command line. The following new options are added:

-XO [translet_name]  (specify translate class name)
-XD destination_directory (specify destination directory)
-XJ jar_name (put translet into jar file)
-XP package_prefix (specify package name prefix)
-XN (enable template inlining)
-XX (additional debug messages)
-XT (use translet to transform if possible)

The new options can only be used with the -XSLTC option. The options are
passed to XSLTC via the standard TRAX API - TransformerFactory.setAttribute().
Process does not directly communicate with XSLTC.

The usage instructions are also re-organized. The options are divided into
three categories (command options, Options for Xalan and Options for XSLTC). A
pager is used when displaying the usage instructions so that you can see them
page by page.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336832 13f79535-47bb-0310-9956-ffa450edef68"
b8a20376ee8426afbc814cc7994d0e7db2e0c351,"Add debug messages for -XX option in the Process command line. These messages
tell the user whether they are transforming using XSLTC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336833 13f79535-47bb-0310-9956-ffa450edef68"
ccdf62a1ba6334ca1e6a04240a2962acfb8da78f,"Fix problems in the baseName() interface so that it can handle system ids like
file:abc.xsl and file:///c:\test\abc.xsl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336834 13f79535-47bb-0310-9956-ffa450edef68"
a4fcf15c7de30448434fa549e66bfbdea0b4bd52,"XSLTC support in the Process command line - phase 2
Add two new output types:
- BYTEARRAY_AND_FILE_OUTPUT: return a byte array and generate the translet class
- BYTEARRAY_AND_JAR_OUTPUT:  return a byte array and generate the jar file

Add a new compile() interface which accepts the output type as the third
parameter. Use different Vectors to store bytecodes and JavaClass objects.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336835 13f79535-47bb-0310-9956-ffa450edef68"
9a58fe48776a90cd7d961326d6ea7bde9c0e1033,"Add a wrapper for the noExtName() method in compiler.util.Util.
The transformerFactoryImpl class makes use of it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336836 13f79535-47bb-0310-9956-ffa450edef68"
688ad308dc2a0de4c7829eda0896c96a02d8e6db,"The member name _defaultTransletName in TransformerFactoryImpl
has been changed to _transletName.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336837 13f79535-47bb-0310-9956-ffa450edef68"
933a1340f09dcbc513860722fc60c45ae2b9f433,"XSLTC support in the Process command line - phase 2
Most of the changes appear in this class. The changes not only allow you
to use the new XSLTC options in the Process command line. It also give
you the ability to customize the XSLTC behavior using the standard TRAX API.
Previously, the XSLTC TRAX API is not aware of translets. You cannot tell it
to use translets for do transformations. Now you can customize the XSLTC bevaior
using the new attributes. For example, the following code will allow you
to use translets for transformations when the translet is newer than the xsl.

TransformerFactory tf;
tf.setAttribute(""auto-translet"", ""true"");
Templates templates = tf.newTemplates(xslSource);

The following attributes are added:
Attributes		Corresponding Process command line options
use-translet
translet-name		-XO
destination-directory	-XD
package-name		-XP
jar-name		-XJ
auto-translet		-XT

Four of the new attributes (translet-name, destination-directory, package-name and
jar-name) are transient. They only apply to the next newTemplates() or newTransformer()
call. Their values are reset to the default after the call.

There is also a makefile like feature when you set the ""auto-translet"" attribute. It will
use the translet to do transformation when the translet is newer than the xsl. If the xsl
is modified, it will use the xsl to transform and regenerate the translet.

Unlike the XSLTC Transform command line, the new code will NOT use the existing
ClassLoader to load the translet or jar file. It directly reads the file content into a
byte array. This makes the Process command line capable of loading the translet from
any directory the xsl file might be in or any user specified destination directory, without
the need on the user to add that directory to the CLASSPATH first.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336838 13f79535-47bb-0310-9956-ffa450edef68"
be8dab7657b0095c0e323143ae3a8ca74ad297c5,"Added and fixed up some additional translation guidelines.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336839 13f79535-47bb-0310-9956-ffa450edef68"
a09287789dae2432cdff83735a52714f9c92c44d,"Multi-thread protection for the new attributes.
The four transient attributes are now stored in ThreadLocal objects to prevent
multi-thread contention problems. This ensures that each thread will have a
different copy of the attributes and no collision issue will occur.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336840 13f79535-47bb-0310-9956-ffa450edef68"
a765bc01e93e4a7a3d94156bc040182e84cf8ff5,"Change the four attributes to be instance variables and remove
the ThreadLocal protection. TransformerFactory is not guaranteed
to be thread-safe. We will leave the synchronization issues up
to the user if they want to use one TransformerFactory in multiple
threads.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336841 13f79535-47bb-0310-9956-ffa450edef68"
43a2a5eed976f4d1190bd40e97e7e02980abd1d1,"Use Vector.elementAt() instead of Vector.get(). The latter is not available
in JDK 1.1.8. Add two argument accessor methods for Bugzilla 8939.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336846 13f79535-47bb-0310-9956-ffa450edef68"
616f52a7cbf956a1de67f54431bd5324fad2d853,"Use one namespace for all extensions (Bugzilla 9959)
Use the new namespace uri ""http://xml.apache.org/xalan"" instead of
""http://xml.apache.org/xslt"" for xsl:output extension attributes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336847 13f79535-47bb-0310-9956-ffa450edef68"
1c4b20cd30cc9c3bf657ea873d98bfeb277fdacc,"Use one namespace for all extensions (Bugzilla 9959)
Use the new namespace uri ""http://xml.apache.org/xalan"" for
the component and script extension elements. We maintain
backward compatibility so that using the old uri
""http://xml.apache.org/xslt"" still works.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336848 13f79535-47bb-0310-9956-ffa450edef68"
95f58ca0672fc73f8ba7c6b88a7e3424f7388c2f,"Minor Javadoc update to use the new namespace uri.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336849 13f79535-47bb-0310-9956-ffa450edef68"
3110e70f2cfe6d2f1f34ea40d466a2f4180bcf57,"Update the extension samples to use the new namespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336850 13f79535-47bb-0310-9956-ffa450edef68"
7a09da94d773f7cf7c0f1c98d116210deb942282,"Minor fix for math:max().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336854 13f79535-47bb-0310-9956-ffa450edef68"
e5a1ed5790ffb91775a43ea2c91f50cf5e8247bd,"For Bugzilla 13106. Visit the XPath expressions created for match patterns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336855 13f79535-47bb-0310-9956-ffa450edef68"
1dd7396d15d019612ae6282d48a2f3743c0c2eab,"The default type of a <xsl:param> should be result tree.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336856 13f79535-47bb-0310-9956-ffa450edef68"
f2269251d2d2151ef6399c06a210c39e047c7fe0,"Fix a problem in class namespace format and also cleanup the indentation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336857 13f79535-47bb-0310-9956-ffa450edef68"
b93468e894ba4afb746c6948dcbeb60293eb3519,"Set default type of parameters to be reference. The type of a parameter
cannot be determined statically in XSLT 1.0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336858 13f79535-47bb-0310-9956-ffa450edef68"
f136f83081069756bcd71950054569f3ad4d2ce5,"Patch for bugzilla #5046.

The token queue and operations map can now grow to accomodate really
large XPath expressions.   Starting sizes of the data structures remain set
at the size in the current code.

I created new classes org.apache.xml.utils.ObjectVector (based on org.apache.xml.utils.IntVector)
and org.apache.xpath.compiler.OpMapVector to store the token queue
and operations map.

This patch is essentially a stop gap until the new parser (xslt20 branch) is integrated.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336859 13f79535-47bb-0310-9956-ffa450edef68"
9bd22ca2355caa29c81510a4cf357ae727507277,"Patch for bugzilla #5046.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336860 13f79535-47bb-0310-9956-ffa450edef68"
aae47e9f68b9ee6a71484a3ad97938d5218b9a16,"Cleaning up import statements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336861 13f79535-47bb-0310-9956-ffa450edef68"
d51b08356cc6f8c78bee2a852df4e9888db4d097,"Commiting Gordon Chiu's (grchiu@ca.ibm.com) patch for bugzilla#8175.

IntStack's and ObjectStack's are now used in place of fixed length arrays, so that users
should not run into limitations based on array sizes.  The initial size of the arrays has
been set to current array sizes, so the user's experience should not change much, except
in the cases where they were running into the size limitation.

No performance analysis has been done to determine an optimal initial
size for the stacks.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336862 13f79535-47bb-0310-9956-ffa450edef68"
e15fae2261eff17c62ee8a9865ec8f830f41b6b6,"Committing Igor Hersht's (igorh@ca.ibm.com) patch for bugzilla #10176.

Also, removing testcase position102 from the excludes list for the smoketest
since it now runs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336864 13f79535-47bb-0310-9956-ffa450edef68"
98731860978a9dcff46c6854ff5d47c2563c7737,"(1) Eliminated the need for a ReverseIterator.
(2) Added a ForwardPositionIterator as a temporary solution for some
cases.
(3) Added several javadoc-type comments.
(4) Fixed a number of cloneIterator() implementations that were broken.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336865 13f79535-47bb-0310-9956-ffa450edef68"
0f8e63d49cebef20c7c83eddf56260f7650fc340,"Expression wrapper to compute positions properly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336866 13f79535-47bb-0310-9956-ffa450edef68"
99dc9d2c40d855d28b32f01948f873786e0d79c2,"Fix for Bugzilla 13304.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336869 13f79535-47bb-0310-9956-ffa450edef68"
65ab6fa58cbd7a4c2e9d6fb5a42b737c8956beae,"bug fix 12644, Santiago found that the clone iterator was doing a shallow copy


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336870 13f79535-47bb-0310-9956-ffa450edef68"
e9c377d0720e3799653ec218ccc8466a7ca82512,"(1) Fixed some dynamic typing problems with idkeys. Values are now properly
converted to strings before they are compared.
(2) Eliminated the use of BitArrays in KeyIndex (better space efficiency).
(3) All idkey tests now pass with flavor=stream (the 6 failures that are
reported are due to the use of a different algorithm to generate ids).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336876 13f79535-47bb-0310-9956-ffa450edef68"
f32abb4173381bb26872ae98bd9c00497e455e44,"bug fix 13550, for multiple <xsl:output> elements, cdata-section-elements attrs are now merged


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336877 13f79535-47bb-0310-9956-ffa450edef68"
3bf53c6745079a3210e353fb77bebf3bab9006b2,"Patch for bugzilla #13305.  Moved initalization code into a static initializer.

TransformerFactory.newInstance() can now be called safely from multiple
threads.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336878 13f79535-47bb-0310-9956-ffa450edef68"
c13adf43b258f262ba10996fc18a25d2c21c5530,"New implementation of xsl:element that properly handles the case where
the namespace URI computed at runtime is """". Some of the code implementing
the xsl:element instruction has been factored out from the translet into
the basis library.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336879 13f79535-47bb-0310-9956-ffa450edef68"
537484082fd45126deb4c59848558e2d872b1d40,"bug fix 12317, serialization of Templates is fixed


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336880 13f79535-47bb-0310-9956-ffa450edef68"
8ac7cc04ca37f79ceef882a97bd98bf2a4633492,"A RuntimeException cannot be constructed from a Throwable with JDKs
prior to 1.4.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336881 13f79535-47bb-0310-9956-ffa450edef68"
7fe9021fa8c054168a9873d7ecad1bf3d5ddcb47,"Clear dom index flag before passing node to DOMAdapter. Bug reported by
Prakash Sridharan.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336882 13f79535-47bb-0310-9956-ffa450edef68"
3f1bfc975b0ec4417b8b956e9c1d036ea9a5bda9,"Switch order of calls to startElement() and namespace() in startXslElement().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336884 13f79535-47bb-0310-9956-ffa450edef68"
bc9658c94233202f75776522759fe4bc37262816,"bug fix 12308, typeCheck, nodeset to node optimization is turned off if node has context


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336891 13f79535-47bb-0310-9956-ffa450edef68"
67ae9fc869f8f971be5907f4475d0431cf23f0a2,"Added support for all EBCDIC flavors in xsl:output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336892 13f79535-47bb-0310-9956-ffa450edef68"
3f02091f45e10663edad743e81b095754332e09a,"Updating to XercesJ 2.2.0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336893 13f79535-47bb-0310-9956-ffa450edef68"
0e6954aa1df501c48582832a3311e78463104ecd,"Committing Pavel Ausianik's (Pavel_Ausianik@epam.com) patch for bugzilla #12687.

Reduce memory allocation on initialization of ExpandedNameTable.

m_locNamesPool and m_namespaceNames and code that uses them has
been commented out.  Some initialization now done in static initializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336894 13f79535-47bb-0310-9956-ffa450edef68"
78e1ffdc05dcdd3a60d3b3f5bca6989f9f4304b0,"Committing Gordon Chiu's (grchiu@ca.ibm.com) modified patch of Pavel Ausianik's (Pavel_Ausianik@epam.com) 
patch for bugzilla #12486.

Method XPathContext.reset()  was creating many new instances of java objects, 
causing unnecessary memory allocations, instead of reusing previously created 
objects. 


m_locNamesPool and m_namespaceNames and code that uses them has
been commented out.  Some initialization now done in static initializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336895 13f79535-47bb-0310-9956-ffa450edef68"
d0df4fbdbeb2c91ebc7dd7d2f51fec642aef1c68,"Committing Gordon Chiu's (grchiu@ca.ibm.com) patch for bugzilla #13754.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336896 13f79535-47bb-0310-9956-ffa450edef68"
9f1ace1ec6ca1c533e5020266a0af70570d6735f,"Moved EBCDIC support from Output to StreamOutput to ensure correct
serialization of XML header.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336897 13f79535-47bb-0310-9956-ffa450edef68"
b1df2c83fc22d960452dcc7c4b31400becbe3946,"Copying the copyright statement for the DOM L3 XPath API interfaces into
the temporary package (org.apache.xalan.dom3.xpath) which contains
the interfaces until they become a recommendation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336898 13f79535-47bb-0310-9956-ffa450edef68"
51b138e4533bdc3b6c25bc2f0a2bce8246dabd3a,"Committing patch from Henry Zongaro. This patch moves the logic from
XPath's position() function from NodeIterator.getPosition() to
BasisLibrary.positionF(). This change simplifies the integration
between XSLTC and DTM.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336899 13f79535-47bb-0310-9956-ffa450edef68"
da4c16d1a48f49d28501a20eac929be65cce775b,"For bugzilla 13711
Fix the conditions for validating the child elements of func:function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336902 13f79535-47bb-0310-9956-ffa450edef68"
fc234af787d1a623b594f4e8ccd1e4300d3ba0b1,"Committing urban.spielmann@swisslife.ch (Urban Spielmann)'s  patch for bugzilla #11661.  

After the Redundant Expression Elimination merge, the key cache had
not yet been replaced.  This patch puts back the key cache, which
gives xsl:key much better performance.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336903 13f79535-47bb-0310-9956-ffa450edef68"
32433c92c9c318df4883a5371966ac2e16d52751,"For bugzilla 7357
Fix problems in exception handling for extension elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336904 13f79535-47bb-0310-9956-ffa450edef68"
60a8aad4b78a1116d24089ebdae8c361513aac4b,"Adding XSLTC_DTM version of file to branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336908 13f79535-47bb-0310-9956-ffa450edef68"
d42c3abd016eb022282b7487ce75c1537b3912b6,"Whoops!  Checked in file on MAIN branch that was meant for XSLTC_DTM branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336909 13f79535-47bb-0310-9956-ffa450edef68"
2fe26e2d91117af1567df7ffc72e06e4cf530aca,"Adding DTM version of ForwardPositionIterator to XSLTC_DTM branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336910 13f79535-47bb-0310-9956-ffa450edef68"
8a662ca836848fb3ad487f0f5c01a3aaa9608533,"Aarrrgggghhhhh\!\!  Checked in file on MAIN branch that was meant for XSLTC_DTM branch, again\!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336911 13f79535-47bb-0310-9956-ffa450edef68"
a0fd38d0d615268b31ecf08ab4ccfafde81338d1,"Patch for bugzilla #13863.

Moved setting the namespaceContext from the TransformerImpl constructor to
the transform method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336913 13f79535-47bb-0310-9956-ffa450edef68"
57098f38141b57f98b248087c9d86c21a1e5fe28,"Move a hardcoded string into the properties file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336915 13f79535-47bb-0310-9956-ffa450edef68"
4dfe5a9e973f15ecb7320d70911df068c9e7c685,"Fix for Bugzilla 13826. A problem in reset() was the cause of duplicate
nodes in the resulting nodeset.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336916 13f79535-47bb-0310-9956-ffa450edef68"
77a223e9d9fca772f6efc438a8111eb98c371461,"For bugzilla 13944. Check for InvocationTargetException in Method.invoke().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336917 13f79535-47bb-0310-9956-ffa450edef68"
53efe32d31047afdcd4209f07f8389cce0c1288b,"Fix for Bugzilla 13850 provided by Morris Kwan.

Morris Kwan wrote:

Changes in NodeSetType.java:
Allow a org.w3c.dom.Node to be converted to a XSLTC internal nodeset

Changes in ReferenceType.java:
Allow conversions from Reference to Java String, double, w3c Node/NodeList

Changes in ResultTreeType.java:
The result tree when converted to a nodeset, should contain only one node
starting from the root. If you replace <xsl:param> with <xsl:variable> in
the attached testcase, you will see a problem in ""ext:nodelistTest
($a)/h1/h2"" because of this problem.

Changes in BasisLibrary.java:
Added interfaces referenceToNodeList, referenceToNode and node2Iterator.
The changes in copyNodes() fix a problem with the document node. In the
case of an RTF, the NodeList passed to nodeList2Iterator() contains only
one Node, which is a Document Node. The changes try to create a dummy
element for the Document and copy all Nodes under it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336918 13f79535-47bb-0310-9956-ffa450edef68"
e979983bc9b46354a83267c041c892efeade304d,"Fix for Bugzilla 13850 provided by Morris Kwan.

  Changes in BasisLibrary.java:
  Added interfaces referenceToNodeList, referenceToNode and node2Iterator.
  The changes in copyNodes() fix a problem with the document node. In the
  case of an RTF, the NodeList passed to nodeList2Iterator() contains only
  one Node, which is a Document Node. The changes try to create a dummy
  element for the Document and copy all Nodes under it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336919 13f79535-47bb-0310-9956-ffa450edef68"
db45edec8b9deeaba2ddd74b301313bd70b0b6a5,"For Bugzilla 13303.
Fix Memory leak in XPathContext.popRTFContext().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336921 13f79535-47bb-0310-9956-ffa450edef68"
2ca547508b8bc43047bba6dd5eddd37941022ecd,"Backing out patch for bugzilla #13863.  It causes a bunch of failures in 
the trax.sax flavour.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336922 13f79535-47bb-0310-9956-ffa450edef68"
4635ebd9abb1b8665d10fa2619d47825a477baf0,"Update the extensions documentation.
Use the new namespaces in documents and examples. Update EXSLT development
status. Modify setup instructions for SQL samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336923 13f79535-47bb-0310-9956-ffa450edef68"
7d065e2b5303073ce6c4292ef50ed7854721196a,"For Bugzilla 14022
Commit Gordon Chiu's update to the FAQ.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336924 13f79535-47bb-0310-9956-ffa450edef68"
526d7cd58d5c452e6380cb5a38b0db4fdab3d661,"Removed the temporary org.apache.xalan.dom3.xpath package.

Updated the org.w3c.dom.xpath interfaces.

Changed dependencies to org.w3c.dom.xpath interfaces in the implementation
classes in org.apache.xalan.xpath.domapi.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336925 13f79535-47bb-0310-9956-ffa450edef68"
2ab886b572c1217da8d1141d9602d522d3775b97,"Build org.w3c.xpath.dom interfaces into xalan.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336926 13f79535-47bb-0310-9956-ffa450edef68"
0c6897869d76d6b17dcaa34b9827a2263254baea,"Patch from Gordon Chiu.  Replace stack.clear() calls with stack.removeAllElements()
to be compatible with JDK1.1.8.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336927 13f79535-47bb-0310-9956-ffa450edef68"
6ebf16e12344a81f2068447710fa6c8f1d98f84c,"Support compiling under JDK 1.2 - 1.4.  Also check for compatability with target JDK 1.1.x.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336928 13f79535-47bb-0310-9956-ffa450edef68"
c1cd5e9e2ad7a40b8d69ea1bfe4f761fcceb370f,"Somewhat rough implementation of XPathNamespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336929 13f79535-47bb-0310-9956-ffa450edef68"
36ab8764ae40194396391629dca07704ff51cbc7,"Upgrade to Ant 1.5.1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336930 13f79535-47bb-0310-9956-ffa450edef68"
2e40dad3a94e79246c8f779e00b9e0674e678a44,"Fix JDK 1.1.8 compatibility problems.
Replace methods calls that are only in Java2 by JDK 1.1 equivalents.
For DefaultConnectionPool.java, use reflection mechanism to invoke
Thread.getContextClassLoader() instead of hard-coded invocation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336931 13f79535-47bb-0310-9956-ffa450edef68"
3997d939907610b1342d6ed5a6c05ee671a0ee8c,"Distinguish between child::node() and attribute::node() both in patterns
and expressions. This patch also fixes Bugzilla 11433.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336932 13f79535-47bb-0310-9956-ffa450edef68"
092328e67038a9f04dd8f853cd233ce8dfe74569,"Fixed problem in DOMImpl$ChildrenIterator.getLast(). It now returns 0
when the nodeset is empty.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336933 13f79535-47bb-0310-9956-ffa450edef68"
dd4fcbf8fffb64de735e5c6ee51fdd74e2291dfb,"Update samples document to include ApplyXPathDOM sample which
uses the DOM L3 XPath API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336936 13f79535-47bb-0310-9956-ffa450edef68"
6c3c4c42809c3c8d16ab6fa50acc1a47ccd81134,"Add ApplyXPathDOM sample.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336937 13f79535-47bb-0310-9956-ffa450edef68"
9fe80f12f95dcd449f53215f97e008aa2270dd64,"Javadoc update for EXSLT functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336938 13f79535-47bb-0310-9956-ffa450edef68"
5fdb250f5065329e296f502e8934d7e23c2aa782,"Update from Gordon Chiu (grchiu@ca.ibm.com) so that build clean target does
not delete org.w3c.dom.xpath interfaces.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336939 13f79535-47bb-0310-9956-ffa450edef68"
8188b5dd53a087eea394f58a4d27f05244d60de5,"Committing Igor Hersht's (igorh@ca.ibm.com) patch for bugzilla #13863.

Need to reset the namespaceContext; otherwise, can get NPE if transformer
reused.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336940 13f79535-47bb-0310-9956-ffa450edef68"
97dfa5e7e7695ea7f39bf00f83fab1b8dc22f549,"Patch for bugzilla #13501.

Length wasn't being properly cached in NodeSequence or LocPathIterator.  
Also the predicate count on the clone wasn't being set properly in LocPathIterator.getLength().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336941 13f79535-47bb-0310-9956-ffa450edef68"
e02c5a9453e2caf07c041f62914f36c2a73e903e,"Updating commits.xml to contain information for upcoming Xalan release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336942 13f79535-47bb-0310-9956-ffa450edef68"
10cbff2516c401e53f50140b8a32d3876fd83ecb,"Commit Sarah Mcnamara's patch for site docs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336943 13f79535-47bb-0310-9956-ffa450edef68"
f5c6c380b72409e648a89946cc6bc417167632f4,"Commiting Sarah McNamara's (mcnamara@ca.ibm.com) patch for buzilla #14111.
Doc and resource updates for upcoming XalanJ 2.4.1 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336944 13f79535-47bb-0310-9956-ffa450edef68"
21c72f5bba008276cad230e7def86fc3f5b69aac,"One more file for the doc update (bugzilla #14111)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336945 13f79535-47bb-0310-9956-ffa450edef68"
db75e41995fedc9d46ec0984ad9922ff7d71cabb,"For Bugzilla 14157. Correct namespace prefixes in EXSLT javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336948 13f79535-47bb-0310-9956-ffa450edef68"
a4674a0958f0d684882357b9164adb24e18fb204,"Rework the SystemIDResolver class for Bugzilla 13651 and 13977.

The getAbsoluteURI interfaces have been rewritten so that they always
return a good absolute URI for a systemId string, no matter it is a
URI or a local filesystem path. The path is resolved to be absolute
whenever possible. We also do conversions from space to ""%20"" and
backslash to forward slash to ensure that the returned URI is a
well-formed URI. The URI might not be in a normalized form because
normalization takes extra cycles.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336949 13f79535-47bb-0310-9956-ffa450edef68"
3863ae900eb6d3704ff2099ed37407c77ce86592,"For Bugzilla 13977. Return a good absolute URI when the urlstring
is in the form of ""file:abc.xsl"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336950 13f79535-47bb-0310-9956-ffa450edef68"
6ed17373b3c36a09992ad7acdb0bbb8d55b9a9c7,"For Bugzilla 13651. Set the systemID to a good absolute URI for the InputSource.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336951 13f79535-47bb-0310-9956-ffa450edef68"
8afef00c6127c6636edca74b6eb3bc0cb23faea9,"Simplify the code for the new SystemIDResolver. One call to the getAbsoluteURI
interface should be enough.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336952 13f79535-47bb-0310-9956-ffa450edef68"
b84b1b98b58b02a30d183898f43a498a13775e12,"Patch for bugzilla #14178 - Long XPath expressions.  The token queue was 
growing properly, but the operations map was missing the last element when 
it grew.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336953 13f79535-47bb-0310-9956-ffa450edef68"
f2319d5b573eac330556e8ca6daa3b7b577b6836,"bug 14148 fixed, Morris Kwan patch


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336954 13f79535-47bb-0310-9956-ffa450edef68"
5fefc37a7ed7e5d55fdbb5bd61d7e0c948f0e9fa,"Minor correction to javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336955 13f79535-47bb-0310-9956-ffa450edef68"
0bbf5f032018651bf66affa28ebc667d917d7052,"Fixed problem in AxisIterator.isReverse(). This patch fixes Bugzilla
14112.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336956 13f79535-47bb-0310-9956-ffa450edef68"
963bda0093135c5db412c4a00099fecedf21e3ca,"Update XPathNamespaceImpl to be consistent with spec for
getLocalName, getPrefix, getNamespaceURI, getNodeName, getNodeValue


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336957 13f79535-47bb-0310-9956-ffa450edef68"
60f18a1dcda5e742e84ffb76c4a8f792f8c6f025,"Added two new documents: Extensions for XSLTC and XSLTC options in the
Process command line. Added the ""XSLTC Exts"" item to the main panel.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336958 13f79535-47bb-0310-9956-ffa450edef68"
846855b26c6db92a7b34a254db61e8780afbd310,"For Bugzilla 14237. Fix problems in the hour-in-day extension function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336959 13f79535-47bb-0310-9956-ffa450edef68"
399ff3051577ee1a7869fddb232865a16dab2abd,"Use actual length of array in call to arraycopy.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336962 13f79535-47bb-0310-9956-ffa450edef68"
2c1264104029e9477665565456012a5762fd088e,"Applying Gordon Chiu's (grchiu@ca.ibm.com) patch for bugzilla #14241.

Extra trailing 0 when calling XNumber.str().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336963 13f79535-47bb-0310-9956-ffa450edef68"
a44825f0f1e849ed950d54c9996b68e4acf18e81,"Fix a problem in the max() function. Reuse the Document object to reduce
memory usage.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336964 13f79535-47bb-0310-9956-ffa450edef68"
aa60042be3d229033f26930c5a7ab8e91ba567db,"xdocs update for XSLTC options in Process command line.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336965 13f79535-47bb-0310-9956-ffa450edef68"
0e2cdb3e5b9f54d423b69f60b9e0d88e48e9234e,"XSLTC xdocs update.
Remove xsltc_constraints.xml. Move the ""known problem"" and ""smart transformer
switch"" sections into xsltc_uage.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336972 13f79535-47bb-0310-9956-ffa450edef68"
cbcf38388b4c7023298628e157907de665572a5a,"Fix typo in faq.xml.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336973 13f79535-47bb-0310-9956-ffa450edef68"
586e26dc30781a2320127c59ab59b55edd225c0d,"For bugzilla 14324. Fix a few problems in datetime extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336974 13f79535-47bb-0310-9956-ffa450edef68"
be684f901c74413a8bcbdf155a2413bdc15f2449,"For bugzilla 14322. Fix problem in condition checking in getZoneStart().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336975 13f79535-47bb-0310-9956-ffa450edef68"
0455b3bc4e68059a7bda62332cd7c1be79034389,"Fix for Bugzilla 14229.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336976 13f79535-47bb-0310-9956-ffa450edef68"
e16dbbef8200bfc626e982ee4d05401d9ba5f999,"Committing Gordon Chiu's (grchiu@ca.ibm.com) patches for
namespace bugs #13774,13775,13414


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336977 13f79535-47bb-0310-9956-ffa450edef68"
d1e19d0b28b72636c888b3204306528023f8cf6e,"Minor improvement to the getAbsoluteURIFromRelative() and getAbsoluteURI()
interfaces. Reorganize the code to be more efficient. Return a slightly
better result when the input string is an invalid URI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336978 13f79535-47bb-0310-9956-ffa450edef68"
5229d827fe0c1e3eead6e0e98a7941992a52c06b,"For Bugzilla 14406. Make the interface getDTMIterator() public.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336979 13f79535-47bb-0310-9956-ffa450edef68"
264653fef5551f809aa95a7663db5823caefa410,"For Bugzilla 14406. Handle the side-effect that creating a DTMNodeList
will change the state of the iterator.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336980 13f79535-47bb-0310-9956-ffa450edef68"
0984d6cafaba3cdf0289f6d372c722867891a9c0,"Fix problems in the XSLTC redirect sample. This sample was copied from
xsltc_constraints.xml. It works with XSLTC, but not using a good syntax.
It is better to change ""xsl:version"" to ""version"" and add a ""extension-
element-prefixes"" attribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336983 13f79535-47bb-0310-9956-ffa450edef68"
50e21c977c03c88c7292c33562549da46e5b0256,"For bugzilla 14236. Add a new interface to pass the XPath
extension function up to Xalan.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336992 13f79535-47bb-0310-9956-ffa450edef68"
85e8d4113532a5cf5f39311b39fd5fa6bfa7a4dd,"For bugzilla 14236. Pass the XPath extension function object to the
extension provider.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336993 13f79535-47bb-0310-9956-ffa450edef68"
078246d63e1c24f64893f4db615d8dcaf6f38d29,"For bugzilla 14236 and 14244. Cleanup in the extension handling code to make
EXSLT func:function and func:result work correctly.

New interfaces are added in ExtensionProvider, ExtensionsTable and
ExtensionHandler to pass the XPath extension function up to the extension
handler. In the case of an EXSLT function, we need to find out the frame
size of the caller template and use that to reset the frame bottom of
the variable stack. This prevents the local variables in the callee
from overwriting the variables in the caller. Also change the way to
handle the return result of the function to fix the problem in 14244.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336994 13f79535-47bb-0310-9956-ffa450edef68"
76ff0ca620c91a1ea14579cd590cf72880df0b94,"Committing Gordon Chiu's (grchiu@ca.ibm.com) patches for bugzilla #14365, 14368.

Fixes for processing of last()  function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336995 13f79535-47bb-0310-9956-ffa450edef68"
ede9f05a24a15a818df320e2bd1ecba2eda26133,"Update links to GUMP output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@336997 13f79535-47bb-0310-9956-ffa450edef68"
fd6a6df8bbbb1edbdf8a0fa26b652ba3e60084c2,"Add ApplyXPathDOM sample to samples jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337002 13f79535-47bb-0310-9956-ffa450edef68"
9d3b1b9268aad305140f365bf938943bc840f9c3,"Code cleanup. Remove all the unnecessary imports.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337003 13f79535-47bb-0310-9956-ffa450edef68"
42684c21579825f8a17811786f8caeae11f526a6,"Forward namespace() event as startPrefixMapping() to the DOM builder. TODO:
additional logic is needed to emit the endPrefixMapping() event. This patch
fixes namespace141.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337005 13f79535-47bb-0310-9956-ffa450edef68"
a110a76731205b199530825cd1ab10fc2b3f3ee5,"In response to Simon Kitching's  (simon@ecnetwork.co.nz) bug report #14578, moved synchronized 
block from init method to static initializer to avoid race conditions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337010 13f79535-47bb-0310-9956-ffa450edef68"
b003b094b800106d1afca5e9555e4d0259349e00,"Committing Gordon Chiu's (grchiu@ca.ibm.com) patch for encoding issues
with serializer, samples and test harness. (Bugzilla #14753)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337012 13f79535-47bb-0310-9956-ffa450edef68"
a1eb1768e2eb9ac71a94a729a33d7d2732d6656e,"Fix possible thread contention issue by putting
a lock on the Document object before using it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337013 13f79535-47bb-0310-9956-ffa450edef68"
930d72acd66b70b274e4e344d733f998d5fe2efc,"Commit Ramesh Mandava's (ramesh.mandava@sun.com) patch to allow xalan to read
property files without opening upcontainer permissions when Xalan is used as
part of a secure container, such as J2EE RI.

The change makes use of the PrivilegedAction interface in JDK 1.2+. It was
written with JDK 1.1.8 compatibility in mind so that it will do the same
thing as before in JDK 1.1.8.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337014 13f79535-47bb-0310-9956-ffa450edef68"
f1de1f583249b8d1151a0f7e2cd403723acf40f7,"Changed the NodeSortRecord class to hold non-static references to
instances of java.text.Collator and java.util.Locale. Updated the
bytecode generation for NodeSortRecord subclasses to access the new
variables correctly. When a stylesheet specifies a different language
in xsl:sort, the protected references in NodeSortRecord will be
updated by the subclass' constructor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337021 13f79535-47bb-0310-9956-ffa450edef68"
9938cb297f5c5e836be49536ec22f4638b06af37,"Patch for bugzilla #14862.  When NodeSequence wraps a mutable nodeset
use the wrapped nodeset in getLength() method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337023 13f79535-47bb-0310-9956-ffa450edef68"
7ec1daa0f06dced0264f4f1d34c23bcf0f66d397,"The is a better patch for bugzilla #14862 and more consistent with code in xslt20 branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337024 13f79535-47bb-0310-9956-ffa450edef68"
86dbc38924c1a78e213e30c250b3dd8275261431,"Added deprecation comments for DefaultSAXOutputHandler and TextOutput.
 The class xsltc.runtime.output.TransletOutputHandlerFactory
 should be used instead. See xsltc.cmdline.Transform for an example.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337028 13f79535-47bb-0310-9956-ffa450edef68"
c9c1b6c9339d975d56cd33ff44972131ff59499d,"Updated sample to use non-deprecated API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337029 13f79535-47bb-0310-9956-ffa450edef68"
5631279e1bce5d58d27457a86cac7b500fe402fe,"Updated samples to use non-deprecated API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337030 13f79535-47bb-0310-9956-ffa450edef68"
3d7342c20928011d2d14d7340727cb7112f18f26,"Patch provided by W. Eliot Kimber to support user-defined collators. A
class implementing the org.apache.xalan.xsltc.CollatorFactory interface
can be specified from the command line by setting the property:

 org.apache.xalan.xsltc.COLLATOR_FACTORY

 The class org.apache.xalan.xsltc.dom.CollatorFactoryBase will be used
by default.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337032 13f79535-47bb-0310-9956-ffa450edef68"
88101479bb7e223cd28b2a6c6eebc8d11ee2a0db,"Performance fix

Move the call to newTemplateHandler() to be after DOMSource processing.
DOMSource creates another template handler in the processFromNode() method.
The newTemplateHandler() call initializes the schema, which is expensive.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337033 13f79535-47bb-0310-9956-ffa450edef68"
02a12a90412f9c3b9809f33a0ecabfeb0157e22a,"Performance fix

Reuse the node name in the preceding statement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337034 13f79535-47bb-0310-9956-ffa450edef68"
9950ebf45e078edb5405de95a4ac6c41bdc4f969,"Commit Gordon Chiu's (grchiu@ca.ibm.com) patch for performance improvement
in the Encodings class. The convertJava2MimeEncoding() and getLastPrintable()
methods can be called many times. The old code walks through a big array and
do String comparison to find a match. A Hashtable is now used to speed up
this processing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337035 13f79535-47bb-0310-9956-ffa450edef68"
9b2c960c417ae5a76f16b4e40200d2e5db694817,"For Bugzilla 15074. Return a java Boolean type object in object(),
so that it can be recognized by extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337038 13f79535-47bb-0310-9956-ffa450edef68"
5ee54a2a4d7e722d421d5e239c03a27c8039c3ba,"Patch for Bugzilla 15094. Fixed method to compute limit in a Descendant
iterator; old method was (very) buggy.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337039 13f79535-47bb-0310-9956-ffa450edef68"
9be67d58c4abe1b9751976eab56a94e93ae49edc,"Commit the patch from Arun Yadav(arun.yadav@sun.com) to fix Bugzilla 15089.
Don't add the func:result element to the variable table because it does not have
a name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337040 13f79535-47bb-0310-9956-ffa450edef68"
12c292e47c7dd6a26259c08c5635783206a8740e,"Fix the memory leak problem in Bug 6075.

In the detach() method, null out the fields in the iterators that will
be reassigned a value upon the next usage. This change fixes the problem
that the iterators in the IteratorPool can indirectly reference the
TransformerImpl object.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337042 13f79535-47bb-0310-9956-ffa450edef68"
41534671c37df2cb157d4bd24ad5eed7c288b2f7,"Patch for bugzilla 14965, with tweak from Art W (art_w@eastpoint.com).

Handle empty comment case.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337046 13f79535-47bb-0310-9956-ffa450edef68"
47de8701c0612e21c6a64fd5cc8f670d1b12ef66,"Patch for bugzilla 15254.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337051 13f79535-47bb-0310-9956-ffa450edef68"
c55be337102153af2ae3abdc503381aeef7a5cd2,"Applying Arun Yadav's (arun.yadav@sun.com) patch for bugzilla #15218.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337052 13f79535-47bb-0310-9956-ffa450edef68"
53a1d0b4a17764941dede54087ee64b93f361a76,"Just tidying up the javadoc in the previousNode and nextNode methods
and making sure we're testing against DTM.NULL instead of -1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337054 13f79535-47bb-0310-9956-ffa450edef68"
fab7c233e7ad25bacbd6392b13b114e095c6d989,"Changes:

 - Fixed matching problem reported by Ivelin Ivanov (Cocoon).
 - Added support for namespaces when output is HTML.
 - Set new version of XSLTC to be 1.4.0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337066 13f79535-47bb-0310-9956-ffa450edef68"
87ea727e153081087e50ab902245a7a8f9f3c143,"Fixing encodings issues with samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337067 13f79535-47bb-0310-9956-ffa450edef68"
73dbb4b0a8a69cfa831a31ecb17fc63d391c2007,"Migrating an improvement in memory usage from the XSLTC_DTM branch:

Reduced the initial sizes of SuballocatedIntVectors used for m_dtmIdent and
namespace management.  In both cases default size SuballocatedIntVectors were
being used, which entails a block size of 2048.  For m_dtmIdent, that value
would only overflow into a second block for a document with 2048*65536 nodes.
Using a smaller size improves DTM build time for smaller documents, without
penalizing most larger documents.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337068 13f79535-47bb-0310-9956-ffa450edef68"
2a71d6d52daaa15f60471fd869c53e88073bab6a,"Patch for bugzilla 4858.

Reduces SAX2DTM memory usage by dropping m_locator after parsing is complete. Value of m_locator.getSystemId() is cached.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337072 13f79535-47bb-0310-9956-ffa450edef68"
a1675e8e74e739cf5f5734dde8fe8e12f2579fa6,"Fixed spelling mistake for DEFINITELYWRITABLE


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337077 13f79535-47bb-0310-9956-ffa450edef68"
8d0cb9b7f7d8d17eb2995bc359bbcd493f232829,"Fixed handling of Node text when an Element Node is selected
Code provided by art_w@EASTPOINT.COM


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337078 13f79535-47bb-0310-9956-ffa450edef68"
bdfbba806c0a69086a0089556238d02b431535b4,"Added in missing code for disable pool
Code provided by art_w@EASTPOINT.COM


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337079 13f79535-47bb-0310-9956-ffa450edef68"
effe5c7f29d95be5ddfa446e7fc2878892bf683f,"Fixed minor bug with for loop in getNodeData. Removed
direct access to child node array


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337081 13f79535-47bb-0310-9956-ffa450edef68"
5eda32624151ad4c40a709267fcc1068d0142e3a,"Fixed createConnection method for JDK1.4
Tested with 1.4.1


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337082 13f79535-47bb-0310-9956-ffa450edef68"
f959cb7badfbce4d2032b6e4c13a7cec52286a23,"For Bugzilla 15373. Change the execute() method to always return a XString
object. Also change the type to CLASS_STRING.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337090 13f79535-47bb-0310-9956-ffa450edef68"
b9460560cff8bd34c925f0d9e5876d9bcd007b2e,"Patch for bugzilla 14300.

Corrected algorithm for converting strings to numbers as it was failing on very large or very small numbers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337095 13f79535-47bb-0310-9956-ffa450edef68"
e8efffec7c9dcedfff4005a8433b639247888bc8,"Changes from Ramesh Mandava (Ramesh.Mandava@sun.com) to move to using
ListResourceBundles for Xalan-J Interpretive messages, along with localized
versions of those messages.

In addition, message keys are now meaningful strings, rather than numeric.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337098 13f79535-47bb-0310-9956-ffa450edef68"
3bfb042fddf245234ce8c5593d9f81a7e1b1f822,"Committing Gordon Chiu's patch for bugzilla #6157.  Multiple xsl:output
statements should now be merged correctly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337101 13f79535-47bb-0310-9956-ffa450edef68"
835a90f7153e614e2779fee89c503a89901da0c6,"Small cleanup regarding bugzilla 6157.

Removed m_propertiesLevels field as it's no longer required.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337103 13f79535-47bb-0310-9956-ffa450edef68"
4f556e214cbef5c1ca375782898547748b683d81,"Fixing mispellings in xsltc_performance.xml (bugzilla 15591).
Changes will appear when the site is re-generated.

Mispellings originally reported by Rob Tougher (robt@robtougher.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337105 13f79535-47bb-0310-9956-ffa450edef68"
c62f7e0dde249b0a6ac144de86e15a0671d75dda,"Committing changes in response to bugzilla #12481.  

Before this commit,  DTMManager.newInstance cached the found class
in the cases where the class was identified in jaxp.properties or the class path.

There were some problems with this:

1. It was not thread-safe because access to the static field foundFactory was
    not synchronized.

2. We weren't caching the class when we defaulted to the fallback class (this
    was the original issue in the bug report.)

3.  We weren't using the AccessController class available in JDK1.2 to control
   acess to priviliged resources (eg. system properties, files).

4. DTMManager would never be specified in jaxp.properties because it's
    not part of the JAXP specification.

5.  We aren't using context class loaders.

So, I have made the following changes:

1. Taken the FactoryFinder, SecuritySupport and SecuritySupport12 classes
from the JAXP subdirectories (in xml-commons) and used them as the basis 
for the lookup of the DTMManager class.  This gives us the AccessController
code.

2.  Removed the context class loader support and added a cache for
    the found class (which gets used if the system property is not set.)   
    If we want context class loader support in the future (which we probably) 
   do, then we will need to revisit this to see if caching the class loader and the
   class would work.  

3.  Synchronized access to the found class.

4.  Instead of looking in jaxp.properties, look in xalan.properties (a xalan
     specific configuration file) which can be placed in <$JAVA_HOME>/jre/lib.

Possible issues:

1. In general, using a cache means that the class will not change, 
    regardless of changes to xalan.properties or the class loader.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337107 13f79535-47bb-0310-9956-ffa450edef68"
226bdedf9a6e959bb92b621bee8355906c6c244f,"DTM Separation -- New message files
Move the error messages used by DTM classes from Xalan and XPath
down to org.apache.xml.res. Created XMLErrorResources files for
all locales. The XMLMessages class is introduced to handle error
resources at this level. If a DTM interface needs to issue an error
message, it will use the new XMLMessages class rather than the
XSLMessages class in org.apache.xalan.res.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337115 13f79535-47bb-0310-9956-ffa450edef68"
9cd8948e6e77cd134baa453c615155537fc7e14f,"DTM Separation - new files in org.apache.xml.utils
Move the classes DOMOrder, DOMHelper and DOM2Helper from XPath to xml.utils.
Add a new Constants class to hold the constants used by XPath.
The ThreadControllerWrapper class is a container for the nested class
ThreadController which was originally in org.apache.xalan.transformer.TransformerImpl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337116 13f79535-47bb-0310-9956-ffa450edef68"
b8535aab90f53557026b4cc2ea5220c402d57322,"DTM Separation -- patches for files under org.apache.xml
1. Replace all invocations of XSLMessages.createMessage() by
XMLMessages.createXMLMessage().

2. Replace XSLTErrorResources by XMLErrorResources.

3. In IncrementalSAXSource_Filter, use ThreadControllerWrapper.runThread()
rather than calling TransformerImpl.runTransformThread().

4. In SAX2DTM, use a setter method to set the source location property.
Remove the field access to org.apache.xalan.processor.TransformerFactoryImpl.m_source_location.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337117 13f79535-47bb-0310-9956-ffa450edef68"
3faafca6653ff8d2332c22646159e4aae0dc2483,"DTM Separation - remove old files in XPath
DOMOrder, DOMHelper and DOM2Helper are now in org.apache.xml.utils.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337118 13f79535-47bb-0310-9956-ffa450edef68"
a5edaa05b1eb2b49954452e8ed8fce3586f3e3bd,"DTM Separation -- changes in org.apache.xpath
1. Change the import path for DOMHelper and DOM2Helper
2. Move 8 errror messages from XPATHErrorResources to XMLErrorResources
3. Create a new XPATHMessages class to handle error resources at
the XPath level.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337119 13f79535-47bb-0310-9956-ffa450edef68"
8b716b45ad215ee2dbb91218fbaed79fb282473b,"DTM Separation -- changes in org.apache.xalan
1. Change the paths to DOMHelper and DOM2Helper
2. Remove the m_XSLMessages field from a few classes.
Use the static methods instead.
3. In TransformerFactoryImpl, whenever the source location attribute
is set, call the setter method in SAX2DTM to set the same attribute.
4. XSLMessages now extends from XPATHMessages. The common interfaces
are moved to XMLMessages.
5. Move 53 error messages from XSLTErrorResources to XMLErrorResources.
6. Move some of the constants from org.apache.xalan.templates.Constants
to org.apache.xml.utils.Constants.
7. Move the nested class ThreadControler in TransformerImpl to
org.apache.xml.utils.ThreadControllerWrapper.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337121 13f79535-47bb-0310-9956-ffa450edef68"
8f4f99d376ef24b94a949f0238fe70160c6b910d,"Updating license in some samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337122 13f79535-47bb-0310-9956-ffa450edef68"
a2319143f2ef2516adbbe8a491af755666a29388,"Correction to the message number.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337125 13f79535-47bb-0310-9956-ffa450edef68"
449cd80464f91bd61a74b290408f59f48d7e05e3,"For Bugzilla 16386. Add rules for object type matching.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337132 13f79535-47bb-0310-9956-ffa450edef68"
5d7a20032bd8de53b98cf718708c865af4a10d89,"Fix for Bugzilla bug 10053.  Before, a blank was emitted for any chunk that
began with whitespace after non-whitespace characters had been seen.  Also made
some performance improvements to sendNormalizedSAXcharacters.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337136 13f79535-47bb-0310-9956-ffa450edef68"
af629bfc8369a50bb6693b51b016598201a09545,"Commit the patch from Sarah Mcnamara (mcnamara@ca.ibm.com) to remove
the compat target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337137 13f79535-47bb-0310-9956-ffa450edef68"
552d187cc22c0261763fc35c383e9ae34c4599fa,"Committing xml-apis bin and source based off new tck-jaxp-1_2_0 branch 
of xml-commons.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337142 13f79535-47bb-0310-9956-ffa450edef68"
b161eff8bbb1a7b8cc1a294938aa982817a8ced5,"Commit the copyright patches from Sarah Mcnamara (mcnamara@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337144 13f79535-47bb-0310-9956-ffa450edef68"
bcd41fedfae9fd8872d5d37ec47bc363f52c8341,"Changes to minimize set of classes imported.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337156 13f79535-47bb-0310-9956-ffa450edef68"
0c04a29d76d9647282550542b6ad87c161746961,"Added support for distinguishing between active and past developers.  The
latter will have an attribute on the ""person"" tag named ""status"" whose value
equals ""emeritus"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337158 13f79535-47bb-0310-9956-ffa450edef68"
25696193c6b65dde94d6923e9c449ae213e07fb0,"Changed two developers to have 'emeritus' status.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337161 13f79535-47bb-0310-9956-ffa450edef68"
26cbf57b5de8caada45088b658ebed86ef83736d,"Patch from Sarah Mcnamara (mcnamara@ca.ibm.com) to remove
unused imports in samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337163 13f79535-47bb-0310-9956-ffa450edef68"
dc8c732088dfcb9eb8351e4f00644c253d5d4168,"Patch from Sarah Mcnamara (mcnamara@ca.ibm.com) to remove
unused imports in java source.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337166 13f79535-47bb-0310-9956-ffa450edef68"
ed3c641be173aaa0d90407c044ce9dee39affb23,"Check in new XercesImpl (2.3.0 + patch).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337168 13f79535-47bb-0310-9956-ffa450edef68"
6eb66abcca517283b1eeeff9d7527d76542fed3f,"Removed current project name from list of past developers, as it might not be
pertinent.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337173 13f79535-47bb-0310-9956-ffa450edef68"
8290a22d2c6556c36bd42205ffae9cad8ee0f592,"Committing a patch contributed by Prakash Sridharan (psridharan@selectica.com).
Messages displayed using xsl:message are now reported to an ErrorListener
registered in a Transformer instance. The warning() callback is used for
this purpose.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337174 13f79535-47bb-0310-9956-ffa450edef68"
53e737fa583297c6072b6e2e068bdfdf071c0f40,"Committing patch for bugzilla #16222.  Thanks to Elson Jiang (elsoncj@ca.ibm.com)
for identifying the problem and isolating the cause.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337175 13f79535-47bb-0310-9956-ffa450edef68"
efa62b04d0549c36dce08ef7a0e91acca48c154c,"Committing Elson Jiang's (elsoncj@ca.ibm.com) patch for bugzilla #5140.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337177 13f79535-47bb-0310-9956-ffa450edef68"
7cd1cc636df87151c04f08eaddcb24ad9155f6d2,"Add a new attribute ""use-classpath"" to the XSLTC Trax API.
If this attribute is set, the Templates object is created from a translet
which is loaded from the CLASSPATH. The translet name is either set by
the ""translet_name"" attribute, or derived from the system ID, or the
default name. In TemplatesImpl, we add a new constructor to support
creating a TemplatesImpl from a Translet instance.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337180 13f79535-47bb-0310-9956-ffa450edef68"
0d4ef5c68263c069a9ff5667b50ff7084ee45f25,"Updates to the FAQ for bugzilla#15586 and #14856


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337181 13f79535-47bb-0310-9956-ffa450edef68"
4f77eca759f73fa0e68a524d4fea1bd94f8be156,"Add missing import.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337182 13f79535-47bb-0310-9956-ffa450edef68"
5102b08e8dc61a15bdf5abf6b5bf0ea49427e19f,"The behaviour of the Xerces-J parser recently changed to agree with its
documented behaviour with respect to the dynamic validation feature.  This
causes problems for stylesheets that contain a DTD, but are not otherwise
""valid"" - for instance, because the DTD contains ENTITY declarations, but no
ELEMENT declarations - because error reporting is performed for documents if
the dynamic validation feature is enabled and the document contains a DOCTYPE
declaration.

The solution is to remove code (including code that was commented out) that
enabled the Xerces dynamic validation feature.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337187 13f79535-47bb-0310-9956-ffa450edef68"
5abae70a69b272963cf636b37ff03b09d2f90f05,"Updating xml-apis.jar and source.  A security exception wasn't being
handled when reading java.home from system properties.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337192 13f79535-47bb-0310-9956-ffa450edef68"
c85039cdcb973cfde80caa92b58481eb5bb814dc,"xdocs update
In samples.xml, update the documentation for the ApplyXSLT sample to provide
more information about the input xml and stylesheet.
In extensions.xml, add documentation for the src attribute in xalan:script.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337210 13f79535-47bb-0310-9956-ffa450edef68"
26746cdd1549b572cb86e987ebc45a0dce6eb6f1,"Committing patch for Bugzilla 10626 contributed by Arun Yadav
(Arun.Yadav@sun.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337220 13f79535-47bb-0310-9956-ffa450edef68"
650d589e772deafbd7ea76f08c5d3551c36d5f4b,"Wrapped called to Stylesheet.translate() with class-level synchronization
 block. This is needed since BCEL is not thread-safe. The bug was reported
 by Michael Melhem (Cocoon).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337228 13f79535-47bb-0310-9956-ffa450edef68"
669da09461a99bfee3c46f3620010c95dd00bec2,"Applying patch for Bugzilla bug 16745 from Igor Hersht (igorh@ca.ibm.com).

The code generated for a reference to generate-id with no arguments used to
default to the current node.  XSLT requires it to default to the context node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337232 13f79535-47bb-0310-9956-ffa450edef68"
88d53b592e53d9c31bdef1d4c32712e3dd70e4ef,"Checking Axis back in on main branch


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337255 13f79535-47bb-0310-9956-ffa450edef68"
0799324e880d5520e5bd5ff18c7f4296b122216e,"Patching Prakash's patch (of Feb.3, 2003).  We can't assume that _translet
is non-null when the call to setErrorListener is made.  For example, we could
have the lines of code:

Transformer transformer = new Transformer();
transformer.setErrorListener(myErrorListener);

The original patch caused TCK failures.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337261 13f79535-47bb-0310-9956-ffa450edef68"
b3c3849047d82ad09292a0346df47cdf8b4b2236,"Patch for bugzilla #17030.  The command line (Process) uses the
bootstrap classloader (in JDK1.4) instead of the system class loader to 
load classes specified by the URIResolver, EntityResolver and 
ContentHandler options.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337270 13f79535-47bb-0310-9956-ffa450edef68"
7a745fd285d0d76c3139b10abac3f22bf906baa8,"Committing Christine Li's (jycli@ca.ibm.com) patch to the servlet sample.
Bugzilla #17136


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337275 13f79535-47bb-0310-9956-ffa450edef68"
1d37740cc7171438b505c672aa4056029ab43ac7,"Committing Christine Li's (jycli@ca.ibm.com) patch to the servlet sample documentation.
Bugzilla #17136


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337276 13f79535-47bb-0310-9956-ffa450edef68"
7432d6d2e47d720d45aa68887306bbeb0eb04759,"Committing Christine Li's (jycli@ca.ibm.com) patch to the build script for the servlet sample.
Bugzilla #17136


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337277 13f79535-47bb-0310-9956-ffa450edef68"
220428aa04e23e9ca5b0d66ad36b1b1bd4477d45,"Minor change to build script for updated servlet sample.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337278 13f79535-47bb-0310-9956-ffa450edef68"
e6699e471e3edf2e1497b6e50ce0165dc2f0828c,"New implementation of xsl:message that does not use RTFs. Using RTFs
 is both slow and problematic since the number of RTFs that can be
 created is limited in XSLTC.

 The new implementation uses a StreamXMLOutput and a StringWriter to
 output the template body as a string (in some cases, NS declarations
 will be included and this behavior differs from the old implementation).
 Additionally, the new implementation optimizes the case where the
 message is empty and where the message is just a literal string.

 The bug was reported by Mark Brunkhart (mark@matchanalysis.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337280 13f79535-47bb-0310-9956-ffa450edef68"
d78cfd5dfe81f2c0ad0a5742057223e3054d120e,"Removed the getTreeString() method from the DOM interface (as well as
 from all the classes that implement this interface). This update will
 require a sync with the XSLTC_DTM branch, but there was no point in
 keeping this method when it's no longer used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337281 13f79535-47bb-0310-9956-ffa450edef68"
f591f18743b66ac0f21fe6cd647e30ce70f3fc52,"Applying Sarah McNamara's (mcnamara@ca.ibm.com) patch for bugzilla #6285.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337282 13f79535-47bb-0310-9956-ffa450edef68"
014dda61e8bcbf4c5ebd1b27e4e22f5ab5ebd98c,"Applying Sarah McNamara's (mcnamara@ca.ibm.com) documentation patch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337283 13f79535-47bb-0310-9956-ffa450edef68"
549ad49d8f88916620f43494608e77bad5a24299,"One more file needed for Sarah's doc updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337285 13f79535-47bb-0310-9956-ffa450edef68"
41fa416deefa8e671be84dff14f7487443e851c0,"More doc changes from Sarah McNamara (mcnamara@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337286 13f79535-47bb-0310-9956-ffa450edef68"
73f683d1e8e1bb7ed5bb58fee086c47ced25cb9f,"Update to latest version of xml-apis.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337288 13f79535-47bb-0310-9956-ffa450edef68"
7a57729197797cf992fd71a8b574ee875930a638,"Fix for Bugzilla 17447. Conversion from reference type to string type
 assumed the existence of the ""current"" local variable, which is
 unavailable at top-level.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337291 13f79535-47bb-0310-9956-ffa450edef68"
85201a8efce84a0237d4b17edfa2340aaaf5a240,"More sample and documentation updates from Christine Li (jycli@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337296 13f79535-47bb-0310-9956-ffa450edef68"
2db244cb1bb24bc2bafad3b12067c2b2c8d8eec7,"Add a getTransformer() interface to TrAXFilter. This is a user requested
feature. This interface can be used by the UseXMLFilters samples to
set the output properties correctly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337297 13f79535-47bb-0310-9956-ffa450edef68"
e6cc7bceac4e0cf0adc39c435c4ef537d44bf5de,"Patches for samples from Christine Li (jycli@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337300 13f79535-47bb-0310-9956-ffa450edef68"
5b70b6f5a28ad2d0033dd06ee11df9826cb36c08,"Updates for XalanJ 2.5D1 release, from Sarah McNamara (mcnamara@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337303 13f79535-47bb-0310-9956-ffa450edef68"
51dc97d4055fb442efef9f9989da1dfccc24e42a,"Applying patch for bug 15332 from Igor Hersht (igorh@ca.ibm.com).  Ensure that
patterns of the form processing-instruction() and processing-instruction('name')
are given the right priorities.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337335 13f79535-47bb-0310-9956-ffa450edef68"
c42c922482d9d6917f6f68226713a55c41d3e989,"Override definition of Type.POP() in VoidType to return NOP instead of POP.
 If type is void, there's nothing to be popped. This problem shows up when
 invoking an external Java function whose return type is void.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337339 13f79535-47bb-0310-9956-ffa450edef68"
d4dd75e26ff58a0d3806658ceaa5262adac1aec6,"Changed XSLTC messages to extend ListResourceBundle, and use String keys to
access messages.  Code used to extend ResourceBundle and used to use integer
indices to access error messages.

Changes from myself and Gordon Chiu (grchiu@uwaterloo.ca).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337340 13f79535-47bb-0310-9956-ffa450edef68"
68bef332ecbe2ccc11d767b6a9daa4865682d705,"Oops! Old bug, just noticed -- we forgot to override RootTraverser's typed first().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337344 13f79535-47bb-0310-9956-ffa450edef68"
e55b22ea1cba586fcf0e02ce7e034b48ef8e1ded,"The generated code for xsl:decimal-format used the no argument constructor of
DecimalFormatSymbols, which is affected by the default locale.  The default
attribute values for xsl:decimal-format should not be affected by the default
locale.  Instead, the en_US Locale should be passed to the constructor, as it
has settings that are consistent with the defaults for xsl:decimal-format.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337345 13f79535-47bb-0310-9956-ffa450edef68"
4334bf828f03b417c915192c455382c5e6e7edca,"Fix for Bugzilla 18162. Warnings are still reported if an occurrence of
 xsl:attribute *may* result in a runtime error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337355 13f79535-47bb-0310-9956-ffa450edef68"
a2b8861fa97ccd7818bdbd52e69405db7287781e,"Committing Christine Li's (jycli@ca.ibm.com) patch for bugzilla #18210.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337356 13f79535-47bb-0310-9956-ffa450edef68"
ba11e1887923307edf53ca2baee1ca933ae93335,"Committing patch by Arun Yadav (Arun.Yadav@sun.com) that fixes the problem
of using ""."" or ""-"" as part of the name of a parameter (Bugzilla 15636).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337360 13f79535-47bb-0310-9956-ffa450edef68"
4b4d3d685b176c4b38898b4c37a2fe2a5ef53a66,"Committing patch from Arun Yadav (arun.yadav@sun.com) for Bugzilla
 15830. Correct handling for id()/key() values of type result-tree.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337361 13f79535-47bb-0310-9956-ffa450edef68"
e068dc313151f5a7654588f548b2468e1ff11efa,"New implementation for TemplatesHandlerImpl that does not extend
 xsltc.compiler.Parser. The new implementation has a simpler init()
 method. Also, instances of the new class can be re-used (previously,
 there were problems with the output method when an instance was
 used more than once).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337367 13f79535-47bb-0310-9956-ffa450edef68"
885a9466c138d14938ec5d0af0ab7c2328fb1f9a,"Remove XSLTC's compile time dependency on Xalan.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337368 13f79535-47bb-0310-9956-ffa450edef68"
0c0f9fa2bc33b821a31729120e7481c691e6db7b,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xml.dtm.ref.sax2dtm.
Add new file SAX2DTM2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337374 13f79535-47bb-0310-9956-ffa450edef68"
a33569fd081362226c801adb9b79ce60972dd530,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xml.dtm.ref.dom2dtm.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337375 13f79535-47bb-0310-9956-ffa450edef68"
e2aaf1c0cf1d07a12e03273f72c206cb123f976f,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xml.dtm.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337376 13f79535-47bb-0310-9956-ffa450edef68"
8b96b0768647f3ef3cf16ac7b00da8ce55acbe6b,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xml.dtm.ref.

Add new files:
DTMAxisIterNodeList.java
DTMChildIterNodeList.java
DTMNodeListBase.java
ExtendedType.java


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337377 13f79535-47bb-0310-9956-ffa450edef68"
87f53af8d9b4e46904a18dea7e9692b2de5981ee,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xml.res.

Add new messages for common serializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337378 13f79535-47bb-0310-9956-ffa450edef68"
13af4b83c5a2e4e12054a6e2f0c35b5729de78ba,"Merging XSLTC_DTM and common serializer to the head

Add new serializer classes under package org.apache.xml.serializer.

Log from Brian Minchau (minchau@ca.ibm.com):

In the past Xalan-J interpretive (Xalan) and XSLTC both implemented their own
serialization stages.  Much of the code provides the same functionality.
In order to improve the maintainability of the code, and to eliminate any
functional differences, these two serializers are now merged in the
org.apache.xml.serializer package.

The best performing features of both have been used.  The class hierarchy
of serializers used by XSLTC is re-used for this reason. At the highest
level the serializer classes split based on whether the output of the
serializer is a ""Stream"" or whether it is a ""SAX"" handler.  After that
both major branches split based on the output type (e.g. XML, HTML or TEXT).

The external user interface of the old Xalan serializer has been kept.
Other classes and interfaces have been absorbed into the serializer
package to keep it independent of both Xalan and XSLTC. The primary
interface, SerializationHandler, accepts SAX and SAX-like calls, but
it also absorbs other interfaces from the old Xalan serializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337379 13f79535-47bb-0310-9956-ffa450edef68"
d6a1f8e4cd1dc9f0ccd7bffecee4d2cac72fb6c0,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xml.utils.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337380 13f79535-47bb-0310-9956-ffa450edef68"
0b4b8b8762a882c13782f4c58a01bea048564723,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337381 13f79535-47bb-0310-9956-ffa450edef68"
5021b84418e284395184faab6e4929faf596e061,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.lib.

1. Change the return types of some date-time extension functions
for support in XSLTC.

2. Changes for the new serializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337382 13f79535-47bb-0310-9956-ffa450edef68"
8b625c0085fe4f1bb1d7c673022bccd109e9d333,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.processor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337383 13f79535-47bb-0310-9956-ffa450edef68"
12afd886fcb211685e67788ed6db9271882a4094,"Merging XSLTC_DTM and common serializer to the head

Remove old serializer classes under org.apache.xalan.serialize.
The new serializer files are now in org.apache.xml.serializer.
Add new file SerializerUtils.java.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337384 13f79535-47bb-0310-9956-ffa450edef68"
f522b87080c04586bbfadd39b8de51ef401bb51c,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.templates.
Replace ResultTreeHandler with SerializationHandler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337385 13f79535-47bb-0310-9956-ffa450edef68"
617567d95f4f0bc899209d7628922b877833ef62,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.trace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337386 13f79535-47bb-0310-9956-ffa450edef68"
8083121e5161bbbd9b913665d498440121a2e28d,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.transformer for the new serializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337387 13f79535-47bb-0310-9956-ffa450edef68"
2542a83924996971158b64c75af71c0d4872f1dc,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.xsltc.cmdline.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337388 13f79535-47bb-0310-9956-ffa450edef68"
5c288708e3c17def1c7a3da06bcfddeae918e873,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.xsltc.

1. Remove TransletOutputHandler.java
2. Adapt the XSLTC interfaces to the DTM model.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337389 13f79535-47bb-0310-9956-ffa450edef68"
1e8fa6befdd89f3b3ab9b1d5d2560da746e51c15,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.xsltc.util.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337390 13f79535-47bb-0310-9956-ffa450edef68"
fd532cf8b972e103732bcaa658e2b6756df38749,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.xsltc.compiler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337391 13f79535-47bb-0310-9956-ffa450edef68"
b10916c60819004f2b97d8db9f39002647ac0717,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.xsltc.compiler.util.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337392 13f79535-47bb-0310-9956-ffa450edef68"
4889736a31498296b5be83a57325d1e68ea8381f,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.xsltc.trax.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337393 13f79535-47bb-0310-9956-ffa450edef68"
13bbda5d6b26d6d0c40ed1af6b08328543be70fb,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.xsltc.runtime.output

Remove the output classes in XSLTC. XSLTC now uses the
output classes in the common serializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337394 13f79535-47bb-0310-9956-ffa450edef68"
10e9098ae96364e9c92ae2fbc360034d67d1acee,"Merging XSLTC_DTM and common serializer to the head

Changes in org.apache.xalan.xsltc.runtime.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337395 13f79535-47bb-0310-9956-ffa450edef68"
38b3e3894265117b5b402b9d4ba00a554b37805a,"Merging XSLTC_DTM and common serializer to the head

Adapt all dom classes in org.apache.xalan.xsltc.dom to
the DTM model.

Removed DOMImpl, DTDMonitor.
Added a few new classes for the new DOM model. The core
DOM class is SAXImpl.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337396 13f79535-47bb-0310-9956-ffa450edef68"
530e05fbeb4c7ca61a2e350182079caa44e9889f,"Merging XSLTC_DTM and common serializer to the head

Update build.xml and xsltc_todo.xml.

Now the default build target is a big xalan.jar which
includes both Xalan-J Interpretive and XSLTC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337397 13f79535-47bb-0310-9956-ffa450edef68"
9d5e97bc75a5cb5b1e541b2982b46461bebcfa4b,"Merging XSLTC_DTM and common serializer to the head

Update MANIFEST.MF to include information about
xsltc and its support jars.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337398 13f79535-47bb-0310-9956-ffa450edef68"
6e3766b6dc14502c0ce1727a2645d7e736aec47c,"Updating to Xerces-J 2.4.0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337399 13f79535-47bb-0310-9956-ffa450edef68"
582719c00dbdbdce83d0e73921c626451c3d9534,"Merging XSLTC_DTM and common serializer to the head

Update spec version for XSLTC in MANIFEST.MF


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337400 13f79535-47bb-0310-9956-ffa450edef68"
6dfc217e1d25ec5fca5a1b8bd9bffdcbddfdc917,"Merging XSLTC_DTM and common serializer to the head

Cleanup in HTMLEntities.res and XMLEntities.res


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337401 13f79535-47bb-0310-9956-ffa450edef68"
7a7fbbc527738174da4a6f5cc6695b6800827034,"Merging XSLTC_DTM and common serializer to the head

Re-add  HTMLEntities.res and  XMLEntities.res


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337402 13f79535-47bb-0310-9956-ffa450edef68"
cc8a337928f39dfdf67c7e8c5eb12eeb44d54116,"Merging XSLTC_DTM and common serializer to the head

Update in the samples
1. Changes from Henry Zongaro (zongaro@ca.ibm.com) in the
XSLTC samples. Use TrAX API instead of native API.
2. Changes from Brian Minchau (minchau@ca.ibm.com) to use
the new serializer classes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337403 13f79535-47bb-0310-9956-ffa450edef68"
85990a8d272fd24a487a58e795b8959300288f3d,"Merging XSLTC_DTM and common serializer to the head

Add new sample files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337404 13f79535-47bb-0310-9956-ffa450edef68"
3c0d76bec7040d30a0a24ba8617fd95962297a3f,"Merging XSLTC_DTM and common serializer to the head

Update in java/xdocs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337405 13f79535-47bb-0310-9956-ffa450edef68"
dee7d0b7645cebc8c9788cb7cf602fe8aa36e06f,"If there is an error listener registered to a TransformerFactory, and the
stylesheet cannot be compiled, call fatalError, in addition to throwing 
the TransformerConfigurationException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337406 13f79535-47bb-0310-9956-ffa450edef68"
861da436717f6059b285294325496b03f0785906,"Commit patch for bug 12797 from Arun Yadav (arun.yadav@sun.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337407 13f79535-47bb-0310-9956-ffa450edef68"
0def119382c4b686c1a61e9d8b7519938b87a73e,"Javadocs updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337408 13f79535-47bb-0310-9956-ffa450edef68"
5ed5ab0d602066e6d0d75ffbaaa158626d3c55c5,"Update comments for DTMDefaultBase.ROOTNODE.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337409 13f79535-47bb-0310-9956-ffa450edef68"
1b07b37846223722e57d2b72ec04ebfb5a1ee365,"Added a new ""fulldist"" target.  It builds a distribution that includes Xalan-J
components that depend upon non-standard components that aren't part of the
Xalan-J repository.  In particular, xsltcbrazil.jar is built under the
""fulldist"" target, but not under the ordinary ""dist"" target.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337410 13f79535-47bb-0310-9956-ffa450edef68"
22dc9c9bc4ed6a77e1692c9d1131773eeeefc02d,"Replace Vector.add() by Vector.addElement() because the first method
is not in JDK 1.1.8.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337411 13f79535-47bb-0310-9956-ffa450edef68"
514f1ee40d783671dc2206a6b24fd4c49ed0c084,"According to spec http://www.w3.org/1999/11/REC-xslt-19991116-errata/#E27,
when element nodes are used in the instantiated content of attribute, comment
and processing instructions, we should ignore the elements together with
their content.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337412 13f79535-47bb-0310-9956-ffa450edef68"
95054411dd6f2378403eba350f5553ecdf3c7147,"Instead of setting a default baseURI in newTemplates, append a dummy string
to the default used in the TreeWalker constructors.  This solves the problem
of violating the SourceLocator.getSystemId API which should return null
if if no systemId was set, while allowing relative URI's to be resolved when
the source is a DOM and no systemID has been set.  Relative URI's are already 
resolved correctly for other source types.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337413 13f79535-47bb-0310-9956-ffa450edef68"
65b25cdffe6e7c904d38f3f69500271c38437de0,"Patch from Christine Li (jycli@ca.ibm.com).  Reworked applet code so that the
init method creates a thread to which it delegates all the work of creating
Transformers and performing transformations.

Xalan needs all of its classes to be loaded with respect to the same class
loader.  The thread that's created will have the context class loader, if any,
that is in effect when the applet's init method is called, but calls to other
methods on the applet might not have the same context class loader.  Using a
thread avoids any problems that might arise from such a situation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337414 13f79535-47bb-0310-9956-ffa450edef68"
84b723f712033baf1fce4c3f9771e3e911016575,"Patch from Christine Li (jycli@ca.ibm.com).  Changed CharInfo so that it allows
descriptions of entities to be specified as a properties file in addition to a
Xalan-specific resource file format.

The code previously always assumed a Xalan-specific resource file format, for
both user-supplied descriptions of entities, and for those supplied with
Xalan-J.  The security restrictions of applets are such that an applet that
relies on a copy of Xalan-J in the Java run-time would find that Xalan-J would
be unable to read the default entities file that is packaged with the JRE on
the applet's behalf - it can only do so with a properties, via ResourceBundle.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337415 13f79535-47bb-0310-9956-ffa450edef68"
587527416ebf3c4cd3aeb0ac603b522e30d78645,"Patch from Christine Li (jycli@ca.ibm.com).  Changed CharInfo so that it allows
descriptions of entities to be specified as a properties file in addition to a
Xalan-specific resource file format.

The code previously always assumed a Xalan-specific resource file format, for
both user-supplied descriptions of entities, and for those supplied with
Xalan-J.  The security restrictions of applets are such that an applet that
relies on a copy of Xalan-J in the Java run-time would find that Xalan-J would
be unable to read the default entities file that is packaged with the JRE on
the applet's behalf - it can only do so with a properties, via ResourceBundle.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337416 13f79535-47bb-0310-9956-ffa450edef68"
f50777f032dd30ef269176ef9e25513ceb3869bf,"Need to override more startElement and endElement interfaces
in AdaptiveResultTreeImpl, because it now extends EmptySerializer,
which has a few more interfaces than the old TransletOutputHandler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337417 13f79535-47bb-0310-9956-ffa450edef68"
b6a07d130526fcd0493fd499be4e6e94ca4f2ee7,"Commit an implementation of the date-time:format-date() extension function
(bugzilla 18713) contributed by Helg Bredow (helg.bredow@kalido.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337418 13f79535-47bb-0310-9956-ffa450edef68"
b28ba89a56e3fb3d5fa7460e3308982ed381bf23,"Docs update

Document the new ""use-classpath"" attribute
which is supported in the XSLTC TrAX API.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337419 13f79535-47bb-0310-9956-ffa450edef68"
b8734b8e4597bbb754b4487172d9c0ad244349d4,"Fix for a few testcase failures in XSLTC trax.localPath.

Detect the backslash (""\"") character in the path in addtional to the
forward slash ('/') in LoadDocument.document().

The XSLTC conformance result in trax.localPath changed from
Pass: 1634/Fail: 14/Errr: 35 to Pass: 1657/Fail: 17/Errr: 9
after this change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337420 13f79535-47bb-0310-9956-ffa450edef68"
1c673439a0f54f479d933d67c57afabb47236c53,"Sample updates from Christine Li (jycli@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337421 13f79535-47bb-0310-9956-ffa450edef68"
92d513950518d4780a3e8303bf4dacea0d09b1a4,"Patch from Brian Minchau (minchau@ca.ibm.com) for backward compatibility
of new serializers.  Also a fix related to a failure in the DOM2DOM sample.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337422 13f79535-47bb-0310-9956-ffa450edef68"
bddb9f108f16b74236a56c2cf3d6486cba462022,"Fix for bugzilla 17448.

Stylesheet.setIncludingStylesheet() should use _includedFrom
instead of _importedFrom.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337423 13f79535-47bb-0310-9956-ffa450edef68"
1b41953370ec205af1901b9744f1ef18639923f6,"Fix another problem related to bug 17448.

Only set the import precedence of an included stylesheet when it
is directly included by this stylesheet. If it is indirectly
included via imports, the import precedence will be different.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337424 13f79535-47bb-0310-9956-ffa450edef68"
27a48fe1f07c9bdf176127f2d575b236d930be76,"Dropped descriptions of entities in the form of resource files in favour of
those in the form of properties file.  The resource files are still supported,
but Xalan-J's serializer only requires one.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337425 13f79535-47bb-0310-9956-ffa450edef68"
a8558b85ef90fc70c8a9305aa75b37238f0aed02,"Applying Sarah McNamara's (mcnamara@ca.ibm.com) patches to update
version numbers in XalanJ.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337426 13f79535-47bb-0310-9956-ffa450edef68"
d6d70de295fa2513fac5fa4ad37a618a0d27f8fc,"Sarah McNamara's (mcnamara@ca.ibm.co) documentation patch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337427 13f79535-47bb-0310-9956-ffa450edef68"
4074702a400f9a1c9031f32d2b0e9af8ab5c9156,"Added comments before a couple of messages to assist translators, and fixed a typo in the class name mentioned in a message.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337428 13f79535-47bb-0310-9956-ffa450edef68"
90690d28d7a287fb496550daf58cc79f422d8099,"Applying patches from Igor Hersht (igorh@ca.ibm.com) for bug 15200 and
bug 18585.

Fixed up code that processes the document function when it has two arguments,
the second of which must be a node-set; the code didn't always resolve the
value of the first argument against the first node in the second argument, as it
should have.

In addition, in order to simplify run-time processing, added a new
LoadDocument.documentF method that is used when the second argument to the XSLT
document function is present; if that argument is an empty node-set, the result
of the document function should be an empty node-set, and that logic is much
easier to code in the run-time than via generated code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337434 13f79535-47bb-0310-9956-ffa450edef68"
f3c6273bb9827fbb355af3cbc0514b6d42ccdaf6,"Applying patches from Igor Hersht (igorh@ca.ibm.com) for bug 15200 and
bug 18585.

Pulled EmptyIterator class out of SAXImpl to allow for more widespread use.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337435 13f79535-47bb-0310-9956-ffa450edef68"
b977a228e4884e686b5ee59d26a6964096098d6c,"Set SourceLocator in stylesheet instead of XSLTC object. This ensures
 proper use of user-defined URIResolvers in a TemplatesHandler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337436 13f79535-47bb-0310-9956-ffa450edef68"
7250cb4991e4549b54a50f8175913bb6d10103ad,"New FAQ from Christine Li (jycli@ca.ibm.com) for using Xalan in Tomcat
with JDK 1.4.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337438 13f79535-47bb-0310-9956-ffa450edef68"
2205de81d25c1f78b233e809d0e6edcbdbd5c197,"Fix for array out of bounds exception in findNamespaceContext, where the index was allowed to go to -1.  This is a blind fix, and someone who knows the code better should take a look to see what they think.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337439 13f79535-47bb-0310-9956-ffa450edef68"
4f25c2251e1f590f3700107ad172683eae08e6a0,"Made it a static error in compose(...) if a reference is made to a non-existent template.  Note this might cause some existing stylesheets to not work, since the error would never have been flagged if the code was not run.  Note the old code was marked for %REVIEW%, so I don't think this was ever resolved.  I think it's clear that this should be a static error.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337440 13f79535-47bb-0310-9956-ffa450edef68"
ed254de452ac5f062ce3eb93fca52733aa06eba5,"Output properties were not properly cleared when reusing the same instance
 of a TemplatesHandlerImpl. The top-level stylesheet in the XSLTC object
 referenced by TemplatesHandlerImpl (indirectly via an instance of Parser)
 was not reset after the first use of the instance.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337441 13f79535-47bb-0310-9956-ffa450edef68"
35830aa4962d09e2ec0aeb5111f16c1332373e11,"Change in comments only. Deleted old commented out (and incorrect)
double-checked locking code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337442 13f79535-47bb-0310-9956-ffa450edef68"
e17c0b329a2e3b88e67aa6eb80d92037211c3780,"Duplicate trace was event being issued.  One from ElemElement and then 
from its parent class: ElemUse.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337443 13f79535-47bb-0310-9956-ffa450edef68"
26382271ca27bcc15fe00f55d85d66e6dfa5bd62,"Dropping properties files that contain English messages.
xml-xalan/java/src/org/apache/xalan/res/XSLTErrorResources.properties has been
replaced by xml-xalan/java/src/org/apache/xalan/res/XSLTErrorResources.java.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337444 13f79535-47bb-0310-9956-ffa450edef68"
eb9811c0777f0521a88071a00ab293ab5af425ec,"Dropping properties files that contain English messages.
xml-xalan/java/src/org/apache/xpath/res/XPATHErrorResources.properties has been
replaced by xml-xalan/java/src/org/apache/xpath/res/XPATHErrorResources.java.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337445 13f79535-47bb-0310-9956-ffa450edef68"
1d55a0e1d61c15bdbc27b22dba8853a8acf4cc5b,"Changed incorrect double-check locking code with an inner class
with a static field.  Synchronization is covered by the class loader.
Loading happens when first referenced. A cool, efficient, safe 
way to lazy load a static field.

PR: bugzilla 19029
Obtained from: Henry Zongaro
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337446 13f79535-47bb-0310-9956-ffa450edef68"
e06820a409a09766640c19a6b1f6cbd99fca1cfa,"Cleared two helper fields, m_elementURI and m_elementLocalName in endElement()
Both of these fields are out of scope after the element is ended
so it is correct to null them out at endElement()

PR: bugzilla 19388
Obtained from: bruno@outerthought.org (Bruno Dumon) and Brian Minchau
Submitted by:	bruno@outerthought.org (Bruno Dumon)
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337447 13f79535-47bb-0310-9956-ffa450edef68"
54f6d7e4dbf00827df4e42fd99b18e847d0b0268,"endDTD() for ToHTMLStream now does nothing. It used to incorrectly
write out some closing characters, but that was already hanled in startDocumentIntermal()

PR: 19587
Submitted by:	bruno@outerthought.org (Bruno Dumon)
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337448 13f79535-47bb-0310-9956-ffa450edef68"
6300436324774bf398fb35ff4f3907e6fd67fed2,"Performance fix for double buffering.  Don't use WriterToUTF8Buffered if the 
writer class is ""BufferedServletOutputStream"".

PR: bugzilla 19474
Submitted by:	Brian Minchau
Reviewed by:	Ilene Seelemann


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337450 13f79535-47bb-0310-9956-ffa450edef68"
35e91d491585c4271c328d54fab30a13cc58d011,"Fix for flushing occuring in trace code even when tracing is not being done.

PR: bugzilla 19471
Submitted by:	Brian Minchau
Reviewed by:	Ilene Seelemann


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337451 13f79535-47bb-0310-9956-ffa450edef68"
c6c53e122ed4414acb8030f6951845ac59c7ef96,"Serializer properties files have moved to the new org.apache.xml.serializer
package.  Corrected part of documentation that didn't yet reflect that.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337452 13f79535-47bb-0310-9956-ffa450edef68"
71a21c2f7ce41985ffb5eb8d3584d58d7e9a39a3,"Noticed a few typos.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337453 13f79535-47bb-0310-9956-ffa450edef68"
1d45a7766cbf0cbaeabc1702802746aca579daf1,"Fixing case of TrAX in documentation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337457 13f79535-47bb-0310-9956-ffa450edef68"
ae328ffaf6a385c8e10a0ccc0dfd97f95f061cdc,"Guarded the fireXXX(); calls to trace events with if (m_tracer != null),
strictly for performance reasons. This should run faster than making the call and then checking.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337458 13f79535-47bb-0310-9956-ffa450edef68"
58ae54ae0d9ebf98f972e41c77e3db5df8b12448,"Title of FAQ for Xerces version read, ""Which version of Xerces-J 2.4.0 should I
use?"" answering it's own question.  Fixed that to make for a more suspenseful
read.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337459 13f79535-47bb-0310-9956-ffa450edef68"
74e30ebf32f54a2d57549f587211820909de7a81,"Some Trace-related fixes: Two trace events were being fired for ElemCopy,
and for templates elements derived from ElemUse the trace end event was
being fired before child templates were executed. Also saved locator
information for the end tag of stylesheet elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337462 13f79535-47bb-0310-9956-ffa450edef68"
e5ee58e0bf12b54ce29fd7afffa7bb7051974c9c,"See bugzilla # 19900 for a laundry list of small performance 
enhancements.

PR: bugzilla 19900
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337463 13f79535-47bb-0310-9956-ffa450edef68"
349d2c167085eaaed60de24d968d8b25f7f51548,"Performance enhancement. Cache the loading of classes via Class.forName(classname)
 in the serializer.  The same class is otherwise loaded over and over with each request
to a server, e.g. in a servlet. 
PR: bugzilla # 19960
Submitted by:	Brian Minchau
Reviewed by:	Morris Kwan


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337464 13f79535-47bb-0310-9956-ffa450edef68"
decf3e09d40f3a5c976f53e4fa3258ee1f2a8810,"Fix a multithread safety issue in the use-classpath option. The old code
reuses a Translet object for all newTransformer() calls, which is not the
right thing to do. We should pass in a Class array and let TemplateImpl
create a new Translet instance for each newTransformer() call.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337465 13f79535-47bb-0310-9956-ffa450edef68"
823a4b0cd334f9e57620451fa00aac21f8ae9a3b,"Adding missing trace events for the func:result element.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337466 13f79535-47bb-0310-9956-ffa450edef68"
43ccf30f999399a17baf3e67d680a584ced3ee63,"The HTML serializer should do nothing with the methods on the 
DeclHandler interface, so they are now defined with empty
bodies.  Also the comment() method does nothing when in a
DTD.
PR: bugzilla 19640
Submitted by:	Bruno Dumon (bruno@outerthought.org)
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337467 13f79535-47bb-0310-9956-ffa450edef68"
fd6f3e5da5276d273911ca6e8e62494a66a27217,"Added a new FAQ to describe a situation some users have encountered of late
using XSLTC with JDK 1.4.
Contributed by Christine Li (jycli@ca.ibm.com) with some editorial input from
myself.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337468 13f79535-47bb-0310-9956-ffa450edef68"
b1f3597bb297812a6f85940a059dcab951844ab1,"Fix a compatibility problem when using the old ""http://xml.apache.org/xslt""
namespace with extension functions in org.apache.xalan.xslt.Extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337469 13f79535-47bb-0310-9956-ffa450edef68"
cc8bf2af056a83f230f1d791963f694b1e5631f3,"Patch from Sarah McNamara (mcnamara@ca.ibm.com) which improves documentation
about packaging and adds support for building and testing an alternate 
binary distribution which provides xalan-interpretive and xsltc in separate jars.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337470 13f79535-47bb-0310-9956-ffa450edef68"
e7d13623e6ee52d86c78eb8b468cfddb5d44adad,"One line fix to get a lexical handler, was casting the wrong reference.
PR: bugzilla 20237
Submitted by:	Bernard D'Have (bdhaveos@wanadoo.be)
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337471 13f79535-47bb-0310-9956-ffa450edef68"
76c3bae4d6b641fddb5ad3fd82713a271e01d162,"Update to the SQL extension sample from Christine Li (jycli@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337472 13f79535-47bb-0310-9956-ffa450edef68"
36ec7f6a995214f60b7ef91f64b9ffded03f2adb,"Applying Christine Li's (jycli@ca.ibm.com) fix for bug 19522.  When a
SerializationHandler object is created for Xalan-J Interpretive, it needs to
be informed which Transformer object is associated with the serialization.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337473 13f79535-47bb-0310-9956-ffa450edef68"
afe8e4796d578c1a42d7dde4f20590000b086083,"AttributesImplSerializer now uses the older (faster) org.xml.sax.helpers.AttributesImpl
up until about 12 attributes and switches over to using a Hashtable for faster lookup
of attributes, avoiding an order N*N performance problem for large
number of attributes, but faster for lower number of attributes.
PR: bugzilla 20273
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337474 13f79535-47bb-0310-9956-ffa450edef68"
9e2b554dfa3af06bab75ac7bf3e4e79f22806cb3,"Patch from Christine Li (jycli@ca.ibm.com) for bugzilla #18926.

Variables weren't being cleared from stack between calls to func:function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337475 13f79535-47bb-0310-9956-ffa450edef68"
1d2ea1e0ea62a7c5103004387443e9dd215bf96f,"Updates from Christine Li (jycli@ca.ibm.com) for upcoming XalanJ 2.5.1 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337476 13f79535-47bb-0310-9956-ffa450edef68"
d8ce2471a49de965a62fa2d578125735e137d1c2,"Checked in localized messages for Xalan and XSLTC contributed by IBM.
New Locale support includes ca, cs, hu, pl, pt_BR, ru, sk and tr.
The old messages are also updated with translations for newly added
English messages.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337477 13f79535-47bb-0310-9956-ffa450edef68"
14e5ffc9e6d3df13e2141b36eea01b5401144c63,"Added a clear() method to clear a BoolStack, so that such a 
stack can be re-used without the need to create a new one
(for performance).
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337478 13f79535-47bb-0310-9956-ffa450edef68"
8b8382cc213f110b25f1171de09622131c0dd3b3,"Support for reset() for the stream serializers and for ToXMLSAXHandler.
These serializers can now be reset and re-used rather than creating a new one.
A reset() takes about 1/2 the time of creating a new one.

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337479 13f79535-47bb-0310-9956-ffa450edef68"
55bc579b9b518458186fe43aae22fd5503793794,"Support for a ToHTMLSAXHandler serializer to be reset() and re-used.
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337480 13f79535-47bb-0310-9956-ffa450edef68"
5902c69cf2e5e14797c116d66da31aace0d2a956,"Updates from Christine Li (jycli@ca.ibm.com) for upcoming XalanJ 2.5.1 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337481 13f79535-47bb-0310-9956-ffa450edef68"
d08d6306842868606193cf44944df3df8c486f1b,"Contributed by Christine Li (jycli@ca.ibm.com).
Modified FAQ entry regarding bootclasspath; the class path separator is not
colon for all systems.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337482 13f79535-47bb-0310-9956-ffa450edef68"
e73db90772ece0733d26af0dce93a22e2f051eda,"Activate redundant expression elimination!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337483 13f79535-47bb-0310-9956-ffa450edef68"
2259a768fc5852fcd783f567dc223512a95fa550,"Updated history file from Christine Li (jycli@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337484 13f79535-47bb-0310-9956-ffa450edef68"
07d1736f8ad1ea6d59c901d2b4be6ddb958779fe,"Minor changes to m_writer.write().
Changing write(""x"") to write('x').
Changing write('a'); write('b');  to write(""ab"");
Changing write(""abc""+str); to write(""abc""); write(str); to avoid creating temporary String.
All for performance.
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337485 13f79535-47bb-0310-9956-ffa450edef68"
758ca327fbb7157beda768dea60aaae8104aa258,"REE causes some new failures which need to be investigated.  Backing out
for now.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337486 13f79535-47bb-0310-9956-ffa450edef68"
d7ff730c07e8ea0474d88601bc1994c0a5030906,"One more update to history file, from Christine, because I backed out
REE.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337487 13f79535-47bb-0310-9956-ffa450edef68"
575baafbbbba8f416ebdb149337d047c6155ab13,"Dropped check against null for name in for getElemDesc(name)
This is a very small performance enhancement.

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337490 13f79535-47bb-0310-9956-ffa450edef68"
ab14e3eebe1fa3e54339cfce5db6e1401236a64a,"writeAttrString() and writeURI() now keep track of the number
of ""clean"" characters in a row that require no special processing.
This reduces the number of calls to the underlying writer and
improves performance.

Thanks to Joe Kesselman for the suggestion to not write out each
character one at a time.

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337491 13f79535-47bb-0310-9956-ffa450edef68"
67fa2cda9bfa829e908bd98cb96ab6798ff226f2,"Remove dependency on deprecated XSLProcessorVersion.java.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337492 13f79535-47bb-0310-9956-ffa450edef68"
3ea83986e5e7cc4237907ffe6f60066026535cb8,"Optimization to ToHTMLStream.startElement() and endElement() to not save and restore
so much information for empty elements, i.e. elements with no children such as the <IMG> tag.
The endElement() should immediately follow the startElement().

But even if such an element has an unexpected child the code will still
work as before.

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337493 13f79535-47bb-0310-9956-ffa450edef68"
5b37096356bfdf2147af6608a42464823d3bf03c,"Generate values for Version information from constants in the build script.
(Adapted from xml-commons build script for the resolver.)

New file Version.src (in org.apache.xalan) is copied into Version.java
with version constants from build script plugged in.

Deprecated XSLProcessorVersion class can be removed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337494 13f79535-47bb-0310-9956-ffa450edef68"
1243329d3284dc5718e6e1850ad0b287cd88e62f,"Generate values for Version information from constants in the build script.
(Adapted from xml-commons build script for the resolver.)

New file Version.src (in org.apache.xalan) is copied into Version.java
with version constants from build script plugged in.

Deprecated XSLProcessorVersion class can be removed.

Also, updated build clean target to delete Version.java, so it will
be regenerated in the next build.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337495 13f79535-47bb-0310-9956-ffa450edef68"
3cdbcd4c1e4ee5e1b89f66920bb0525c0cd4106b,"Documentation patch to correct typos, contributed by Glen Mazza 
(glenmazza@yahoo.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337496 13f79535-47bb-0310-9956-ffa450edef68"
172d799bddfcee282898f9b519c1bd37772c441c,"Documentation update: Replaced all occurrences of TRaX with the properly
capitalized TrAX.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337497 13f79535-47bb-0310-9956-ffa450edef68"
0973ed9badf4ad8169d626b49e1e46c294e3f1dc,"Speed up CharInfo.isSpecial() by replacing its internal use of 
java.util.BitSet with a more tuned bitset.
Also sped up the common case of this method for ASCII values (0-126) by
saving booleans in a cached array rather than looking them up via their
bits in the bitset.
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337498 13f79535-47bb-0310-9956-ffa450edef68"
6006dc1dcbbe0e280ba46c29bee04faaa04c9425,"Speed up ToStream.characters(char[] , int, int) method by
caching commonly calculated boolean expression for characters in the range (0-126)
in an array in CharInfo.

Also move a whitespace check out of the loop that processes characters and into
a separate loop.  Most of the time this whitspace checking loop will end early and
speed up the other loop which no longer checks for whitespace with every character.

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337499 13f79535-47bb-0310-9956-ffa450edef68"
3268c09cc767205f8f629a3659e6ad271c02d672,"Performance improvement of WriterToUTF8Buffered.characters(char[],int,int);

1. Reduced the number of checks for buffer overflow from 2 to 1
most of the time by nesting the checks.

2. Used local variables for the array reference and count of characters stored in
the buffer to make the loop faster.

3. Added an additional tight loop for better optimization.

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337500 13f79535-47bb-0310-9956-ffa450edef68"
9894c4f2fbc707c136ac5a98eb8db8e006f590c6,"Changing firePseudoAttributes() to firePseudoElement() which
is for debugger tooling.  Now both the whole start of the element-tag
e.g.   <abc attr1=""val1"" attr2=""val2""
will appear as output that might be written out, rather than
just the attributes.

Submitted by:	Gordon Chiu
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337501 13f79535-47bb-0310-9956-ffa450edef68"
3630dd01c97e17d42a13656d4988fe52c7026cc7,"Change to use a local variable to hold the reference to m_writer (minor change for performance).
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337502 13f79535-47bb-0310-9956-ffa450edef68"
9e4bf7f8d46c7b6306cefe1469c352dbd6099171,"Changed references to m_writer to a local writer variable in
a number of places (a minor performance improvement).

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337503 13f79535-47bb-0310-9956-ffa450edef68"
0db7846f3a466db52bbe4e6bffae7509f470b393,"Fix for bugzilla 20685. In startResetIterator(), check see if the
expression wrapped by the CastExpr is a VariableRef. If so, don't
generate a call to setStartNode.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337505 13f79535-47bb-0310-9956-ffa450edef68"
225b70e9cf49e59371d3cfd5a255f91fbf57b770,"Made ToStream.characters(char[], int, int) not bail out early if
the length was 0 characters, but do all processing.  This forces
the close of any open start tag.

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337506 13f79535-47bb-0310-9956-ffa450edef68"
7c6216bc80a32a5fda819a9909e35d6af6443610,"Patch from Igor Hersht for Bug 19770.  getFirstAttributeIdentity should check
that argument is not equal to DTM.NULL prior to calling _type2 method - that
method assumes that the argument is not NULL.  Added comments to that effect to
_type2, _parent2, _firstch2, _nextsib2 and _exptype2.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337507 13f79535-47bb-0310-9956-ffa450edef68"
3aba794e60efbfe9d60f24bf2d91908ba0dd14e4,"Fix for the general case of bugzilla 20685:
DTMAxisIteratorBase#cloneIterator() was not setting clones to be
non-restartable.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337508 13f79535-47bb-0310-9956-ffa450edef68"
204d33196334c4692a9fed8f00f995a8e58fbb2f,"Fix a minor bug in MultiDOM.addDOMAdapter().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337509 13f79535-47bb-0310-9956-ffa450edef68"
e28a0eaf3e52e76fd7992914b1f045d2de9b1e13,"Patch for bugzilla #15828.

Arguments to URIResolver.resolve method for document function, in XSLTC are now

href: argument passed to document function
base: URI of stylesheet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337510 13f79535-47bb-0310-9956-ffa450edef68"
77cd7e0d7a3aa631d0f4db11aea0763f1f3627e7,"Putting back LoadDocument.java


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337511 13f79535-47bb-0310-9956-ffa450edef68"
1970667123e3392dcba4cb33f1b84153ae6501c6,"Patch for bugzilla #15828.

Arguments to URIResolver.resolve method for document function, in XSLTC are now

href: argument passed to document function
base: URI of stylesheet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337512 13f79535-47bb-0310-9956-ffa450edef68"
be7fe8632fd82fda3cf728f8e18137befa364472,"Putting back TransformerImpl


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337513 13f79535-47bb-0310-9956-ffa450edef68"
2b225edd12525f5b9993eec03890b34bbaf7e01e,"Patch for bugzilla #15828.

Arguments to URIResolver.resolve method for document function, in XSLTC are now

href: argument passed to document function
base: URI of stylesheet


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337514 13f79535-47bb-0310-9956-ffa450edef68"
4f1facfc9174253c3735e93a728b1ea024a4db72,"Aarg!  Fighting with CVS.  Getting rid of extra print statement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337515 13f79535-47bb-0310-9956-ffa450edef68"
1a42107dfaa2abc5595739820d6fc74af99af52b,"Patch contributed by Glen Mazza (glenmazza@yahoo.com):
Fixing a typo in the command line help.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337516 13f79535-47bb-0310-9956-ffa450edef68"
5c60511c2f2bc36e35e4da17e699e12649a4ea23,"Patch contributed by Glen Mazza (glenmazza@yahoo.com) for bugzilla 20625:
Fixing some documentation typos.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337517 13f79535-47bb-0310-9956-ffa450edef68"
cdb875c9958446d23fa89f5c5dd840b6a6d677e6,"Patch from myself and Brian Minchau (minchau@ca.ibm.com):
Added serializer trace mechanisms to flush trace pseudo characters for
start tag before attributes are added. Fixed serializer trace to generate
correct pseudo characters for html attributes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337518 13f79535-47bb-0310-9956-ffa450edef68"
a8565c40802d2383b7db559758d42667a9e51628,"A little code clean up, introduce the SQLQueryParser to handle variables
better.

Added code by Art Welsh to hande the Set/get Feature routine


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337519 13f79535-47bb-0310-9956-ffa450edef68"
b6a504fcc3ed38304485aef7688b4b2e6f7bed52,"Added code by Art Welsh to hande the inline variable parser.
SQL Statements can describe an XSL variable name along with
its type inside the statement instead of using the addParameter methods.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337520 13f79535-47bb-0310-9956-ffa450edef68"
bbebab9d3d3fe1636d204235caa960a2c0229611,"Added code by Art Welsh to hande full errors, where multiple warning
stattments wll be output into the error document


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337521 13f79535-47bb-0310-9956-ffa450edef68"
3f8501ebe6a7de89bbfcd8699997410026883368,"Added code by Art Welsh to hande multiple result sets and Callable statements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337522 13f79535-47bb-0310-9956-ffa450edef68"
14ceae37060fbd26f5f5b1af24f2e2ab0ea13a97,"Added code by Art Welsh to handle more of the SQL Types, and other attributes
about the parameter. such as IsOutput and the Name for XSL Variable reference


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337523 13f79535-47bb-0310-9956-ffa450edef68"
d407aff358a70e952a2c43c9603368c45c4d73e4,"Added SAXTransformerFactory.FEATURE and SAXTransformerFactory.FEATURE_XMLFILTER
to the list of features that are implemented.  Fix for bug 20795.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337524 13f79535-47bb-0310-9956-ffa450edef68"
41659c5a7c78a4a20640fbfb7c6a35514056acc6,"Moved a number of serializer instance variables into ElemContext,
which is a stack to push/pop such values in unison. This makes
the code clearer and less error prone and probably marginally
(0.001%) faster.
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337525 13f79535-47bb-0310-9956-ffa450edef68"
eb6567099a319807321ab2d9a0c52f01655023e6,"Fixing a build issue for JDKs that include XSLTC (specifically, the
JavaCupRedirect class) but not java_cup.jar. Need to put java_cup.jar
and runtime.jar on the bootclasspath.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337526 13f79535-47bb-0310-9956-ffa450edef68"
b908f1036570bea33f0dfbe82b86612ba4047891,"Implement a ""DTM migration"" feature, which allows a DTM that is built with
an old DTMManager to be migrated to a new DTMManager. This is to support
DTM sharing between multiple transformations.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337527 13f79535-47bb-0310-9956-ffa450edef68"
365713b144afa94d36038987582387ebdb2d4140,"Performance improvement for XSLTC
Don't add a simple or adaptive RTF to the DTMManager if the nodeset
extension is not used. The DOMAdapters are also not created in
this case. This is a noticeable improvement for stylesheets that use
many small RTFs but do not use the nodeset extension.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337528 13f79535-47bb-0310-9956-ffa450edef68"
991ea0a0c5b371cc83205c41c8652a4c071500d6,"Performance improvement for XSLTC

New codegen solution for parameter passing in named templates,
which provides significant improvement for stylesheets that use
xsl:call-template and xsl:with-param heavily.

The old solution generates code to call Translet.addParameter(),
which seems to be too expensive. In the new solution, parameters
are passed to named templates via method arguments. The method
signature for a named template is not fixed. It depends on the number
of parameters declared in the template.

The caller (xsl:call-template) is responsible for generating the
correct parameter list and passes it to the called template. This is
done in the CallTemplate class, which finds out the corresponding
called template and processes its own xsl:with-param children together
with the xsl:params in the called template to generate an effective
parameter list. In the case where a xsl:param references another xsl:param,
local variables are generated to hold the temporary parameter value.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337529 13f79535-47bb-0310-9956-ffa450edef68"
10f09b4c08be31ccc84732d290e43f07d5d20110,"Patch for bugzilla #15828.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337530 13f79535-47bb-0310-9956-ffa450edef68"
3287608a6e2230360a8d1c36a1bd0f71b3068221,"Added addUniqueAttribute() method for optimization purposes.
The serializer may write out this attribute straight away with little processing becuase the caller guarantees
that the value has these qualities:
1) Value is unique, i.e. will not be changed by other addAttribute() calls.
2) Value is ASCII
3) Value does not contain quot (34) amp (38)  lt (60) gt (62)

Submitted by:	Brian Minchau
Reviewed by:	Morris Kwan


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337531 13f79535-47bb-0310-9956-ffa450edef68"
c3d2d17aa11d699aa09eca25f4f40221ced4e51d,"Add a ""public Transformer getTransformer()"" method to XSLTC's TrAXFilter class.
The Xalan TrAXFilter class already has such an interface.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337532 13f79535-47bb-0310-9956-ffa450edef68"
5fbde3f0d7bfad0db0af0b773201ffe425373d0f,"Fix for XSLTCSource (see bugzilla 21048).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337533 13f79535-47bb-0310-9956-ffa450edef68"
2f7510872c00e1512d43162b804159056c913eed,"Update documentation about how to use XSLTCSource.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337534 13f79535-47bb-0310-9956-ffa450edef68"
e7c4410626948241acee74274c1ee99b4361a75d,"Performance improvement for XSLTC

Implement a compiler-assisted serialization feature.
Generate code to make use of the new
addUniqAttribute(String name, String value, int flags)
interface in SerializationHandler. The compiler does
more static analysis on attributes of literal elements
and passes the additional information to the serializer
via a bit-encoded flag.

The additional information includes whether this attribute
is unique, whether its value has bad characters (something
needs to be escaped), whether it is a HTML URI or empty
attribute. If the attribute is unique, the serializer can
write out the attribute right away, without having to
accumulate it in an internal table. If it also does not
contain bad characters, then escaping is not needed.
All these information speeds up the serializer on writing
the attributes out.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337536 13f79535-47bb-0310-9956-ffa450edef68"
4cd177e18194ac1b61ee5e8377afe8ed25564077,"Changed code like this:
String s; ...
char[] array = s.toCharArray();

To this:
final int length = s.length();
if (length > m_charsBuff.length)
{
    m_charsBuff = new char[length * 2 + 1];
}
char[] array = m_charsBuff;
// re-use ""array"" but use ""length"" for the
// number of characters in the array.

This shows a 2% performance improvement for some
XSLTC/HTML testcases. Of course some transformations
may do betterthan this, and some worse, but all should be
faster.

The performance should also get marginally better for transformations that spend their
time writing out attributes.  It runs marginally faster because
the helper character buffer, m_charsBuffer is re-used rather
than a new one being created each time. 

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337537 13f79535-47bb-0310-9956-ffa450edef68"
f413a0ae41050ee331ddf2aefd0e15c697ed8e01,"Performance improvement for XSLTC

Introduce two new iterators (CachedNodeListIterator and CloneNodeListIterator).
They are used by variable/param references that are evaluated to nodesets.
CachedNodeListIterator traverses the underlying iterator once and caches the
nodes in an IntegerArray. Its clone() method returns an object of
CloneNodeListIterator, which also retrieves nodes from the cache.

This mostly improves the case where a variable is referenced multiple times
in a context. In the old code, the iterator for the variable is traversed
as many times as the variable is referenced. Using the cached iterators,
the iterator is only traversed once. All later references retrieve nodes
from the cache.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337538 13f79535-47bb-0310-9956-ffa450edef68"
6f85c366281d4104fc72d652eabacc46dafd87dc,"Fix for problem in ExpandedNameTable (bugzilla 21087).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337539 13f79535-47bb-0310-9956-ffa450edef68"
d9c8ddf20fc3f01c8f027f9edb9a5e8f86ce5fe9,"Fix problem in EXSLT align function (bugzilla 19890).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337540 13f79535-47bb-0310-9956-ffa450edef68"
3e6921c83c3f659a5f3757366780c7466d8eef80,"Sped up the Trie.get(String) method by about a factor of 2.
This was done by:
1) Not using string.charAt(i) when looping through the characters,
but rather using string.getChars(0, len, array, 0) and looping over the array.

2) Special casing the lookup in get(String key) for 0,1,2 or more characters

3) Putting the objects into the Trie considering the key as case insensitive at the
time of putting the objects in, rather than at the time of taking them out.

4) Not using a try/catch in the search loop to test if an
index is out of bounds, but testing if the character value is less than 128.

Thanks to Gordon Chiu for optimization 1) and Henry Zongaro for 3) and 4).

Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337541 13f79535-47bb-0310-9956-ffa450edef68"
ee368de1e475d4e3df1ec040d08b8140d14c3bcf,"Implement a feature to cache the DTM for the stylesheet in
the Templates object. This improves the case where document('')
is used. In this case the DTM for the stylesheet is only built
once per thread. It can be reused by multiple transformers
created by the sample Templates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337542 13f79535-47bb-0310-9956-ffa450edef68"
185dd0049bcdb5ae3dd691355e7083c558f0b0a1,"Patch from John Lambe (john.lambe@openjawtech.com) for bugzilla 20819
with some modifications. removeElement() and removeElementAt() were
not removing nodes correctly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337543 13f79535-47bb-0310-9956-ffa450edef68"
198934e68517178f95df556005a5d1b30a4c9672,"Minor change to firing of trace events from xsl:if.

xsl:for-each now fires one trace event plus one for every iteration.
xsl:if should fire one regardless of whether or not the expression
evaluates true or false. Related to discussion on bug 11414.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337544 13f79535-47bb-0310-9956-ffa450edef68"
a3b67862dcb2249cbbd73a2a15c630a2a37c5714,"Patch from Christine Li (jycli@ca.ibm.com) for bugzilla 20913, with
modifications. In UnionIterator, after calling the getLast() method, the
heap is not restored properly. Recreate the heap in gotoMark(), as well
as restore _returnedLast and _heapSize.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337545 13f79535-47bb-0310-9956-ffa450edef68"
65369e939176e775d9778688b04917372001f5f2,"Applied Igor Hersht's (igorh@ca.ibm.com) patch for Bugzilla bug 10900.  Fixed
up algorithm for determining the result of the current() function to avoid
NullPointerException.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337546 13f79535-47bb-0310-9956-ffa450edef68"
cd8a844407613e8f8e51c227256ae5bdec17cea4,"Put back DocumentCache


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337547 13f79535-47bb-0310-9956-ffa450edef68"
62b1f6ab02358e3232dd0eac58575d9d18da39e5,"Update the DocumentCache class to be compatible with the DOMCache 
interface.  Although, with the native interface no longer supported, users
should not be using the DocumentCache.  Instead they should set a 
URIResolver on the Transformer in order to resolve arguments
passed to the document function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337548 13f79535-47bb-0310-9956-ffa450edef68"
f252d40b3e73683553a7c9018d8353f7aaab9cc7,"Fix for 3 trax.localPath failures.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337549 13f79535-47bb-0310-9956-ffa450edef68"
dbec423e73391431f251631ef489724cd68d5b21,"Patch from Sarah McNamara (mcnamara@ca.ibm.com)

Moving java_cup.jar and runtime.jar from v0.10j to the latest version: v0.10k.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337551 13f79535-47bb-0310-9956-ffa450edef68"
bcd6c6b76ccf472d02f68ebf67435aa2c016245d,"Patch for bugzilla 20909.
Need to fix-up variables for PredicatedNodeTest sub-iterators in
UnionChildIterator. Variables in the m_nodeTests expressions were not
'fixed up'.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337552 13f79535-47bb-0310-9956-ffa450edef68"
7798e34d694a823ce477197fe471b3a7b241dee9,"Adding missing trace events for xsl:with-param. Trace events for
xsl:with-param are fired as the parameter expressions are executed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337553 13f79535-47bb-0310-9956-ffa450edef68"
bdfa3892d28feda5eea80cc8e00f742c19c428b4,"Adding missing trace events for ElemWithParam as used in xsl:call-template.
Trace events for xsl:with-param are fired as the expression is executed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337554 13f79535-47bb-0310-9956-ffa450edef68"
f2cb35a746846e470680b6428ec0f257cbc5e5c6,"Patches for bugzilla 20841 and 21039.

PR: 20841, 21039
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337555 13f79535-47bb-0310-9956-ffa450edef68"
a71db78d83a375d34fd8db570d1e0a179db323de,"Applying patch from David Bertoni (bertoni@us.ibm.com) for bug 20920.  The code
for xsl:element was copying all accessible namespace declarations to the
result, but that's something that should only happen for literal result
elements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337556 13f79535-47bb-0310-9956-ffa450edef68"
6b39d95572101e1ae5cd760d9886ecb2556d0d5c,"Fix a memory leak problem with the DTMManager.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337557 13f79535-47bb-0310-9956-ffa450edef68"
9c3e4216b267255b024f807083a25250ccfb9525,"Fix a few conformance regressions introduced by the addParameter
optimization work.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337558 13f79535-47bb-0310-9956-ffa450edef68"
6aaf23c38d4383c91c08062520cfb2f673d5848f,"Fix for bugzilla 21423
PR: 21423

Bug caused by an optimization where the element name was not
remembered if the HTML tag was empty and the endElement() call
was coming right away.  But XSLTC injected startNamespaceAfterElement() 
in the middle, and it needed the element name, So startElement() records the 
element name in the ElemContext even though the context is soon going away.


Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337559 13f79535-47bb-0310-9956-ffa450edef68"
fa87b690d1005d17844694fc6274574de1602613,"Reduce the indentation level of end-element tags by 1 level.
PR: bugzilla 21449
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337560 13f79535-47bb-0310-9956-ffa450edef68"
df2207dac0673b7b870be32dd3526b363616e82f,"WriterToUTF8Buffered is now faster because it uses a character
array rather than a series of string.charAt(i) calls.  Other changes 
were also made to this class.  

Performance gains are when writing to an output stream that has UTF-8 encoding.

WriterToUTF8   (not buffered) is deleted.  On analysis, its slow feature was that it
didn't buffer and so it suffered many calls to the underlying OutputStream.  The more work that was done to
this class to speed it up, the more it looed like WriterToUTF8Buffered.
didn't 
PR: bugzilla 21452
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337561 13f79535-47bb-0310-9956-ffa450edef68"
6f14082cb49b47214070f0be4eed04ec920a4e4c,"Fix for bugzilla 17630 (method keys for extension functions are not unique).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337562 13f79535-47bb-0310-9956-ffa450edef68"
477e85b3b3127416f2c63f1be70463e62b1776cb,"Fix for bugzilla 20074. Don't create an IntegerArray of size 0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337563 13f79535-47bb-0310-9956-ffa450edef68"
7330d9a0deb7723cd01986a10cae56da8236edb7,"Fix to WriterToUTF8Buffered to ALWAYS buffer regardless of the
size of the input char array or String.  This is achieved by logically cutting
the input into chunks, each of which will not blow the internal byte buffer,
and calling itself recursively.

PR: bugzilla 21491
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337564 13f79535-47bb-0310-9956-ffa450edef68"
9508226a5616a3177002657255bd48183a6b9bb1,"XSLTC: TransformerHandler.setResult should throw an IllegalArgumentException
when the result argument is null.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337565 13f79535-47bb-0310-9956-ffa450edef68"
ee139738e2d2c8ef0d609d1eab938ae7edcb3d1c,"Fixed NPE bug with inline variables


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337573 13f79535-47bb-0310-9956-ffa450edef68"
3d76814de0360c88390bd6d81546ecfbca2e3762,"Fix for bug 20256. Remove an unused reference to an
inexistent class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337574 13f79535-47bb-0310-9956-ffa450edef68"
2b329ecfc56f73be9ba16468ed093523e0dfd958,"Fix for bugzilla 21697:
processAttributes always called writeAttrString with m_writer, regardless
of which writer was passed to it. Now always using the passed writer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337575 13f79535-47bb-0310-9956-ffa450edef68"
72e902efb36449fbeff56f30683c975372fd660e,"Patch for bugzilla #20537.  

When URIResolver was set for includes/imports, the system id of the included/imported
files was not always set correctly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337576 13f79535-47bb-0310-9956-ffa450edef68"
dea82fa44b36230a93de127e8b096d14fe870d3a,"Adding my public key.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337577 13f79535-47bb-0310-9956-ffa450edef68"
27f7f2d597977cdf664bc9c00f2bdfb15c97d3af,"Applying patch from Igor Hersht (igorh@ca.ibm.com) for Bugzilla bug 18821.
At some point in the recent past, Predicate started trying to optimize filter
expressions with positional predicates, but the receiving code in FilterExpr
was always incorrect.  The fixes to FilterExpr and related code aren't so
straightforward, so the easiest thing to do for now is to disable the
broken optimization for FilterExpr objects.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337578 13f79535-47bb-0310-9956-ffa450edef68"
a5ea96de27e3381d063300d9ac3a5cdcb6fbfb1e,"Applying patch from Igor Hersht (igorh@ca.ibm.com) for Bugzilla bug 18821.
Nested iterators in UnionIterator weren't correctly handling multiple calls to
setStartNode in generated code.  Fixed by ignoring calls after the first.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337579 13f79535-47bb-0310-9956-ffa450edef68"
56a3308e0545d246bc2d3090eaff9bffd52514bb,"Applying patch from Igor Hersht (igorh@ca.ibm.com) for Bugzilla bug 6155.
Prior to looking up an unnamed decimal format, the FuncFormatNumb.execute
method was calling the stylesheet's getDecimalFormatCount method to save the
cost of the look-up, in the event the result was zero.  The problem is that
that method only returns the number of decimal-formats prior to composition of
multiple stylesheets into a single stylesheet, so it was incorrectly returning
zero always.  Now, the FuncFormatNumb.execute always performs the look-up.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337580 13f79535-47bb-0310-9956-ffa450edef68"
ffb3e96bcec0c984663a4e11c4f5a4e6c0ec8144,"Fix for bugzilla 21713: need to check m_allowDetach before detach()ing an
iterator of type DescendantIterator. (Thanks to Morris Kwan for reviewing
this patch.)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337581 13f79535-47bb-0310-9956-ffa450edef68"
ea2ac40dc7ee0096e356ef274738835b5c6bff57,"Fix for bugzilla 20832. Also fix testcase attribset19.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337584 13f79535-47bb-0310-9956-ffa450edef68"
ca8b567915319bcdfb0d386d4f86ccb7d63b66a2,"Fix for bugzilla 21805.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337586 13f79535-47bb-0310-9956-ffa450edef68"
1d4f008656e66b41d9ad940b7727952ef3089cae,"Updating with latest code from the tck-jaxp_1_2_0 branch of xml-commons
which contains the SAX 2.0.1 code.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337587 13f79535-47bb-0310-9956-ffa450edef68"
7c4e571b68baa6bb5f3ccc0a29b8aa274d19644a,"Added code to create static char[] fields in the translet containing the
literal text in the source stylesheet.  The code generation for xsl:comment and
for literal text that constructs text nodes takes advantage of this by using
the serializer's comment(char[],int,int) and characters(char[],int,int) methods,
respectively, rather than the comment(String) and characters(String) methods.
The former pair of methods avoid some potential overhead in the serializer from
copying the contents of strings to char[] objects.

Code that creates a static initializer method in a translet was written by
Morris Kwan (mkwan@ca.ibm.com).

Reviewed by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337594 13f79535-47bb-0310-9956-ffa450edef68"
e881db1dfcab06ae1718427abe47dfaa67c28a04,"Added code to create static char[] fields in the translet containing the
literal text in the source stylesheet.  The code generation for xsl:comment and
for literal text that constructs text nodes takes advantage of this by using
the serializer's comment(char[],int,int) and characters(char[],int,int) methods,
respectively, rather than the comment(String) and characters(String) methods.
The former pair of methods avoid some potential overhead in the serializer from
copying the contents of strings to char[] objects.

Reviewed by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337595 13f79535-47bb-0310-9956-ffa450edef68"
acbaf3074b6e6547568908ea8b29dd2c14cc02f1,"Made a couple of improvements to startElement and endElement to cache
m_elemContext in a local variable.  Also, replaced calls to ElemDesc.is with a
single call to ElemDesc.getFlags, and used inline code to check flag settings.

Reviewed by Brian Minchau (minchau@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337596 13f79535-47bb-0310-9956-ffa450edef68"
a5405c9492df01f882ad03b34d706244da1ca3bc,"Added a getFlags() method to allow all flags on an ElemDesc object to be
retrieved at once, rather than forcing multiple calls to ElemDesc.is(int).
Also, marked class final.

Reviewed by Brian Minchau (minchau@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337597 13f79535-47bb-0310-9956-ffa450edef68"
044340c7ac4358d9ea458e51adf2957a74318a3f,"Backing out SAX 2.0.1 xml-apis to the level used in XalanJ 2.5.1.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337598 13f79535-47bb-0310-9956-ffa450edef68"
1c61419349faa01b2938cfbe6bb37f1edb9a57a5,"Patch from Bruno Dumon (bruno@outerthought.org) for bugzilla 20114.
When using XSLTC's TemplatesHandler to create templates, errors are never
reported; getTemplates() just returns null.
Changed behaviour to be inline with Xalan behaviour: stylesheets are
compiled in the endDocument() event and a SAXException wrapping the real
exception is thrown.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337599 13f79535-47bb-0310-9956-ffa450edef68"
3b36063d366598e70c6a30c92a2799ae93281b52,"Patch for Bugzilla Bug 21893


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337602 13f79535-47bb-0310-9956-ffa450edef68"
ecf3bfda53984153a5a43ff746601f2ffc7e071f,"Patch for Bugzilla Bug 19918


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337603 13f79535-47bb-0310-9956-ffa450edef68"
fe24aea022e24c171e527a7c0d4a506d7edb8ea6,"PR: bugzilla 19591
Submitted by:	Gordon Chiu
Reviewed by:	Brian Minchau

Fixes a few methods in the ToStream serializer so that it outputs the DOCTYPE
sooner and in the correct location.  Thanks to Bruno Dumon for the nice test case
and thanks to Gordon Chiu for the fix.
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337605 13f79535-47bb-0310-9956-ffa450edef68"
dd02c3d81dfbe03fdaf975bd0e8e791b62459421,"Fix bytecode generation problem for extension method calls via
interfaces for bugzilla 22115.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337606 13f79535-47bb-0310-9956-ffa450edef68"
c333ba1e8fad4b3706cb548de13129856754b72d,"PR: bugzilla 19972	
Submitted by:	William Lee (william.lee@cognos.com)
Reviewed by:	Brian Minchau and Gordon Chui

The code loops over elements in a Vector, incrementing the index j.
Some elements should not be processed so they were removed from the Vector.
The removal of element ""j"" shifted all higher elements down and made the
Vector 1 shorter.  So removal of an element and incrementing ""j"" actually caused
elements to be skipped.

It is not quite clear why the element is being removed from the Vector rather
than just skipped over. For safety sake an iteration over the loop either removes an
element, or increments ""j"", but not both in the same iteration.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337607 13f79535-47bb-0310-9956-ffa450edef68"
9f44d3814217c9d8e7f8f24db3eb969c03c255cd,"PR: bugzilla 21309
Submitted by:	Brian Minchau

Utils.classForName(String classname) still throws a ClassNotFoundException rather than
return null, but it doesn't cache the classname/null combination anymore if the classname 
is not loaded.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337608 13f79535-47bb-0310-9956-ffa450edef68"
1d5f57764cadd0bd9a5c477f30b96844d68699b2,"PR: bugzilla 18907
Submitted by:	Brian MinchauPatch has just been applied to main branch of CVS.

Now ToStream.writeUTF16Surrogate(char c, char ch[], int i, int end) 
return nothing rather than the ""i+1"" that it had always returned, 
which was a bit confusing. 
 This routine always processed 2 input characters and always returned ""i+1"" so why bother?  

There was no error in returning ""i+1"" because the situation in which this routine was called were always in a loop:
for (int i=start; i < end; i++) { ... }
so ""i"" was always incremented before going on to the next iteration. Any i++; after calling writeUTF16Surrogate() now means that 2 input characters have been processed, so there is no bug here (never was).  The code is just clearer now.

A bug has been fixed in ToStream.accumDefaultEscape() which used to mis-count how many input characters that it processed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337609 13f79535-47bb-0310-9956-ffa450edef68"
4498d48f010d2748e223715841930e77b4d92089,"PR: bugzilla 21300	
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro
The review was done via a discussion.  Not too many requests are made to
add encoding information to this property file.  Doing one now and then is OK.
A comment was added to the property file showing where to go to get information
on ISO encodings.   

At this point a decision was made to NOT update the information en-mass, but wait for
individual requests.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337616 13f79535-47bb-0310-9956-ffa450edef68"
5e6c26b2a64456524660b6e5b8ba64780065feac,"Applying Igor Malinin's (igor@widespace.ee) patch for more convenient	(centralized)
classloading.  See bugzilla #16675.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337617 13f79535-47bb-0310-9956-ffa450edef68"
b91de551ece41c7b588d3ae0f8a05fb2c39fc7e6,"A few minor doc updates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337618 13f79535-47bb-0310-9956-ffa450edef68"
dbffd51f1680f8a4c5991e148171baa148ca9c9a,"Fix a typepo in ExtensionHandlerGeneral.java. It should check for null
instead of nonnull.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337619 13f79535-47bb-0310-9956-ffa450edef68"
a5f149c649aaa5e3bb773bf462ccdcf561553790,"Patch for bugzilla 12441. In forward-compatible mode, an unknown attribute
should be ignored. Currently Xalan throws an exception.

Reviewed by Morris Kwan (mkwan@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337620 13f79535-47bb-0310-9956-ffa450edef68"
01f38a13ab722fa0befea34f8cdec10a8782d8e1,"Removed static method which was reading XSLTInfo.properties file and setting
a system property for each property in the file.  That code was not appropriate
in a secure environment, and wasn't actually needed.  Three of the properties
were being set in support of the XSLT system-property function, but the
implementation of that function didn't actually access the values from the
system properties; the fourth was org.xml.sax.driver, which should be provided
by the user's application or by the parser in a
META-INF/services/org.xml.sax.driver file.

Reviewed with Christine Li (jycli@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337621 13f79535-47bb-0310-9956-ffa450edef68"
d26eb5cab915e791493c40938f10d96ed5504a67,"Removed property for org.xml.sax.driver.  This is something that should be
set by either the user's application code or by a
META-INF/service/org.xml.sax.driver supplied with an XML parser.  Xalan
shouldn't be responsible for setting it.

Reviewed with Christine Li (jycli@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337622 13f79535-47bb-0310-9956-ffa450edef68"
3bb915a2777cf76ea177bee3062ba51c33498381,"Changed the way XSLTInfo.properties file was being read to use SecuritySupport
class instead.  Added copies of SecuritySupport classes to this package as well.

Reviewed with Christine Li (jycli@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337623 13f79535-47bb-0310-9956-ffa450edef68"
eaeed3b5f023d4ae7ee87143d90f3e296da2ad55,"Changed comments that referred to JAXP.  Updated imports to avoid using
wildcards, which is a practice Xalan-J has largely eschewed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337624 13f79535-47bb-0310-9956-ffa450edef68"
1e097b595e5e0dc364eb1e443f510f74e766780a,"Applying patch for bug 19297 from Christine Li (jycli@ca.ibm.com).  The
document() function must treat the second argument as a node-set; it should
not permit an argument of any other type.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337625 13f79535-47bb-0310-9956-ffa450edef68"
79ac6cae77c5b1d0721b26387913dbdc7fbcd1ec,"Applying patch for bug 19973 from Christine Li (jycli@ca.ibm.com).
A call to buildKeys (for xsl:key) should be generated before a call to topLevel
(to handle top-level variable and parameter declarations) because top-level
variables and parameters can contain references to the key() function, but not
the other way around.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337626 13f79535-47bb-0310-9956-ffa450edef68"
92e85ce674009aeadae043f83a345d6c6989da1d,"Implemented extensions trace mechanism for Java extension calls.
(http://marc.theaimsgroup.com/?l=xalan-dev&m=105715909512185&w=2)

Added new interfaces to allow a trace listener to receive information about
extension functions and elements that are called or executed.

Placed hooks in subclasses of ExtensionHandler prior to and after invoking
the resolved extension method.

Adding missing trace event for ElemExtensionCall.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337627 13f79535-47bb-0310-9956-ffa450edef68"
4a9cca3568142b5953f4bc4e3682f88439d6452e,"Patch from Sarah McNamara (mcnamara@ca.ibm.com).

Removing JavaCupRedirect from the jar files. This class is only
needed at build time, and causes build problems when placed on the
bootclasspath (when bootclasspathing xalan.jar under JDK 1.4).

See also (http://marc.theaimsgroup.com/?l=xalan-cvs&m=105637851030164&w=2)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337628 13f79535-47bb-0310-9956-ffa450edef68"
fc31359235edc12e48d171440f30b93133cd5d9d,"Applied patch for bug 15090 from Joanne Tong (joannet@ca.ibm.com).  Added code
to handle the case in which a referenced function is not found by reporting an
error.  Previously, a NullPointerException was the result.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337629 13f79535-47bb-0310-9956-ffa450edef68"
62e3111b5811bd10d513f065b6ebe3d44db3f7c2,"Patch for Bugzilla Bug 22777


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337630 13f79535-47bb-0310-9956-ffa450edef68"
ec95172ec7b11ab7e7f2f1c4140d01c4a2010274,"PR: bugzilla 21478	
Submitted by:	Christine Li
Reviewed by:	Brian Minchau

Added message key ER_FUNCTION_NOT_SUPPORTED that
maps to message (in English) ""Function not supported!""
so that an error message comes out rather than a crash.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337631 13f79535-47bb-0310-9956-ffa450edef68"
1fed852d76a52a2479204508f1df92eed74ef723,"Applied patch for bug 22769 from Christine Li (jycli@ca.ibm.com).  If a
variable reference occurs inside the definition of another variable, XSLTC adds
a dependency link upon the referenced variable to the defined variable.
However, if the referenced variable was overrode by another variable definition
with higher import precendence, the dependency should be placed on the
overriding variable instead.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337632 13f79535-47bb-0310-9956-ffa450edef68"
7e14ad388e34dfa8b3182c10b86c7f112efd4335,"Patch for Bugzilla Bug 22808


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337633 13f79535-47bb-0310-9956-ffa450edef68"
413c1391c1bb246718caf23ba09ff2a1e7dd2f34,"Moved return statements outside of finally block. The compiler correctly points out that when an exception is not caught by a catch, the finally block cannot return normally.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337634 13f79535-47bb-0310-9956-ffa450edef68"
e205584bf23216fbfaab634d38ef920e810ffa72,"Updated documentation to describe behaviour of XSLTC when the translet name
specified by the user contains characters that are not permitted as part of a
Java class name.

Reviewed by Sarah McNamara (mcnamara@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337635 13f79535-47bb-0310-9956-ffa450edef68"
cff593b5e7cea577d53f4ca42ad799e8c15c46c0,"Apply the patch from Richard Cao (richcao@ca.ibm.com) for bug 13082.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337636 13f79535-47bb-0310-9956-ffa450edef68"
146cead5ef0c263965d15c50ea986d460f6f93c5,"Updating PrintTraceListener to print information about the recently
added ExtensionEvents.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337637 13f79535-47bb-0310-9956-ffa450edef68"
a0f394323b79a06adfc73b01f2413a016493c1e7,"Update Trace sample to allow tracing of extension calls, as well as
optionally read the name of the stylesheet from the command line arguments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337638 13f79535-47bb-0310-9956-ffa450edef68"
1adca76f1bdf3628b38e8791adc55aca64648788,"Documenting the addition of the ExtensionEvent trace event, as well as
the Trace sample changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337639 13f79535-47bb-0310-9956-ffa450edef68"
df0eb0e4850c0ad1c770ee933134975ca9bf88a9,"PR: Bugzilla 23089
Submitted by:	Joanne Tong
Reviewed by:	Brian Minchau

A slight rework of Joanne's patch made by Brian and now commited to CVS.
 Also just previosly commited was a testcase, extend06 created by Joanne (thank!).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337646 13f79535-47bb-0310-9956-ffa450edef68"
78c323259d76f0a077574bce92167a3dc9346b7a,"Applying patch from Joanne Tong (joannet@ca.ibm.com) for Bugzilla bug report
16311.  After completing the relevant operations in applyTemplateToNode, the
method was popping various pieces of the context off of stacks.  However, in
the case of the default template rule for text nodes, it was trying to pop
variables off the stack, even though no variables had been pushed onto the
stack.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337647 13f79535-47bb-0310-9956-ffa450edef68"
bd5392c19b10d896b19f205a3e88db48f6161eb3,"Applying patch from Joanne Tong (joannet@ca.ibm.com) for Bugzilla bug report
23200.  The XPath syntax for a number is ""Digits ('.' Digits?)? | '.' Digits"".
The XPath parser accepted anything accepted by the Java double literal syntax,
including values using ""E"" exponential notation.  The fix was to guard against
any value using exponential notation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337648 13f79535-47bb-0310-9956-ffa450edef68"
5530cbc34aedc6a1ef64492b0d00fcb905ec44dc,"PR: bugzilla 23418
Submitted by:	Sarah McNamara
Reviewed by:	Brian Minchau
Updates to java/xdocs so that new webpages point to Apache Mirrors for
distribution.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337652 13f79535-47bb-0310-9956-ffa450edef68"
1e7b7563c22fb9553d42a9cc7a91ceb474c32dda,"Ensure we set a non-empty name for the translet even when one cannot be obtained from the systemId.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337655 13f79535-47bb-0310-9956-ffa450edef68"
4482d8d80ead98291774223463630650929702d5,"PR: bugzilla 22623
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro

Tabs in HTML attribute values are now output as charater 
references.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337657 13f79535-47bb-0310-9956-ffa450edef68"
dacd4bcc9f1c9707d78396b87ed754563ec8e5b0,"Fixed problem in XSLT parameter optimization. The search for the template being called should start from the top-level stylesheet. The incorrect signature was generated when xsl:template and xsl:call-template were located in different stylesheets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337658 13f79535-47bb-0310-9956-ffa450edef68"
8f42c64a8584c478e37048e084dcae8bce63ecdc,"PR: bugzilla 21471
Submitted by:	Joanne Tong
Reviewed by:	Brian Minchau
Stop some SAXExceptions from being quietly caught by the serializer.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337659 13f79535-47bb-0310-9956-ffa450edef68"
bf247d492a349196ed7c7139161d721da0677793,"*** empty log message ***


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337661 13f79535-47bb-0310-9956-ffa450edef68"
af2768b7c3a8a198273d3a92e3dea5f804fb9e2d,"(Committing this again to get the log message right! - c.f. revision 1.54)
1. Added Javadoc comments to instance variables.
2. getAllValidTemplates() now caches result in top-level stylesheet.
3. setSystemId() maps a file system path to a URI (if needed).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337662 13f79535-47bb-0310-9956-ffa450edef68"
a108c703aae10d80397ca900b811deed10d5743f,"1. New code to map relative paths to URIs in Include.java and Import.java.
2. If SourceLoader returns null, the JAXP API states that the processor
should attempt to resolve the reference. Changed the logic to do this.
(1 and 2 should solve some of the problems we have resolving relative
paths and also using URI resolvers. More testing is needed, though).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337663 13f79535-47bb-0310-9956-ffa450edef68"
eba17c37f88194d394ca0504035fb1386388a699,"Adding a new extension function for XSLTC. Using this extension function, it is
possible to recover type information lost by the use of xsl:param (see Bugzilla
19038). Here is an example:

<xsl:stylesheet version=""1.0""
    xmlns:xsl=""http://www.w3.org/1999/XSL/Transform""
    xmlns:java=""http://xml.apache.org/xalan/java""
    xmlns:xsltc=""http://xml.apache.org/xalan/xsltc"">

<xsl:param name=""object""/>

<xsl:template match=""/"">
    <xsl:value-of select=""java:length(xsltc:cast('java.lang.String', $object))""/>
</xsl:template>

</xsl:stylesheet>

Without using xsltc:cast(), XSLTC will report an error as the type of param
'object' cannot be determined statically. The type of xsltc:cast() is:

object[T] cast('T', reference | object[R])

where 'T' indicates that the type of the first argument must be a literal
string. A ClassCastException may be thrown at runtime if R is not convertible
to T.

I believe we still need a fully-dynamic solution that does not rely on this
extension function. However, the two solutions can coexists, especially since
using xsltc:cast() will always be more efficient than any alternative based
on Java reflection.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337664 13f79535-47bb-0310-9956-ffa450edef68"
a483ded2b97b71823763e7e4ed82493fccd7ceb2,"Propagated SecuritySupport and SecuritySupport12 classes to serializer package.
Code in Encoding that uses Class.getResource should instead use
SecuritySupport.getResourceAsStream.

Reviewed by Christine Li (jycli@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337665 13f79535-47bb-0310-9956-ffa450edef68"
afaae7de300a99809872e64f8fba16a63f311c09,"Patch for Bugzilla Bug 14607


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337666 13f79535-47bb-0310-9956-ffa450edef68"
5e6189ee1e7c7e6e64b158bcedff41d2fb4ad922,"PR: bugzilla 22422
Submitted by: Brian Minchau	
Reviewed by:	Naeim Semsarilar (person reporting the problem)

Get a system and public ID from the properties used to create a serializer
and used them to call appropriate methods on the ToXMLSAXHandler.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337668 13f79535-47bb-0310-9956-ffa450edef68"
dc74b57d66b0440df8115bca4ffe4a8653c4768a,"Fix for bugzilla 22342.

Rename variables with name ""enum"". In JDK 1.5, enum is a keyword.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337669 13f79535-47bb-0310-9956-ffa450edef68"
1f9f2f6c53dd12414f83bbcc39f6be44d00807d4,"Fix the makeNode and makeNodeList methods in SAXImpl for bugzilla 23115.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337671 13f79535-47bb-0310-9956-ffa450edef68"
559ec2b0fe882146bc2482fd20a188d5608d61a7,"Apply the patch for bugzilla 23271 from Bruno Fernandez-Ruiz (brunofr@olympum.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337673 13f79535-47bb-0310-9956-ffa450edef68"
9649ac59c088a9dba88969cdf1fe31320530d47a,"PR: bugzilla 15901
Submitted by:	Brian Minchau
Reviewed by:	John Meyer (bug reporter)

XSLTC now uses properties from the serializer's factory rather than
setting its own defaults. This makes XSLTC's default serialializer 
properties (indentation, entity file ... ) the same as Xalan-J.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337674 13f79535-47bb-0310-9956-ffa450edef68"
acf0a031b68acb4954c09e18db8932c33b3a5a71,"PR: bugzilla 15327	
Submitted by:	Christine Li
Reviewed by:	Brian Minchau

Fix for XSLTC problems with [last()] and [last()-1] predicates.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337677 13f79535-47bb-0310-9956-ffa450edef68"
f1fe874c26485b5ed7a177b607d071272dbbd35a,"Apply the patch for bugzilla 14149 from Joanne Tong (joannet@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337679 13f79535-47bb-0310-9956-ffa450edef68"
0e647703928eaac337c816b456f9f5e949f36a3f,"PR: bugzilla 23113
Submitted by:	Brian Minchau
Reviewed by:	Brian Minchau

The reset() in ToStream did not reset a few fields to the original values
that were obtained via "" new ToStream() "".  The applied patch fixes that.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337681 13f79535-47bb-0310-9956-ffa450edef68"
d435549de8a3ea5b7f79b30fa86afaa2009d66f4,"PR: bugzilla 23706
Submitted by:	Joanne Tong
Reviewed by:	Brian Minchau

Not only does this patch for ""fallback""  fix the bug in 23706 it also makes ver01 ver05 ver06 and ver07 pass
for the conformance tests!


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337682 13f79535-47bb-0310-9956-ffa450edef68"
9c67acf3b470f355a0e231bc6f9d20b994353c09,"PR: bugzilla 890
Submitted by:	 Richard Cao
Reviewed by:	Brian Minchau
Make sure a non standard property has a key with only one '{' and only one '}'
and that the '{' is first thing in the key.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337684 13f79535-47bb-0310-9956-ffa450edef68"
3b16ef0f2c9599057a8a95a5f5b1fd4860e33cd3,"Patch from Christine Li (jycli@ca.ibm.com) for Bugzilla bug report 22880.

When input comes from DOMSource, a TreeWalker object walks the DOM input and
fires events to the ContentHandler for the result object, unless the DOM
consists of only an Attribute node.  In the case of an Attribute, the TreeWalker
is not utilized, and just the character data is copied to the result.

As part of the traversal of the DOM, the TreeWalker always fires startDocument
and endDocument events.  The code in the transform(Source,Result) method was
redundantly firing those same events if the Node specified by the DOMSource
was not a Document node.  Instead, that should be left to the TreeWalker.  The
startDocument and endDocument events should only be fired in the transform
method itself to complete the entirely local processing of Attribute nodes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337685 13f79535-47bb-0310-9956-ffa450edef68"
527c4e5fa5d5e70e235b5583ceea012d8f7779c0,"Patch for Bugzilla Bug 7408. Submitrd by  Richard Cao.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337686 13f79535-47bb-0310-9956-ffa450edef68"
6a6996276e7c10b8fb3ede7ccb134b0a534e5c02,"Patch for Bugzilla Bug 5972. Submitrd by  Richard Cao.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337687 13f79535-47bb-0310-9956-ffa450edef68"
993e83d84c7c6c71953bcaaf6b8735933370f8dc,"Patch for Bugzilla Bug 788. Submitted by  Richard Cao.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337688 13f79535-47bb-0310-9956-ffa450edef68"
9c755392c7777782773f2b4a93246458c2196b2e,"Added the public key of ""Brian James Minchau"" to the xml-xalan/java/KEYS file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337689 13f79535-47bb-0310-9956-ffa450edef68"
ee417d3f586e6a078934503a41a378dc680db83f,"PR: bugzilla 16512
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau

This bug has existed since the earth cooled (Mid 2000).
Clearly 3 of 4 lines were commented out
// if (x)
//   diagnositcsWriter.print(...)/
// else
   diagnosticsWriter.print(...);

And it was printing a message that we were done, not in the spirit of quiet
success.  Richard Cao's patch is applied, the fourth line is now commented out as well.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337690 13f79535-47bb-0310-9956-ffa450edef68"
5e7a73c5c6e50de7c1a0a02046b84fbe905f936b,"Patch for Bugzilla Bug 789. Submitted by  Richard Cao.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337691 13f79535-47bb-0310-9956-ffa450edef68"
f296a1ebdc474bc8a8672b995bfe4070113cc969,"Replace ad-hoc code to resolve relative URIs by calls to the xml.utils.SystemIDResolver class. This change fixes a few a regressions and also simplifies the code in XSLTC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337692 13f79535-47bb-0310-9956-ffa450edef68"
49c71ae8ea0216ff05fad56bb641e44b235bcc00,"Allow conversion between types 'string' and 'object[java.lang.String]'.
Conversion is trivial as instances of both types have the same runtime
representation. This was needed in order to write expressions such
as,

    string:new(xsltc:cast('java.lang.String', $object))

where 'object' is a param bound to a value of type 'java.lang.String'.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337693 13f79535-47bb-0310-9956-ffa450edef68"
14d6a5089936aee09fbf6404f5ccf83f200fcdfe,"Patch from Richard Cao (richcao@ca.ibm.com) for Bugzilla bug 15700.

Added additional check to prevent unrecognised elements from the XSLT namespace
(or even recognized elements, other than xsl:stylesheet and xsl:transform)
from appearing as the outermost element in a stylesheet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337694 13f79535-47bb-0310-9956-ffa450edef68"
be7dc29c9b630846805bdb2dd7dff00b6182d3f2,"PR: bugzilla 20572 (javadoc generation failing under JDK 1.4)
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau

Did a further review and tested javadoc generation under JDK 1.4.1 and under 1.2.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337695 13f79535-47bb-0310-9956-ffa450edef68"
e9436b4ff7fcf5d80d2d3cfb6e2909c9079d6c42,"PR: bugzilla 20572 (javadoc generation failing under JDK 1.4)
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau

Did a further review and tested javadoc generation under JDK 1.4.1 and under 1.2.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337696 13f79535-47bb-0310-9956-ffa450edef68"
9602bad2aeccd2026d33c672bbc5c553d2eb8ba2,"PR: bugzilla 20572
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau

Forgot to commit this one part (build.xml).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337700 13f79535-47bb-0310-9956-ffa450edef68"
aaeb9e9fbac0bf539a8ee3644ac7126e6d06c091,"Patch from Christine Li (jycli@ca.ibm.com) for Bugzilla bug report 19823.

Added code to use a Hashtable to keep track of parameters set for an applet.
The old implementation allowed just one parameter to be specified for the
transformation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337702 13f79535-47bb-0310-9956-ffa450edef68"
fe28abf18bca1709de6d202944c50ea22ac45741,"Patch from Christine Li (jycli@ca.ibm.com) for Bugzilla bug report 22167.

When the zero-argument constructor of DOMSource, StreamSource or SAXSource is
invoked, and no setter method is called to specify an actual source, the
source should be treated as if it contained only a root node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337703 13f79535-47bb-0310-9956-ffa450edef68"
f9a8df9b1a2dabcdb32b9c2457c4520ae6f4d5d6,"Check for null before setting DTM base URI.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337706 13f79535-47bb-0310-9956-ffa450edef68"
958f46c1be7afcf527d1d60a61a68a9d1ebdeca4,"PR: Bugzilla 20572
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau
Renaming xalan2taglet.jar to xalan2jtaglet.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337707 13f79535-47bb-0310-9956-ffa450edef68"
da9a4fc036ef4571602a6f7df935278976fcbbb1,"PR: bugzilla 20572
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau
Richard added extra -breakiterator option when building javadoc for SDK 1.4 or higher
to get rid of warning messaes when doing the build.
This is a compatibility option.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337708 13f79535-47bb-0310-9956-ffa450edef68"
47942e082930c0ab9c1f868c0afcb77c0023ffcc,"Fix for regression in Resolve002 TCK.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337712 13f79535-47bb-0310-9956-ffa450edef68"
c00ea99eee5bcbd7233132537342d70ee9cccad6,"PR: bugzilla 23812
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro
Fixes incorrect handling of CDATA by a ToXMLSAXHandler. 
The CDATA was defined by calls to the LexicalHandler methods:
startCDATA()
endCDATA()

Henry would rather have a new flushPending() method which does not
flush a generated endCDATA() call, but I copied the contents of flushPending()
to the top of ToXMLSAXHandler.character(char[] chars, int off, int len)
anyways.  I didn't want to put a new flushPending() method on a SerializationHandler
interface.   I'm not completely happy with either choice so I left it as-was  - bjm


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337713 13f79535-47bb-0310-9956-ffa450edef68"
841fd22875c754e3d81b62cbf3316e47b95d5ec0,"PR: bugzilla 7205
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau/Henry Zongaro
Do NOT  have ToXMLSAXHandler always mirror namespaces given via
startPrefixMapping(""prefix1"", ""uri1"")
 as attribute values of the form xmlns:prefix1=""uri1""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337714 13f79535-47bb-0310-9956-ffa450edef68"
8cd83d52a3c603d220df3de0496e024bd57cefcd,"bugzilla 7205


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337715 13f79535-47bb-0310-9956-ffa450edef68"
5d49b8bdf8bb53f3b3b20aa5a4ba43fd0a3a5fbc,"PR: bugzilla 23983
Submitted by:	Brian Minchau
javadoc cleanup


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337716 13f79535-47bb-0310-9956-ffa450edef68"
b2d7b5f76e08ea7debe7388a2bad6bd59ccc7a02,"PR: bugzilla 23983
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337717 13f79535-47bb-0310-9956-ffa450edef68"
28941c8d4d52b8c7181cce745c49ae336e28bce8,"PR: bugzilla 23983
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337718 13f79535-47bb-0310-9956-ffa450edef68"
d390d4fb9ba613f47c0d58e88c62d7fcc216a324,"javadoc cleanup
PR: bugzilla 23983
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337719 13f79535-47bb-0310-9956-ffa450edef68"
a9691b4ba4615a9c0c3792d05893120d696059a9,"javadoc cleanup
PR: 23983
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337720 13f79535-47bb-0310-9956-ffa450edef68"
013e4e82c97d87495f8ac177b892ac433083d710,"javadoc cleanup
PR: bug 23983
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337722 13f79535-47bb-0310-9956-ffa450edef68"
2a319f696e5e136f90e03218472e74daebbc689a,"javadoc cleanup
PR: bug 23983
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337726 13f79535-47bb-0310-9956-ffa450edef68"
054fb19bcf5a55ebb2a02abd7e277bc30a1cbb41,"Fix to make SerializerFactory return a serializer even if the only
property specified is method=""xml""
PR: bugzilla 22025
Submitted by:	Brian Minchau
Reviewed by:	John Meyer (bug originator)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337729 13f79535-47bb-0310-9956-ffa450edef68"
59a1b45e295c4fc4884b3e6d2cc66ed8c22791df,"Apply Joanne Tong (joannet@ca.ibm.com) patch for bugzilla 23706,
with my own modifications. I also fixed bug 23896 in the same
patch.

This patch includes the fixes for the following:
1. an unsupported XSL element will trigger a syntax error in 1.0 mode.
2. In forward-compatibility mode, if an unsupported XSL element is in
a template, has no fallback, it will trigger a runtime error if it is
instantiated.
3. All fallback children are called in sequence. The old code only makes
use of the first fallback child.
4. Only direct fallback children are processed. The old code finds the fallback
from all descendants of an unsupported element, which is wrong behavior
according to the spec.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337730 13f79535-47bb-0310-9956-ffa450edef68"
656485363c1703b0205c87e49a88d3a5e5a41f3d,"Committing path for bugzilla 22438 from Bhakti Mehta (Bhakti.Mehta@sun.com). This patch fixes serialization problems of Templates objects in XSLTC. A user-defined URIResolver associated to a Templates object is also serialized whenever possible (i.e. if it is also serializable).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337732 13f79535-47bb-0310-9956-ffa450edef68"
17322b8ffe8ddd7ddec419b78b1bdc092436109c,"patch to emit emit error message for method=""text""
 when output character not valid in the output encoding.   
PR: bug 795
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337733 13f79535-47bb-0310-9956-ffa450edef68"
9ec5ca9ae3916849f0f9f81366588d41debc4082,"Error message for testcase attribseterr07
PR: bug 782
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337736 13f79535-47bb-0310-9956-ffa450edef68"
d94bdfa0642485643c2732e7e8798b4d998ebc8f,"Weird error message for wront NameSpace for stylesheet now
produces a more correct message.
PR: bug 5659
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337737 13f79535-47bb-0310-9956-ffa450edef68"
305d953258e0002155cb3f65a6f558108946d9fa,"PR: bug 24025
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337738 13f79535-47bb-0310-9956-ffa450edef68"
22e80c5111a63defe4ac23682312f74863657a8a,"Version and documentation updates for 2.5.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337740 13f79535-47bb-0310-9956-ffa450edef68"
bd86c5bb1dbf26931f06a792824af1e519114d73,"Update for 2.5.2


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337741 13f79535-47bb-0310-9956-ffa450edef68"
a8b9594bc79c0261123740f6631d836ff102d180,"Updates for 2.5.2 packaging


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337742 13f79535-47bb-0310-9956-ffa450edef68"
880d1716d8d3c59202ac351fe369cfde97280528,"Fixed a typo.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337743 13f79535-47bb-0310-9956-ffa450edef68"
1d575065eef685c716076f7bce035cca1f11fb08,"Shouldn't be able to call a template with no prefix:
<xsl:template name="":tmplt1"">
PR: bug 3415
Submitted by:	Richard Cao
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337744 13f79535-47bb-0310-9956-ffa450edef68"
7ecdb4d7eea80045a76b3aeee82ad4e655f0da43,"PipeDocument was not calling out.close() when done with the 
FileOutputStream ""out"".

PR: bug 24013
Submitted by:	Pierre Chardin (bug reporter)
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337746 13f79535-47bb-0310-9956-ffa450edef68"
5047566f95c4db9b95de3ec2c9215cf77e4eb4ce,"Patch from Sarah McNamara (mcnamara@ca.ibm.com) with final documentation
updates in preparation for Xalan-Java 2.5.2 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337747 13f79535-47bb-0310-9956-ffa450edef68"
8e9ca3b2ab9013323080f7f1e69e595d46ea13f4,"Use translet as whitespace filter if it implements the StripFilter interface (This class should probably be deprecated to avoid having to get it in sync with the Process class).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337750 13f79535-47bb-0310-9956-ffa450edef68"
a29b068c434bd084ec658ef23b228158783f797a,"Patch for Bugzilla 24187 by Bhakti Mehta (Bhakti.Mehta@sun.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337752 13f79535-47bb-0310-9956-ffa450edef68"
ada0c1f8a705bdbcc094bd34fd7058014a478116,"Patch for Bugzilla 24188 by Bhakti Mehta (Bhakti.Mehta@sun.com). The runtime now attempts to resolve a reference when the URI resolver returns null.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337753 13f79535-47bb-0310-9956-ffa450edef68"
71469182c38295b4146ce80652fccb58ea26eb37,"Committing patch for Bugzilla 24414 by Bhakti Mehta (Bhakti.Mehta@sun.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337754 13f79535-47bb-0310-9956-ffa450edef68"
5474113c23509da987f9080a62b3ee5cdff33f06,"Patch for Bugzilla 24518 by Mehta Bhakti (Mehta.Bhakti@sun.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337756 13f79535-47bb-0310-9956-ffa450edef68"
a8f5d75efd1a84c5f59919d339f5ec0e68c02b96,"Patch for Bugzilla 24695 by Bhakti Mehta (Bhakti.Mehta@sun.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337757 13f79535-47bb-0310-9956-ffa450edef68"
f6ed7b6cd6f450570094455a797a9e5fda190640,"Use Xerces as the default provider for property org.xml.sax.driver. Even though this property is set in XercesImpl.jar, it is sometimes undefined, which causes failures in the conf tests. More investigation is needed, but for now this patch fixes the problem.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337758 13f79535-47bb-0310-9956-ffa450edef68"
36ff1bb6fe07abff0bae6f881db65d7f8995af0e,"Moved and modified Xerces' fallback code for the creation of XMLReaders. This fallback does not belong here and will be removed after we figure out why is needed.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337760 13f79535-47bb-0310-9956-ffa450edef68"
c144787a9a0481d17b2916812b9ef0ace77e834f,"Updated patch for Bugzilla 24695 by Bhakti Metha. This patch gets an XMLReader from a SAXParserFactory if unable to obtain one from an XMLReaderFactory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337761 13f79535-47bb-0310-9956-ffa450edef68"
ca1d0a28bbd9384d85652397ab6a32bda860e0ab,"Patch from Morris Kwan (mkwan@ca.ibm.com), reviewed by myself, with a tweak
or two from myself, reviewed by Morris.

Split namesArray in translet into three arrays:  namesArray, urisArray and
typesArray.

Previously, entries in the namesArray had to be examined at run-time to
distinguish those that represented elements, from those that represented
attributes (prefixed by an '@'), and those that represented namespace node
names (prefixed by a '?').  In addition, any namespace URI for the element or
attribute was similarly stored in the namesArray entry.  So,
""http://example.org:abc"" and ""http://example.org:@abc"" respectively represented
an element and an attribute named abc in the http://example.org namespace;
""?abc"" represented a namespace prefix of abc.

With this change, the namesArray will have entries for ""abc"" in all three
cases; the urisArray will contain entries for ""http://example.org"" for the
element and attribute, and an empty string for the namespace prefix; and the
typesArray will contain the value 1 for the element, 2 for the attribute and 13
for the namespace (which correspond to the DTM constant values for those kinds
of nodes).

In addition, these values are stored in static arrays in the translet, and
references to those arrays are copied to instance fields in the translet's
constructor, rather than constructing arrays and initializing all their entries
in the constructor each time.

All this serves to reduce the overhead of initializing a transformation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337762 13f79535-47bb-0310-9956-ffa450edef68"
16b702916901cf69d0c4c3ac21ab1dba3cd7c807,"Patch from Morris Kwan (mkwan@ca.ibm.com), reviewed by myself:

Split namesArray in translet into three arrays:  namesArray, urisArray and
typesArray.

Previously, entries in the namesArray had to be examined at run-time to
distinguish those that represented elements, from those that represented
attributes (prefixed by an '@'), and those that represented namespace node
names (prefixed by a '?').  In addition, any namespace URI for the element or
attribute was similarly stored in the namesArray entry.  So,
""http://example.org:abc"" and ""http://example.org:@abc"" respectively represented
an element and an attribute named abc in the http://example.org namespace;
""?abc"" represented a namespace prefix of abc.

With this change, the namesArray will have entries for ""abc"" in all three
cases; the urisArray will contain entries for ""http://example.org"" for the
element and attribute, and an empty string for the namespace prefix; and the
typesArray will contain the value 1 for the element, 2 for the attribute and 13
for the namespace (which correspond to the DTM constant values for those kinds
of nodes).

In addition, these values are stored in static arrays in the translet, and
references to those arrays are copied to instance fields in the translet's
constructor, rather than constructing arrays and initializing all their entries
in the constructor each time.

All this serves to reduce the overhead of initializing a transformation.


Patch from myself, reviewed by Morris Kwan:

Introduced a versioning mechanism in AbstractTranslet.  After constructing an
object of a class that extends AbstractTranslet, the postInitialization method
must be called.  That method will detect any versioning differences that can
be resolved automatically, if a translet was compiled with an older version of
the XSLTC than is being used at run-time.  The version number is stored in the
translet's transletVersion field.

In many cases, incompabilities run up against Java's binary compatibility
rules, and fail catastrophically.  This versioning mechanism is designed to
detect those cases that can't be detected by the JVM.  The first use of this
mechanism is to translate from the old form of the namesArray used by old
translets, to the new form expected by the modified version of the XSLTC
run-time, as described above.

In addition, if the translet version detected by the XSLTC run-time is more
recent than any supported by the XSLTC run-time, an error will be reported.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337763 13f79535-47bb-0310-9956-ffa450edef68"
65d03329929c20a7aca87205d5b6a8a8a30a9c72,"Patch from myself, reviewed by Morris Kwan (mkwan@ca.ibm.com):

Introduced a versioning mechanism in AbstractTranslet.  After constructing an
object of a class that extends AbstractTranslet, the postInitialization method
must be called.  That method will detect any versioning differences that can
be resolved automatically, if a translet was compiled with an older version of
the XSLTC than is being used at run-time.  The version number is stored in the
translet's transletVersion field.

In many cases, incompabilities run up against Java's binary compatibility
rules, and fail catastrophically.  This versioning mechanism is designed to
detect those cases that can't be detected by the JVM.  The first use of this
mechanism is to translate from the old form of the namesArray used by old
translets, to the new form expected by the modified version of the XSLTC
run-time, as described above.

In addition, if the translet version detected by the XSLTC run-time is more
recent than any supported by the XSLTC run-time, an error will be reported.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337764 13f79535-47bb-0310-9956-ffa450edef68"
4f2c31e0ff1e05c3ec04ea6cdc74f55e86d10300,"Submitted by:	Brian Minchau
Just indentation and whitespace changes in the code
(trying to get Apache head and the xslt2.0-compiled branches closer).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337768 13f79535-47bb-0310-9956-ffa450edef68"
9528c4b4ff4e373aee799c60c7628c6c12c3a2e1,"PR: bugzilla 24278
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337769 13f79535-47bb-0310-9956-ffa450edef68"
197fff62e014c399cba754d6f807c1b43d9f252d,"PR: bugzilla 24423
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337770 13f79535-47bb-0310-9956-ffa450edef68"
15bcabe070b6baf3e57ff460a67a1e0e7fea9df2,"Submitted by:	Brian Minchau
Just indentation and whitespace changes in the code
(trying to get Apache head and the xslt2.0-compiled branches closer).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337771 13f79535-47bb-0310-9956-ffa450edef68"
05ed8d19e86b562b4b81150c9f4903f3f4fc5f7d,"PR: bugzilla 24958
Submitted by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337772 13f79535-47bb-0310-9956-ffa450edef68"
be53da1e7502143b70f530cbcd777707e9b3b818,"Transform Thread sample. Submitted by  Richard Cao.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337774 13f79535-47bb-0310-9956-ffa450edef68"
72b55abb6c5f97b4dd289bc741ec4977c96bd636,"Moved code for caching XMLReader objects from XSLTC's TransformerFactoryImpl to
a new org.apache.xml.utils.XMLReaderManager class.

It is now the responsibility of the DTMManagerDefault class to request one of
these cached XMLReader objects, so the benefit of reusing an XMLReader is now
conferred upon both XSLTC and Xalan-J Interpretive, as well as upon references
to the document() function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337775 13f79535-47bb-0310-9956-ffa450edef68"
311e345f673089fcf1509f5061b8fb80cfb4036a,"Changes to permit different DTM implementations to be supplied to XSLTC.

Part of the change was to replace hard-coded references to SAXImpl with
references to a new interface - DOMEnhancedForDTM.  This part of the change was
supplied by Joseph Kesselman (keshlam@us.ibm.com).

The other part of the change was to use ObjectFactory to look up a new XSLTC
DTM Manager service provider (org.apache.xalan.xsltc.dom.XSLTCDTMManager).  The
provider is looked up once when a TransformerFactory is created, and used by
any Transformer objects created by that TransformerFactory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337776 13f79535-47bb-0310-9956-ffa450edef68"
fe106fb4344d46f23d1b661a95ac0ae1f07eb3f8,"Changes to permit different DTM implementations to be supplied to XSLTC.

XSLTC will now use ObjectFactory to look up a new XSLTC DTM Manager service
provider (org.apache.xalan.xsltc.dom.XSLTCDTMManager).  The provider is looked
up once when a TransformerFactory is created, and used by any Transformer
objects created by that TransformerFactory.

Also, moved code for caching XMLReader objects from XSLTC's
TransformerFactoryImpl to a new org.apache.xml.utils.XMLReaderManager class.

It is now the responsibility of the DTMManagerDefault class to request one of
these cached XMLReader objects, so the benefit of reusing an XMLReader is now
conferred upon both XSLTC and Xalan-J Interpretive, as well as upon references
to the document() function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337777 13f79535-47bb-0310-9956-ffa450edef68"
dd495db9f1235fde3233329cddca6a0e244e2fdb,"Factored out part of ObjectFactory's createObject method into separately
callable lookUpFactoryClass and lookUpFactoryClassName methods.  This allows
the caller to cache the Class object that provides a service at an appropriate
level, and create new instances of that class at will, rather than going
through the expensive service provider look-up procedure for each and every
object created.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337778 13f79535-47bb-0310-9956-ffa450edef68"
7146262ded9a10d7ec390b8eac2d00e2eac75829,"Added comments to describe the situation in which this iterator is used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337779 13f79535-47bb-0310-9956-ffa450edef68"
7e0e2059b99888e2bd81fe2ad91ffab48c8bbb1d,"Reflection code to load sun.io.CharToByteConverter is now wrapped in a privileged action. This is needed when user code is run without the required permssions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337780 13f79535-47bb-0310-9956-ffa450edef68"
824cc5604014462afd6cc18fbd49869d57d0ae55,"Upgrading to version 2.6.0 of Xerces-Java.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337781 13f79535-47bb-0310-9956-ffa450edef68"
50fbb01fc708b4bdda0754c6e5027fad623cb43a,"Upgrading to xml-commons-external-1.2.01 release, and moving to new naming
convention for xml-commons source file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337782 13f79535-47bb-0310-9956-ffa450edef68"
0f6cbe8de4033b5dcf7458d947961041ca870616,"Avoid RuntimeException(Throwable) as it is only available in JDK 1.4.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337786 13f79535-47bb-0310-9956-ffa450edef68"
8afeca4ffee1ce47f54397da53634ef3b8811477,"Creation of translet's class loader should be wrapped in a doPrivileged block (java.lang.RuntimePermission createClassLoader).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337791 13f79535-47bb-0310-9956-ffa450edef68"
fed23200ec18fb9d18cb057fb604aad5d6b4512d,"Applying patch from Richard Cao (richcao@ca.ibm.com) for Bugzilla bug report
797.

Added code that checks whether an xsl:param, xsl:variable or xsl:with-param
has both a select attribute and content.  Also, new test case to test for
message in case of xsl:with-param, and updated messages in existing tests for
xsl:param and xsl:variable.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337792 13f79535-47bb-0310-9956-ffa450edef68"
53c44d5b2a562f620df4541347202030913acb61,"Applying patch from Richard Cao (richcao@ca.ibm.com) for Bugzilla bug report
5761.

Removed code that caused keys to be ignored when they select an empty set of
values.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337793 13f79535-47bb-0310-9956-ffa450edef68"
299f533e8c771a4cee4034ecfa092f98609f9fd1,"Something went wrong with that last commit!  This is the real Xerces-J 2.6.0.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337794 13f79535-47bb-0310-9956-ffa450edef68"
4242980aae22442d73459d10a737583eaa16fd6e,"Adding explicit final keyword to the intended constants which are defined with public static keywords. This will avoid the problem of cross site java sandbox violation.
  In the case of xsltc/compiler/util/Util.java making the ""filesep"" variable to private to avoid the  chance of somebody else changing the value of this static variable


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337796 13f79535-47bb-0310-9956-ffa450edef68"
e23e5dc7ba2c40c1f52df5079a4aa728bad7af33,"Take advantage of DTM pluggability support for XSLTC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337797 13f79535-47bb-0310-9956-ffa450edef68"
e598639403280df1a93f7d510348d13945936093,"The getDOM method might be entered more than once during a transformation, so
the DTMManager that is created the first time in must be saved so that
subsequent DTM's can be created with respect to it, and then discarded at the
end of the transformation.

This change restores logic that I had foolishly eliminated with my previous
change to this file.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337798 13f79535-47bb-0310-9956-ffa450edef68"
666fafefb4b96bf6784b213ba0cabe2e9315ebb9,"Added a finally block for SAXSource/StreamSource case in order to ensure that
any XMLReader is released to the XMLReader cache.

Thanks to Joanne Tong (joannet@ca.ibm.com) for catching this bug when she
reviewed my changes to where caching of XMLReaders was handled, and the DTM
plugability changes for XSLTC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337799 13f79535-47bb-0310-9956-ffa450edef68"
dc6731f0a995e2d9baa9c294c570f3e2aa134cf4,"Created a named constant for ""META-INF/services"" string.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337800 13f79535-47bb-0310-9956-ffa450edef68"
3ff0e2d37b8c602c816d5a01208c225bc86a51e2,"Patch for XSLTC's parameter optimization introduced in 2.5.2. The problem is that a param's default value can now be compiled multiple times, once for every call to the template for which that param is not specified. This essentially turns the AST into a graph, which requires the state of a param subtree to be reset after the each compilation. In particular, the variable Expression._startReset was not reset and this resulted in calls to setStartNode() to be generated only the first time the param's default value was compiled. After some analysis, I realized that _startReset was no longer necessary, so I removed it. I also renamed Expression.startResetIterator() to Expression.startIterator() since calls to reset() are no longer generated within this method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337808 13f79535-47bb-0310-9956-ffa450edef68"
e848d728ae9725bca4c0b957cf56c8419a36715d,"Setting the maximum fraction digits on a DecimalFormat object to Integer.MAX_VALUE causes problems in some JDKs. Since only doubles need to be formatted, I've changed the code to set the maximum to 340. I've also optimized formatNumber(), the new version uses setters on the DecimalFormat object instead of calling toPattern().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337809 13f79535-47bb-0310-9956-ffa450edef68"
9822487b4b9803af66148beceb78a277014b28be,"Moving classes that are used between Xalan interpretive and XSLTC ( StylesheetPIHandler and StopParseException )  to xml/utils package . Making the required modifications to accomadate this change.

 Thanks to Bhakti for the Patch

Submitted by:	Bhakti Mehta ( bhakti.mehta@sun.com )
Reviewed by: Ramesh Mandava


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337810 13f79535-47bb-0310-9956-ffa450edef68"
5e00b5b0f091d4f5aa24ef2d88b8afcd245478d9,"Type conversions from internal to external Java types revisited: (1) Type.Int and Type.Real are now treated identically given that the former is an optimization for the latter (i.e. their use should be transparent to the user) (2) Better support Type.Reference, conversions to integral types are now supported. There are still some conversions that are supported by Xalan and not by XSLTC. We need to either revisit the conversion table for XSLTC or document the differences.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337811 13f79535-47bb-0310-9956-ffa450edef68"
b44c885dcfd35b5393ef737d9e0cc87a3fdb25da,"The parameter optimization implemented in 2.5.2 does not work in all cases. The problem (see Bugzilla 25449) is that a param's default value needs to be compiled multiples when there are mulitple calls the a template none of which has a correspoding with-param. However, ASTs store an internal state which is not restored after compilation; consequently, only the first compilation is guaranteed to succeed. Stated differently, the AST cannot be operated as a graph because sub-tree sharing causes problems.

The optimization has now been changed so that a param default value is compiled only once by the callee instead of multiple times by each caller. A caller will now pass 'null' when there is no with-param; a callee will only initialize a param if its value is 'null'. This ensures that default values are compiled exactly once while at the same time preserving the XSLT semantics.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337812 13f79535-47bb-0310-9956-ffa450edef68"
9fb185b786a1b274fcbc56d1e548b2559a2cd74a,"Fixed a bug I injected recently - missing slash between 'META-INF/services' and service name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337813 13f79535-47bb-0310-9956-ffa450edef68"
352bf0643266751d842b5ecaec03d7c1581a5869,"Made methods in this class public, as is the case in the XPathVisitor class that
it extends.  Having the class be public, but none of the methods public isn't
helpful.

Contributed by Warwick Burrows (wburrows at us.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337814 13f79535-47bb-0310-9956-ffa450edef68"
5a8e3101c6b5c274edfcb7c47d79547a936bf593,"SAXImpl.startDocument was calling SAX2DTM.startDocument followed by
SAX2DTM.startPrefixMapping for the xml prefix.  However, the
SAX2DTM.startElement always ensures the xml prefix is declared for the first
element.  The effect of the startPrefixMapping call was to create two namespace
nodes on the first element declaring the xml prefix.  This had no discernible
consequence, except to throw off the numbering of subsequent nodes with the
generate-id() function.

I've eliminated the redundant call to startPrefixMapping, and adjusted the gold
test output files for the generate-id function.

Reviewed by Christine Li (jycli at ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337815 13f79535-47bb-0310-9956-ffa450edef68"
23ebf4e4b27a27368be98c22817b37d5f7df750c,"Updating the copyright dates to reflect recent modifications.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337817 13f79535-47bb-0310-9956-ffa450edef68"
f670a7c8d2b5ab5a99351b82bd9aa3d2df78c3b2,"Updating build copyright year.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337818 13f79535-47bb-0310-9956-ffa450edef68"
f2b82c154fdc4f2c6a49716ed7fc826309ffc691,"Fix for Bugzilla 25924 by Bhakti Mehta (Bhakti.Mehta@sun.com). Variable _lastNext must be preserved in setMark() and restored in gotoMark().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337820 13f79535-47bb-0310-9956-ffa450edef68"
0785bdb35d922dc4b02312b59589af02ec3efa9d,"Committing a patch from Bhakti Mehta (Bhakti.Mehta@sun.com). ForwardPositionIterators and ForwardPositionExprs are not needed anymore after the intergration with DTM. Despite that, ForwardPositionIterators were still being used even though they did not provide any additional functionally (they were basically identity iterators). This patch eliminates the need for these iterators (and the corresponding compile-time expressions) and also replaces calls to BasisLibrary.positionF() with calls to currentIterator.getPosition(). The resulting code should be smaller and faster.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337821 13f79535-47bb-0310-9956-ffa450edef68"
7c18368c7a9b321c8bada03f78b9cd5b125a5319,"Removing unused constant.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337822 13f79535-47bb-0310-9956-ffa450edef68"
d9ccfb002a7b6d9371591e817ab4f9e63c4927a6,"PR: 26169
Submitted by:	Brian Minchau
Flushed serialier before emitting trace event in ElemeTextLiteral and
ElemLiteralResult.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337823 13f79535-47bb-0310-9956-ffa450edef68"
e77ab7779a97f732f71008ce5bacfe9400ac192a,"XSLT->Java and Java->XSLT conversion table revisited. I made sure that two internal types corresponding to the same XSLT type had identical conversion rules (e.g. IntType and RealType). The multi-step conversions NodeSetType->int and ResultTreeType->double have been eliminated in order to simplify the table (they can always by implemented externally). The resulting conversion table is still not identical to the interpreter (and perhaps it will never be) so it should be documented separately.
   Parameters
   ----------------------------------------------------------------
   XSLT type       Java Type
    boolean        boolean, java.lang.Boolean, java.lang.Object
    number         double, java.lang.Double, float, long,
                   java.lang.Integer, int, short, byte, char,
                   java.lang.Object
    string         java.lang.String, java.lang.Object
    node-set       org.w3c.NodeList, org.w3c.Node, java.lang.Object,
                   java.lang.String
    result-tree    org.w3c.NodeList, org.w3c.Node, java.lang.Object,
                   java.lang.String

    Return type
    ---------------------------------------------------------------
    boolean           boolean
    void              (ignored)
    char, byte,
    short, int,
    long, float,
    double            number
    java.lang.String  string

For parameters, the order on the right column of the table is significant --following the convention already in used in the docs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337824 13f79535-47bb-0310-9956-ffa450edef68"
f6efe907359200f645aa1cdb29f75d6ff013734d,"Building TransformThread sample


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337825 13f79535-47bb-0310-9956-ffa450edef68"
918cf7e37183286520cf390b76cceca179714edb,"Fix for bugzilla bug report 25442.

Record the initial empty sizes of the various vectors in the DTM, and use those
sizes as the defaults in popRewindMark.  The code originally assumed that these
vectors had default sizes of zero, but that's not true in the case of m_data,
which reserves entry zero.

Reviewed by Christine Li (jycli () ca!ibm!com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337828 13f79535-47bb-0310-9956-ffa450edef68"
cf1be2995c3b5d54684ad6520d3ae034ae2be78c,"Fix for bugzilla bug report 23046.

For included stylesheet, set the _numberFormattingUsed flag to true
for its including stylesheet too

Reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337829 13f79535-47bb-0310-9956-ffa450edef68"
6668e62beab2b679f877a21bf3d2da6390197362,"Fix for bugzilla bug report 19464

A reworked patch, move the push statements to the beginning of try block
and added a flag to make sure that there is always something to pop

Reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337831 13f79535-47bb-0310-9956-ffa450edef68"
0d920f8e9c5153f713607775e5a1ccd00829217d,"Fix for bugzilla bug report 26019

detach location path iterators happens only when allowDetach flag is true.

Reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337832 13f79535-47bb-0310-9956-ffa450edef68"
3b39400cafa35e23876c48082fac35f015cbad42,"Fix for bugzilla bug report 18351.

xsl:message instruction is allowed inside func:function.
It doesn't construct nodes as part of the result.

Reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337833 13f79535-47bb-0310-9956-ffa450edef68"
2cd8335e36931947dd468bf6420b37a20c393e3a,"Fix bugzilla bug report 18351.

Set allowDetachToRelease flag to false, which allow caching of the arguments

Reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337834 13f79535-47bb-0310-9956-ffa450edef68"
89b890892bda8b4ff78ae5f2594b1a5c240805c8,"Patch for Bugzilla 19194. I've made the following changes: (i) re-wrote Predicate.typeCheck() (ii) the predicate optimizations are turned off for FilterExpr, as they don't apply in all cases (iii) sync up Step, StepPattern and FilterExpr to accomodate the new changes. The interaction between these classes is non-trivial, and the code for some optimizations is brittle, to say the least. As part of this patch, I rolled back a patch to FilterExpr and fixed Bugzilla 25783 which wasn't really related despite what the bug report states. For the 2.0 work, it would be nice to place optimization code in separate classes so that it can be easily maintained and also easily deactivated via a command-line flag.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337835 13f79535-47bb-0310-9956-ffa450edef68"
68c868c8e46421490883e56e4101cc80a11a70c3,"Fix for Bugzilla Bug 26075.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337836 13f79535-47bb-0310-9956-ffa450edef68"
ce713b9a8ebf0e18fffe074d3e1d44903f9d5e02,"Fix for Bugzilla Bug 25416.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337837 13f79535-47bb-0310-9956-ffa450edef68"
bd71446ea34f314fd2890a6bfe600cec5ae217bf,"Applying Joanne Tone's (joannet@ca.ibm.com) patch for
bugzilla bug report 26030.

Do not suppress Xalan specified extension element namespace, unless they
are declared as extension element namespaces by users


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337838 13f79535-47bb-0310-9956-ffa450edef68"
0fd44aafe773f989c0477052fb8d6ffd3054fa25,"Fix for bugzilla bug report 24111.

The string values for both positive and nagative zero are 0. However,
a number div 0 returns Infinity, a number div -0 returns -Infinity.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337839 13f79535-47bb-0310-9956-ffa450edef68"
7e6f892ef25d8623499fc1bb7da2ad27d486ff60,"New Apache 2.0 license


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337841 13f79535-47bb-0310-9956-ffa450edef68"
19f7da2d43a69c8c8b79e8daba547e7860323a30,"New Apache 2.0 license


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337842 13f79535-47bb-0310-9956-ffa450edef68"
3ba6f45da49cdd4215a092d544bf4ded8c731f9e,"Fix for bugzilla bug report 26829.

Modified build.xml to add xalanj2taglet.jar to Xalan source distribution
Contributed by Sarah McNamara (mcnamara@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337843 13f79535-47bb-0310-9956-ffa450edef68"
bf2fb8d45e33c92795a683b28228a68388728a1a,"New Apache 2.0 license


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337844 13f79535-47bb-0310-9956-ffa450edef68"
a9448595a778cc5c715b6fede9d33a74a3ac7228,"New Apache 2.0 license


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337845 13f79535-47bb-0310-9956-ffa450edef68"
44b55b7c88b424e0adf3862a4914876f6ad4b7c1,"Fix for Bugzilla 24788. NodeValue optimization was too optimistic. Since the value in 'step = value' is not compiled in the predicate's context, it must be limited to expressions that are context independent, but this was not the case as the example in 24788 shows.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337846 13f79535-47bb-0310-9956-ffa450edef68"
234d51b1088489512885097c858a2abcdd0ec775,"Fix for bugzilla bug report 24302.

Fields in the object representing an EXSLT function element (ElemExsltFunction)
were being used to store execution state information for references to that
function.  That caused problems with multi-threaded code that used Transformer
objects created from the same Templates object - each Transformer shares the
same instances of ElemExsltFunction.

The fix was to replace the fields ElemExsltFunction.m_result and
ElemExsltFunction.m_isResultSet with a new ObjectStack field in TransformerImpl
named m_currentFuncResult.

Also, the ElemExsltFunction.setCallerFrameSize method has been removed, so the
references to that function were dropped.  The ElemExsltFunction.execute method
is now responsible for managing the variable stack on its own.

Reviewed by Morris Kwan (mkwan () ca!ibm!com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337847 13f79535-47bb-0310-9956-ffa450edef68"
7860aa23a12685f8b29b52ee1a204147fe11bb3a,"Fix for bugzilla bug report 24302.

Fields in the object representing an EXSLT function element (ElemExsltFunction)
were being used to store execution state information for references to that
function.  That caused problems with multi-threaded code that used Transformer
objects created from the same Templates object - each Transformer shares the
same instances of ElemExsltFunction.

The fix was to replace the fields ElemExsltFunction.m_result and
ElemExsltFunction.m_isResultSet with a new ObjectStack field in TransformerImpl
named m_currentFuncResult.

Also, changed how VariableStack was being updated in the execute method for a
function reference - this change was modelled on equivalent code in
ElemCallTemplate.

Reviewed by Morris Kwan (mkwan () ca!ibm!com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337848 13f79535-47bb-0310-9956-ffa450edef68"
e2d3fe18193e5e8c6a0187680a84d967de3d44eb,"Fix for bugzilla bug report 24302.

Fields in the object representing an EXSLT function element (ElemExsltFunction)
were being used to store execution state information for references to that
function.  That caused problems with multi-threaded code that used Transformer
objects created from the same Templates object - each Transformer shares the
same instances of ElemExsltFunction.

The fix was to replace the fields ElemExsltFunction.m_result and
ElemExsltFunction.m_isResultSet with a new ObjectStack field in TransformerImpl
named m_currentFuncResult.

Reviewed by Morris Kwan (mkwan () ca!ibm!com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337849 13f79535-47bb-0310-9956-ffa450edef68"
4d0eaee364bb1c23707b45cf09d132a35941f8e7,"Fix for bugzilla bug report 24302.

Changed condition under which the parent element's m_inArgsSize field is
incremented - that field keeps track of the number of xsl:param children an
element has.  This was only happening for ElemTemplate, but it needs to happen
for ElemExsltFunction, which is a subclass of ElemTemplate, as well.

Reviewed by Morris Kwan (mkwan () ca!ibm!com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337850 13f79535-47bb-0310-9956-ffa450edef68"
e660b1d0dea550303b55a3a230080b49eefec63c,"Fix for Bugzilla Bug 26842.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337851 13f79535-47bb-0310-9956-ffa450edef68"
681b70aa7cbad89f0cf76f98189696fd6d5498b7,"Committing patch by Bhakti for XSLTC. If attributes are created without an explicit prefix, then NamespaceMappings.generateNextPrefix will be called to generate a prefix. Also if elements are created using createElementNS(null,localname) then they will be serialized properly without being in default namespace.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337859 13f79535-47bb-0310-9956-ffa450edef68"
dc38f5b0c08357e95c573e1393795eb382831ef2,"Fix for Bugzilla Bug 1396


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337861 13f79535-47bb-0310-9956-ffa450edef68"
3e3ed1b9de617b88a2053c7525fc7b6d747b4d79,"A slightly faster implementation of round function


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337862 13f79535-47bb-0310-9956-ffa450edef68"
477f22dff01a1a40ca7368d2523ee4de5cdaeb5e,"Fix a bug introduced during optimizing for the previous code
Should check for NaN cases


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337865 13f79535-47bb-0310-9956-ffa450edef68"
1e75985a4a8aa15264fec6ef111f7cf0f4d47b6c,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337866 13f79535-47bb-0310-9956-ffa450edef68"
9ae71aa649bb9eed85e88ce5f791c484f50f136c,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337867 13f79535-47bb-0310-9956-ffa450edef68"
6feeac7dd2c8c6d6c136b67e6308066ef025cc92,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337868 13f79535-47bb-0310-9956-ffa450edef68"
96cf5860ada40068a66b739d082ef98ac5337b3d,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337869 13f79535-47bb-0310-9956-ffa450edef68"
a7b6f075d11748f91ac2081e070c9a60c0827931,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337870 13f79535-47bb-0310-9956-ffa450edef68"
3b3627e1d6b91d7198d9d1d12821f5359fb5400b,"Update to Apache 2.0 license.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337871 13f79535-47bb-0310-9956-ffa450edef68"
807521108ac0add4a022508647782ba40e5fa03e,"Update to Apache 2.0 license.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337872 13f79535-47bb-0310-9956-ffa450edef68"
9b7234297710781c656eb06be8e69c42246350ed,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337873 13f79535-47bb-0310-9956-ffa450edef68"
a28c835d9358b45c23066350bf9b9d7becaf92eb,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337874 13f79535-47bb-0310-9956-ffa450edef68"
50b76a71f76d5227a5d9e45733076ebbd1d5564d,"Fix for Bugzilla Bugs 22564 and 22808


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337875 13f79535-47bb-0310-9956-ffa450edef68"
052d6fea7e7a106b68c50b7bc94574826c2a6ab4,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337876 13f79535-47bb-0310-9956-ffa450edef68"
0af3305d54b5d1e7a6877068c9fd775f2fc63f88,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337877 13f79535-47bb-0310-9956-ffa450edef68"
03789a3237186e56388d692aa2440ffbe4ec711f,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337878 13f79535-47bb-0310-9956-ffa450edef68"
7e0fa6c7996cfd86c847b51579f2538be0f3eba5,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337879 13f79535-47bb-0310-9956-ffa450edef68"
d5f944aaa31461f19a6163ccc5366d5421f1c0ba,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337880 13f79535-47bb-0310-9956-ffa450edef68"
e296a4049e5b91f03bbe79fde034ad922325e2c9,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337881 13f79535-47bb-0310-9956-ffa450edef68"
06d4dba7ba1f454eef14f26b82c51a18439850e3,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337882 13f79535-47bb-0310-9956-ffa450edef68"
fd834b09669b3c89366931f33564ee1a4af786ae,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337883 13f79535-47bb-0310-9956-ffa450edef68"
e237de2262e39944d5052f84de870cccefa09b4b,"New Apache 2.0 license update.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337884 13f79535-47bb-0310-9956-ffa450edef68"
d33468f5239da12c2f0679693617777886a28111,"PR: bugzilla 26217
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro

Programming instructions don't have a namespace, so make
the PI with no namespace be ""xalan-doc-cache-off"" rather than
""xalan:doc-cache-off""
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337885 13f79535-47bb-0310-9956-ffa450edef68"
c344b4e2e3d90a7246f2a6ee4d737efa847e7310,"PR: bugzilla 26217
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro

This is a javadoc update only.
Programming instructions don't have a namespace, so make
the PI with no namespace be ""xalan-doc-cache-off"" rather than
""xalan:doc-cache-off""
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337886 13f79535-47bb-0310-9956-ffa450edef68"
69700334660557f71891cf84191ec19d008d4ebc,"PR: bugzilla 26217
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro

Changed a "":"" to a ""-"" in ""xalan:doc-cache-off"" in the FAQ.

Programming instructions don't have a namespace, so make
the PI with no namespace be ""xalan-doc-cache-off"" rather than
""xalan:doc-cache-off"". 
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337887 13f79535-47bb-0310-9956-ffa450edef68"
1d9f7826d6ba84c000a8107c71e81138b8a3eed0,"PR: bugzilla 15140
Submitted by:	patch submitted by Bruno Dumon (bruno@outerthought.org)
Reviewed by:	Brian Minchau (minchau@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337888 13f79535-47bb-0310-9956-ffa450edef68"
d1fc8c1965f26ddf9c19e7f9878bc586abf8e3fa,"PR: bugzilla 24304
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro
Serialized XML no longer put a new line after the xml header unless
indent=""yes"".
-Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337889 13f79535-47bb-0310-9956-ffa450edef68"
05357a745a74305ade6fecee9ac579f32b06dfe3,"PR: bugzilla 16889
Submitted by:	Elson Jiang
Reviewed by:	Brian Minchau

Fixes ElemForEach TraceListener bug.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337890 13f79535-47bb-0310-9956-ffa450edef68"
e911e101fa99f45d43db456516e900c94fdd896c,"PR: bugzilla 23591
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro

JAXP transformer.setOutputProperties(null); now not only doesn't
get an exception, it also resets the internal state to flush out any
previously accumulated properties as if the transformer had
just been created.
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337891 13f79535-47bb-0310-9956-ffa450edef68"
761970b0ed3d12abd19182d2292c94203f6132b1,"PR: bugzilla 25816
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro
Make default properties returned by serializer factory immutable.
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337892 13f79535-47bb-0310-9956-ffa450edef68"
280205b362ff5fc416535b77936e31ac5b356e9b,"Javadoc update only.

PR: bugzilla 26742
Submitted by:	Brian Minchau

Changed old invalid URI for xmlns:xsl to the correct one
for XSLT 1.0.  The old value was before the XSLT 1.0 recommendation
and appeared only in a javadoc example.  But it did confuse me when
I tried to run the example in the javadoc.
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337893 13f79535-47bb-0310-9956-ffa450edef68"
4190323edf3fb8341349ff9af58849f489f4bfaf,"Fix for Bugzilla Bugs 24793


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337894 13f79535-47bb-0310-9956-ffa450edef68"
5c7fdbb3b4dc93184b12c1c7b429cb699c2d70e8,"Fix for the bug in DOM2TO where there was a call to _handler.addAttribute
which was moved to the if clause and hence attributes in no namespace were
lost when using an identity transformation with DOMSource.

Thanks to Henry Z. for pointing it out and Santiago for reviewing.  I have tested it locally. Please let me know if you see any issues with this.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337895 13f79535-47bb-0310-9956-ffa450edef68"
4ef0864ce3edc8a33b6224e8958612e26d0808c9,"Fix for bugzilla bug report 24979

Fix for DOM XPath API, any element has an implicit declaration of its own
prefix, which is enforced during namespace serialization

Reviewed by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337896 13f79535-47bb-0310-9956-ffa450edef68"
d093c410c9bdd874227307fad6609678058025f1,"Fix for bugzilla bug report 26697

XSLTC supports convert a NodeList to an internal DOM iterator.
Use setAttributeNS method to copy attribute node when an attribute
has a prefix, which maps to a namespace URI

Reviewed by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337897 13f79535-47bb-0310-9956-ffa450edef68"
ae4efb5b9715bd5a9da474271540306c7608b087,"Code cleaning and optimization for copy and copy-of.  Discussed with Henry


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337899 13f79535-47bb-0310-9956-ffa450edef68"
435e4fa4b89cad1adb0c827c4d2d479630c03710,"Applying patch for Bugzilla bug report 24728 from Sarah McNamara
(mcnamara () ca ! ibm ! com).

Use Ant's filtering capabilities to place appropriate ""created-by"" information
into the MANIFEST.MF file of the jar that's being built.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337900 13f79535-47bb-0310-9956-ffa450edef68"
ece2785811888611fd2661ac554bf6ba880d46ea,"Description :
ObjectFactory was designed to be package private. ObjectFactory class exposes class loaders publicly which allow untrusted code to access internal classes. Making following changes to fix it.

1.Coping the ObjectFactory, SecuritySupport.java and SecuritySupport12.java class in the sub packages in  order to make it package    private.
2.Using checkPackageAccess() to prevent access to internal packages of jdk(sun.*).

PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337902 13f79535-47bb-0310-9956-ffa450edef68"
4c6184e9b78ef48a01e817f3c3c01e779ae51db1,"always use setAttributeNS() method and pass null as
its namespace for non-namespaced nodes
Thanks Joe Kesselman for pointing it out


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337903 13f79535-47bb-0310-9956-ffa450edef68"
1adc401a0d42f695f1793981be60fdee923a97c4,"Fix for bugzilla bug report 22376

When a TrAXFilter has a parent, should set itself as the EntityResolver,
DTDHandler and ErrorHandler for it's parent to keep the filter chain,
instead of always use the default EntityResolver, DTDHandler and ErrorHandler

The patch is submitted by Werner Donne (werner.donne@re.be)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337905 13f79535-47bb-0310-9956-ffa450edef68"
708111a8394787261fae7be95827d2f9b7ed4fb3,"Description : Adding the basic functionality for resolving external function dynamically. If static resolution fails then Dynamic resolution is used as last resort
PR:
Obtained from:
Submitted by:
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337906 13f79535-47bb-0310-9956-ffa450edef68"
1356074e20c090b72971965cc8c2c464e824b159,"Description : Copying the patch from jaxp-1_3_0-branch  to main trunk.
When there is no mark up inside element content, text should be contained in single TEXT node.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337907 13f79535-47bb-0310-9956-ffa450edef68"
2c1f88059e35148168f9aeffd8472c92a6d8ddf3,"Patch for Bugzilla Bug 25368 submitted by Joanne Tong


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337908 13f79535-47bb-0310-9956-ffa450edef68"
f977c51672ff217d0624d2fd3175726edbff5c44,"Patch for Bugzilla bug reports 24988 and 25368 from Joanne Tong
(joannet () ca ! ibm ! com) reviewed by myself.

24988:
Changes required to test whether an attribute value that is required to be
a QName, NCName or whitespace-separated list of QNames actually meets that
requirement.

25368:
Code was basing variable and parameter names on the local part of the name,
rather than including the namespace URI in the name.  This resulted in
collisions in the generated code between distinct variables that had the same
local-name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337909 13f79535-47bb-0310-9956-ffa450edef68"
098f71bd2c38cc6b6a8127e05443a917bac27586,"Patch for Bugzilla bug report 25368 from Joanne Tong (joannet () ca ! ibm ! com)
reviewed by myself.

Code was basing variable and parameter names on the local part of the name,
rather than including the namespace URI in the name.  This resulted in
collisions in the generated code between distinct variables that had the same
local-name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337910 13f79535-47bb-0310-9956-ffa450edef68"
ba3c7fe147768ffde65d6c67a48e52a5aa448561,"Patch for Bugzilla bug report 24988 from Joanne Tong (joannet () ca ! ibm ! com)
reviewed by myself.

Changes required to test whether an attribute value that is required to be
a QName, NCName or whitespace-separated list of QNames actually meets that
requirement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337911 13f79535-47bb-0310-9956-ffa450edef68"
77110ab4b22be10fd32c79f2665ff492d3abccac,"Upgrading to version 2.6.2 of Xerces-Java.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337912 13f79535-47bb-0310-9956-ffa450edef68"
7fd5ff8186c6d7b44ab4602771ea1717c32aa980,"Part of fix for bug report 24985.  The code that resulted for a NodeTest of
the form ""@p:*"" or ""attribute::p:*"" was identical to that for ""@*"" - in other
words, the prefix was not being tested.  Fixed this so that
DOM.getNamespaceAxisIterator is used to create the right kind of iterator.

Reviewed by Morris Kwan (mkwan () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337913 13f79535-47bb-0310-9956-ffa450edef68"
c2babffe882b88a75e6d23bd9f6b263959f1652a,"Part of fix for bug reports 24985 and 24365.

Moved the NamespaceChildrenIterator and NamespaceAttributeIterator classes into
this class from SAX2DTM2, where they can use fields specific to SAXImpl to
refer to namespace information.

Also added a new NamespaceWildcardIterator that handles axes other than the
child and attribute axes (which are handled by the specific iterators already
mentioned).

Reviewed by Morris Kwan (mkwan () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337914 13f79535-47bb-0310-9956-ffa450edef68"
a1e52aeaf2a21f1d2ffa9e055446875cbbd471ac,"Part of patch for bug report 24985.  Ensure that m_size is set to zero in
setStartNode methods of AncestorIterator and TypedAncestorIterator.  The way
getLast() is implemented resulted in setStartNode being called twice in
some circumstances, with the nodes from the second call being included as
additional (though duplicate) ancestors.  Clearing m_size avoids that.

Reviewed by Morris Kwan (mkwan () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337915 13f79535-47bb-0310-9956-ffa450edef68"
96a893a7ee63032dafc72facc0c9da0de027eaa1,"New ""top-level"" Apache 2.0 license
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337924 13f79535-47bb-0310-9956-ffa450edef68"
2bb344513f27baeb5c7d088252006bc42dc083db,"Top level ""NOTICE"" file, per section 4d of the Apache License, Version 2.0
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337925 13f79535-47bb-0310-9956-ffa450edef68"
b48b44a336360fdb9925ac1f502369478bfec5c6,"Deleting old Apache 1.1 ""License"" which was recently replaced with the 
Apache 2.0 ""LICENSE""
- Brian M.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337926 13f79535-47bb-0310-9956-ffa450edef68"
6a51470bf93e647db85a66944b97b3d03f566a27,"Apache License 2.0 put as HTML comment in readme.html


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337927 13f79535-47bb-0310-9956-ffa450edef68"
278371a273d641da7cb8c7d2183faf54e4fab123,"Apache License 2.0 put as HTML comment in html


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337928 13f79535-47bb-0310-9956-ffa450edef68"
35fc435bb6e2484bd464c021c87ea6c017a28979,"missing check-in for 25368


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337929 13f79535-47bb-0310-9956-ffa450edef68"
2dd52bf59faa34b674c45af0f8b12c84fa675689,"Apache License 2.0 put as HTML comment in html


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337930 13f79535-47bb-0310-9956-ffa450edef68"
98a139840025d343712f1eacc50d997fbe190c6d,"Apache License 2.0 put as comment in properties file


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337931 13f79535-47bb-0310-9956-ffa450edef68"
6da95fdb03823fef29935840fb80a0c0e338f26f,"Apache License 2.0 update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337932 13f79535-47bb-0310-9956-ffa450edef68"
79ae62b48010924349cb0d4cdd2049466f4ad1a5,"Apache License 2.0 update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337933 13f79535-47bb-0310-9956-ffa450edef68"
b31232597fafa53b08e55d2579bfacbcac0fa700,"Deleting xml-xalan/java/compat_src tree.
This is old unused code (pre-TRAX).
If we kept it we would need to update to the Apache License version 2.0.
It is easier to delete.
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337934 13f79535-47bb-0310-9956-ffa450edef68"
d6f1cd3ec3f1f984238ea3c7336154e65870cf27,"Apache License 2.0 update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337935 13f79535-47bb-0310-9956-ffa450edef68"
2e0b00b8a6934230ad868c2d870cc815a6d623b7,"Description : Fixing a NPE related  to previous checkin.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337936 13f79535-47bb-0310-9956-ffa450edef68"
36c71454b6378ab66779ed969efc5d42cf3373ba,"Patch for bug report 27205 from Sarah McNamara (mcnamara () ca ! ibm ! com).

Version number updates for Xalan-Java 2.6.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337937 13f79535-47bb-0310-9956-ffa450edef68"
fcc928819a3b2587ab51e9ab945c3e03ec7d41c3,"Patch for bug report 27205 from Sarah McNamara (mcnamara () ca ! ibm ! com).

Documentation updates for new release number for Xalan-Java 2.6.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337938 13f79535-47bb-0310-9956-ffa450edef68"
4f84e320372943cab75df896af78780ac2040e4f,"Patch for bug report 27205 from Sarah McNamara (mcnamara () ca ! ibm ! com).

Release notes for Xalan-Java 2.6.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337939 13f79535-47bb-0310-9956-ffa450edef68"
c2ecde5ad700a4ffeefc992fea9a7ea3f95158eb,"Fixed hard-coded reference to processor name to use an entity ref. instead.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337940 13f79535-47bb-0310-9956-ffa450edef68"
f0c3d047b18307085f1868235cbecbd74c6329bb,"Patch for bug report 27205 from Sarah McNamara (mcnamara () ca ! ibm ! com).

New and improved release notes for Xalan-Java 2.6.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337941 13f79535-47bb-0310-9956-ffa450edef68"
dba0eef5348b29e65a34ca5aaf0caa2ce1711aad,"Added new section of documentation describing public, experimental and
internal interfaces of Xalan-J.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337943 13f79535-47bb-0310-9956-ffa450edef68"
1038f874d3cd4354d2167c5fcf791b1c80185e4b,"Reformatted to fit in 80 columns.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337944 13f79535-47bb-0310-9956-ffa450edef68"
d00159c7e43eb5c4bdbd7b5daefdac47a20b2458,"Apache License 2.0 update


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337945 13f79535-47bb-0310-9956-ffa450edef68"
2ad3a0bd31055d9da18df7fb83dab65490217487,"Restored old constructor of NodeSortRecordFactory and _collator field of
NodeSortRecord for binary compatibility.  These changes allow translets
compiled with an earlier version of XSLTC to continue to run with the new
version.  They should not be used in newly compiled translets or in new code
in XSLTC itself.

Also introduced a SortSettings class that is used to bundle sort settings from
NodeSortRecordFactory into instances of NodeSortRecord.  That reduces some of
the space overhead in constructing a NodeSortRecord.

Reviewed by Igor Hersht (igorh () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337946 13f79535-47bb-0310-9956-ffa450edef68"
a1f3ae2e3e6f817855132c8d9b9ec16020ecf605,"Revived ForwardPositionIterator class and BasisLibrary.positionF purely to
support backwards compatibility with translets compiled with earlier versions
of XSLTC.  New code should not reference either.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337947 13f79535-47bb-0310-9956-ffa450edef68"
c631c746a9f0eb66e97a0075aa238fecf2fa0c02,"Minor history log edits.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337948 13f79535-47bb-0310-9956-ffa450edef68"
626041a150652c6a3604b48b59e6e4b65264204a,"Patch from Sarah McNamara (mcnamara () ca ! ibm ! com).

Ensure new LICENSE and NOTICE files are packaged as part of binary and source
distributions for Xalan-Java.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337949 13f79535-47bb-0310-9956-ffa450edef68"
cb2ae002ee9d90950214c2fa998f7c2967e79cf6,"Submitted by:	Brian Minchau
Modified code for potential extension of classes with callbacks to the extensions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337951 13f79535-47bb-0310-9956-ffa450edef68"
e86d2c5a477b65911133d6a9b13644efca0beac7,"Added a newline at the end of Encodings.properties to fix bug 27516


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337952 13f79535-47bb-0310-9956-ffa450edef68"
b581381795dac427697f3ed141dfe7d3e6a58f7b,"xsl:number, minor code cleaning and optimization
PR:
Obtained from:
Submitted by:	
Reviewed by:	
CVS: ----------------------------------------------------------------------
CVS: PR:
CVS:   If this change addresses a PR in the problem report tracking
CVS:   database, then enter the PR number(s) here.
CVS: Obtained from:
CVS:   If this change has been taken from another system, such as NCSA,
CVS:   then name the system in this line, otherwise delete it.
CVS: Submitted by:
CVS:   If this code has been contributed to Apache by someone else; i.e.,
CVS:   they sent us a patch or a new module, then include their name/email
CVS:   address here. If this is your work then delete this line.
CVS: Reviewed by:
CVS:   If we are doing pre-commit code reviews and someone else has
CVS:   reviewed your changes, include their name(s) here.
CVS:   If you have not had it reviewed then delete this line.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337953 13f79535-47bb-0310-9956-ffa450edef68"
65134b673167e18a6590acb36421402157ad836e,"fixing wrong commit


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337954 13f79535-47bb-0310-9956-ffa450edef68"
dfe090a0435e29dfa321e2d589043330350f9484,"Check if the systemId for the stylesheet is null to avoid getting an NPE


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337955 13f79535-47bb-0310-9956-ffa450edef68"
5aa09bc7aa10817feaed0efa25d65ddf829c6558,"Fix a bug in the findProviderClass method of ObjectFactory
classes. The argument of SecurityManager.checkPackageAccess should be a string
value of a package name, instead of a class name


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337956 13f79535-47bb-0310-9956-ffa450edef68"
71d197a49a49421fb85d1473dd690de745ad885c,"Reverting latest patch by Arun. There are some problems with the new code to invoke functions dynamically (e.g. docbook reports a compile-time type check error). The approach taken to determine when to invoke methods dynamically needs to be revisted.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337957 13f79535-47bb-0310-9956-ffa450edef68"
6ab71d0cd82fe192a98ff87b2db09eb851654609,"Patch to hide static function table in FunctionTable class. We do not want to expose this table to others.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337958 13f79535-47bb-0310-9956-ffa450edef68"
e5db4b1c87320e5264a84b096a763ec8226d0d24,"The xmlns URI should also be used to add NS decls as attributes to a DOM. However, this was only done for attributes that started with 'xmlns:' and not for 'xmlns' (i.e. not for decls of the default NS).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337959 13f79535-47bb-0310-9956-ffa450edef68"
1ec8f02b8cb34a34330f31dbef1d5e56ae357100,"Patch for bug 27417.

If an output stream is created by the XSLTC transformer, close
it after the transformation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337961 13f79535-47bb-0310-9956-ffa450edef68"
e99a65435ad78844c4dfa2d5e588acf9ebd74054,"""import"" clean up. Removed un-used imports,  some rearranging,
(a freebie from eclipse to sort them!). 

Minor clean up as part of the preparation to make the serializer
stand-alone for use by Xalan and Xerces later on.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337962 13f79535-47bb-0310-9956-ffa450edef68"
fba6181bcb622b0bc8fb4af98e639bb6d9b5c183,"Due to license issue, remove the suggestion in FAQ of using -Xbootclasspath to replace xalan.jar in the jdk1.4 environment


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337963 13f79535-47bb-0310-9956-ffa450edef68"
efebd4a236b98734a03f7aa9b8f084f99c515a06,"Applying patch for bugs 27932 and 15333.

Code was incorrectly calculating the set of templates to which an
xsl:apply-imports instruction applies.  It should consider all templates that
the current template rule could override, which means that if the template
appeared in a stylesheet that was included in another stylesheet, any templates
imported into the including stylesheet have to be considered as well.  The
method Stylesheet.getMinimumDescendantPrecedence is responsible for this
calculation.

In addition, when code is generated for an xsl:apply-imports, if any template
has local parameters, an empty stack frame has to be pushed before attempting
to apply-imports.  Otherwise, parameters from the template that contains the
apply-imports instruction will be passed into the matching template.

Reviewed by Joanne Tong (joannet () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337964 13f79535-47bb-0310-9956-ffa450edef68"
52a42a6799e4a56f66086407c6199a0d256aed27,"Applying patch for bug 27932.

Code was incorrectly calculating the set of templates to which an
xsl:apply-imports instruction applies.  It should consider all templates that
the current template rule could override, which means that if the template
appeared in a stylesheet that was included in another stylesheet, any templates
imported into the including stylesheet have to be considered as well.  The
method Stylesheet.getMinimumDescendantPrecedence is responsible for this
calculation.

Reviewed by Joanne Tong (joannet () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337965 13f79535-47bb-0310-9956-ffa450edef68"
320753b1a287d82343d8e7f471d610f4222a9c17,"The problem is that about 1800 * Thread_num  XRTreeFrag  objects were created. 
It took too long for finalizer to be executed to release the references.

A lot of the objects have the same DTMs (and one XPathContext per thread).
In my fix I am suggesting 
a. to have new class DTMXRTreeFrag. The object of the class would 
be created only for different DTMs (just 5 objects). 
b. release the references to  DTM and XPathContext from XPathContext.reset()
(and remove finalize() ).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337966 13f79535-47bb-0310-9956-ffa450edef68"
2ec63453618e53484c65c181c41943bad5f92524,"PR: bugzilla 28435
Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337967 13f79535-47bb-0310-9956-ffa450edef68"
c186d631b6620f6aa552df077f498c685d8d4893,"Fix copyright and use @xsl.usage tag in javadocs


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337968 13f79535-47bb-0310-9956-ffa450edef68"
229117ba67f530efafabd094ee90f6b31a1e6252,"Fix problem with end-of-line sequence.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337969 13f79535-47bb-0310-9956-ffa450edef68"
735313d5128f45570fdc3bc3c9395eac4a40005e,"Add Apache copyright and license


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337970 13f79535-47bb-0310-9956-ffa450edef68"
3de709035808881b081cebf94f78a8e5893a9c0e,"Add Apache copyright and license.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337971 13f79535-47bb-0310-9956-ffa450edef68"
80bbca6811afbb7b7f00933b2469f416265fc0e3,"Correct the generated html names for the translet samples.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337972 13f79535-47bb-0310-9956-ffa450edef68"
c9fa3c75a2d31baf7c36b3e4680bde3c7bd094b0,"Catching up with a hotfix that was done to the live Xalan website when 2.6.0 was published.

The ""whatsnew.html"" file is not part of the docs for the 2.6.0 release, but the index.html file
was still trying to reference it.  Changed index.html to reference the release notes in the
readme.html file instead.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337973 13f79535-47bb-0310-9956-ffa450edef68"
615d9bb625f60c0d5d8880989f1d59bb8bd0905f,"Fix broken links to the Xalan FAQ and JAXP SAXParser


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337974 13f79535-47bb-0310-9956-ffa450edef68"
ffda26303eaa506d8b2e31af69ea7fb5e1935d18,"Fix broken links to the TransformerHandlerImpl api docs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337975 13f79535-47bb-0310-9956-ffa450edef68"
47eea05b29d27a18ad931d7081dfbe4486e01a2d,"Scaling Problem in org/apache/xalan/templates/AVT.evaluate
The problem is that synchronized calls 
StringBufferPool.get() and StringBufferPool.free(buf)  
are redundant if (null != m_simpleString).
The bug results in severe performance derogation in multi-thread test.

The fix is simple just not to the calls when (null != m_simpleString).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337976 13f79535-47bb-0310-9956-ffa450edef68"
c820f54170769903c5a434ea7ef99f84cbddbdeb,"Fix problem with end-of-line sequence.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337977 13f79535-47bb-0310-9956-ffa450edef68"
49eec6c052ba418fb61b277fc7ec63ddd8da4c46,"Provide alternative text for images to address accessibility issues.
All images should contain a short alternative text description that represents
the function of the graphic.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337978 13f79535-47bb-0310-9956-ffa450edef68"
976eedcb241f0b610815986a16df9cd62acaa821,"Update document2html.xsl withing this tarball to provide alternative text for images to address accessibility issues.
All images should contain a short alternative text description that represents the function of the graphic.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337979 13f79535-47bb-0310-9956-ffa450edef68"
0049f6c794e854f84d41dc644bc944d54a0d4fc5,"Clean up related to bugzilla 24304.
There is no longer a space after the XML header. To keep the output
of this sample the same as before properties were set on the
serializer (indent=""yes"" and standalone=""no"" ).

Submitted by:	Brian Minchau
Reviewed by:	Sarah McNamara


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337980 13f79535-47bb-0310-9956-ffa450edef68"
b57fbe361ac7d3dff81ae7f7fc1a7f9dfcd47b2c,"Clean up related to bugzilla 24304.
There is no longer a space after the XML header. To keep the output
of this sample the same as before properties were set in the
stylesheet (indent=""yes"").

Submitted by:	Sarah McNamara
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337981 13f79535-47bb-0310-9956-ffa450edef68"
d165f41ae2541c9a18ef20a44c59f629252dd4b2,"Clean up related to bugzilla 24304.
There is no longer a space after the XML header. To keep the output
of this sample the same as before properties were set on the
serializer (indent=""yes"" and standalone=""no"" ).

Submitted by:	Sarah McNamara
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337982 13f79535-47bb-0310-9956-ffa450edef68"
6c165dceb8f89d5a94f78cbac55aa8597990390d,"Clean up related to bugzilla 24304.
There is no longer a space after the XML header. To keep the output
of this sample the same as before properties were set in the
stylesheet (indent=""yes"").

Submitted by:	Sarah McNamara
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337983 13f79535-47bb-0310-9956-ffa450edef68"
7525e775c2fe8344881d12eee979cb48e6eac608,"The problem is that we use an object pool (shared between different threads)
to allocate  FastStringBuffer objects. The problem results in a serious performance
degradation  on Z/OS and seems to be invisible on AIX.

1 Differences in optimization of object pools  for different JVMs and for different 
platforms are known(I know it now too). It is not surprising that  Z/OS and AIX 
have different results.

2. 
a. Object pools should be used only for very heavy object which live for a long time
and could be reused in a lot of places. 
b. Small local objects which size cannot be changed could be allocated on the
stack => creating them with new in the local scope could be a good idea.
c. Caching middle size objects which can grow in size seems as a good idea,
because such objects usually cannot be allocated on the stack.
 This is actually the case for FastStringBuffer objects. 

 Solution
I am creating FastStringBuffer objects in a local scope. I am going
to use caching whenever possible. 
First I am fixing the bug.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337984 13f79535-47bb-0310-9956-ffa450edef68"
cb27a9e5626d9ea16d3d777f5a233fe662500005,"PR: bugzilla
Submitted by:	Brian Minchau
Reviewed by:	Christine Li

Fixing binary compatibility (serialization/de-serialization) 
of XSLTProcessorApplet.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337985 13f79535-47bb-0310-9956-ffa450edef68"
408a9a1c85d086f7cdb6df624339912cfae686de,"In xsltc currently with the extension redirect the output file is created only if the parent dir exists. Making the behaviour similar to that of xalan wherein the parent directory is also created.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337986 13f79535-47bb-0310-9956-ffa450edef68"
ff84da87dcf5f33f325c845e7f3ecca382b30665,"Fix for Bugzilla 29120. The translet now stores a reference to the DocumentBuilderFactory which is used by nodeList2Iterator() in the basis library. Note that to reuse that reference you need to use the same transformer (not just the same template).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337987 13f79535-47bb-0310-9956-ffa450edef68"
0ba16b91616f5f3b0ddd0673941518afd5f6bc8e,"Implemented a new parser for ATVs. The old was buggy: did not handle escaped curly braces in all cases and did not handled quotes at all. The old parser assumed that braces came in pairs, but it is possible to have an odd number as in ""{{{$foo}}}"". The new parser seems to handle all cases correctly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337988 13f79535-47bb-0310-9956-ffa450edef68"
f723d0823a49d882706bf300f5db41a3dab8369b,"Modified code to ensure line number information is propagated from parent to children to ensure we get informative error messages. This was particularly bad for errors in ATVs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337989 13f79535-47bb-0310-9956-ffa450edef68"
053675ac48d814d19fdf07b2ec8f90d39d4513a1,"Improved patch for Bugzilla 29120 based on Matthias' suggestion. A DOMImplementation is now cached for even better performance.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337990 13f79535-47bb-0310-9956-ffa450edef68"
e3266b5f8a3591a0dde95a0de218bffbc226a205,"If the local is set to Turkish, but the codepage is MS-DOS (US) 437. The BCEL
InstructionFinder.search(String) method can not find any instructions contain
letter I. In Turkish, there are 2 lower case i.  Since the search() method is case
insensitive, change the pattern string to use lower case.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337991 13f79535-47bb-0310-9956-ffa450edef68"
477704d7bad5b91c854f0db8dc759695b76a22e8,"PR: bugzilla 29234
Submitted by:	Brian Minchau
Reviewed by:	Morris Kwan
This problem only showed up under XSLTC.  When setting the
encoding a related field was not set.  Fixed this by over-riding the 
set method for the stream serializers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337992 13f79535-47bb-0310-9956-ffa450edef68"
e5fc767c1d99d37209739ef50bfdcb47f947948a,"PR: bugzilla 29372
Submitted by:	J Desrochers (john@ASCnet.COM)
Reviewed by:	Brian Minchau

A safe fix for chunking up an array for output. The length  was multiplied by the
chunk number (0,1,2... chunks) then divided by ""chunks"". John's fix uses a 
""long"" to do the arithemetic because multiplying by the chunk number first 
could cause an overflow.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337993 13f79535-47bb-0310-9956-ffa450edef68"
938b519adc3203f18698585dc1f8d845c0febfbc,"Patch for Bugzilla 29411. New algorithm shoudl optimize the way NS decls are reported for nested literal elements. Note that the algorithm will not work accross non-literal elements. E.g., if there is an xsl:element between two literal elements, the inner literal element may report unnecessary NS delcs. This is just a simple way to ensure that any NS decls defined by the xsl:element instruction are re-defined in the inner literal (see namespace39 in the conf tests).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337994 13f79535-47bb-0310-9956-ffa450edef68"
44fe6c25cb19b1e47e4abf32064f6147cf4ed9b4,"Fixed a problem with peephole optimization patterns. I don't know if something changed in BCEL since the code was written, but the pattern syntax was not correct. I've also added a new common peephole pattern which should reduce then inner loop's length in some Translets.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337995 13f79535-47bb-0310-9956-ffa450edef68"
7cc010b7b3235802c4eea5e9aad27febc4ad2a3a,"Fix for Bugzilla bug 28879.  Classes derived from NodeTest need to ensure
that initNodeTest is called to set the filter for the kinds of nodes accepted.
Without this change, ChildIterator will reject all nodes.

Patch reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337996 13f79535-47bb-0310-9956-ffa450edef68"
42ce5ddf46cec820ec6f30de9a686b4642ea8221,"Fix for Bugzilla Bugs 28622


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337997 13f79535-47bb-0310-9956-ffa450edef68"
6275cf4a54b28252e776215ad4f1f8e07f901402,"Patch for Bugzilla 27539 and related problems. The main problem was that hashCode() was not implemented correctly in ObjectType. To eleminate further problems I also removed Type.ObjectString as this type is the same as Type.String and the latter can be used in place of the former.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337998 13f79535-47bb-0310-9956-ffa450edef68"
fa22db94c809ad4fc4438991226f4362aea91f45,"Description: getNode should return the result DOM tree once TransformerHandler completes the transformation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@337999 13f79535-47bb-0310-9956-ffa450edef68"
725820839a630f3931bb8f2d91f02a1e8f3eb2bb,"Description: Patch for the support of extension attribute ""intent-amount"" for xsl:output. Supports the old URI {http://xml.apache.org/xslt} and new URI{http://xml.apache.org/xalan}.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338000 13f79535-47bb-0310-9956-ffa450edef68"
b499f7fbca70628f7ad4775d94a731fa2de6bbc2,"Description: Patch for concatenating adjacent text nodes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338001 13f79535-47bb-0310-9956-ffa450edef68"
49f535c6d6e3ac2f80fb5647dcb32221966bcfe3,"Description: Improper Serialization of document type declaration in xml document.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338002 13f79535-47bb-0310-9956-ffa450edef68"
f1c78f5bb28f819344f8a78db40169fc58fa6e29,"Patch for bug 30056

Recover the performance degradation for xsl:copy
and xsl:copy-of.

Reviewed by Henry Zongaro (zongaro@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338003 13f79535-47bb-0310-9956-ffa450edef68"
8590caee4c22ae20886104d40d95396aa29a4a89,"PR: bugzilla 29706
Submitted by:	Brian Minchau
Reviewed by:	Christine Li

A fix to add a temporary vs. permanent output state to the serializer
(AKA result-tree-handler).  In theory the XSLT processor should set the
temporary or permanent output state, but we observer that when the
encoding of a ToTextStream serializer is null, then such a serializer is
in temporary output state.

In temorary output state we don't do any escaping or encoding or other 
sorts of normalization on output. This will be done by another serializer 
later on, and that one will be in permanent output state.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338004 13f79535-47bb-0310-9956-ffa450edef68"
b89ad571dd4f1016adb28f41d4742c9f2d5652e8,"PR: bugzilla 30142
Submitted by:	Bruno Dumon (bruno@outerthought.org)
Reviewed by:	Brian Minchau

Thanks to Bruno for this simple one-line, fix where we forgot to put
a space between the PUBLIC and SYSTEM ID's in a DOCTYPE declaration
in serialized HTML output.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338005 13f79535-47bb-0310-9956-ffa450edef68"
99b810c0091246c0dd3d6fc51b94a70325aabbeb,"Submitted by:	Brian Minchau
Reviewed by:	Henry Zongaro
Backing out the last code change by Arun because it breaks the smoketest.
The code I am backing out is definately wrong.  The old code appears
to be correct to both myself and Henry Zongaro.

Waiting for a testcase to see what is wrong with the serialization code
and DOCTYPE.  Future changes may be made.
- Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338006 13f79535-47bb-0310-9956-ffa450edef68"
43c9974a18a95065be5b12f88fd75becfbbc1783,"Submitted by:	Yash Talwar
Reviewed by:	Brian Minchau
Fix for bugzilla 28796


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338007 13f79535-47bb-0310-9956-ffa450edef68"
3dcab6f3caf3e4b7628beba81284652711b2d181,"Submitted by:	Yash Talwar
Reviewed by:	Brian Minchau
Fix for bugzilla 29655


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338008 13f79535-47bb-0310-9956-ffa450edef68"
cbf23cae8f2d9abb713930bd8d26059926990ac6,"PR: 30658
Submitted by:	Brian Minchau
Reviewed by:	Morris Kwan


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338009 13f79535-47bb-0310-9956-ffa450edef68"
17027286d8ae2c83830b478a28bd10b5de6fc864,"PR: 30301
Submitted by:	Brian Minchau
Reviewed by:	Morris Kwan


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338010 13f79535-47bb-0310-9956-ffa450edef68"
31945f14119a756e53c8c4a4c8f466ac49549a7b,"PR: 30262
Submitted by:	Yash Talwar
Reviewed by:	Henry Zongaro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338011 13f79535-47bb-0310-9956-ffa450edef68"
0f2d869f05445f1175e49fd2fdf234e4c7d1eb40,"Fix for printStackTrace when using JDK 1.4


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338012 13f79535-47bb-0310-9956-ffa450edef68"
8715306de914fc3a40ff4ab45e0b32a46907ce9a,"Fixing a potential memory leak.  The reader used to read the service provider is never closed if an IOException is thrown while reading from it.  Adding a finally block so that the reader will always be closed.  Patch reviewed by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338013 13f79535-47bb-0310-9956-ffa450edef68"
a2eed4aa4085caae05b206552b83e6fced75d43c,"Added serialVersionUID for classes which implement Serializable interface


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338014 13f79535-47bb-0310-9956-ffa450edef68"
529a488e20c0a8fd7c6279984f975be1a391b106,"Added serialVersionUID for classes which implement Serializable interface. Was reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338015 13f79535-47bb-0310-9956-ffa450edef68"
f728696b9d511d67f48d21163e63561b521fe0c7,"Added serialVersionUID for classes which implement Serializable interface. Patch created by Christine Li (jycli@ca.ibm.com) and was reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338016 13f79535-47bb-0310-9956-ffa450edef68"
cc6fa4d8c16b720553eced6a61c057e0a771ec5b,"Added serialVersionUID for classes which implement Serializable interface. Patch created by Christine Li (jycli@ca.ibm.com) and was reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338017 13f79535-47bb-0310-9956-ffa450edef68"
a7ca9a8c16420df72ede8ff1171ee55608160a1f,"Added serialVersionUID for classes which implement Serializable interface. Patch created by Christine Li (jycli@ca.ibm.com) and was reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338018 13f79535-47bb-0310-9956-ffa450edef68"
701b9baef86b9ed08ecab4635adf491ae11ed268,"Added serialVersionUID for classes which implement Serializable interface. Patch created by Christine Li (jycli@ca.ibm.com) and was reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338019 13f79535-47bb-0310-9956-ffa450edef68"
b66de6eff99aa013b1df9c520a4e8ccb57d4b127,"Added serialVersionUID for classes which implement Serializable interface. Patch created by Christine Li (jycli@ca.ibm.com) and was reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338020 13f79535-47bb-0310-9956-ffa450edef68"
c3a13d281710bcf8790d73884b4a3083a37f0d9c,"Submitted by:	Brian Minchau
No external changes to Trie, but some additional APIs to make for a lower case
only search in a Trie (possibly for future XHTML support where the element
names are lower-case only).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338021 13f79535-47bb-0310-9956-ffa450edef68"
8bd56aef918896bb27396ab085d7cb07af53a741,"Minor changes to CharInfo to map charaters to decorated entities (e.g. ""&lt;"" ) 
rather than just entity names (e.g. ""lt""), which is a minor performance improvement.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338022 13f79535-47bb-0310-9956-ffa450edef68"
45cc76badc0efcc986c3b7fa90892491d4e58f4e,"Clean-up.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338023 13f79535-47bb-0310-9956-ffa450edef68"
0185fc039bc854814f077f769b03196d332f2fa4,"Added HTMLELEM constant.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338024 13f79535-47bb-0310-9956-ffa450edef68"
04c7ca915e4f5dfa14f14715291932f9fc8126f5,"Clean-up.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338025 13f79535-47bb-0310-9956-ffa450edef68"
f745762c2ad427b74e4c8623d5fef76b64c4c687,"Added a comment.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338026 13f79535-47bb-0310-9956-ffa450edef68"
b01ae048e7cfa7a5119dc33955bf5595d2cbeb2d,"Submitted by:	Brian Minchau

Added @xsl.usage internal to the Javadoc for the class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338027 13f79535-47bb-0310-9956-ffa450edef68"
55bbd460f292a99a168d1036a9f964ebb3cdbcec,"Obtained from: Brian Minchau
Javadoc changes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338028 13f79535-47bb-0310-9956-ffa450edef68"
25c3c6a099347e48b0bebc5f25c3d10493004b6c,"Obtained from: Brian Minchau
added @xsl.usage internal tag to Javadoc.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338029 13f79535-47bb-0310-9956-ffa450edef68"
ebc9bc7aacf216defb6630d2edfa25a063f15bec,"Fix a memory leak problem described in bugzilla 28082.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338030 13f79535-47bb-0310-9956-ffa450edef68"
9e01612bb09d6df85daef716d6fceed7ddf04bed,"Submitted by:	Brian Minchau
Javadoc changes only.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338031 13f79535-47bb-0310-9956-ffa450edef68"
1a36677d8ad4c20d970a2c7754ec6a7b9bef75da,"Submitted by:	Brian Minchau
Javadoc changes only.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338032 13f79535-47bb-0310-9956-ffa450edef68"
bbeb38a8ed14d136adb13754bbe5a73bf141bb1e,"Submitted by:	Brian Minchau
Javadoc changes only.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338033 13f79535-47bb-0310-9956-ffa450edef68"
369ad1588e0e16ab3ba62a1b5e5ae0180ce028c2,"Submitted by:	Brian Minchau
Javadoc change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338034 13f79535-47bb-0310-9956-ffa450edef68"
f82abf26fbf51d94ed85d9ee819cc73c2642e7dd,"Submitted by:	Brian Minchau
deleting unused directWrite() method.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338035 13f79535-47bb-0310-9956-ffa450edef68"
c1b4059ff4a0fe6d4b5560178f27a424ef958b61,"Submitted by:	Brian Minchau
Code clean up, to have an explicit interface, WriterChain,
for writers that wrap other Writers or OutputStreams,
e.g. WriterToUTF8Buffered.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338036 13f79535-47bb-0310-9956-ffa450edef68"
8fda1bcf3d3566f7cc4c3f4e802bc0fc80a09fad,"Submitted by:	Brian Minchau
Javadoc changes, and added a call in ToXMLStream.processingInstruction() 
method to effectively consider that a startDocument() call was made,
if none was yet seen.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338037 13f79535-47bb-0310-9956-ffa450edef68"
ca79fb7a7ec94959af4ecad798fcd99bab06deae,"PR:
Obtained from:
Submitted by:
Reviewed by:Morris kwan


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338038 13f79535-47bb-0310-9956-ffa450edef68"
40f2a8c5658591daadeb9e3ad36d16fd28d0cc89,"Submitted by:	Brian Minchau
javadoc update to add the tag  @xsl.usage internal


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338039 13f79535-47bb-0310-9956-ffa450edef68"
09dc4cdeb89f3481de57cc35dfc1bb532daf464f,"PR: bugzilla 27522
Submitted by:	Brian Minchau
committing patch from bugzilla 27522


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338040 13f79535-47bb-0310-9956-ffa450edef68"
41b32049a6e60942460520f5b087a89470ad8d7c,"Fixed bug where JDBC execute was being called instead ofg executeQuery.
executeQuery will always retrurn a result set even if the query does not return any  rows
where execute won't. This was causing a compatibility issue.

Added in Record skip code to help with pagination.

PR: http://nagoya.apache.org/jira/browse/XALANJ-1908
Obtained from:
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338041 13f79535-47bb-0310-9956-ffa450edef68"
842865519c4b757648edbaae363ace49b46af16d,"Fixed bug where the close document method could not locxate the
SQL Document.

see http://nagoya.apache.org/jira/browse/XALANJ-1925

PR:XALANJ-1925 
Obtained from:  Moraine Didier mailto://didier.moraine@winterthur.be
Submitted by:	John Gentilin
Reviewed by:


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338042 13f79535-47bb-0310-9956-ffa450edef68"
862f0446fca50f7c68e98097be82820647cab691,"- Added new targets to support building the distribution packages (*-bin.tar.gz/.zip and *-src.tar.gz/.zip)
  without building the user guide and api docs.
- Reorganized some sections to make the targets more readable.
- Renamed the ""*-nojardepends"" rules to either ""*-compile"" or ""*-build"" to make them more intuitive.

Reviewed by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338043 13f79535-47bb-0310-9956-ffa450edef68"
26eb4b266a03072e7e6f36e06b443689d41c9946,"Skip translation for any unreferenced variables.

Patch reviewed by Christine Li (jycli@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338044 13f79535-47bb-0310-9956-ffa450edef68"
7c5d70e2614a84c9cd5e42eb51d152e9f9f5a25c,"Patch from Yash Talwar (ytalwar () ca ! ibm ! com) for Jira bug report 1186.

The existing code in the interpretive processor was handling namespace::pre by
resolving the namespace prefix ""pre"" in the stylesheet, and then looking for
namespace nodes with that same URI in the input document.  In fact, it should
look for namespaces nodes in the input document that declare the prefix ""pre"",
without regard to the associated URI.

The patch was reviewed by myself (zongaro () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338045 13f79535-47bb-0310-9956-ffa450edef68"
40e9a64f02b58e0e82098e0fcf209db050dafa83,"XSL Transformation drops content inside xsl:comment tags
PR: XALANJ-1966
Submitted by:	Yash Talwar
Reviewed by:	 Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338046 13f79535-47bb-0310-9956-ffa450edef68"
ef11ec3b223370fc09efad0584ac9b57239c5462,"Null Pointer Exception on sorting using a variable
PR: XALANJ-1942
Submitted by:	Yash Talwar
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338047 13f79535-47bb-0310-9956-ffa450edef68"
7d7360f1b20de24cac5fa776b194b1b44d28c515,"Null Pointer Exception when namespace-alias element says to
use ""#default"" namespace but there is no default namespace.
PR: XALANJ-1967
Submitted by:	Yash Talwar
Reviewed by:	Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338048 13f79535-47bb-0310-9956-ffa450edef68"
b70055ab4d0848034e9b1a2e243c791dfa757ef1,"At the suggestion of Joseph Kesselman, dropped contents of the
org.apache.xml.utils.synthetic package, as they have never been used.

Patch reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338049 13f79535-47bb-0310-9956-ffa450edef68"
40d4ee5634b0e24b7b1e72e0d7a50b40583252c9,"Fixed of Bug report XalanJ-1822. Added alternative BSF implementation support for extension functions in languages other than Java
Patch reviewed by Henry Zongaro (zongaro@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338050 13f79535-47bb-0310-9956-ffa450edef68"
f9d68e79855612577b5ba95ac46a3f25afb4220e,"PR: XALANJ-1891
Submitted by:	Brian Minchau
Reviewed by:	Yash Talwar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338051 13f79535-47bb-0310-9956-ffa450edef68"
92e70f7cd90e6f07cdc59e6b2c1012f413906f3c,"Submitted by:	Brian Minchau
Made some fields final or private to make the objects immutable,
especially the messages.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338052 13f79535-47bb-0310-9956-ffa450edef68"
570b2ebcc10989083f789dfd80a5a00c42aa2f47,"Submitted by:	Brian Minchau
Reviewed by:	Yash Talwar
Source code changes to the serializer to make it independent of Xalan.
Mostly message and utility usage changes.
However multiple classes had their visibility reduced to less than ""public"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338053 13f79535-47bb-0310-9956-ffa450edef68"
f4b39bfbeb2378644594fdd2c5c714e66cf0a50c,"PR: XALANJ-1891
Submitted by:	Brian Minchau
Reviewed by:	Yash Talwar
Deleting Charkey and Trie which were only used by the serializer.
These classes are migrated to the serializer package, in the case of
CharKey, it is now an inner private class.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338054 13f79535-47bb-0310-9956-ffa450edef68"
28a5112b039b9e3e488847f8cd6c32019156c65d,"PR: XALANJ-1891
Submitted by:	Brian Minchau
Reviewed by:	Sarah McNamara
Creating MANIFEST.SERIALIZER, a template like MANIFEST.MF but
for an independent serializer.jar that is not part of xalan.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338055 13f79535-47bb-0310-9956-ffa450edef68"
d321dfa6e21ed22a8db94747a809feaffcf1f297,"PR: XALANJ-1891
Submitted by:	Brian Minchau
Reviewed by:	Sarah McNamara
Changes to java/build.xml so that the serializer.jar is built
and used by Xalan.

The two new build targets are serializer.jar and serializer-dist


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338056 13f79535-47bb-0310-9956-ffa450edef68"
256024c88d222e207ef39a01acf7894347577835,"PR: XALANJ-1891
Submitted by:	Brian Minchau
Reviewed by:	Sarah McNamara, Yash Talwar

Checking in an initial serializer.jar into java/bin, hopefully this won't change
too often.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338057 13f79535-47bb-0310-9956-ffa450edef68"
a3b82d73667fedcd4ee95b55036718062a5b6fd2,"This patch makes the close() function behave better but still has a 
problem when certain iterators are used.  This code is at least safe 
in all instaces. 

It also fixes a minor bug in the default connection pool

PR:
Obtained from: John Gentilin
Submitted by:	John Gentilin
Reviewed by:	
CVS: ----------------------------------------------------------------------
CVS: PR:
CVS:   If this change addresses a PR in the problem report tracking
CVS:   database, then enter the PR number(s) here.
CVS: Obtained from:
CVS:   If this change has been taken from another system, such as NCSA,
CVS:   then name the system in this line, otherwise delete it.
CVS: Submitted by:
CVS:   If this code has been contributed to Apache by someone else; i.e.,
CVS:   they sent us a patch or a new module, then include their name/email
CVS:   address here. If this is your work then delete this line.
CVS: Reviewed by:
CVS:   If we are doing pre-commit code reviews and someone else has
CVS:   reviewed your changes, include their name(s) here.
CVS:   If you have not had it reviewed then delete this line.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338058 13f79535-47bb-0310-9956-ffa450edef68"
e5f4182928f0b676eacd2b481b6c84500223a645,"A patch to fix Bug XALANJ-1708
Reviewed by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338059 13f79535-47bb-0310-9956-ffa450edef68"
b60e0c3add1ef33ad88b75af99da13766dfd1c1e,"a fix for bug XALANJ-1810
Reviewed by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338060 13f79535-47bb-0310-9956-ffa450edef68"
cce92522ff1610e4df026a43a4a6314b247d2775,"Fix the samples build. The samples.class.path needs to include the serializer.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338061 13f79535-47bb-0310-9956-ffa450edef68"
20ecd8166424f2843bd40df98b1dfb11897b3589,"Submitted by:	Brian Minchau
Restoring the SerializerBase class ""public"" (what it used to be).
There were strange build problems, I'll open a JIRA issue.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338062 13f79535-47bb-0310-9956-ffa450edef68"
89d723f2d6b8aa339bc70c516e35db22e69d8a2b,"One more fix to enable builds with JDK 1.4.x.  Need to add the serializer classes to the
xslt.boot.class.path.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338063 13f79535-47bb-0310-9956-ffa450edef68"
2718f7d54063ffae82c1c9ad6fe120dab8138be9,"String comparison should use String.equals(), instead of ==.
Even == works fine for most of the cases, for a serializable object, two variable originally reference to the same string
after deserialization, they no longer reference the same string, although the values are the same. Fix for bug XalanJ-1550


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338064 13f79535-47bb-0310-9956-ffa450edef68"
5e345ab738c2fe6930a90577e1c2f67e47f51143,"The latest Rhino1_5R5 checks for the script language line/column no.>=0
Fixed for bug XALANJ-1887


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338065 13f79535-47bb-0310-9956-ffa450edef68"
d293b17867d8b839ef27e7d0a1423b1e1861a523,"Submitted by:	Brian Minchau
Deleting Xalan's  ./java/bin/serializer.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338066 13f79535-47bb-0310-9956-ffa450edef68"
5090975c8f66259d7de634a46e8a52ca1a12eae2,"Added a service provider configuration file to set the Apache BSF as the default implementation for scripting language support


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338067 13f79535-47bb-0310-9956-ffa450edef68"
72ac7eabd2b05a3199e2fd83f22649c43105c202,"remove IBM bsf implementation from the distribution. Xalan is not going to ship any bsf implementation. If users need IBM bsf, they can download it from Attic


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338068 13f79535-47bb-0310-9956-ffa450edef68"
1441e4cef5a7cc93aaa00b474d087d8d524906dc,"PR: bug XALANJ-1985
Submitted by:	Yash Talwar
Reviewed by:	Brian Minchau

Support for DOM 3 API, for use by an XML Parser.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338069 13f79535-47bb-0310-9956-ffa450edef68"
4f532bce1a5aa13038ebb7d8c2121599ff00c359,"Patch for bug report XALANJ-1994.

The CallTemplate.getCalleeTemplate() method was searching through a Vector of
all templates defined by the logical stylesheet, and picked out the first with
the same name referenced by the current xsl:call-template instruction.  However,
that failed to account for import precedence.  The SymbolTable.lookupTemplate
method takes into account import precedence, and should be used instead.

Patch was reviewed by Christine Li (jycli@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338070 13f79535-47bb-0310-9956-ffa450edef68"
fe7ff2019cab0d1fad5b7fd7d8336efc192bc249,"Patch for Jira bug 1955.  The equals(Object) method contains a list of
instanceof checks, and then casts the Object argument to the tested type in
order to dispatch to a more specific equals method.  In the case where the
Object argument was an XMLString, the code was actually casting ""this"" to
XMLString - thus testing this.equals(this), which will always be true.

Reviewd by Joanne Tong (joannet () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338071 13f79535-47bb-0310-9956-ffa450edef68"
ee1e5c3878329c0225604e39e294f9396bdfb149,"Patch for Jira bug 1368.

The method getKeyDeclaration was looping through all the xsl:key elements
defined, and returning the first with the required name.  However, more than
one xsl:key element can specify the same name, and should be treated
cumulatively.  Modified the method so that it returns all elements with the
required name, and the caller so that it tries to match against the patterns
associated with all such elements.

Reviewed by Joanne Tong (joannet () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338072 13f79535-47bb-0310-9956-ffa450edef68"
8870fe23ee8f6eeaa14e178950cbbff454099a3b,"Fix a memory leak problem in DTMManager (JIRA bug 1999).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338073 13f79535-47bb-0310-9956-ffa450edef68"
602ee28dfef5cc1b8a94c7cc5e1b2b4e48c83700,"Patch for Jira-2003. Problem was unrelated to recursion, but simply a bug in the basis library. Swapping operands requires swapping operators and the latter was not done. A workaround for this bug would be to swap the operands (and operator) in the stylesheet (as that would not cause any swapping in the basis library).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338074 13f79535-47bb-0310-9956-ffa450edef68"
2903bedeb40fab4ef86fc9761bafec4f13cc88d4,"Patch for Jira 2015. Namespace declarations are now reported on a first pass to avoid the problem described in the bug report.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338075 13f79535-47bb-0310-9956-ffa450edef68"
3e9ba4b8ee2d4caf29d7981c22238a4e9896807b,"Patch for Jira 1761. Output properties from multiple xsl:output instructions are now correctly merged (previously, only cdata-section-elements were handled correctly).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338076 13f79535-47bb-0310-9956-ffa450edef68"
faf464910d2ac6596bcff7e9029fdbccb1a0bea8,"Replaced meaningless numbers by predefined constants in swapArray[] vector.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338077 13f79535-47bb-0310-9956-ffa450edef68"
d0b15fbfeed1e7ca475523cfb19f12c921b2e921,"fixed jira 1824, changed current template rule when named template executes an xsl:apply-imports


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338078 13f79535-47bb-0310-9956-ffa450edef68"
78e797932c6b084037af67b32000a0cfa279c738,"fixed jira 1662, allow pipeDocument to throw exceptions


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338079 13f79535-47bb-0310-9956-ffa450edef68"
051d5612e10d249e9d4e9d03850351fd50fa2186,"fixed jira 1812, template inlining setting propagated to imported stylesheets


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338080 13f79535-47bb-0310-9956-ffa450edef68"
2d07c253b814672a82d969836d58577bfa628b88,"Patch for bug report XALANJ-2008
Based on Sun's Security Code Guidelines, modified the code to improve the
security. Major changes includes:
1. Added final modifier to static variables;
2. Reduced scope and added public get methods whenever it is appropriate;
3. Changed some static variable to instance variables;
4. Changed some interfaces to final classes, if those interfaces are used only to define constants
5. Removed the usage of System.exit;
6. For various org.apache.xml.utils.res.XResourceBundle, the getObject() methods return immutable array wrappers instead of arrays
7. Changed static methods of org.apache.xpath.compiler.FunctionTable to instance methods and the reference of a function table is passed around the processing to create an XPath object;
8. Changed the flags of FEATURE_INCREMENTAL, FEATURE_OPTIMIZE and FEATURE_SOURCE_LOCATION to instance variables in TransformerFactorImpl. So they will not be changed during a processing once a new Templates is created;


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338081 13f79535-47bb-0310-9956-ffa450edef68"
d6df3172694241c05c554c70df53ad5eaab7d2bf,"Patch for bug XALANJ-1592. Submitted by Catya Alone (catyaa@hotmail.com).
Set the parent node for the arguments in extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338082 13f79535-47bb-0310-9956-ffa450edef68"
70c0e71e11b408f566733ee187d1ecccbbedbf04,"Partial fix for bug XALANJ-2021


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338083 13f79535-47bb-0310-9956-ffa450edef68"
6709cc95dff36c3312f9eac2c3fd45384119b8ee,"Partial fix for bug XALANJ-2021
just to make key/keyvalue consistent


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338084 13f79535-47bb-0310-9956-ffa450edef68"
ea0d96ba6a916b1490923761be4d761855dbc76a,"Other languages, for XALANJ-2021


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338085 13f79535-47bb-0310-9956-ffa450edef68"
47c8952811abf0ff15fb8b139be8738986dd86b3,"A class containing only message keys, to be shared by all language
translations (including English).  This is to prevent replication of these
keys during translation. Related to XALANJ-2021


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338086 13f79535-47bb-0310-9956-ffa450edef68"
78dc80c54e3f762e95d6ef30468049046e155ca6,"Changes for moving the message keys, to be shared by all language
translations (including English).  This is to prevent replication of these
keys during translation. Related to XALANJ-2021


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338087 13f79535-47bb-0310-9956-ffa450edef68"
7cf2b43d3d0db01a39d44b12e72a38664b7ba370,"Serializer messages were copied into a message file in the
org.apache.xml.serializer.utils package.

The serializer messages in this file are now ""dead"", so they are being deleted.
This is part of the cleanup with XALANJ-2021


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338088 13f79535-47bb-0310-9956-ffa450edef68"
adb0d5092fc58b728075da089c096c53f72cf4d2,"Applying patch for Jira bug report XALANJ-1427 on behalf of Yash Talwar
(ytalwar () ca ! ibm ! com).

Completing support for DOM Level 2 Core methods that were previously
unimplemented, and fixed some bugs in the implementation.  The implementation
continues to be, of necessity, a read-only implementation.

In particular, implemented the following:

  DTMNamedNodeMap.getNamedItem(String)
  DTMNodeProxy.getElementsByTagName(String)
  DTMNodeProxy.getElementsByTagNameNS(String,String)
  DTMNodeProxy.getElementById(String,String)
  DTMNodeProxy.getAttributeNodeNS(String,String)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338089 13f79535-47bb-0310-9956-ffa450edef68"
5ad48f9d39e1befbc6002d1b85f06ad261b49bb4,"Added a FAQ about how to use XSLTC in applet when using JRE1.4. It is a fix for bug report XALANJ-1705. Patch reviewed and modified by Sarah McNamara


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338090 13f79535-47bb-0310-9956-ffa450edef68"
f497fb651aeaa7a33d9514269b93f4439671bd6d,"Fix for JIRA bug #2013.  Duplicate time zone string returned from EXSLT time() function.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338091 13f79535-47bb-0310-9956-ffa450edef68"
69cbfe1ec3ac646b98f65b7a310b70f91f7cff30,"New manifest file to resolve Jira bug report XALANJ-1853 .


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338092 13f79535-47bb-0310-9956-ffa450edef68"
6c0f00f4f78163418f5799b04c02e2e878a34df7,"Fix for Jira bug report XALANJ-1853 .  Use the new xalan interpretive manifest file
when building the standalone xalan.jar that only contains the interpretive processor.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338093 13f79535-47bb-0310-9956-ffa450edef68"
b16baefaed27f67f47b9f2cc7ec0dde2df5820ab,"Fix for Jira bug report XALANJ-1852.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338094 13f79535-47bb-0310-9956-ffa450edef68"
94810fbfeb337c8030754a81e050f4211a4113e0,"Update org.w3c.dom.xpath package to the latest DOM L3 Working Group Note level.  See XALANJ-1985.
Ideally this package should be moved into the xml-apis.jar in xml-commons, but until that move happens
(likely when JAXP 1.3 is done), we should keep these APIs up to date.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338095 13f79535-47bb-0310-9956-ffa450edef68"
0eaf5fb23a3872336d577ab4d4287aad394e9ae1,"Applying patch for Jira bug report XALANJ-1640.

As it's currently written, SerializerUtils.outputResultTreeFragment loops
through the nodes in a result tree fragment, and for each one, it checks
whether the node is in some namespace.  If it is not, the code undeclares the
default namespace by calling handler.startPrefixMapping("""", """").  The problem
is that if the RTF that's being copied just consists of a text node (or PIs or
comments), that undeclaration of the default namespace hangs around until some
subsequent child element picks it up as one of its attributes, even if that
element is in some namespace - even what should be the default!

The fix is to check whether the node that is being output is an element node
prior to issuing the handler.startPrefixMapping call - that ensures the prefix
mapping is not issued unless it's actually going to be used by the node that is
about to be serialized.

This patch was reviewed by Brian Minchau (minchau () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338096 13f79535-47bb-0310-9956-ffa450edef68"
f0edf88a2858cc5e75e64ce0179523d179b17df6,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338097 13f79535-47bb-0310-9956-ffa450edef68"
7d749ec5cec2a0072201b9efa2e7eee4f7549ca6,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338098 13f79535-47bb-0310-9956-ffa450edef68"
a3231ff0aed61f78c4f5cab3d71d5f68173bec47,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338099 13f79535-47bb-0310-9956-ffa450edef68"
c1f3e5df27c9de2d2ac22bb948354fbfc45661bd,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338100 13f79535-47bb-0310-9956-ffa450edef68"
66d546727ccbb1ca81853d5bde38f6e007f1bba8,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338101 13f79535-47bb-0310-9956-ffa450edef68"
d53b1f306871a83e96499bf12c229a83ddef8ca4,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338102 13f79535-47bb-0310-9956-ffa450edef68"
230fa82bab6cdf2c47ad1ecb45cf70403b2a6ad5,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338103 13f79535-47bb-0310-9956-ffa450edef68"
34924b102395b0d9cac7b890167ac8b3e7698ca5,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338104 13f79535-47bb-0310-9956-ffa450edef68"
7bf9d69ccbc0d88790d455e0510746888741152d,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338105 13f79535-47bb-0310-9956-ffa450edef68"
e617ac6a69a10b0e0582e1d1508adfe3c0b8f1bc,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338106 13f79535-47bb-0310-9956-ffa450edef68"
092a5e1ca1a81eb4304bff482acd0b862ea41ab2,"Fix for Jira bug report XALANJ-1811.

Updated Javadocs for constructors to make it clear that a single instance of
CachecXPathAPI must not be used by multiple threads without synchronization.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338107 13f79535-47bb-0310-9956-ffa450edef68"
e96c2d81e978ced2e5be0222cc4929dd6c30ea2d,"Fix for Jira bug report XALANJ-1888.

It is possible for the characters SAX event to specify a length of zero.  Text
nodes should not be created in such situations.  Changed the charactersFlush
method to guard against this case.

Reviewed by Morris Kwan (mkwan () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338108 13f79535-47bb-0310-9956-ffa450edef68"
1917e1b8a5e51479b723f23189314e5be5dcaa56,"Two part fix for Jira bug report XALANJ-1888.

1) It is possible for the characters SAX event to specify a length of zero.
Text nodes should not be created in such situations.  Changed the
charactersFlush method to guard against this case.

2) Made a defensive change to references to m_dataOrQName.  If the value in
this vector is to be interpreted as an index into m_data, it is stored as a
negative value (via calls to addNode).  However, most references to elements of
m_dataOrQName were checking whether the value was non-positive, treating a
value of zero as an index into m_data as well.  The zeroth entry into m_data is
an invalid entry.
The fix to charactersFlush described above should ensure that zero is never
stored in m_dataOrQName, but I thought it was just as well to duplicate the
interpretation used in storing values in m_dataOrQName.

Reviewed by Morris Kwan (mkwan () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338109 13f79535-47bb-0310-9956-ffa450edef68"
43e784fc82e1b01103ef985891ce436829624135,"Implement Errata E24, when the value attribute of xsl:number is NaN, infinite or less than 0.5. More details please refer to bug report XALANJ-1979.
Patch is reviewed by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338110 13f79535-47bb-0310-9956-ffa450edef68"
8db4c65f10fd6a38814117e11ea5044dd24c9957,"Implement Errata E24 for XSLTC, when the value attribute of xsl:number is NaN, infinite or less than 0.5. More details please refer to bug report XALANJ-1979.
Patch is reviewed by Morris Kwan (mkwan@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338111 13f79535-47bb-0310-9956-ffa450edef68"
85e0a8bffa901a71549e132992a59286b5f50dbe,"Clean up javadoc to reduce warnings during doc builds.  See XALANJ-2048


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338112 13f79535-47bb-0310-9956-ffa450edef68"
53b7c55b6ff61ee9e177df7d566a1cace870e61e,"Fix for Jira bug report XALANJ-1478.

In the recursive descent parsing of an ill-formed XPath expression like ""2+"",
when the parser reaches the end of the expression while still looking for an
operand it ultimately ends up trying to see whether what remains can be parsed
as a location path.  However, the LocationPath method was silently parsing the
end of an expression as a location path!  Added an error for that situation.

Reviewed by Brian Minchau (minchau () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338113 13f79535-47bb-0310-9956-ffa450edef68"
d793724df0b852fdfc359a570c5ca402906ac959,"Fix for Jira bug report XALANJ-2054.

The sample ContentHandler code was printing the namespaceURI argument of
startElement and of endElement twice, but never printed the localName argument.
Fixed that typo.

Reviewed by Brian Minchau (minchau () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338114 13f79535-47bb-0310-9956-ffa450edef68"
5e32b6859ae6e947331cfccd543d67bba0374ba6,"Fix for XALANJ-1417
position() method when template is imported.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338115 13f79535-47bb-0310-9956-ffa450edef68"
65cebcca4ba7438f6730cbdb2421226b6ee92113,"Fix for XALANJ-1886. Multiple problems fixed related to collecting xsl:attributes 
with over-ridden values and prefix/URI maps.  With this fix, internally the
serializer correctly identifies attributes by their expanded QName, which 
includes the URI rather than the prefix.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338116 13f79535-47bb-0310-9956-ffa450edef68"
ab7d65352f28a3a5ad5ef3e2ee30cf4134f94c76,"Fix for XALANJ-1985, reviewed by Henry Zongaro.
Problem was that a serialized DOM failed to declare a prefix/URI mapping.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338117 13f79535-47bb-0310-9956-ffa450edef68"
b892d4a4048586c66b09f33712dc15af5e99265d,"Fix for XALANJ-2037, that the trace information 
doesn't have the right location information in this case.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338118 13f79535-47bb-0310-9956-ffa450edef68"
8275e902655dbc2f70c9f186f4493af04a7e659d,"This is a fix for XALANJ-2058.
In the code, the problem is that a pattern gets compiled once, 
and then this compiled pattern get re-used whenever the pattern is
needed in any method.

The fix is that pattern should get compiled once per method.  So, pattern get reused only within a given method.
For any new method, a pattern is recompiled.

This fix has been reviewed by Henry Zongaro.
Henry had also provided suggestions about the fix to resolve this issue.
Thanks Henry for his valuable input.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338119 13f79535-47bb-0310-9956-ffa450edef68"
fb2fc89568e1757a8c3a642a203334d240886f59,"Committing serializer.patch5.txt  in JIRA issue XALANJ-1886,
that puts back an old attAttribute() method that takes 5 String arguments.
There is a new one that takes these
5 String arguments and a boolean to indicate if it is from an xsl:attribute
or not.  I'm just restoring the old method.

Patch reviewed by Henry Zongaro.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338120 13f79535-47bb-0310-9956-ffa450edef68"
b164811de5633575cb688fe8df7364befdf8da93,"Fix for XALANJ-2033 and XALANJ-2051 so that the serializer will serialize DTD
tags if desired.  The patch was reviewed by Ilene Seeleman.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338121 13f79535-47bb-0310-9956-ffa450edef68"
4ad18b32bdcb9b5561a363e0806110017bddf96e,"The fix is for XALANJ-2059.
The problem is that when href attribute has aboslute uri with jar scheme and
base uri is not null, then base uri is pre-appended to uri specified in href attribute.
The newer patch is according to RFC 2396.
The newer patch ignores base uri and directly make use of uri specifed href attribute, provided following conditions are met.
a)If uri specified in href attribute starts with / after the scheme and :
  For example, href=""file:/myDIR/myXSLFile.xsl.
b)If scheme specified for uri href attribute is not same as scheme for base uri.
c)If base uri is not hierarchical

Henry Zongaro has helped creating this patch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338122 13f79535-47bb-0310-9956-ffa450edef68"
3a99c18208bd8fec39c5fdb8230aa55c869b4c87,"This patch fix XALANJ-2070.
This patch add XML 1.1 support in term of following:

- Output Document can be of Version XML 1.1
- Control Characters in Range C0 and C1 are output as NCR.
- Namespaces in XML 1.1 can be IRIs.
- NCNames and QNames can conform to XML 1.1 specifications.
- NEL and LSEP characters are treated as new end of line character as per XML 1.1 specifications.

Thanks to Brian Minchau for reviewing the patch.  Brian Minchau and Henry Zongaro has also helped how XML 1.1 support should be done.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338123 13f79535-47bb-0310-9956-ffa450edef68"
08d96722d655ebb527e0454e0c49df3717536353,"Added implementation for getAttribute, getAttributeNS and
getAttributes for LRE. A fix for bug report XALANJ-1526


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338124 13f79535-47bb-0310-9956-ffa450edef68"
4fcaccb99758426bc0fbcb7db74418812ffddd35,"Patch for XALANJ-1990.  Fixes broken link to apidocs for Serializer.html.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338125 13f79535-47bb-0310-9956-ffa450edef68"
36a2bac7b520a8493f2854d24cbca86c1d1a2769,"Patch for XALANJ-2026.  Fixes typo in Debugger interface code example.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338126 13f79535-47bb-0310-9956-ffa450edef68"
e20b5d2e07b917aa5d5f90e88762d121ffb26b2a,"Patch for XALANJ-1937.  Change references in the docs from bugzilla to Apache Jira for reporting new issues and checking the status of existing issues.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338127 13f79535-47bb-0310-9956-ffa450edef68"
db7b7053b087579efa3d3eabfa7b7c789f80a952,"Fix for XALANJ-2074, committing patch2 in that issue, which removes two
untranslated messages in SerializerFactory, and uses a new common message
in SerializerMessages.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338128 13f79535-47bb-0310-9956-ffa450edef68"
b37d74cf03e04eabcb7d42ea6ca6cd0668b25d02,"Marked the code to be privileged, which allows users to load
customized entity files in sandbox. Fixed bug report XALANJ-2068.
Patch was reviewed by Brian Minchau (minchau@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338129 13f79535-47bb-0310-9956-ffa450edef68"
d6b0819a2ff49c011822e0d9ea3e5c701a8de540,"This patch fixes XALANJ-1431.
The patch has been reviewed by Brian.

The problem is that that when an empty attribute value is encountered, a text node is being created 
with empty string. 
Henry Zongaro has helped finding the XSLT 1.0 specs. that suggest a text node with empty string should not be created. URL http://www.w3.org/TR/xslt#value-of has the following information: 

""The xsl:value-of element is instantiated to create a text node in the result tree. The required select attribute is an expression; this expression is evaluated and the resulting object is converted to a string as if by a call to the string function. The string specifies the string-value of the created text node. If the string is empty, no text node will be created. The created text node will be merged with any adjacent text nodes.""


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338130 13f79535-47bb-0310-9956-ffa450edef68"
896bc4ab2f750e4203d07f44558eaa7762d6822a,"update the copyright year for changes (5% of the file or more)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338131 13f79535-47bb-0310-9956-ffa450edef68"
6210259653fee1d192793059e2cc681721d297e2,"Patch for Jira bug report XALANJ-2079.

Updated links to nightly Gump build.

Reviewed by Brian Minchau.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338132 13f79535-47bb-0310-9956-ffa450edef68"
f5d98c3cbbe4890d2f6eb957b255d0cd87cbe27a,"One character change, updated copright to 1999-2005 (was 1999-2004).
No JIRA issue.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338133 13f79535-47bb-0310-9956-ffa450edef68"
c51d12ea6cdf9636dd94d95e6ce732af2dfbc9ad,"Minor changes to comments and javadoc comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338134 13f79535-47bb-0310-9956-ffa450edef68"
040240df0d7926e6e105fefc747579b68315632f,"Minor changes to comments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338135 13f79535-47bb-0310-9956-ffa450edef68"
ca67d47b323e2c3997599cb371a14c285d31f712,"This is a fix for XALANJ-2081.
In class org.apache.xalan.xsltc.compiler.Text, a check was being done to find out if a given text string is all whitespaces.
In case, a given text string is all whitespace, a call to serializer is not made.
The code was using trim() method from java.lang.String.  trim() method trimmed characters as whitespaces 
that are not considered as whitespace in XML.

The code logic is changed to check if a given string is all whitespace accoding to XML specifications.

I would like to thank Michael Glavassevich and Brian Minchau for their input to resolve this issue.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338136 13f79535-47bb-0310-9956-ffa450edef68"
f5e9379c12858644b7457ebfd53486a4d094102a,"This is resolve UTF-8 Charcater support and QName character support for XML 1.1 support in XALANJ-2070.

Henry Zongaro and Brian Minchau helped in fixing this part of the JIRA issue.

A new class org.apache.xml.utils.XML11Char has been included to support XML 1.1 characters.
Also a reference to org.apache.xml.utils.XMLChar has been replaced with a reference to
org.apache.xml.utils.XML11Char in almost all the places in Xalan.

org.apache.xml.serializer.WriterToUTF8Buffered has been update to support UTF-8 characters that can be represented in four bytes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338137 13f79535-47bb-0310-9956-ffa450edef68"
8dafafac43d3215dac32f71857dd425d9cd03714,"This resolves XALANJ-2085.
Sarah McNamara has reviewed this change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338138 13f79535-47bb-0310-9956-ffa450edef68"
556575ea4927b785c8b4416f5d8509e39264cada,"This is a fix for XALANJ-2089.
Christine Li has created this patch.
Brian Minchau helped in creating this patch.
Brian Minchau also reviewed this patch.

org.apache.xalan.templates.ElemNumber.java has raised some performance issue as 
a static array to hold resources was removed earlier.  However, the removal of static array is necessary
to fix a potential bug multithread environment, where a given thread can request different locale than another thread.

This patch resolves the performance glicth that was found in internal testing.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338139 13f79535-47bb-0310-9956-ffa450edef68"
521a5308c838a6b4c479897531e06cf118ad5785,"Commiting patch for XALANJ-2095, that tabs in text nodes in XML documents
are serialized to &#9; but should stay as a tab character.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338140 13f79535-47bb-0310-9956-ffa450edef68"
11e0695f438f2e5fcdf379e8fa53ba18848794f9,"Committing patch from XALANJ-2082 , mostly changing javadoc from:
  @see org.apache.xml.serializer.<ClassName>
to
 @see <ClassName>.

A few other javadoc clean ups.
Just trying to make the serializer itself less dependant on its own
high level qualifiers in its package name.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338141 13f79535-47bb-0310-9956-ffa450edef68"
82708ce2b229c5123d0526fd3607e1fe40faaeef,"Patch from XALANJ-1924 applied. The one deprecated API used is replace
by the current one, but multiple typos in other examples are corrected.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338142 13f79535-47bb-0310-9956-ffa450edef68"
4151a6cc634c2d44725a22f464ba7e7a4ccc7678,"Committing patch for XALANJ-2077.  This performance modification is
estimated to shave 3% of the serialization stage of small documents.

Every little bit counts.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338143 13f79535-47bb-0310-9956-ffa450edef68"
6e37cb45c07d6131eca408b194d4fe71bf5dcd4a,"Appling fix for XALANJ-2086, which pointed out that findCharToByteConverterMethod() 
always returned null.  This bug was introduced some time ago during some security
fixes.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338144 13f79535-47bb-0310-9956-ffa450edef68"
fd1f08b9350768d714ae774ad28a94c2da441056,"Clear XML reader for the case in which them main stylesheet is passed using a DOMSource. This fixes the problem of trying to use a DOM2SAX reader for included/imported stylesheets that are resolved by user-defined URI resovers.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338145 13f79535-47bb-0310-9956-ffa450edef68"
fd69d9d3c9a4b4d08eb40856fa59cdd938396950,"Fix for XALANJ-2109 applied (we won't \n to \r\n in an HTML attribute value on
Windows OS anymore, it will be left as is during serialization).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338146 13f79535-47bb-0310-9956-ffa450edef68"
7a57aaa0c6c704fd80f66138feadb1ec76d91fb8,"Applying patch in XALANJ-2105


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338147 13f79535-47bb-0310-9956-ffa450edef68"
837d8e2c7557e7a350027424f0f8c546b44ac1db,"Current release plan for Xalan-J 2.7.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338148 13f79535-47bb-0310-9956-ffa450edef68"
c4a86cf87fb0840d3df94f2a1947420f6e4b1d9f,"Putting Morris Kwan's name by some of the JAXP 1.3 line items


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338149 13f79535-47bb-0310-9956-ffa450edef68"
fc90504a8fe629fa8e065bd7bbb5404e180085ff,"JAXP 1.3 integration

Integrate the Sun donated JAXP 1.3 implementation into the head branch


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338150 13f79535-47bb-0310-9956-ffa450edef68"
12a187c062062a229ade9a486a6a0ee210a4d633,"JAXP 1.3 integration
Commit the XPath API implementation under org.apache.xpath.jaxp


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338151 13f79535-47bb-0310-9956-ffa450edef68"
8783dc072a4d5f6fa0fdd5941f0f4ed3a3e699b7,"New xml-apis.jar containing JAXP 1.3 APIs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338152 13f79535-47bb-0310-9956-ffa450edef68"
fadf2d0fde5c5324b4bcad392064ff7ca4428ca9,"Modified FunctionTable. Although it is not recommanded, but it is doable for users to add a customized function or overwrite the default implementation of a build-in function. Fixed bug report XALANJ-2116
patch is reviewed by Henry Zongaro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338153 13f79535-47bb-0310-9956-ffa450edef68"
a937025f555d0dcebd12bebc5d446a8cedc7f965,"Put in the missing Transformer.reset() implementation when doing the JAXP 1.3 integration


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338154 13f79535-47bb-0310-9956-ffa450edef68"
4fb18f8e9debadd6f28251464b3859bda58ab421,"Support DOMResult.nextSibling in XalanJ Interpretive. If
nextSibling is not null, then result nodes are inserted
before it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338155 13f79535-47bb-0310-9956-ffa450edef68"
aba5d5c4af90b8bae414a425916312b147f8c2b4,"Support DOMResult.nextSibling in XSLTC.
The nextSibling information is passed from TransformerImpl to TransletOutputHandlerFactory,
then to SAX2DOM. If nextSibling is not null, SAX2DOM inserts the result nodes before it.
Otherwise the result nodes are appended as the last children of the parent.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338156 13f79535-47bb-0310-9956-ffa450edef68"
24b73f1892c8a85f2f25a1966cb3f9ea64a59aee,"Add two samples to demonstrate how to use the XPath API in JAXP 1.3.
1. ApplyXPathJAXP
Basic sample like ApplyXPath, but use JAXP 1.3 XPath API instead

2. XPathResolver
Demonstrate how to use NamespaceContext, XPathFunctionResolver and XPathVariableResolver.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338157 13f79535-47bb-0310-9956-ffa450edef68"
83c2d7b03c9d56b8fbdf7bd774552753ad8a5b44,"Replace copyright statements.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338158 13f79535-47bb-0310-9956-ffa450edef68"
f4e310ee6b4efea1eed5f4dc78ac673aa9fbf5df,"Patch for XALANJ-2126.
This is a sample implementation of XPathFunctionResolver, with support for
Java and EXSLT extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338159 13f79535-47bb-0310-9956-ffa450edef68"
310873427c30eb1f5abb34fa3c18ae842ef4bf93,"New messages for XALANJ-2126.
Messages for the sample XPathFunctionResolver implementation.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338160 13f79535-47bb-0310-9956-ffa450edef68"
357aab6902bce1b2b2baace77e4280be9b1e6191,"For XALANJ-2126. New sample to demonstrate how to use the sample
XPathFunctionResolver to evaluate XPath expression containing
Java and EXSLT extension functions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338161 13f79535-47bb-0310-9956-ffa450edef68"
9bb1e33791361ca62c3b8a2ddaa86aa856d88007,"Committing patch for issue XALANJ-2121, which is that some empty attributes
of some HTML elements are note serialized as empty.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338162 13f79535-47bb-0310-9956-ffa450edef68"
e52f6707803a83bd2c5c2888be18011d065a81ab,"Putting static iniitialization of HTML element/attribute information in a static method,
which is invoked from a static { ...} block.

No real difference, but slowly inching this code towards adding a
ToXHTMLStream class that extends ToXMLStream, but uses methods in
ToHTMLStream.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338163 13f79535-47bb-0310-9956-ffa450edef68"
f22658e0d69f8550b3494a8593653ad91e44410c,"Patch for XALANJ-2123.
Move hard-coded messages for JAXP 1.3 into resource bundles.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338164 13f79535-47bb-0310-9956-ffa450edef68"
d2de8d63ab9f10c7a4a7d79f875a8fdbca459ac0,"Added ""nowrap"" as an empty attribute for elements <div> <src> and <tr>
as these are either Netscape or Internet-Explorer extensions.

This is patch3 from XALANJ-2121


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338165 13f79535-47bb-0310-9956-ffa450edef68"
2031c5d0b75380930bca7472f7fe3024620bf09b,"Applying patcth for JIRA XALANJ-2093
adding a xalan:line-separator extension output attribute.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338166 13f79535-47bb-0310-9956-ffa450edef68"
5fc95cae41ce4f004a0ea6fff15b94b064547eaf,"Patch for XALANJ-2134.
Change the error handling behavior to be conformant with the requirement
from JAXP 1.3 that the default ErrorListener will report all warnings and errors
to System.err and does not throw any Exceptions.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338167 13f79535-47bb-0310-9956-ffa450edef68"
5c5ee1903026642f6537f99e8efb471e5ea26664,"Patch for XALANJ-2136
Support the secure processing feature in Xalan interpretive. When this feature
is set to true, the following XML processing limits are applied:
1. extension functions and extension elements are disabled.
2. parsers created by the XSLT processor also have the secure processing feature set
to true.

A new option -secure is added to the Process command line to enable the secure
processing feature.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338168 13f79535-47bb-0310-9956-ffa450edef68"
e1e1f39528f8bfac8ff9b4a6b209ae5503e71ca9,"Patch for XALANJ-2136
Implement the secure processing feature for XSLTC. Extension functions
and extension elements are disabled when this feature is set to true.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338169 13f79535-47bb-0310-9956-ffa450edef68"
aa28c154d8f57854986dd266f1149dc49cb25406,"Fix for XALANJ-1938.

A KeyIndex object contains a Hashtable mappings from key values to the
IntegerArray objects that contain the set of nodes selected by those key values.
For a reference to the key function, the lookupKey method finds the nodes
selected by a particular key value, and the merge method merges all the nodes
selected if more than one key value is specified for the one refernce to the key
function.

The problem was that the lookupKey and merge methods operated on the ""live""
versions of the IntegerArrays stored in the mapping Hashtable, so that one
reference to the key function might affect the result of subsequent references
to the key function.  Changed those methods to make clones of the selected
IntegerArray objects, which can be safely modified without affecting the
original IntegerArrays.

This patch was reviewed by Joanne Tong (joannet () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338170 13f79535-47bb-0310-9956-ffa450edef68"
db239167d2ddec47478956532c1b502bc3260b17,"The new xercesImpl.jar supports the secure processing feature.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338171 13f79535-47bb-0310-9956-ffa450edef68"
65e8d97ec2057e377dafac85ebe4413b9ef3acb4,"Update with the latest xml-apis.jar built from xml-commons.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338172 13f79535-47bb-0310-9956-ffa450edef68"
0e337e7d92a750139000337aae8264f2e278ee65,"Patch for XALANJ-2124
Update the online documentation to include descriptions on the new JAXP 1.3 features:
1. Add a new ""XPath API"" page to provide a complete guide on how to use the
XPath API in JAXP 1.3. Details on basic usage patterns, factory plugin mechanism,
how to use NamespaceContext, XPathVariableResolver and XPathFunctionResolver.
2. Document the secure processing feature in the features page
3. Describe three new XPath API related samples in the samples page.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338173 13f79535-47bb-0310-9956-ffa450edef68"
1a5cc05317366cc57a542c07981979541f11acb1,"Patch for bug XALANJ-2097 from Nick Van den Bleeken
(Nick.VandenBleeken () pandora ! be), reviewed by Henry Zongaro.

The code generated for a path expression of the form $var/self::node() was
incorrect.  It looked like the following, where ""i"" refers to the context node.

  new StepIterator(dtmaxisiterator1.cloneIterator(), new SingletonIterator(i));

That's incorrect, because the SingletonIterator will only return the node used
upon its instantiation, rather than the node provided from the parent step
expression by the StepIterator.

The SingletonIterator should only be used if the self::node() is not a step
in a path expression.  In the case of a path expression, dom.getAxisIterator
should be used to create the axis iterator instead.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338174 13f79535-47bb-0310-9956-ffa450edef68"
8e46d9d05009a6c301c9a0ee704c01984d13dc8b,"Service provider file for javax.xml.xpath.XPathFactory


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338175 13f79535-47bb-0310-9956-ffa450edef68"
b143ceebd91b2400a80538989086483d702960ad,"xml and extension java source for the ExtensionFunctionResolver sample.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338176 13f79535-47bb-0310-9956-ffa450edef68"
b2e0954a56e71c6b87c680a3abea496c7698755f,"Update manifest files for jaxp version and remove entry for org.w3c.dom.xpath.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338177 13f79535-47bb-0310-9956-ffa450edef68"
0560ac5bb3ff162f6b66d82e3443bc9b57d94598,"Update the source and binary of xml-apis.jar


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338178 13f79535-47bb-0310-9956-ffa450edef68"
4f2ce4ca882a5eadf127d0d88530f14e6b2c552b,"Java docs cleanup.
Remove the word ""Experimental"" for DOM Level 3 spec and update the URI link.
Also remove the obsolete methods that are replaced by new ones.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338179 13f79535-47bb-0310-9956-ffa450edef68"
0b2bdf802c3baa074f7bf2c5b2800a4f348d7525,"Cleanup javadocs on DOM Level 3 spec. Update the uri and remove
obsolete methods. The getVersion() method in org.w3c.dom.Node is replaced by
getXmlVersion().


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338180 13f79535-47bb-0310-9956-ffa450edef68"
c847147fcfd580f356d98c52758aa334c82f555e,"The latest xercesImpl.jar from cvs.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338181 13f79535-47bb-0310-9956-ffa450edef68"
d22bb62f6f961af7e7892cf5e734c3995427090d,"Add xml-apis.jar to boot classpath to fix a build problem
with JDK 1.4.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338182 13f79535-47bb-0310-9956-ffa450edef68"
2a4c485800396803f5f171f957b9a8cadcde2a6b,"Update xml-commons source


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338183 13f79535-47bb-0310-9956-ffa450edef68"
cab606709e6ca97a85596edba4d79c5583464ee7,"The new xml-apis.jar from the parser team.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338184 13f79535-47bb-0310-9956-ffa450edef68"
85df3e6396872128bb0fdd001cf1d63db5008628,"Patch for XALANJ-2076. Fix a bug in date:month-in-year.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338185 13f79535-47bb-0310-9956-ffa450edef68"
2e0b27e8cd9cc8fb0281786f3a5bbe93bed76bc9,"New xercesImpl.jar from the official Xerces-J 2.7.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338186 13f79535-47bb-0310-9956-ffa450edef68"
471ee807515b30452446056c7fc1094df22ff787,"Remove files under xml-xalan/java/src/org/w3c/dom/xpath. These classes
are already included in xml-apis.jar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338187 13f79535-47bb-0310-9956-ffa450edef68"
1077fbacabe0ab7df2e2e8781abd05ea7f5cde87,"Remove the corrupted file, which was not marked as a binary.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338188 13f79535-47bb-0310-9956-ffa450edef68"
89238e304f804dfa401db95e8927e6192c300d49,"Recreate the file as a binary


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338189 13f79535-47bb-0310-9956-ffa450edef68"
c447ef7ce5a98efb0909366a92f09d97862bfb91,"Cleanup resource files. Remove unused constants and commented out message keys. Fix for bug XALANJ-2161
Patch is reviewed by Sarah McNamara (mcnamara@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338190 13f79535-47bb-0310-9956-ffa450edef68"
1ca29c27de15c3f0758c79f0f3360a05eaae2495,"Patch for XALANJ-2146.  Reviewed by Christine Li (jycli () ca ! ibm ! com).

Section 4.3.4 of the JVM specification prohibits an uninitialized object from
appearing on the stack or in a local variable when a backwards branch is
executed.  We need to guard against that in the generated code in XSLTC by
storing arguments to constructors in temporary variables if there's any
possibility that the code used to calculate such arguments might contain a
backwards branch.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338191 13f79535-47bb-0310-9956-ffa450edef68"
a4e8ae0fbfb12ec55cf84fc2cc22dafa40af8501,"Patch for Jira issue XALANJ-1978.  Reviewed by Christine Li
(jycli () ca ! ibm ! com).

Behaviour of StreamResult.getSystemId has changed if the Result object was
created using a File.  The URI returned begins with ""file:/"" where it used to
begin with ""file:///"".  TransformerIdentityImpl had a dependency on the old
behaviour.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338192 13f79535-47bb-0310-9956-ffa450edef68"
a22de068d4eac6d346d120f0dfd3bc987b61448b,"Added missing apostrophe for error messages. Fixed bug report XALANJ-2167. Patch is reviewed by Sarah McNamara (mcnamara@ca.ibm.com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338193 13f79535-47bb-0310-9956-ffa450edef68"
a9748402bdf3df897f76ff12f2bb9a802a1f596f,"Fix for bug report XALANJ-2140.

The AbstractTranslet._keyIndexes field is used to record the sets of keys
for a particular transformation by name.  This table was not cleared at the
end of a transformation, so the keys from one transformation persisted to
subsequent transformations.  Fixed this by adding a try-finally block in
the AbstractTranslet.transform method and setting _keyIndexes to null in the
finally block.

Reviewed by Brian Minchau (minchau () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338194 13f79535-47bb-0310-9956-ffa450edef68"
b4977542cb7a660656497bc028eb63fe732e0e0c,"Minor change in the error message,
fix was found by Brian Vargas, patch produced and
reviewed by Brian Minchau.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338195 13f79535-47bb-0310-9956-ffa450edef68"
f7e16f8424e286b02bb67f63ce56f59e6b528929,"Applying patch2 from XALANJ-2023
Submitted by Ken Weiner,
reviewed, approved, applied by Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338196 13f79535-47bb-0310-9956-ffa450edef68"
8f1440970deb1e28ba3e52ca53d53cce56adf1c6,"Changing ""<!DOCTYPE HTML"" to ""<!DOCTYPE html"" to be more xhtml friendly.
Applying the patch in XALANJ-2103 that was created by Brian Minchau
and reviewed/approved by Joanne Tong.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338197 13f79535-47bb-0310-9956-ffa450edef68"
55405742b3c2093aa6e8691f280414f58343df3d,"Fixing a NPE for when _locator is null in the XSLTC Parser.
Applyin the patch in XALANJ-2154 from Brian Minchau, reiwed and approved by Santiago P.G.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338198 13f79535-47bb-0310-9956-ffa450edef68"
e510207b29d85f9037b95a72eabe69c1bc63d32d,"Patch for XALANJ-2099 provided by Morris Kwan and reviewed by me.

According to the EXSLT doc the extension date:day-abbreviation() should
output a three-letter English day abbreviation: one of 'Sun', 'Mon', 'Tue',
'Wed', 'Thu' or 'Fri'.
(See http://exslt.org/date/functions/day-abbreviation/index.html)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338199 13f79535-47bb-0310-9956-ffa450edef68"
f0963a275d722d1c7b44426c33ba4e30f83ca0e0,"Patch for XALANJ-2143.   Javadoc improvement for TransformerImpl.setOutputProperty(name,value).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338200 13f79535-47bb-0310-9956-ffa450edef68"
f89b8db4ddecd3cd3d52f5712916b1d3cb2512f8,"Patch for XALANJ-2142 - correction for the xalan namespace URI.  Patch provided by Brian Minchau and
reviewed by Sarah McNamara.

Patch for XALANJ-2144 - incorrect use of the word ""concurrently"" when referring to the XPath module.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338201 13f79535-47bb-0310-9956-ffa450edef68"
ef7621122762e463b2f9fc3c5bb6f81ccd0fcc46,"delete obsolete file


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338202 13f79535-47bb-0310-9956-ffa450edef68"
1915b5e63712c4b3050a3ef578400a3f69016f36,"Fix file formatting; no functional changes


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338203 13f79535-47bb-0310-9956-ffa450edef68"
efcecf372b331f66df35dbbb6de026dee53abcd7,"Shift release date to Aug 4


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338204 13f79535-47bb-0310-9956-ffa450edef68"
3acc2d8817985903e4f15449de778754b70440e8,"Creation of the xml-xalan/java/licenses directory which contains
all licenses required for the Xalan Java (interpretive and compiled) runtime
jars and its dependencies.   Most of these files have been moved here
from xml-xalan/java/bin.  The serializer files are new for the Xalan Java 2.7
release (fixes XALANJ-1977).  The xercesImpl.LICENSE.txt and xml-apis.LICENSE.txt
now reflect ASL v2.0.

This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338205 13f79535-47bb-0310-9956-ffa450edef68"
78b33590b2ab894e8c02d0ca6bf198f85e9f3e68,"Creation of the xml-xalan/java/lib directory which contains all runtime
library dependencies (jars) required by Xalan Java (interpretive and compiled) runtime
These files have been moved here from xml-xalan/java/bin.

This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338206 13f79535-47bb-0310-9956-ffa450edef68"
32b74c4fd804053259895a4d52d6c69b909083f3,"Another fix for XALANJ-2170.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338207 13f79535-47bb-0310-9956-ffa450edef68"
051ebea6efc71220b82c5f5f212b072ddae5165b,"Creation of the xml-xalan/java/tools directory which contains all build time
tools required by Xalan Java (interpretive and compiled) builds, including
documentation builds.  These tools are not required at runtime.

These files have been moved here from xml-xalan/java/bin.

This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338208 13f79535-47bb-0310-9956-ffa450edef68"
d55d5119d30a043e251dcc49fd5cfcc4fcc536a7,"New readme files for the xalan.jar and serializer.jar.
This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338209 13f79535-47bb-0310-9956-ffa450edef68"
273888a62cbbec994f0180c491e7bc6a9c149fc8,"Remove file. It has been moved to the xml-xalan/java/licenses directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338210 13f79535-47bb-0310-9956-ffa450edef68"
74a240c672d52e04aae74616e6920e27da1c1b94,"Remove file. It has been moved to the xml-xalan/java/lib directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338211 13f79535-47bb-0310-9956-ffa450edef68"
a8b79aaecbce5d4e6332cc592d56ff9c75d42550,"Remove file. It has been moved to the xml-xalan/java/tools directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338212 13f79535-47bb-0310-9956-ffa450edef68"
d8c58c753eaf317dcba1ce0906425e9640296831,"Remove file. It has been moved to the xml-xalan/test/tools directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338213 13f79535-47bb-0310-9956-ffa450edef68"
debaef7232da1b63dce062ee9d4b68b868abfad5,"Updates to the build scripts and Ant build.xml file to accomodate the
restructuring of the tools and runtime libraries in xml-xalan/java/tools and
xml-xalan/java/lib.    Also changes to build.xml to reflect upcoming
Xalan Java 2.7.0 (version number) changes.

This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338214 13f79535-47bb-0310-9956-ffa450edef68"
89d5c187efc5c01c9354c5b57046fcbf353a65c2,"Remove file.  Version.java will be generated, from Version.src at build time
and the appropriate version numbers will be inserted using Ant's filtering capability.

This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338215 13f79535-47bb-0310-9956-ffa450edef68"
6746dfbeb6091e9e8cc9ec46d53a90941e0008e2,"Remove file. It has been moved to the xml-xalan/java/liceenses directory.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338216 13f79535-47bb-0310-9956-ffa450edef68"
7b012d25725560a429ab57b2e48479be2c8492b6,"Remove file.  entities.ent will be generated, from entities.src at build time
and the appropriate version numbers will be inserted using Ant's filtering capability
using information from build.xml.

This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338217 13f79535-47bb-0310-9956-ffa450edef68"
12c987894f97a45e9599e3ac4ebed361a5dc583d,"Doc changes for Xalan Java 2.7.0 release.
This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338218 13f79535-47bb-0310-9956-ffa450edef68"
8ea81ea530c2fb8452c8be9417b9f4a9f514e64c,"Remove file.  XSLProcessorVersion.java will be generated, from XSLProcessorVersion.src
at build time and the appropriate version numbers will be inserted using Ant's filtering capability
using information from build.xml.

This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338219 13f79535-47bb-0310-9956-ffa450edef68"
379483504b012fcc97eab1d28179a6033c06698b,"Doc changes for Xalan Java 2.7.0 release.
This change was reviewed and approved in XALANJ-2170 by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338220 13f79535-47bb-0310-9956-ffa450edef68"
8c2b2d35695898b560500a4925c68d156a39c336,"Patch for XALANJ-2176 reviewed by Christine Li (jycli@ca.ibm.com).

Replaced characters in Javadoc comments that were encoded in ISO-8859-1 with
HTML character entity references.  This avoids any problems with editors, IDEs
or versions of javac that make faulty assumptions about source encodings.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338221 13f79535-47bb-0310-9956-ffa450edef68"
79a05976ce990ae756bfc5a7ca27f30ad40f54d8,"We have a successful gump build using the new xml-xalan/java/lib and xml-xalan/java/tools
directories, so now its time to remove these files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338222 13f79535-47bb-0310-9956-ffa450edef68"
6c1b134105ab233a30fa277b8b2452f9f704d8a2,"PR: XALANJ-2113
Obtained from:
Submitted by:	John Gentilin
Reviewed by:	Henry Zongaro
CVS: ----------------------------------------------------------------------
CVS: PR: XALANJ-2113
CVS: clean up exception handling


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338223 13f79535-47bb-0310-9956-ffa450edef68"
dc3553dba9b15d7ec92ae9846f88774d04ea363a,"PR: XALANJ-2114
Obtained from:
Submitted by:	John Gentilin
Reviewed by:	Henry Zongaro
CVS: ----------------------------------------------------------------------


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338224 13f79535-47bb-0310-9956-ffa450edef68"
38c5b6987861a14a838dccb8e480ba1bb106ff2f,"PR: XALANJ-2114
Obtained from:
Submitted by:	John Gentilin	
Reviewed by:	 Henry Zongaro


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338225 13f79535-47bb-0310-9956-ffa450edef68"
0e3beea5e60b789135f01bf39651ceb47ba97f9e,"Patch for XALANJ-936.
Reviewed by Yash Talwar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338226 13f79535-47bb-0310-9956-ffa450edef68"
79cb148421366312db0f08c32f25b5bb2f4b380f,"Updates to docs for Xalan Java 2.7.0.  These updates are part of
XALANJ-2170 which has been reviewed by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338227 13f79535-47bb-0310-9956-ffa450edef68"
40912ce81bce441447e15d3a3825aa563d0775c5,"Update xercesImpl.jar to Xerces Java 2.7.1  This update is part of
XALANJ-2170 which has been reviewed by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338228 13f79535-47bb-0310-9956-ffa450edef68"
3b00c45770fb3e1e0c37ff9f25d676047f11a825,"Update xml-apis.jar to xml-commons-external-1.3.02 version.
This update is part of XALANJ-2170 which has been reviewed by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338229 13f79535-47bb-0310-9956-ffa450edef68"
8b71dc671560a2dd849f425283b9cfbc4605b928,"Update src tarball to xml-commons-external-1.3.02 version. This version
adds the package.html files for javax.xml.validation and javax.xml.xpath
which were missing in xml-commons-external-1.3.01.

This update is part of XALANJ-2170 which has been reviewed by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338230 13f79535-47bb-0310-9956-ffa450edef68"
7c46ce9be042691ed7660feeff6bf95d607c5a77,"Remove  xml-commons-external-1.3.01 version; it has been succeeded by
xml-commons-external-1.3.02-src.tar.gz.   This update is part of
XALANJ-2170 which has been reviewed by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338231 13f79535-47bb-0310-9956-ffa450edef68"
c7c07add76f5d7d7a933017b2f5ff9b16756b85b,"Updates to docs for Xalan Java 2.7.0.  These updates are part of
XALANJ-2170 which has been reviewed by Christine Li.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338232 13f79535-47bb-0310-9956-ffa450edef68"
d7ac0f6781de1869ff9bfb2761e192afc2ade830,"PR:XALANJ-2172
Obtained from: Eric Everman
Submitted by:	John Gentilin
Reviewed by:	Yash Talwar
CVS: ----------------------------------------------------------------------
CVS: Obtained from:
CVS: The XConnection modifications for the JNDI support along with the
CVS: JNDI COnnection pool were contributed by Eric Everman on the
CVS: USGS
CVS


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338233 13f79535-47bb-0310-9956-ffa450edef68"
8fee7a007b24c073de5e982481c0b636d4d0dc7c,"PR: XALANJ-2172
Obtained from: Eric Everman
Submitted by:	Eric Everman / John Gentilin
Reviewed by:	Yash Talwar
CVS: ----------------------------------------------------------------------
CVS: Obtained from:
CVS: The original JNDIConnection pool was contributed by
CVS: Eric Everman.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338234 13f79535-47bb-0310-9956-ffa450edef68"
99acdbdae05b15cbddc5da5ac94ab68b66c4de93,"PR:XalanJ-2172	
Obtained from:
Submitted by:	John Gentilin	
Reviewed by:	Yas Talwar
CVS: ----------------------------------------------------------------------
CVS: Change Example file to utilize the Apache Derby DBMS


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338235 13f79535-47bb-0310-9956-ffa450edef68"
a361c16b41029aff126f3488148d4d3d6d933df4,"PR:XalanJ-2172	
Obtained from:
Submitted by:	John Gentilin	
Reviewed by:	Yash Talwar
CVS: ----------------------------------------------------------------------
CVS: Change Example file to utilize the Apache Derby DBMS


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338236 13f79535-47bb-0310-9956-ffa450edef68"
47af593b8d64ab66990e39f7ddc954215509ebbe,"Patch for XALANJ-1912.
Provided by Santiago Pericas-Geertsen
Reviewed by Yash Talwar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338237 13f79535-47bb-0310-9956-ffa450edef68"
849b504b2a1518e6f483c0a6755729ce3b424199,"Removing obsolete files.  See XALANJ-2172.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338238 13f79535-47bb-0310-9956-ffa450edef68"
cb00c6bcaec2a263ce2bd880feee25ef624856c4,"Fix location of dependent jars.  See XALANJ-2172.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338239 13f79535-47bb-0310-9956-ffa450edef68"
487b3b254394e1bdcb1c753d7caa0066fecdd4a0,"Committing patch for XALANJ-2087
This is a fix for correctly deciding if a character is in an encoding or not,
so we write it as is, or as an entity.

The old code had a concept of a
maximum character in the encoding, and assumed that all characters less
than that unicode value were in the encoding.  New code uses the
underlying Java libarary, but caches results for performance.

Patch was reviewed/approved by Yash Talwar (see XALANJ-2087)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338240 13f79535-47bb-0310-9956-ffa450edef68"
b3c504b62e308c108637145eb7041b67462b8a37,"Add back the Version.java file.  Eclipse users have difficulty with the fact
that Version.src is used to generate Version.java at build time since Eclipse
does not invoke the ant build.xml file.

We will still use Version.src to generate the Version.java file for official builds.
Official builds call the 'clean' target which delete Version.java and then recreate
if from Version.src.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338241 13f79535-47bb-0310-9956-ffa450edef68"
3a6c25752d90c966f19947593d82b3830b52c191,"fix typo


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338242 13f79535-47bb-0310-9956-ffa450edef68"
c65ab898b13a30ec8912f8af6534d3ad49cafb93,"correction to the list of bugs fixed.  2133 and 2137 will not make the 2.7 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338243 13f79535-47bb-0310-9956-ffa450edef68"
49d257cfd7a550ffdad61898bf8ea58f0e4427ee,"Doc updates for the SQL samples (part of the fix for XALANJ-2172).
Patch provided by John Gentilin and reviewed by Sarah McNamara.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338244 13f79535-47bb-0310-9956-ffa450edef68"
3fb3d3bf481d4f363b8557e73a02d9df3927c955,"Updates for the SQL samples (part of the fix for XALANJ-2172).
Patch provided by John Gentilin and reviewed by Sarah McNamara.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338245 13f79535-47bb-0310-9956-ffa450edef68"
b6f9315f77662ad0345addde8dabff5f4a0f4917,"Deleting obsolete files.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338246 13f79535-47bb-0310-9956-ffa450edef68"
1fd3d992d03081f3aad3cb663eb33105bee7f908,"Doc updates for the SQL samples (part of the fix for XALANJ-2172).
Patch provided by John Gentilin and reviewed by Sarah McNamara.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338247 13f79535-47bb-0310-9956-ffa450edef68"
9f078c2cd1a58fecd08649e4ec4edfde4a340eec,"Doc updates for the SQL extension (part of the fix for XALANJ-2172).
Patch provided by John Gentilin and reviewed by Sarah McNamara.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338248 13f79535-47bb-0310-9956-ffa450edef68"
25287f2f125a022bd55452a269d0f111435921a0,"Committing XALANJ-2181, not yet reviewed, but a safe fix.

When the requested encoding is not supported by the JDK no
warning is given,... this fix adds an error message.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338249 13f79535-47bb-0310-9956-ffa450edef68"
403d9dd7441970bfac4f4cd104a92e91ff3aefd2,"PR: XALANJ-2183	
Obtained from:
Submitted by:	John Gentilin
Reviewed by:	Yash Talwar
CVS: ----------------------------------------------------------------------
CVS: This fixed a problem with freeUnused connections


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338250 13f79535-47bb-0310-9956-ffa450edef68"
5400ef8677c86f22f80c59b36130795e6a13bb3f,"PR:XALANJ-2183	
Obtained from:
Submitted by:	John Gentilin	
Reviewed by:	Yash Talwar
CVS: ----------------------------------------------------------------------
CVS: New batch for for the ext-sample and revise fo new Jar
CVS: file locations. Now works from both Binary and Source distros.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338251 13f79535-47bb-0310-9956-ffa450edef68"
7dcb4ee0c5bfd5fed851519d9ed2eaac3ba71fd9,"PR: XALANJ-2183	
Obtained from:
Submitted by:	John Gentilin
Reviewed by:	
CVS: ----------------------------------------------------------------------


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338252 13f79535-47bb-0310-9956-ffa450edef68"
6086afdb34b53fde07b14dbc5e623a65bb334e97,"Applying patch (XalanJ-2183-SqlExtension-DefConPoolFix.patch) from John Gentilin.
This patch fixes a problem with the default connection pool where we were using an
Iterator but in the Iterator look we were trying to remove elements in the Iterators's
collection. This caused a concurrent access error.
Reviewd by Yash Talwar.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338253 13f79535-47bb-0310-9956-ffa450edef68"
181d9536802179acc785656ca898c1589cad8b72,"Last update for the readme prior to the Xalan Java 2.7.0 release.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338254 13f79535-47bb-0310-9956-ffa450edef68"
7732c9f658ab8299f48746a566abcc1db55d3152,"Fix build error.  (mismatched tags)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338255 13f79535-47bb-0310-9956-ffa450edef68"
c18d7cd8dcc3da7656a7f1b002cf323b8672c0ed,"Document final changes in Xalan J 2.7.0


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338256 13f79535-47bb-0310-9956-ffa450edef68"
12ac175aed96ee45039c5d943838dc7cb855c960,"Minor fix to clean target to resolve build clean failure when xdocs.style does not exist.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338258 13f79535-47bb-0310-9956-ffa450edef68"
38e608645542d8224d9e9d500ff341bce83bc404,"Just moving some code into a utility method, to set the EOL
separator (a char array) and at the same time update
the lenght of the array (just so we don't forget).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338259 13f79535-47bb-0310-9956-ffa450edef68"
715caf5f3fb956a31724ec97fcece97ce69d0e13,"Removing unused import.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338260 13f79535-47bb-0310-9956-ffa450edef68"
33fba525266af95825793d64d9abee51afef3a97,"Update copyright year to 2005


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338261 13f79535-47bb-0310-9956-ffa450edef68"
5e4961ccba4fb4437c4d471ced885053535f1260,"Adding Cp850 Cp860 to Encodings.properties file
Patch from XALANJ-2184 is applied.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338262 13f79535-47bb-0310-9956-ffa450edef68"
b367aa28afb164f03d66d545de8af924a852daf2,"Applying fix for XALANJ-2205, which gets Xalan out of the business of parsing base URIs of stylesheets and include/import href values provided that:

1) The user has provided a URIResolver
2) The Source returned by a URIResolver has its system ID set.

If the system ID is not set, or there is no URI resolver the behavior is as before, namely that Xalan-J will call its SystemIDResolver class to figure out how to get a base URI for the included stylesheet. This does fine for most users, but has issues if the URIs are not valid. One way to be invalid is to have non-ASCII characters in the URI. For example, suppose one is running on an operating system that allows non-ASCII characters in its directories or file names (e.g. Chinese characters). To use URIs such as:
  file:///dir1/dirXX2/part.xsl
where XX are some Chinese characters, then the user must provide 1) and 2) above.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338263 13f79535-47bb-0310-9956-ffa450edef68"
13aac57fc8267b254cb143f1e309b473eb3e9bfa,"Commiting fix for XALANJ-1706 that removes startDocument()/endDocument() calls for result tree fragments.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338264 13f79535-47bb-0310-9956-ffa450edef68"
0aa75a8531708fd8544761ee0faa432a4237bee6,"Fix for XALANJ-2217 applied, except for the change to ElemNumber.
Patch was submitted by Dave Brosius and reviewed and approved
by Brian Minchau


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338265 13f79535-47bb-0310-9956-ffa450edef68"
2f3d4cf9c76984f737bbe63c530d7949a208a9d5,"Increasing visibility of CharInfo.defineChar2StringMapping() from
private to package private (or default) access.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338266 13f79535-47bb-0310-9956-ffa450edef68"
85b378b0d6a9974f6d359136fa6a2181719d1248,"Minor Javadoc change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338267 13f79535-47bb-0310-9956-ffa450edef68"
b8ed487dd13801acdf8dc7bcf7d4c46e8f9ed913,"Changed interface from ""abstract"" to ""public"".


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338268 13f79535-47bb-0310-9956-ffa450edef68"
0997f0e5eff801da39ad70fffdf23d56f49fba55,"Minor javadoc change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338269 13f79535-47bb-0310-9956-ffa450edef68"
220380661ccae0c8e93588d9160ee75489cba70b,"Corrected the javadoc for S_KEY_LINE_SEPARATOR


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338270 13f79535-47bb-0310-9956-ffa450edef68"
0f49fb31e3249fe5b28cb64e059330e87a7f8d4d,"Minor javadoc change.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@338271 13f79535-47bb-0310-9956-ffa450edef68"
787c5fac4d810a9fb25c601e2fc27df9de2893d0,"Fix for XALANJ-2230.  There were two problems that together combined to make
a third:

1) By the time the NameTests in xsl:strip-space/xsl:preserve-space get to the
WhitespaceRule constructor, any namespace prefix has been resolved, and the
test rendered in a String as uri:local-name.  The problem was that this
constructor searched for the first colon in the String in order to separate
the URI from the local-name, but the URI could itself contain a colon.  It
should have searched for the last colon in the String.

2) For a NameTest that has no prefix, the code in parseContents() was looking
up the namespace associated with the default namespace.  However, the NameTest
should behave like any other XPath NameTest - i.e., a NameTest that is not a
wild-card that has no prefix should match only names that are in no namespace.
The namespace URI should only be looked up if there is a prefix.

3) If no URI was associated with the default namespace, a NameTest with no
prefix was rewritten in the form "":local-name"" or "":*"" for wild cards.  The
code in the WhitespaceRule constructor handled the local name case correctly,
but treated the wild card case as if it was testing for a namespace, but that
test never found a match.  Dropping the look up of the default namespace in the
problem described above eliminates these degenerate forms, which allows the
wild card to match appropriately.

Patch was reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@351494 13f79535-47bb-0310-9956-ffa450edef68"
83e9217b1f6ef95350b21d417091887f3e572389,"Fix for XALANJ-2199.  Lexical disambiguation rules for an NCName with the same
name as an operator assumed that any such name that follows an asterisk, must
really be an NCName, and not an operator, under the assumption that the asterisk
must be a multiplication operator.  However, that causes the operator in an
expression like ""* or doc/ch"" to be treated as an NCName, resulting in an
incorrect syntax error.

Introduced a new token to distinguish between the use of asterisk as a wildcard
and its use as a multiplication operator, and added new disambuguation rules
to identify the two uses.

Patch was reviewed by Yash Talwar (ytalwar () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@351910 13f79535-47bb-0310-9956-ffa450edef68"
8cdda2f04016414ea6820cb863e78d316161ef0f,"New learn-svn directory


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@354706 13f79535-47bb-0310-9956-ffa450edef68"
8274635bcd0b2373d7021e40cbe6d5e84a00ea31,"Adding a practice part, bjm.txt.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@354718 13f79535-47bb-0310-9956-ffa450edef68"
78561e14d677a0d295a5eb3a02aff04a43b73abc,"Delete this useless part.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@354794 13f79535-47bb-0310-9956-ffa450edef68"
80fcf62b42e3a1b62e4590ed73cc97f5224813ef,"New bjm2.txt part

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@354801 13f79535-47bb-0310-9956-ffa450edef68"
b9f854bbebd8b353d5fb1f16625e5f01a63d0af8,"Removed a unused class which introduced possible security exposure. Fixed bug report XALANJ-2249

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@357811 13f79535-47bb-0310-9956-ffa450edef68"
79c09149c0601e636898f65ec640b8cdd51877a5,"Committing the patch in XALANJ-2220.
This reducest the serializer's knowledge of its own package
by replacing literal strings starting with:
  ""org.apache.xml.serializer""
  ""org/apache/xml/serializer""
with a constant that is derived from:
  SerializerBase.class.getName()

The patch was reviewed by Yash Talwar (see the Jira issue).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@367949 13f79535-47bb-0310-9956-ffa450edef68"
ee276fae3a7d82ac18ffe4ef8e6bdacf862e5e73,"Code clean-up. Deleting commented out lines on old
""lastPrintable"".  Although there is a lastPrintable,
at least conceptually, that whole idea was flawed. Encodings
are like swiss-cheese. Characters in the encoding are
not continguous in codepoint values, lots of holes.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368178 13f79535-47bb-0310-9956-ffa450edef68"
d82fadb6015415f8e526d1e8f5a12417cc695664,"Minor, changed ""abstact"" on an interface, to ""public"".

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368179 13f79535-47bb-0310-9956-ffa450edef68"
9adf11401e687a843291db573af4e1253204ec1f,"Minor javadoc change.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368180 13f79535-47bb-0310-9956-ffa450edef68"
14b854e0e5a86bcc9ccffdbf12669cdcd5bbfb5d,"Minor, refer to Method.UNKNOWN rather than
org.apache.xml.serializer.Method.UNKNOWN.

That class and this one are in the same package, so it isn't needed.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368181 13f79535-47bb-0310-9956-ffa450edef68"
e68dc7fdcbe7ec160d0e3da891b85781bef577d8,"Minor, changes to comments and javadoc.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368182 13f79535-47bb-0310-9956-ffa450edef68"
00bc4cf5034f69ecc91c56c9bac507cb9ce1e74c,"Minor,  calling the setWriter() method to set the writer,
rather than explicitly setting the field:
  m_writer=writer;

Its just the wright thing to do.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368185 13f79535-47bb-0310-9956-ffa450edef68"
aa9efd4f1d50d41139a91b01011dc7e304a09b4f,"Minor, ""import"" cleanup in java code.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368186 13f79535-47bb-0310-9956-ffa450edef68"
86ea4bc4a23212177cb5d6a3dfd327e71f6bbcc0,"Minor, whitespace in Javadoc change.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368188 13f79535-47bb-0310-9956-ffa450edef68"
467a8515079006e21c5c8a56011b46a9e0c95b08,"Minor, changes to comment lines.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368189 13f79535-47bb-0310-9956-ffa450edef68"
416023b62686c31d27a838bc478bcc31cb5d93cb,"Minor, changes to comment lines.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368190 13f79535-47bb-0310-9956-ffa450edef68"
d194a84badf1bbf020dc6c32fe7c4a597718dfd0,"Minor, javadoc change.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368257 13f79535-47bb-0310-9956-ffa450edef68"
99e314e32dcbb1dbcc9e201e8b3718d9222b6eec,"Minor javadoc change, and slight code re-arrangement.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368260 13f79535-47bb-0310-9956-ffa450edef68"
d4c172405350023f753d1f1d0d5faffa1d83a6f6,"Minor, making class non-final.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@368270 13f79535-47bb-0310-9956-ffa450edef68"
cf5f1a98d7d2036a584a43eab39fee6e3face543,"Removing unused imports in Java code.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@369594 13f79535-47bb-0310-9956-ffa450edef68"
b23435defb630cd89cfdf3697663057c828f9199,"committing NM2.txt patch in XALANJ-2258
Reviewed by Yash Talwar.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@370188 13f79535-47bb-0310-9956-ffa450edef68"
047e63ee74bf5db1e56a2b4446743ed5ead4d84f,"Commiting patch CDATApatc.txt in issue XALANJ-2258
Some re-work/cleanup of the CDATA code.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@370242 13f79535-47bb-0310-9956-ffa450edef68"
faace2ec452660888752fce5572c15976333b039,"Applying cleanup.txt patch in XALANJ-2258

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@370286 13f79535-47bb-0310-9956-ffa450edef68"
6f414fd6ab31a6c19b42f961533e207e790c7756,"javadoc change.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@372645 13f79535-47bb-0310-9956-ffa450edef68"
5c12c8134a0274e87082d24b781208243528e86a,"clean-up of imports


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@372648 13f79535-47bb-0310-9956-ffa450edef68"
37a8fa64015304395a1cba577f7c2c36b912ea28,"Committing cleaup5.txt patch in xalanj-2258

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@373181 13f79535-47bb-0310-9956-ffa450edef68"
bc23eccedb34b49a6e5375e11772449bbae368a0,"fixed jira bug xalanJ-2204 - need to reset iterator when cloning

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@376867 13f79535-47bb-0310-9956-ffa450edef68"
e582bfb0fa8a933d860b0a0d2ed03ee50ca21ea2,"Committing patch in XALANJ-2271 which fixes a bug in
outputing XML 1.1 attributes.

It is also a general clean-up of code related to whether
particular characters have entities, or should be written
as character entities, etc.  The code is tricky because
it all depends on:
> method type (xml, html, text)
> character in a text node?
> character in an XML attribute value?
> character in an HTML URL attribute value?

The old code had a concept that the character was ""special""
but put plenty band-aids on that CharInfo API call.

New code has far fewer band-aids. CharInfo basically knows if
the character is mapped to a String (e.g. '<' mapping to ""&lt;"")
and leave it more explicitly to the methods (e.g. ToXMLStream)
output method (e.g. characters() or writeAttr() ...)
whether it is a character in a text node, or an attribute
value, or 

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@383923 13f79535-47bb-0310-9956-ffa450edef68"
08980a8323ea55531b2d915cdbf690bbdb3c2a01,"Removed unused import.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@383949 13f79535-47bb-0310-9956-ffa450edef68"
5f8669f7d2a915aa21b0bb4e147c051dbab675b3,"Added an explicit default constructor (just in case
a developer wants to set a breakpoint in it to see
where a serializer is being created from).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@383952 13f79535-47bb-0310-9956-ffa450edef68"
d05a270c0e216958dba1c48795082ee97556ea5a,"Commiting changes for XALANJ-2275. Which un-entagles
output properties from xsl:output from OutputStream
or Writer.

For example one can set an encoding via JAXP and this
does have implications on the writer that wraps an
OutputStream, because the writer is encoding sensitive.

Ugly code, just less ugly now.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384059 13f79535-47bb-0310-9956-ffa450edef68"
700f16e1bb3acd20270631431cd3adbd74e280b8,"Changing the UTF-8 encoding to allow all characters

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384110 13f79535-47bb-0310-9956-ffa450edef68"
26f8963035d07446fd15a2d3102c1231ac73b013,"Committing fix for XALANJ-2269. The 'final' was already accidentally
removed from ToXMLStream in another commit.  In anycase what the user
asked for was done. All 3 are non-final.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384573 13f79535-47bb-0310-9956-ffa450edef68"
68762252ebdaa908bd3dcf1ecee5145adc5d9a30,"Added a special case for '&' when outputting an attribute
value that is a URI in HTML output. Committing the fix for
XALANJ-611

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384575 13f79535-47bb-0310-9956-ffa450edef68"
30044c31c1c69e4e9a59805315f97de1bf434704,"Committing patch for XALANJ-2277, which removes a
duplicate definition of m_cdataTagOpen from ToXMLStream.java
(it was already defined in the base class).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384576 13f79535-47bb-0310-9956-ffa450edef68"
4e2ab78f7b7b4bae3bb5895e391b238d75b7eb13,"Updated copyright to 2006

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384641 13f79535-47bb-0310-9956-ffa450edef68"
e00bb4214ee55479f26c71f8521da41b8ce0dd68,"Updated copyright to 2006

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384642 13f79535-47bb-0310-9956-ffa450edef68"
2931c9fe4c6e736d5f5caf324c1c2079a4658a7f,"Updated copyright to 2006

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384644 13f79535-47bb-0310-9956-ffa450edef68"
00c14912d090eccc636378cbcbd03d61b05b5b04,"Updated copyright to 2006

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384649 13f79535-47bb-0310-9956-ffa450edef68"
6a1d0c7bac4526335ff5ec6fbc8d5baf4badb2de,"Fix for XALANJ-1497 which fixes the incorrect newline
after a PI, but also other incorrect whitespace around
PI and comments.

After this fix the newline after an XML header is almost
never written out because the generated XML could later be
used as an external general parsed entity and even that
extra newline could mess things up.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384711 13f79535-47bb-0310-9956-ffa450edef68"
36d610b0e5a4f8882fe6263a0e57962d01844b26,"Committing patch for XALANJ-2276 to get the name of the element
after the DOCTYPE correct more often for HTML output.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384712 13f79535-47bb-0310-9956-ffa450edef68"
e39c6c687cb20700ac3e5018d1117edac74a6a60,"Committing the mini-patch in XALANJ-2276

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384880 13f79535-47bb-0310-9956-ffa450edef68"
f9e8029008bba1012865890b1b736f36346852d9,"Committing patch in XALANJ-2278 to add a method to
NamespaceMapping

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384886 13f79535-47bb-0310-9956-ffa450edef68"
0ad38a762a58d7caf8344baf15ec0af8869404b4,"Fixes to various serializer reset() methods for fields that were 
newer and forgotten. Fix for XALANJ-2279

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384916 13f79535-47bb-0310-9956-ffa450edef68"
aa97ba7a75e79633e92c94f883ef4976fa28cf11,"Committing patch for XALANJ-2218 which changes the initial value for
escaping of ToHTMLSAXHandler and ToXMLSAXHandler.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@384956 13f79535-47bb-0310-9956-ffa450edef68"
2dd4076312f7e07fc97dd603359e65020501e3ee,"Update the translated message files for globalization support. Checkin for feature XALANJ-2281

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@385892 13f79535-47bb-0310-9956-ffa450edef68"
cab12eb6431f8f563423da1026dcc12a3c75605a,"Update the translated message files for globalization support. Checkin for feature XALANJ-2281

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@385894 13f79535-47bb-0310-9956-ffa450edef68"
c4dfcb6e1f51ed710fea0b7bbaeb75c46c5c20c0,"Update the translated message files for globalization support. Checkin for feature XALANJ-2281

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@385896 13f79535-47bb-0310-9956-ffa450edef68"
c4a2c113f13e0065a762d876e60f0842d8bc9ebd,"Update the translated message files for globalization support. Checkin for feature XALANJ-2281

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@385900 13f79535-47bb-0310-9956-ffa450edef68"
b1a604572cd6655243f3b0c515af518963ddc60a,"Update the translated message files for globalization support. Checkin for feature XALANJ-2281

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@385904 13f79535-47bb-0310-9956-ffa450edef68"
a3e56f46caf0ed1b5f95e0d17d496bd483a74d24,"Update the translated message files for globalization support. Checkin for feature XALANJ-2281

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@385905 13f79535-47bb-0310-9956-ffa450edef68"
782a20f0cfccd06ccb1ccf42f8eb014eb0db86a4,"Update the translated message files for globalization support. Checkin for feature XALANJ-2281

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@385908 13f79535-47bb-0310-9956-ffa450edef68"
170f41f6d11ef46cf6f6d26f5674d216352b1895,"Update the translated message files for globalization support. Checkin for feature XALANJ-2281

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@385909 13f79535-47bb-0310-9956-ffa450edef68"
2fe6eed18eff1362d4340709812a10b77374920b,"Part of patch for XALANJ-1324 and others.

Error class used to report internal errors in XSLTC.  Instances of this class
should only be thrown if XSLTC reaches some unexpected, inconsistent internal
state from which it is unable to recover.

Patch reviewed by Christine Li and Erin Harris.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@395273 13f79535-47bb-0310-9956-ffa450edef68"
480fc3e61f3162d6702ae2271f44b92002675f6f,"Part of patch for XALANJ-1324 and others.

Made changes to accurately annotate LocalVariableGen objects with the range of
instructions over which the variable is actually alive.  This is in
support of method splitting and outlining.

See org.apache.xalan.xsltc.compiler.util.MethodGenerator.outlineChunks for more
information.

Patch reviewed by Christine Li and Erin Harris.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@395274 13f79535-47bb-0310-9956-ffa450edef68"
dd410b02ec1e80bdadea1873ca0da2d5f7655960,"Part of patch for XALANJ-1324 and others.

Creating new marker instructions (OutlineableChunkStart, OutlineableChunkEnd
and their base class, MarkerInstruction).

In SyntaxTreeNode.translateContents, before and after generating code for the
content of an XSLT element, added references to MethodGenerator.markChunkStart
and MethodGenerator.markChunkEnd, respectively, to assist method splitting and
outlining.  These mark the boundaries of logical chunks of the generated byte
code that are eligible for outlining using MarkerInstructions.  Generated code
should not branch out of or into such chunks of code.

See org.apache.xalan.xsltc.compiler.util.MethodGenerator.outlineChunks for more
information.

Patch reviewed by Christine Li and Erin Harris.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@395275 13f79535-47bb-0310-9956-ffa450edef68"
af7cb2ecfc2b984f29678068d1abba7f5b97d4cd,"Part of patch for XALANJ-1324 and others.

References to serializer methods in byte code generated for xsl:message were
using virtual method invocation on ToXMLStream.  This causes problems for
method outlining, as the variable involved is marked as being of type
SerializationHandler.  If this part of a method is outlined, the value will
be copied into the outlined method as a SerializationHandler, and the JVM's byte
code verifier will report an VerifyError for the references to the virtual
methods on ToXMLStream.

Replaced virtual method references on ToXMLStream with equivalent interface
method references on SerializationHandler.  Though the performance could be
slightly worse, performance is probably not of great importance for xsl:message.

See org.apache.xalan.xsltc.compiler.util.MethodGenerator.outlineChunks for more
information.

Patch reviewed by Christine Li and Erin Harris.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@395276 13f79535-47bb-0310-9956-ffa450edef68"
04fbeab0e3a7992cdc5a5fe8965298086118e3d8,"Part of patch for XALANJ-1324 and others.

Created a new method on ClassGenerator.addMethod(MethodGenerator), which
deals with the fact that method splitting and outlining could create more than
one method from a single MethodGenerator object.  References to
ClassGenerator.addMethod(Method) are generally replaced with references to the
method with the new signature.

Also, in the cases of some classes, applied changes to accurately annotate
LocalVariableGen objects with the range of instructions over which the
variable is actually alive in support of method splitting and outlining.

See org.apache.xalan.xsltc.compiler.ClassGenerator and
org.apache.xalan.xsltc.compiler.MethodGenerator for more information. 

Patch reviewed by Christine Li and Erin Harris.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@395277 13f79535-47bb-0310-9956-ffa450edef68"
9e07c820fed68a64aa9280a009bba76cf2353718,"Part of patch for XALANJ-1324 and others.

Added support for splitting and outlining chunks of a method that would
otherwise exceed the 64KB limit imposed by the Java Virtual Machine
specification on the length of the byte code in a method.  See Javadocs for all
the gory details.

Also made changes to fix-up branches that would overflow a 16-bit relative
branch offset.  Such branches could occur even in methods that would not exceed
the 64KB method size limit.  The sense of the branch is reversed and made to
guard an unconditional branch whose target is the target of the original
conditional branch.  A wide (32-bit) offset is used in the unconditional branch.

See org.apache.xalan.xsltc.compiler.util.MethodGenerator.outlineChunks for more
information.

Patch reviewed by Christine Li and Erin Harris.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@395278 13f79535-47bb-0310-9956-ffa450edef68"
04482c75e9421055e87f9a9650d8abd202cfa1e0,"Part of patch for XALANJ-1324 and others.

Removed code that was removing xsl:variable declarations from the list of
children of the LRE.   This caused problems with annotating LocalVariableGen
objects with the range of instructions over which the variable is actually
alive.  This is in support of method splitting and outlining.

See org.apache.xalan.xsltc.compiler.util.MethodGenerator.outlineChunks for more
information.

Patch reviewed by Christine Li and Erin Harris.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@395279 13f79535-47bb-0310-9956-ffa450edef68"
01acedf815e774a9c61482b2c6183a7ae178e3df,"Part of fix for XALANJ-2294.  Given a node handle, the getDocumentRoot(int)
was returning the root of the current DTM.  It should be returning the root of
the DTM in which the particular node handle resides, which might be a different
DTM.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412500 13f79535-47bb-0310-9956-ffa450edef68"
1fe839bd646a52438289e605ef6ade954c684afe,"Part of fix for XALANJ-2295.  Changed DupFilterIterator.setStartNode to take
advantage of the fact that if the source iterator is a KeyIndex, it will
return its nodes in document order, so no additional IntegerArray.sort operation
is necessary.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412501 13f79535-47bb-0310-9956-ffa450edef68"
539b6733e4bdad15a2e40965400b816b385357b3,"Part of fix for XALANJ-2294.  The way that SAXImpl.getIterator is used in
generated code makes it clear that XSLTC always expects the iterator to point to
the root of the DTM, rather than being affected by calls to setStartNode.  Added
the ""constant"" flag with a value of true on SingletonIterator constructed by
getIterator.

Also, added support for ROOT axis in getAxisIterator and getTypedAxisIterator.


Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412502 13f79535-47bb-0310-9956-ffa450edef68"
2c8b8b009e7649a2c83ec17518e5577ce2b224e3,"Part of fix for XALANJ-2294.  Refactored UnionIterator so that it is derived
from a new MultiValuedNodeHeapIterator class.  The latter is responsible for
the basic management of a heap, each of whose nodes contains multiple DTM
node handles, while the former handles the specific case of implementing a
union of other iterators.

In the original heap implementation of UnionIterator, each node contained a
DTMAxisIterator, but in MultiValuedNodeHeapIterator, each node contains
something that returns node handles; that doesn't have to be a DTMAxisIterator,
though in the of UnionIterator, it still is.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412503 13f79535-47bb-0310-9956-ffa450edef68"
f4fa39227087699d02ffd202064190469fbb546c,"Part of fix for XALANJ-2294 and XALANJ-2295.

Each KeyIndex for a particular key or for the id function was set up with a
Hashtable mapping Strings to nodes.  However, the set of nodes returned are
only supposed to be those in the same input document as the context node.  The
code was accepting nodes as node IDs and putting them all into the same table,
so node IDs from different documents were being mixed together.  Fixed this by
adding another Hashtable from the root node of a document to the Hashtable that
maps Strings to node handles in that document.  This affects insertion of nodes
into the KeyIndex (in add) and look-up of nodes for patterns (in containsID,
containsKey, getDOMNodeById).

Generated byte code previously looked up nodes to be retrieved by a reference
to the key or id function by cloning an IntegerArray containing the first set
of nodes and merging in subsequent nodes retrieved.  The generated code
contained any required looping code to loop over nodes in a node set that
appeared in a call to key or id.  The effect of all this was that every node in
the resulting node set was processed at least once, regardless of whether all
the node returned were actually used - they might not need to be if a positional
predicate is used, for instance.

The old KeyIndex.lookupId and KeyIndex.lookupKey are now deprecated, but
preserved for any previously compiled translets.  Instead, new code will use
the KeyIndex.getKeyIndexIterator methods to get an iterator that will return the
nodes for a particular reference to the key or id function.

The iterator returned by getKeyIndexIterator is an instance of an inner class -
KeyIndex.KeyIndexIterator - which extends the new MultiValuedNodeHeapIterator.
Each node in the heap refers to an IntegerArray that contains the nodes for
each key value or id value that was looked up.  It's sensitive to the context
node (or more importantly, the root of the context node) and retrieves node
handles for the function reference lazily to avoid unnecessarily greedy and
potentially duplicate processing of the nodes.

Also, fix for XALANJ-2292.  The byte code generation assumed that if the
second argument to a reference to the key function was not a node set or a
string, that it had to be converted to a string.  However, if the argument is
a parameter whose value is a node set, all the nodes in the node set should
play a role in computing the result of the function, not just the first.

The KeyIndex.KeyIndexIterator is responsible for processing the argument to the
key or id function, iterating over nodes in a node set if required, rather than
leaving that responsibility to generated byte code, because we don't generally
know whether the argument will be an iterator.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412504 13f79535-47bb-0310-9956-ffa450edef68"
19c3a5601371d7bbeaf093a3e45dea84a4b6f774,"Part of fix for XALANJ-2294.  When building a KeyIndex for keys or for IDs in
a document, the KeyIndex needs to be informed of the root node of the document
so that it can retrieve only nodes that are in the same document as the context
node and of node handles for nodes rather than the node identities, which will
be reused across different documents.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412505 13f79535-47bb-0310-9956-ffa450edef68"
7fb82571a00230a81987041e0fd62aeeffafd1a1,"Part of fix for XALANJ-2294.  Generated code was passing node identities to
KeyIndex.lookupId and KeyIndex.lookupKey.  It should pass node handles in order
to be able to take into account which document contains the node.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412506 13f79535-47bb-0310-9956-ffa450edef68"
75e2aca4c8c4437cb4b1d6bf253f029b70a79a53,"Part of fix for XALANJ-2294 and XALANJ-2295.

Generated byte code previously looked up nodes to be retrieved by a reference
to the key or id function by cloning an IntegerArray containing the first set
of nodes and merging in subsequent nodes retrieved.  The generated code
contained any required looping code to loop over nodes in a node set that
appeared in a call to key or id.  The effect of all this was that every node in
the resulting node set was processed at least once, regardless of whether all
the node returned were actually used - they might not need to be if a positional
predicate is used, for instance.

The old KeyIndex.lookupId and KeyIndex.lookupKey are now deprecated, but
preserved for any previously compiled translets.  Instead, new generated code
uses the KeyIndex.getKeyIndexIterator methods to get an iterator that will
return the nodes for a particular reference to the key or id function.  The
nodes returned by KeyIndexIterator will be in document order with duplicates
filtered, so the DupFilterIterator that was previously created is no longer
necessary.


Also, fix for XALANJ-2292.  The byte code generation assumed that if the
second argument to a reference to the key function was not a node set or a
string, that it had to be converted to a string.  However, if the argument is
a parameter whose value is a node set, all the nodes in the node set should
play a role in computing the result of the function, not just the first.

The KeyIndex.KeyIndexIterator is responsible for processing the argument to the
key or id function, iterating over nodes in a node set if required, rather than
leaving that responsibility to generated byte code, because we don't generally
know whether the argument will be an iterator.


Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412507 13f79535-47bb-0310-9956-ffa450edef68"
f2ff46815512c82287da63e79f9b435f8542838c,"Part of fix for XALANJ-2294 and XALANJ-2295.

Declared a constant identifying new
org.apache.xalan.xsltc.dom.KeyIndex.KeyIndexIterator class.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412508 13f79535-47bb-0310-9956-ffa450edef68"
55cc23b76b65fedeabb4514a28f51c52d307cff3,"Part of fix for XALANJ-2295.  Allow a positional predicate on a reference to
the key function to be optimized using DTMAxisIterator.getNodeByPosition.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412509 13f79535-47bb-0310-9956-ffa450edef68"
ca0c75590553238172a9dbd716f49f7d8525280b,"Fix for XALANJ-2285.  The SingletonIterator wasn't allowing itself to be
sensitive to a change in the context node (through setStartNode) more than once.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@412510 13f79535-47bb-0310-9956-ffa450edef68"
81025bdbf6abdfe27e88b4bf8ffa8b8c4621d979,"The patch in xalanj-2219 is applied, which is to fix
a bug where the default namespace gets stomped on due
to some DOM manipulation.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@415778 13f79535-47bb-0310-9956-ffa450edef68"
24de42952536da97ed8c64d49c918e398fcef389,"1) Part of patch for XALANJ-2318

Added OutlineableChunkStart and OutlineableChunkEnd instructions through the
static class initializer and constructor generation to allow the code to be
outlined.  Replaced DUP instructions that duplicated array references to
explicitly reload the array reference to allow the code to marked outlineable.

2) Part of patch for XALANJ-1774

Added code to static initializer to record information about the namespace
definitions in scope at different points in the stylesheet.

Reviewed by Christine Li (jycli () ca ! ibm () com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@446471 13f79535-47bb-0310-9956-ffa450edef68"
1b87e783e60ab8a54c4cc741b2ef172422ce9cc4,"Part of patch for XALANJ-2318.

Check whether the method that is being outlined is either <clinit> (the static
class initializer) or <init> (a constructor function).  Only those methods are
permitted to have less than and greater than characters, so any outlined
method based on them has to avoid using those characters.

Also, fixed a bug in MethodGenerator.mergeAdjacentChunks where it was not
correctly handling the end case where the last N chunks are all adjacent.  

Reviewed by Christine Li (jycli () ca ! ibm () com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@446472 13f79535-47bb-0310-9956-ffa450edef68"
dd77b220695a6a42fd4c67482a96d79349585734,"Part of patch for XALANJ-1774

Added new lookupStylesheetQNameNamespace and expandStylesheetQNameRef methods
that determine the namespace in which a QName is defined using information
about the stylesheet's namespace declarations.  The first method returns a
namespace URI or a zero-length string if none was found, and the second returns
an expanded QName of the form <uri>:<local-name> or just <local-name> if no
namespace was found.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@446473 13f79535-47bb-0310-9956-ffa450edef68"
979339b37a67f01d97313286805b98c700f14a36,"Part of patch for XALANJ-1774

Added getNodeIDForStylesheetNSLookup method which is used to get the unique
stylesheet node ID for this node or the nearest enclosing element node in the
syntax tree that has namespace declarations.  If there is no such node, the
value -1 is returned.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@446474 13f79535-47bb-0310-9956-ffa450edef68"
38daab944e9e9e59779f09a75102544f3706bb74,"Part of patch for XALANJ-1774

Defined constants that contain names of static translet fields used to record
information about stylesheet namespaces declarations and their signatures, and
the name and signature of a new BasisLibrary method to look up that namespace
information at transformation time.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@446475 13f79535-47bb-0310-9956-ffa450edef68"
c798ffe40ae67509c9f4814752801e4e3b83a73c,"Part of patch for XALANJ-1774

If an xsl:element instruction has a name attribute that has variable parts, and
has no namespace attribute, any prefix in the name has to be resolved against
namespace declarations accessible in the stylesheet at that point.  The
namespace information is saved in static fields in the translet class, and
the prefix through a call to BasisLibrary.lookupStylesheetQNameNamespace to
which the static fields and a stylesheet node ID (returned by
XSLTC.registerStylesheetPrefixMappingForRuntime) are passed.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@446476 13f79535-47bb-0310-9956-ffa450edef68"
49724ea4004fa57e03a8c343c6e813d1acd2825c,"Part of patch for XALANJ-1774

Added registerStylesheetPrefixMappingForRuntime method, which is used to record
namespace mappings that are accessible at a particular point in the stylesheet,
and returns a unique stylesheet node ID that is used to identify that node
at transformation time in looking up namespaces.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@446477 13f79535-47bb-0310-9956-ffa450edef68"
9dd922b4ab9cd388490dbe04ddc988e35837958a,"Applying Dave Brosius patch from xalanj-2221 which
changes a loop over i that copies values from one
array to another to a System.arraycopy() that should
run faster.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@464552 13f79535-47bb-0310-9956-ffa450edef68"
39e755263c891f516a9cd0b8e79531cba4405037,"Applying patch for xalanj-2208 to remove some dead code.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@464564 13f79535-47bb-0310-9956-ffa450edef68"
576fe088729ee71596550101c6a500bbf848df27,"Applying patch for xalanj-2208 to remove some dead code.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@464566 13f79535-47bb-0310-9956-ffa450edef68"
fe3aec0b68ddd2cec07ef64b86fe3d8773120273,"Applying patch for xalanj-2208 to remove some dead code.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@464568 13f79535-47bb-0310-9956-ffa450edef68"
4b6e5db7cf1b0dd04f90fe8bd54714c0c874840f,"Applying patch for xalanj-2208 to remove some dead code.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@464569 13f79535-47bb-0310-9956-ffa450edef68"
cbe107a708301612cbde583b6e408e2c3fe0ebe5,"Applying patch for XALANJ-2196 from Sarah McNamara (mcnamara () ca ! ibm ! com).

Restored various *nojardepends targets in build.xml that are needed for building
stand-alone versions of Xalan-J Interpretive and XSLTC.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@464657 13f79535-47bb-0310-9956-ffa450edef68"
f284f1fa9d1873718d1abef196a33b72226891d8,"Applying patch for XALANJ-2268 from Dave Brosius.

Removed an unnecessary guard from code in the initialize(URI,String) method that
does not actually protect against any exception.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@464665 13f79535-47bb-0310-9956-ffa450edef68"
f328142a414bcf79fb1b5d5b68df1024b5a0789d,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468635 13f79535-47bb-0310-9956-ffa450edef68"
52e98c2c42257e507bc1688b9fb83acd403388d0,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468636 13f79535-47bb-0310-9956-ffa450edef68"
dfc10a07147eef4a4d80ad67f83aa4424ee13204,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468637 13f79535-47bb-0310-9956-ffa450edef68"
35b1acbee555a66486bb21d03fac2e47d7a64749,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468638 13f79535-47bb-0310-9956-ffa450edef68"
d59a8b8a0911cd9b348b340d32cf5e06b697c212,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468639 13f79535-47bb-0310-9956-ffa450edef68"
5d081e09c81d73fdd6c66423580af96e5a26cc2b,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468640 13f79535-47bb-0310-9956-ffa450edef68"
ee949b3729869d316b284083cabbc3dee4ef0586,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468641 13f79535-47bb-0310-9956-ffa450edef68"
fa592f8e5a41cddc10b9510be07dd801660c0e1f,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468642 13f79535-47bb-0310-9956-ffa450edef68"
6e29bc36dd4fedab1005617b9939e6e257b59a08,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468643 13f79535-47bb-0310-9956-ffa450edef68"
db34084182ec1c43eb6a11a5dbcbf5852d9c5bfd,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468644 13f79535-47bb-0310-9956-ffa450edef68"
1df3bf580318f459af086fdc28055f3026c68df7,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468645 13f79535-47bb-0310-9956-ffa450edef68"
8a06823cd3434aa3568c5a7524a9544bb58c2c6e,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468646 13f79535-47bb-0310-9956-ffa450edef68"
2bc17fb6afe79e31e444699383189be7ff00e7e3,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468647 13f79535-47bb-0310-9956-ffa450edef68"
f8fb67fe9c1db05fa6f70011d6db35584b0abd8e,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468648 13f79535-47bb-0310-9956-ffa450edef68"
e1859419536557822dcd499252df1ca3850a235b,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468649 13f79535-47bb-0310-9956-ffa450edef68"
64a28ceec82b62390844cdb599216c618d67f957,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468650 13f79535-47bb-0310-9956-ffa450edef68"
3e5d98d288563d46a01420f552b6359afe51a3b2,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468651 13f79535-47bb-0310-9956-ffa450edef68"
77dbbd382edba19d5dbc53fb9bffa2a7962d18b8,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468652 13f79535-47bb-0310-9956-ffa450edef68"
5d58499ae535ef41e77fc44503e60c1d0c5cb2f6,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468653 13f79535-47bb-0310-9956-ffa450edef68"
04f47eb2eba6d266ab912d5ccc1f5083d80e377b,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468654 13f79535-47bb-0310-9956-ffa450edef68"
dadd1dda24d4fec26963aa66daeb3c0a2b4f07d7,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468655 13f79535-47bb-0310-9956-ffa450edef68"
b96a5a8c1b1db209ce51cbc329795f74bbe9cafe,"Apache license update per XALANJ-2328.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@468656 13f79535-47bb-0310-9956-ffa450edef68"
bf8aac992acbc4c2eea78b159406c231427ba08a,"Committing the patch in XALANJ-2321, which was reviewed/approved
by Yash Talwar.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469221 13f79535-47bb-0310-9956-ffa450edef68"
f83187e6972d17cd8bab900b3f68e70e0d307218,"Applying part of patch in XALANJ-2061.
Dropping a simple variable assignment to 
a variable that is never used.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469263 13f79535-47bb-0310-9956-ffa450edef68"
1604d5cd4e82698fbd05b0f5b165a999a5d54ee6,"Applying part of patch in XALANJ-2061.
Dropping a simple variable assignment to 
a variable that is never used.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469266 13f79535-47bb-0310-9956-ffa450edef68"
a782b49a2d67d356dc0094d9edd4ad8f94e941bf,"Applying part of patch in XALANJ-2061.
Dropping a simple variable assignment to 
a variable that is never used.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469273 13f79535-47bb-0310-9956-ffa450edef68"
223bb45b24201d519d3f15a04cea4a69b2527329,"Applying part of patch in XALANJ-2061.
Dropping a simple variable assignment to 
a variable that is never used.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469275 13f79535-47bb-0310-9956-ffa450edef68"
d17203343a88d72592d45a9a86c19bf670e17886,"Applying part of patch in XALANJ-2061.
Dropping a simple variable assignment to 
a variable that is never used.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469276 13f79535-47bb-0310-9956-ffa450edef68"
be236712122181e8e979e75d764ad75ff9a815e3,"Applying part of patch in XALANJ-2061.
Dropping a simple variable assignment to 
a variable that is never used.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469277 13f79535-47bb-0310-9956-ffa450edef68"
54762126edf32d9d32dcf102848369d9182128d6,"Applying part of patch in XALANJ-2061.
Dropping a simple variable assignment to 
a variable that is never used.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469278 13f79535-47bb-0310-9956-ffa450edef68"
b1679c6f57dab2f83485557149c1f16c7f9149b8,"Applying part of patch in XALANJ-2061.
Dropping a simple variable assignment to 
a variable that is never used.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469279 13f79535-47bb-0310-9956-ffa450edef68"
7e94c24baaec492a5c4d937bebad095d2affcc2d,"Committing Dave Brosius change to ElemAttribute from the patch in
XALANJ-2061

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469304 13f79535-47bb-0310-9956-ffa450edef68"
f433d3b05f19587ec3032bfc0a2e738e65bf36bf,"Code cleanup from XALANJ-2236 (from Dave Brosius)

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469314 13f79535-47bb-0310-9956-ffa450edef68"
b589c15d8c5632dbf3c87bd7bedd1ba29d4067cd,"Code cleanup from XALANJ-2236 (from Dave Brosius)

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469316 13f79535-47bb-0310-9956-ffa450edef68"
fe5256bef38a0b3913635bf355765786074783f4,"Code cleanup from XALANJ-2236 (from Dave Brosius)

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469317 13f79535-47bb-0310-9956-ffa450edef68"
fc5664dcfcb5fed01a2ab6de241ccff2ac10310e,"Committing the patch in XALANJ-2133 previously reviewed/approved by
Morris Kwan.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469344 13f79535-47bb-0310-9956-ffa450edef68"
1807cbe3034af46216f4b247ed2735daba06558e,"Applying patch in XALANJ-2240

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469347 13f79535-47bb-0310-9956-ffa450edef68"
12c9bbdd4a7ef3ccbaa924013d44c653ea0f1669,"Committing patch for XALANJ-2297 to the code base,
fixing a but for when the wrong base URI is passed to
a URI resolver.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469349 13f79535-47bb-0310-9956-ffa450edef68"
e38caccc59c523cdef4ed23397c13a217e40333b,"Fix for buffer splitting bug, patch from XALANJ-2316 is applied.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469356 13f79535-47bb-0310-9956-ffa450edef68"
79073deeae1a5f2bdbc77d47b747e17af6c3d0f7,"Committing the patch in XALANJ-2312

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469359 13f79535-47bb-0310-9956-ffa450edef68"
5e740051f079287ccec732119d059e4c47f82fd4,"Patch for XALANJ-2204

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469367 13f79535-47bb-0310-9956-ffa450edef68"
31ae31bdb37f580b0a6a656136df7140aec6c0bf,"Patch for XALANJ-2204

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469368 13f79535-47bb-0310-9956-ffa450edef68"
25d0f54a5a50920085fe8cc3285ff69d00444e15,"Committing the changes in patch5 in XALANJ-2219 to
not replace prefix mappings if one already exists
at that depth for the same prefix.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469648 13f79535-47bb-0310-9956-ffa450edef68"
b79ad6dcb756824a80ad486e17c3ec334285a2d5,"Committing Dave Brosius' patch in XALANJ-2224 that uses
get/add/remove rather than elementAt/addElement/removeElement
moving us from 1.1.x APIs on a java.util.Vector to
similar on a java.util.AbstractList.

The only point of this patch is that in the future we might
experiment with different kinds of Lists and not be stuck
with a Vector.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469672 13f79535-47bb-0310-9956-ffa450edef68"
e7c45b504f6bd71f4b598a65c546f09c95bef9f5,"Committing Dave Brosius' patch in XALANJ-2284 that uses
get/add/remove rather than elementAt/addElement/removeElement
moving us from 1.1.x APIs on a java.util.Vector to
similar on a java.util.AbstractList.

The only point of this patch is that in the future we might
experiment with different kinds of Lists and not be stuck
with a Vector.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@469688 13f79535-47bb-0310-9956-ffa450edef68"
b8447822e49619d6c8d5ecb7f950e65ba05099b8,"Apache license update per XALANJ-2328

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470245 13f79535-47bb-0310-9956-ffa450edef68"
ceca6ddb9641c049e6330b7b1747ca88bb028814,"Apache license update per XALANJ-2328

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470262 13f79535-47bb-0310-9956-ffa450edef68"
240c48b8ce90227b4d50c93965464299525baf1e,"Apache license update per XALANJ-2328

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470415 13f79535-47bb-0310-9956-ffa450edef68"
164f2d877d9eb9ba3224562774859e2536828623,"Apache license update per XALANJ-2328

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470420 13f79535-47bb-0310-9956-ffa450edef68"
0a4c67882838c3227729ba687db97ea53a257f3f,"Apache license update per XALANJ-2328

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470453 13f79535-47bb-0310-9956-ffa450edef68"
ba713c3b9233be9e8527c319492e22222d1ca0d8,"Apache license update per XALANJ-2328

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470454 13f79535-47bb-0310-9956-ffa450edef68"
e2d2e304bb6850ca8eb3e42c92fba0c5034f8090,"Apache license update per XALANJ-2328

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470456 13f79535-47bb-0310-9956-ffa450edef68"
d13b7d3b4c52655d72f63d928bce10ee47f3d2a5,"Apache license update per XALANJ-2328

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470458 13f79535-47bb-0310-9956-ffa450edef68"
190acd29917abbe81c835f9a9ce2adc5291fccfc,"Apache license update per XALANJ-2328

Apache would prefer no copyrights from others in the code,
and would like to remove them where possible, and it is
very possible to remove the IBM copyrights here.

As an agent of IBM I removed the IBM copyright which was this:

<!-- 5630-A23, 5630-A22, (C) Copyright IBM Corporation, 1997, 2000 -->
<!-- All rights reserved. Licensed Materials Property of IBM -->
<!-- Note to US Government users: Documentation related to restricted rights -->
<!-- Use, duplication or disclosure is subject to restrictions set forth in GSA ADP Schedule with IBM Corp. -->
<!-- This page may contain other proprietary notices and copyright information, the terms of which must be observed and followed. -->

I don't think that the use, duplication or disclosure of these parts is subject to the restrictions
that it mentioned. These are not major stylesheets here.
Nothing else anywhere has an IBM copyright so this one
was the anomaly.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@470679 13f79535-47bb-0310-9956-ffa450edef68"
fa8ad3ca46fe760d91d9b150fee2d11be4f1ff53,"I have reviewed and approved the patch in XALANJ-2050 
and am committing the patch. I only made one change 
and that was to not have another method, setNewLine on
SerializationHandler, but rather use the existing
setOutputProperty() method.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@471981 13f79535-47bb-0310-9956-ffa450edef68"
d10d5806d6a23159b60a7af8d0cc9c3da1419f31,"Part of the patch in XALANJ-2050 that I forgot
to commit the first time.
DOM Level 3 support.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@472223 13f79535-47bb-0310-9956-ffa450edef68"
64ec5358b2f9d5a1d66084db9c0b774610754d20,"Fixed bug XALANJ-2091
Added namespace nodes to the DOM tree

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@472634 13f79535-47bb-0310-9956-ffa450edef68"
6bd4adae30319fe72bb6a87dc75592ff1913feb5,"A minor change of fNewLine.toString() which
was wrong, to String.valueOf(fNewLine)); to 
turn the character array into a String.

Thanks to Neil Delima for pointing out this error.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@474947 13f79535-47bb-0310-9956-ffa450edef68"
c0e3d8588c3538cd5d1878c6859102ac2a794144,"Javadoc update, just to make the example clearer.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475350 13f79535-47bb-0310-9956-ffa450edef68"
c5824e6013a68f022896f17ab0c62a6fd497e195,"Javadoc update

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475430 13f79535-47bb-0310-9956-ffa450edef68"
693d358f5b7792f3bae5c45cfe20495d509e56ec,"I have reviewed Michael G.'s patch in XALANJ-2323 and I approve it.
This fixes some DOM Level 3 serialization bugs.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475456 13f79535-47bb-0310-9956-ffa450edef68"
2fb8dae21c3a4fd429650faa61e58b1e25f966cd,"Javadoc update

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475578 13f79535-47bb-0310-9956-ffa450edef68"
064a39ca4f443cdda7c08fd829b9a2367e60267f,"Applying Santiago's patch to Process.java from XALANJ-2317 so 
that error messages (like for a semantic error in a stylesheet)
such as for an xsl element that doesn't exist, like
<xsl:fred /> are reported with a location!

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475586 13f79535-47bb-0310-9956-ffa450edef68"
46ab3d225129734bb6e64d02c191c15f2c631137,"AccessController fix for getting the ""line.separator"" 
system property. Applying Michael G.'s patch
from XALANJ-2341

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475894 13f79535-47bb-0310-9956-ffa450edef68"
8947834ac8546971868fbe68da029e6e23e72091,"Minor Javadoc change.  Removing the statement to
avoid the collection classes of 1.2 to keep 1.1.x 
compatibility.

This is no longer true, and we already modified this file
due to XALANJ-2284 where we DID start using them in this class.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475902 13f79535-47bb-0310-9956-ffa450edef68"
310fae6517764523856f95906029f2fba7e22ce8,"Adding comments in the javadoc that perhaps 
a field can be changed from Hashtable to HashMap 
for performance reasons.

Just a bread crumb of information for the next guy.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475904 13f79535-47bb-0310-9956-ffa450edef68"
e2855f8ce0acc9acf47a41a0718a8661afc2e7b2,"Patch in XALANJ-2342 is applied to do better error
handling when setting DOM Level 3 Store parameters for
serialization.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475951 13f79535-47bb-0310-9956-ffa450edef68"
2f0ef16667476dc9aa9a26470f1c16e8ff436ed6,"Fix for XALANJ-2323 is applied making both ToHTMLSAXHandler and 
ToTextSAXHandler obsolete.

Only ToXMLSAXHandler is used from now on, so no optimizations
are done. Rather this kind of object converts our internal SAX-like
calls to true SAX calls on the ContentHandler, which 
may be a user defined one.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475978 13f79535-47bb-0310-9956-ffa450edef68"
204b997b3dee7fd6ba473b88912b6a53cd31d928,"Fix for XALANJ-2323 is applied making both ToHTMLSAXHandler and 
ToTextSAXHandler obsolete.

Only ToXMLSAXHandler is used from now on, so no optimizations
are done. Rather this kind of object converts our internal SAX-like
calls to true SAX calls on the ContentHandler, which 
may be a user defined one.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475979 13f79535-47bb-0310-9956-ffa450edef68"
0dc8124317054b1996fc77794f4506f3d6ca95be,"Committing the patch in XALANJ-2336 which
uses an unsynchronized ArrayList in both ObjectPool
and IteratorPool rather than a synchronized Vector.

This is for performance reasons. Both of these types are
already synchronized on their public methods, so the old
code had unwanted synchronization.

ElemTemplateElement had two fields that were also Vectors that
were search (but not modified) at runtime. These were also
changed to ArrayList objects.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@475981 13f79535-47bb-0310-9956-ffa450edef68"
8039cb520ee0ca66adf74c75d7f7038b1ae51296,"Committing the patch in XALANJ-2343 which
cleans up (and fixes some bugs) in the setting and
use of DOM 3 serialization parameters.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@476337 13f79535-47bb-0310-9956-ffa450edef68"
d074054ceb4a084b71cf75eaa8320ae24a748c75,"Applying the patch ElemLiteralResult.patch.txt in XALANJ-2302
which changes two fields from Vector to ArrayList to unsynchronize
them to run faster in multi-threaded mode.

Thanks to Toadie for the patch.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@476350 13f79535-47bb-0310-9956-ffa450edef68"
ee03e84e7a76e9622a85ccd32e0adde980e10f60,"Partial fix for XALANJ-2344
StylesheetRoot+XSLTSchema.patch.txt is applied.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@476466 13f79535-47bb-0310-9956-ffa450edef68"
9d013995646cfafa57c473439580dcd44b4a24df,"Committing Santiago's pathc for XALANJ-2108 to not 
have an error on certain XSLT parameters that have an
error, but are not used.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@476471 13f79535-47bb-0310-9956-ffa450edef68"
e6995e6dff34e7d840638e0d18ddf359edc2785d,"Updating release to 2.7.1 (was 2.7.0).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@477252 13f79535-47bb-0310-9956-ffa450edef68"
18025cd838bfb72020afab00b6d87512f62ba49d,"Upgrading minor release from 0 to 1 (for 2.7.1 release)

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@477292 13f79535-47bb-0310-9956-ffa450edef68"
8ffe92b9846f3423c52c7a7cc86de18d008fb2ff,"Apache license update.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478201 13f79535-47bb-0310-9956-ffa450edef68"
1ff1ae35091ffdb279da4d31bdf37d663ed806f1,"Apache license update.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478294 13f79535-47bb-0310-9956-ffa450edef68"
c6f5f50134893f671cf7bafdfe757d30d99f4a47,"Apache license update.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478295 13f79535-47bb-0310-9956-ffa450edef68"
b8af76af644c6e26a3b930e66c79ebb9a0298642,"New contact_us page, part of XALANJ-2327 changes

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478653 13f79535-47bb-0310-9956-ffa450edef68"
540d4b4c5a37dcc2384f4c9a9172ba01b52a15ad,"> Multiple broken links fixed
> some updates for 2.7.1
> Upgraded ""downloads"" page to give information
  on downloading the latest release
  or nightly binary builds from gump
  or subversion and the code itself
> Links to the new ""contact_us"" page that 
  has more information on mailing lists and
  JIRA.

Fix for XALANJ-2327


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478654 13f79535-47bb-0310-9956-ffa450edef68"
e71ed546f46d90326cf7c7de0bffc0ed521370ec,"Change feck to push in a comment.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478657 13f79535-47bb-0310-9956-ffa450edef68"
7a5c2e7f1232768c7b151feebba314ad59a6c2fe,"Clean up some profanity. The comment now reads:
// Show the whole thing

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478660 13f79535-47bb-0310-9956-ffa450edef68"
982678f20bfb30901467749a611dbcbfd3924dd6,"Clean up some profanity. The comment now reads:
// ... the whole DOM ...

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478662 13f79535-47bb-0310-9956-ffa450edef68"
f8a1df17a852568b9d38db2c6154f7558cc9b880,"Changed a comment to ""push"" it on the stack

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478664 13f79535-47bb-0310-9956-ffa450edef68"
07019b62113e5bf32732f4233d12ee7694c6cca3,"Clean up some profanity. The comment now reads:
// ... so don't change it.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478667 13f79535-47bb-0310-9956-ffa450edef68"
406a13e28c251848b7d45db0ed484316c1437039,"Changed a comment to ""push"" something on a stack.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478670 13f79535-47bb-0310-9956-ffa450edef68"
90e2fb0f04bf07d9bdd42b3385f1121ccd1c49f4,"Language clean up in a comment, which now reads:
... we're probably in seriously bad trouble.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478671 13f79535-47bb-0310-9956-ffa450edef68"
0685679b8ca25ce09b64e2daa3b75a1e89232a8e,"Adding org.w3c.dom and org.xml.sax to the public APIs list of packages.
per XALANJ-2248 

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478675 13f79535-47bb-0310-9956-ffa450edef68"
ea0f23d5a199bada46206a1304b290821808ad68,"Applying patch in XALANJ-2270 to make it clearer why
to choose one binary distribution over the other.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478682 13f79535-47bb-0310-9956-ffa450edef68"
30c08701e8582e590d7aa103ef7c879299476a98,"xercesImpl.jar is upgraded to 2.9.0 for XALANJ-2345

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478742 13f79535-47bb-0310-9956-ffa450edef68"
56cb3a4dbe98a9bae1c095a49192734b60239ae1,"xml-apis.jar is upgraded to 1.3.04 for XALANJ-2345

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478743 13f79535-47bb-0310-9956-ffa450edef68"
fb4f11ec3ad07f68ff853683417b37c24906d22d,"xercesImpl.jar is upgraded to 2.9.0 for XALANJ-2345
so I'm upgrading the NOTICE for xerces.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478764 13f79535-47bb-0310-9956-ffa450edef68"
91457a176de390f501e0302d6b5222b7631608ce,"Deleting the xml-apis LICENSE and NOTICE since
they are now part of Xerces. Part of XALANJ-2345

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478766 13f79535-47bb-0310-9956-ffa450edef68"
41b93b3e28f45a85bd6a748d0d89b14f560cb37f,"upgraded for XALANJ-2345 for the Xalan-J 2.7.1 release.
Changed Xerces version to 2.9.0 and year to 2006.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@478770 13f79535-47bb-0310-9956-ffa450edef68"
15a46038b109619e7e791b215feccea86362b593,"Pulling out the patch that was from XALANJ-2133 since it caused 
regressions in some of the flavours of testing.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@486494 13f79535-47bb-0310-9956-ffa450edef68"
8f35a3ed27cffad7f8bbea78a56bb9c178cc0e31,"Applying documentation patch to remove references to
gump on the builds and downloads pages.

Patch applied from XALANJ-2356

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@486788 13f79535-47bb-0310-9956-ffa450edef68"
7d14ba0882cf7f24041bcae1041103c9b710f350,"Website updates for the release notes and some other
clean up applied to TRUNK.

Patch2 from JIRA issue XALANJ-2359 is applied.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@489425 13f79535-47bb-0310-9956-ffa450edef68"
39e5884952602d7b04fd6e5ec46e6191261c94af,"Website updates for the release notes and some other
clean up applied to TRUNK.

Patch2 from JIRA issue XALANJ-2359 is applied.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@489426 13f79535-47bb-0310-9956-ffa450edef68"
7066204404f055bb6b89a9564049c7c056b9a450,"Applying patch for XALANJ-2339 from Kevin Cormier (kcormier () ca ! ibm ! com).

Code for converting the Object reference for parameter to a node-set
(DTMAxisIterator) was simply performing a clone of the iterator.  However,
cloning an iterator also clones its iteration state, so that if the original
iterator was part way through its iteration for some reason, the cloned
iterator would not return all the nodes in the node set.  The fix is to reset
the cloned iterator prior to returning it.


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@505310 13f79535-47bb-0310-9956-ffa450edef68"
c718595a70d2bb5e9850950ae2b2c7e34909a3fa,"Fix for JIRA issue XalanJ-1434

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@513117 13f79535-47bb-0310-9956-ffa450edef68"
c78557a5124d3b74cf17b54655beb7265be9ccf9,"Part of fix for Jira issue XALANJ-2375.

Changed default constructor to defer creating a PrintWriter through which to
report any error messages until a message actually needs to be reported.  A
PrintWriter instance consumes a substantial amount of space, and deferring its
creation saves initialization time for the XPath API and XSLT.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524806 13f79535-47bb-0310-9956-ffa450edef68"
f3a43c401a56de76f972faf9c120cbf495189216,"Part of fix for Jira issue XALANJ-2375.

Added a new constructor and corresponding reset method that allow the caller
to specify the initial size for the arrays contained in a VariableStack.  This
is important for XPath expression evaluation, where additional stack entries
are never needed.  Previously, the arrays were always allocated based on the
maximum recursion depth permitted by the XSLT processor, which was caused
unnecessary initialization overhead using the various XPath APIs.

Also added two new XPathContext constructors which accept a boolean argument
that indicates whether the context for variables needs to be push/popable.
When it's false, the XPathContext will create a minimally-sized VariableStack.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524807 13f79535-47bb-0310-9956-ffa450edef68"
59b03dbaae1a4278bc7ac342b003b635162a05fa,"Part of fix for Jira issue XALANJ-2375.

Added a new constructor and corresponding reset method that allow the caller
to specify the initial size for the arrays contained in a VariableStack.  This
is important for XPath expression evaluation, where additional stack entries
are never needed.  Previously, the arrays were always allocated based on the
maximum recursion depth permitted by the XSLT processor, which was caused
unnecessary initialization overhead using the various XPath APIs.

Also added two new XPathContext constructors which accept a boolean argument
that indicates whether the context for variables needs to be push/popable.
When it's false, the XPathContext will create a minimally-sized VariableStack.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524808 13f79535-47bb-0310-9956-ffa450edef68"
89b0c97d2a1af87180ed2cb7dc1751f7f9429e87,"Part of fix for Jira issue XALANJ-2375.

Added a new constructor and corresponding reset method that allow the caller
to specify the initial size for the arrays contained in a VariableStack.  This
is important for XPath expression evaluation, where additional stack entries
are never needed.  Previously, the arrays were always allocated based on the
maximum recursion depth permitted by the XSLT processor, which was caused
unnecessary initialization overhead using the various XPath APIs.

Also added two new XPathContext constructors which accept a boolean argument
that indicates whether the context for variables needs to be push/popable.
When it's false, the XPathContext will create a minimally-sized VariableStack.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524809 13f79535-47bb-0310-9956-ffa450edef68"
d6d102c8fcce0cf01ef277c858b013777a6a38f5,"Part of fix for Jira issue XALANJ-2375.

Lexer.tokenize was always creating an OpMapVector object with large initial
sizes.  This was wasteful, because each XPath expression so tokenize might
need only a small amount of space.  Instead, changed the initial size to be
equal to five times the length of the string to be tokenized, just as a
very conservative estimate.  This has a significant impact on the performance
of the XPath API.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524810 13f79535-47bb-0310-9956-ffa450edef68"
d0e4ff12fb13963ce9b0ba00f894fb01ea07b111,"Part of fix for Jira issue XALANJ-2375.

Added a new constructor and corresponding reset method that allow the caller
to specify the initial size for the arrays contained in a VariableStack.  This
is important for XPath expression evaluation, where additional stack entries
are never needed.  Previously, the arrays were always allocated based on the
maximum recursion depth permitted by the XSLT processor, which was caused
unnecessary initialization overhead using the various XPath APIs.

Also added two new XPathContext constructors which accept a boolean argument
that indicates whether the context for variables needs to be push/popable.
When it's false, the XPathContext will create a minimally-sized VariableStack.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524811 13f79535-47bb-0310-9956-ffa450edef68"
8b274416638bae3d87d7687ae6956ab2aced78ad,"Part of fix for Jira issue XALANJ-2375.

Added a new constructor and corresponding reset method that allow the caller
to specify the initial size for the arrays contained in a VariableStack.  This
is important for XPath expression evaluation, where additional stack entries
are never needed.  Previously, the arrays were always allocated based on the
maximum recursion depth permitted by the XSLT processor, which was caused
unnecessary initialization overhead using the various XPath APIs.

In the case of JAXPVariableStack, which extends VariableStack, the default
constructor can always use specify the minimal stack size on the super class's
constructor.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524812 13f79535-47bb-0310-9956-ffa450edef68"
118e7321776d53374433b8f877c644095e6eadd2,"Part of fix for Jira issue XALANJ-2375.

Added a new constructor and corresponding reset method that allow the caller
to specify the initial size for the arrays contained in a VariableStack.  This
is important for XPath expression evaluation, where additional stack entries
are never needed.  Previously, the arrays were always allocated based on the
maximum recursion depth permitted by the XSLT processor, which was caused
unnecessary initialization overhead using the various XPath APIs.

Also added two new XPathContext constructors which accept a boolean argument
that indicates whether the context for variables needs to be push/popable.
When it's false, the XPathContext will create a minimally-sized VariableStack.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524813 13f79535-47bb-0310-9956-ffa450edef68"
8ff1ceb07188ff113454ca1eb9a9d9404cd21951,"Part of fix for Jira issue XALANJ-2375.

Added a new constructor and corresponding reset method that allow the caller
to specify the initial size for the arrays contained in a VariableStack.  This
is important for XPath expression evaluation, where additional stack entries
are never needed.  Previously, the arrays were always allocated based on the
maximum recursion depth permitted by the XSLT processor, which was caused
unnecessary initialization overhead using the various XPath APIs.

Also added two new XPathContext constructors which accept a boolean argument
that indicates whether the context for variables needs to be push/popable.
When it's false, the XPathContext will create a minimally-sized VariableStack.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524814 13f79535-47bb-0310-9956-ffa450edef68"
96a67fb24c7ab9b2b9e9c986a7f70c7339bed20c,"Part of fix for Jira issue XALANJ-2375.

Added a new constructor and corresponding reset method that allow the caller
to specify the initial size for the arrays contained in a VariableStack.  This
is important for XPath expression evaluation, where additional stack entries
are never needed.  Previously, the arrays were always allocated based on the
maximum recursion depth permitted by the XSLT processor, which was caused
unnecessary initialization overhead using the various XPath APIs.

In the case of JAXPVariableStack, which extends VariableStack, the default
constructor can always use specify the minimal stack size on the super class's
constructor.

Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@524815 13f79535-47bb-0310-9956-ffa450edef68"
6882f3a94705b8d2dfbb2b95e88a67a7e23d852a,"Patch for XALANJ-2377

VariableBase.removeReference was effectively being used to decrement a reference
counter for local variables.

At one time, XSLTC used to release JVM stack slots as soon as the last
reference to a local variable occurred, but that resulted in a bug if loops
were involved.  So the code was changed to release a local variable slot only
when the containing construct went out of scope - this was done with a call to
VariableBase.unmapRegister from SytaxTreeNode.translateContents.

However, VariableBase.unmapRegister still contained a vestige of the old
reference counting code - it was checking whether any references to the variable
still existed.  In the presence of ""Closures,"" the number of calls to
VariableBase.addReference did not equal the number of calls to
VariableBase.removeReference (for no good reason), so the variable was not
marked by VariableBase.unmapRegister as going out of scope.  This caused later
problems for outlining in org.apache.xalan.xsltc.compiler.util.MethodGenerator.

The fix is to remove VariableBase.removeReference, since XSLTC should no longer
on that to determine whether it can release a variable slot.  The
VariableBase.addReference method remains, however, because XSLTC uses that to
determine whether a variable can be discarded completely.


Reviewed by Christine Li (jycli () ca ! ibm ! com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@528589 13f79535-47bb-0310-9956-ffa450edef68"
570edaf47b8af1ac638a0430ad18a4d51c161a1b,"Fix for XALANJ-2384.

The code generated for the topLevel and transform methods of a translet was
generated using DTM.ROOT_NODE (i.e., zero) as the value of the root node for
the initial context.  However, that is not a valid node handle.

The proper way of getting the handle of root of the initial input document is
through DOM.getIterator().next().

Patch was reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@545471 13f79535-47bb-0310-9956-ffa450edef68"
5e83d171affa7d6ca6e88d542777b7e6f9405f68,"Committing changes for XALANJ-2358 on behalf of Brian Minchau (in order to test that my committer SVN account is working).  The changes were reviewed by Henry Zongaro.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@563656 13f79535-47bb-0310-9956-ffa450edef68"
6237bcdbdae3c357e25facfe30301353b726cb62,"Committing changes for XALANJ-2358 on behalf of Brian Minchau (in order to test that my committer SVN account is working).  The changes were reviewed by Henry Zongaro.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@563659 13f79535-47bb-0310-9956-ffa450edef68"
8259d86feb3f56ab5dc6ac178ca558da832fa216,"Updating the date for Xalan-J 2.7.1 release and
including more fixed bugs in the list for the release:
1434
2108
2339
2375
2377
2384

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@563700 13f79535-47bb-0310-9956-ffa450edef68"
70f007b1619924805367ecaa5a1c5f0dbee08eaa,"Added an equals(String) method to the XMLString interface.  This allows the
caller to compare an XMLString to a Java String without forcing the XMLString
to be converted to a String.

In this particular class (XString), modified equals(XMLString) to take advantage
of the new XMLString.equals(String).  If the argument for the comparison
contains a java.lang.String, then comparing that with the String held by this
XString is likely the fastest way to perform the comparison; otherwise, we give
the argument the chance to compare itself natively with the String contained by
this XString.

Part of patch for XALANJ-1243.  Reviewed by Brian Minchau (minchau@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@570108 13f79535-47bb-0310-9956-ffa450edef68"
55a85bcaf926fc43a4a8f3c8e11f3316108490fd,"Added an equals(String) method to the XMLString interface.  This allows the
caller to compare an XMLString to a Java String without forcing the XMLString
to be converted to a String.

Part of patch for XALANJ-1243.  Reviewed by Brian Minchau (minchau@ca.ibm.com).


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@570109 13f79535-47bb-0310-9956-ffa450edef68"
5a5b90f8ef56467f4fe8ecaceb0c3eb150735767,"Patch for XALANJ-2395.  Reviewed by Brian Minchau.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@575747 13f79535-47bb-0310-9956-ffa450edef68"
092f1c6295d7d0889e5d2a9923d5cfdbb0b58d32,"Committing fix for XALANJ-2206
Patch from Vadim Gritsenko.
Patch was modified slightly and approved by Brian Minchau.

The fix lets users set the ""enable-inlining"" feature specifically
in the case of TemplatesHandler,
where the default value in Stylesheet class was wreaking havoc.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@577935 13f79535-47bb-0310-9956-ffa450edef68"
cbd58161735e71781afda4b16f59081794fa10f8,"Updating the bug list for the website.
It already had XALANJ-2206 in the list, but
we have fixed XALANJ-1243 and XALANJ-2395 recently
so I'm adding them in too.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@577937 13f79535-47bb-0310-9956-ffa450edef68"
4d8d12e1772ebdf541c9227e83e165d3de69bb82,"Updating the maintanence version to 1 ( so the product version is now 2.7.1 )

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@577939 13f79535-47bb-0310-9956-ffa450edef68"
bdcd4510e2b8fbdaee32d60d23deb26a53bd833a,"Fix for Jira issue XALANJ-2402.

Unlike all other AST nodes, the AST nodes created for literal result elements,
extension elements and unknown elements did not have a reference to the XSLT
Parser class.  This results in an NPE later if the processor needs to access
the Parser instance (or other fields through it, such as the XSLTC instance).

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@584164 13f79535-47bb-0310-9956-ffa450edef68"
6200f5bbfa82294249ba3690cff7321547243753,"Part of fix for Jira issue XALANJ-2446:

The implementation of getQName(String,String,String) method was ensuring
that any particular pair of namespace URI and local part of the name would
result in a unique QName object.  It did not take into account the prefix,
despite the fact that the original prefix might be associated with a different
namespace URI in this new context or with no namespace at all.

Fixed this by making getQName take into account all three of the namespace URI,
local part of the name and prefix in order to create unique QName objects.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@669372 13f79535-47bb-0310-9956-ffa450edef68"
30b997a4cba1f8a088e1cf95c7ff1c4a2f7fdbf4,"Part of fix for Jira issue XALANJ-2447.

The handling of exclude-result-prefixes for an xsl:stylesheet had the complete
set of excluded prefixes accumulated on the xsl:stylesheet for the main
stylesheet module.  However, the scope of the attribute is supposed to consist
only of elements that are direct descendants of an element that has the
attribute, and does not extend to imported or included stylesheets.  The same
is true of namespaces excluded because they have been declared as extension
element prefixes.

Fixed this by maintaining a stack of excluded prefixes that's pushed on entry
to the Stylesheet.parseOwnChildren method and popped on exit from the same.
The push operation clears the current set of excluded prefixes and the pop
operation restores the set of excluded prefixes that were in effect for the
importing or including stylesheet.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@669373 13f79535-47bb-0310-9956-ffa450edef68"
f3c8794751bd31037fe3ee1496fc8a357fd0d2db,"Part of fix for Jira issue XALANJ-2446:

The implementation of Parser.getQName(String,String,String) method was ensuring
that any particular pair of namespace URI and local part of the name would
result in a unique QName object.  It did not take into account the prefix,
despite the fact that the original prefix might be associated with a different
namespace URI in this new context or no namespace at all.

Fixed this by making getQName take into account all three of the namespace URI,
local part of the name and prefix in order to create unique QName objects.

Some other parts of XSLTC depended on the assumption that a QName object
uniquely identified a pair consisting of the namespace URI and local part of
the name and used object reference comparisons (== or !=) on QName objects.
These comparisons all had to change to use equals(Object) for comparison
instead.  The implementation of QName.equals(Object) itself had to change to
consider the namespace URI and local part of the name rather than relying on
object identity.


Part of fix for Jira issue XALANJ-2447:

The handling of exclude-result-prefixes for an xsl:stylesheet had the complete
set of excluded prefixes accumulated on the xsl:stylesheet for the main
stylesheet module.  However, the scope of the attribute is supposed to consist
only of elements that are direct descendants of an element that has the
attribute, and does not extend to imported or included stylesheets.  The same
is true of namespaces excluded because they have been declared as extension
element prefixes.

Fixed this by maintaining a stack of excluded prefixes that's pushed on entry
to the Stylesheet.parseOwnChildren method and popped on exit from the same.
The push operation clears the current set of excluded prefixes and the pop
operation restores the set of excluded prefixes that were in effect for the
importing or including stylesheet.

Reviewed by Christine Li (jycli () ca ! ibm ! com)


git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@669374 13f79535-47bb-0310-9956-ffa450edef68"
2c821029040889294296ebeb2ff91557d7038db5,"Applying patch contributed by Martin von Gagern for XALANJ-2493 and XALANJ-2424.

Quoting from Martin, ""The current implementation of nodeList2Iterator is
broken, because it can not deal with attribute nodes. It relies on copyNodes
which in turn tries to add attribute nodes as children of some top level node.
Attributes don't live on the children axis, though, so this is against DOM and
causes a DOM exception in the Xerces DOM implementation and probably most other
implementations. The resulting HIERARCHY_REQUEST_ERR was noted e.g. in
XALANJ-2424.  Furthermore, the implementation is inefficient, because it
manually copies each and every node from the source document to a new DTM to
some new DTM....

I dropped copyNodes in favor of Document.importNode, to avoid code duplication
and rely on supposedly more heavily tested code. I also added another level of
elements, so that there is one such dummy node for every item of the source
list, with always a single child or element. A few assertions help ensure this
single child policy. This is especially important in the new implementation,
because otherwise it would become difficult to get the proxied nodes and the
newly DTMified nodes into correct order.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@884287 13f79535-47bb-0310-9956-ffa450edef68"
5bb33256b4260323a2a715d00fd07554ff82727c,"Applying patch for bug XALANJ-2495 from Martin von Gagern which corrects a
mistranslation of two messages to German.  I don't speak or read German, so I'm
taking it on faith that the new message text improves upon the old.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@884640 13f79535-47bb-0310-9956-ffa450edef68"
a00015c6277a96a3b3920ee1935328fab189d3ab,"Committing patch for Jira bug XALANJ-2473 submitted by Martin von Gagern.
Corrects the implementation of the DOM Level 3 Node.getTextContent() method
which was return null for element nodes, rather than the string values of all
the text node descendants in document order.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@889881 13f79535-47bb-0310-9956-ffa450edef68"
d20a295f800d3b19dd9d87909c20ac95f4784721,"Apply the latest ASF license header to build.xml. See http://www.apache.org/legal/src-headers.html.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225247 13f79535-47bb-0310-9956-ffa450edef68"
b0cb1933912b73732ccba97f8a80ba740560d43d,"Update to the latest ASF license header. See http://www.apache.org/legal/src-headers.html.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225248 13f79535-47bb-0310-9956-ffa450edef68"
e70c5c9db55a05e332437989a6dd6d50bdc7d012,"Update to the latest ASF license header. See http://www.apache.org/legal/src-headers.html.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225251 13f79535-47bb-0310-9956-ffa450edef68"
f48d31d37e30863a7da208316981921e514ef365,"Update to the latest ASF license header. See http://www.apache.org/legal/src-headers.html.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225257 13f79535-47bb-0310-9956-ffa450edef68"
cf5b7e66331e50db988e8aeb9ab2d22edc3801f5,"Removing an unnecessary folder.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225260 13f79535-47bb-0310-9956-ffa450edef68"
6fcdfd99243d2dd8c6b915f4666f9ba710f99737,"Reducing object allocation. Use Boolean constants instead.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225263 13f79535-47bb-0310-9956-ffa450edef68"
58cdb48f7b4ebc737772658d27b655ffeb8cff6d,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225265 13f79535-47bb-0310-9956-ffa450edef68"
cb2d68ccae61ab35b9243d98c79b757058b64ea5,"Reducing object allocation. Use Boolean constants instead.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225268 13f79535-47bb-0310-9956-ffa450edef68"
babc68160539737c03aa93755767a2f7554548d5,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225270 13f79535-47bb-0310-9956-ffa450edef68"
c4cd1577df8292bb5ec3b481688bb130091f116c,"Reducing object allocation. Use Boolean constants instead.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225273 13f79535-47bb-0310-9956-ffa450edef68"
ea3715dee958b03d90cbdb632fab40d82bf8a7a6,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225275 13f79535-47bb-0310-9956-ffa450edef68"
be493d35d74ee839e486476f1eae0356de8c4ea6,"Reducing object allocation. Use Boolean constants instead.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225277 13f79535-47bb-0310-9956-ffa450edef68"
b44055aef6531de1e350b0ec0cfb2ff20067ed05,"Reducing object allocation. Use Boolean constants instead.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225280 13f79535-47bb-0310-9956-ffa450edef68"
6f9a7d8ee77bdc57e7f0acce96ff14b61a2c6814,"Reducing object allocation. Use Boolean constants instead.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225282 13f79535-47bb-0310-9956-ffa450edef68"
4938c8068395fc6fe9e20f91395ed42bbbeb9882,"Reducing object allocation. Use Boolean constants instead.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225284 13f79535-47bb-0310-9956-ffa450edef68"
7efd70a4b04e1ac4ef4cc682843e7550d05edb79,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225290 13f79535-47bb-0310-9956-ffa450edef68"
1df08eee8c778dc377f54b356422e863e5b90456,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225292 13f79535-47bb-0310-9956-ffa450edef68"
ffbbd00247cbae71cf135a0097dc1e05c87d5d6f,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225294 13f79535-47bb-0310-9956-ffa450edef68"
0211a22ce416b9fec5bf103faa2eb8eb37b16251,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225295 13f79535-47bb-0310-9956-ffa450edef68"
99fd702ce8e5936fd598521d7c3f79b8b3e60941,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225297 13f79535-47bb-0310-9956-ffa450edef68"
b53e1864e0c719474d6964eb9016bf6a1edb4399,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225298 13f79535-47bb-0310-9956-ffa450edef68"
aa2a91f214f25552b33fd36cb70fb4a0714c291b,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225300 13f79535-47bb-0310-9956-ffa450edef68"
5ba1566afc7181bb172562c8aeb7bc01e4bbc9e4,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225301 13f79535-47bb-0310-9956-ffa450edef68"
40e86dd05ef10eb200c7bff24daa0e631541efd1,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225302 13f79535-47bb-0310-9956-ffa450edef68"
91772fcd4349c201c2983cdc0d4ff9e21becb925,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225304 13f79535-47bb-0310-9956-ffa450edef68"
8a0ea1c773da9afe370cb9ab2ca8531cc074ef82,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225305 13f79535-47bb-0310-9956-ffa450edef68"
25177d05d9997c0c7444e7584631b9c8e7a0883b,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225306 13f79535-47bb-0310-9956-ffa450edef68"
50733b3830ab4554f447b3cdc8a9a394565decc8,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225307 13f79535-47bb-0310-9956-ffa450edef68"
81b89caa918042abaa92daf289521b4c4d9ba80f,"Clean-up unused imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225324 13f79535-47bb-0310-9956-ffa450edef68"
ec70d86eb38c92863deb65e535b3cfeb03bf3a7d,"Eliminate creation of temporary Boolean objects.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225326 13f79535-47bb-0310-9956-ffa450edef68"
a25e293431ec8e2772e6c50b8f7e03e758d0f9de,"Minor performance improvement. String.length() == 0 tends to be slightly faster than String.equals("""").

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225364 13f79535-47bb-0310-9956-ffa450edef68"
09ab400138111d028e292e6e9494594731b3d01b,"Minor performance improvement. String.length() == 0 tends to be slightly faster than String.equals("""").

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225366 13f79535-47bb-0310-9956-ffa450edef68"
21524318f1789b3e3605a8872a6a715422de9f0c,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225368 13f79535-47bb-0310-9956-ffa450edef68"
a7434ed5b16ca44d315222f68dce99fce1cd3f8c,"Minor performance improvement. String.length() == 0 tends to be slightly faster than String.equals("""").

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225369 13f79535-47bb-0310-9956-ffa450edef68"
f302e6e973c481beab3a3828c9ea728ec6a58765,"Minor performance improvement. String.length() == 0 tends to be slightly faster than String.equals("""").

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225372 13f79535-47bb-0310-9956-ffa450edef68"
0ec0b3a17e5c69b915df32069c0541b1a9e8c29b,"Minor performance improvement. String.length() == 0 tends to be slightly faster than String.equals("""").

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225373 13f79535-47bb-0310-9956-ffa450edef68"
f8e75d084813341e2352630bf2ff25029107d76a,"Minor performance improvement. String.length() == 0 tends to be slightly faster than String.equals("""").

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225375 13f79535-47bb-0310-9956-ffa450edef68"
a107399a7ac3f82cc298a0decba539191e192bf1,"Minor performance improvement. Iterate over the entries in the map instead of the keys. This avoids a redundant table lookup for each value.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225382 13f79535-47bb-0310-9956-ffa450edef68"
2e47771ab8fdf2271fed6457af414d9c511e4d0d,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225388 13f79535-47bb-0310-9956-ffa450edef68"
cea6a9f95f71a2e39a409ce1c1ffa3462b189890,"Minor performance improvement. Iterate over the entries in the map instead of the keys. This avoids a redundant table lookup for each value.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225390 13f79535-47bb-0310-9956-ffa450edef68"
90ac1fce57847ec1acbfb7dfa7315e2735a6e00a,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225408 13f79535-47bb-0310-9956-ffa450edef68"
db77739c4f8d13e78ba6415912105da4a72c18c7,"Cleaning up SecuritySupport. We no longer need both SecuritySupport and SecuritySupport12 because Xalan now only compiles and runs on J2SE 1.3 or higher. This allows us to tighten up this class even more.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225414 13f79535-47bb-0310-9956-ffa450edef68"
0df39ffe3caf885caeb26e4e0d140e71df8b31b8,"Adding .project and .classpath files for Eclipse.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225421 13f79535-47bb-0310-9956-ffa450edef68"
1ce30f4bfbb52b6638adffada98e491fc6b29ba6,"Adding an Eclipse code formatting style (e.g. tabs should always be four spaces) and also a template for new Java source files that automatically inserts the Apache license header.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225422 13f79535-47bb-0310-9956-ffa450edef68"
f64cfe6f0c1b7f4e46027fc4a9d79a04b3897857,"Adding my PGP key to the KEYS file.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225424 13f79535-47bb-0310-9956-ffa450edef68"
2cda2bd088e8e961e170c94988866a9da06a6eec,"Adjust spacing.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225425 13f79535-47bb-0310-9956-ffa450edef68"
d2888c087c8219bd965f7f9a34d8574b842933f1,"Adding and fixing SVN properties.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225426 13f79535-47bb-0310-9956-ffa450edef68"
a70fee7ef9db54567def85edb012d34fe923b894,"Making several inner classes and fields static.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225427 13f79535-47bb-0310-9956-ffa450edef68"
75d4677e11625819cbd7309b1d3217656abcfa80,"Fixing an averaging computation that could overflow for large values.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225429 13f79535-47bb-0310-9956-ffa450edef68"
5981546fedc1726398cbfded67d1a499c887d1d4,"Fix test for Double.NaN.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225431 13f79535-47bb-0310-9956-ffa450edef68"
c0a6a2f650e060dfcd73f8e9bb34bc9abe0ddabf,"Eliminate call to inefficient String(String) constructor.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225432 13f79535-47bb-0310-9956-ffa450edef68"
ee444d989856da5d9bebb9aa150db349389d0a82,"Fixing a findbugs warning. clone() is defined on this class but it didn't implement Cloneable.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225434 13f79535-47bb-0310-9956-ffa450edef68"
64ba81c76ea63a79bc35df3b421416c3162bdf66,"Making several inner classes static.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225436 13f79535-47bb-0310-9956-ffa450edef68"
03e9240dcf59a46dc8b0ad397b46f631adc61d3c,"Making an inner class static.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225437 13f79535-47bb-0310-9956-ffa450edef68"
ac06b3dcfb843077ab24d8f49f648199c75da87d,"Eliminate creation of temporary strings in a loop.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225439 13f79535-47bb-0310-9956-ffa450edef68"
51e7b4f66edf23852644d0a151c560b50a5b5574,"Eliminate creation of temporary strings in loops.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225442 13f79535-47bb-0310-9956-ffa450edef68"
06a7e25652176d1311d295eaad30bf815031b207,"Making an inner class static.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225443 13f79535-47bb-0310-9956-ffa450edef68"
01982f296eb8a0c939e191b3b459cc2d4fa87163,"Making several inner classes static.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225444 13f79535-47bb-0310-9956-ffa450edef68"
162af60463160e4b3a89ff698a33b67cc5f16ac7,"Fixing an averaging computation that could overflow for large values.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225445 13f79535-47bb-0310-9956-ffa450edef68"
c82fea076cce5310a2a6de39d0233b988e70de0a,"Eliminate call to inefficient String(String) constructor.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225446 13f79535-47bb-0310-9956-ffa450edef68"
d77a80d0df0ee047050b769d801ea4816e108bfb,"Make ObjectFactory classes final.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225557 13f79535-47bb-0310-9956-ffa450edef68"
a487b9e4e635d7c81a1b64d02dc1e4f98a838471,"Minor performance improvement. Use String.lastIndexOf(int) instead of String.lastIndexOf(String).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225574 13f79535-47bb-0310-9956-ffa450edef68"
869954cf3758e6472b6798188e25843a5821fdbc,"Minor performance improvement. Use String.lastIndexOf(int) instead of String.lastIndexOf(String).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225575 13f79535-47bb-0310-9956-ffa450edef68"
f45011254ae8e5a3203af4bfdd95b75596f3d6a1,"Minor performance improvement. Use String.lastIndexOf(int) instead of String.lastIndexOf(String).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225576 13f79535-47bb-0310-9956-ffa450edef68"
e1dbdeb959ff212d7cce61c32d693433b170a476,"Minor performance improvement. Use String.lastIndexOf(int) instead of String.lastIndexOf(String).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225577 13f79535-47bb-0310-9956-ffa450edef68"
83864fb13e02e97061fcd1de328af223a2cc854e,"Minor performance improvement. Use String.lastIndexOf(int) instead of String.lastIndexOf(String).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225579 13f79535-47bb-0310-9956-ffa450edef68"
4aa53836ab42041eba90192e6855e4741f4bfcd7,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225580 13f79535-47bb-0310-9956-ffa450edef68"
27e9ceb2fa74ba41e54d73f349578d54f31bb472,"Minor performance improvement. Use String.lastIndexOf(int)/indexOf(int) instead of String.lastIndexOf(String)/indexOf(String).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225582 13f79535-47bb-0310-9956-ffa450edef68"
b792b39257238f0432e01b3b77c56057d761b257,"Minor performance improvement. Use String.lastIndexOf(int) instead of String.lastIndexOf(String).

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225583 13f79535-47bb-0310-9956-ffa450edef68"
a95731a82375d06c4c4e67591d2f5ab3780b9376,"Update to the latest ASF license header. See http://www.apache.org/legal/src-headers.html.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225752 13f79535-47bb-0310-9956-ffa450edef68"
54788055993137fad563d4618b00188aa581e74a,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225754 13f79535-47bb-0310-9956-ffa450edef68"
a697b32e0739ff67a9a51fbee6ff839b957a64c4,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225758 13f79535-47bb-0310-9956-ffa450edef68"
5b396a6f5f847e9e46e90a222a7b5657fe013530,"Minor performance improvement. Use the char version of StringBuffer.append() and String.indexOf().

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225761 13f79535-47bb-0310-9956-ffa450edef68"
5d9d30e4d60c8530df948e239f0fb8dea7d90e35,"Clean-up imports.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1225842 13f79535-47bb-0310-9956-ffa450edef68"
61d8edfdb2cf10c544d15ed3c521f571a0ca2890,"Updating copyright years.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1226282 13f79535-47bb-0310-9956-ffa450edef68"
7585fe3b8dd9c90419351651330973ba14153266,"Updating copyright years.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1226283 13f79535-47bb-0310-9956-ffa450edef68"
b9c10aa8da4b76c6e267dd66aed26e5579e30c70,"Updating year.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1226284 13f79535-47bb-0310-9956-ffa450edef68"
44644862e31f6e02d020c0d484686c842321b749,"Fix formatting for method printUsage().

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1347632 13f79535-47bb-0310-9956-ffa450edef68"
882d59fd47b59bb64216d8d284ae45f358af9cb3,"Remove in-line comment because it no longer is true: ""// exits with code '-1'""

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1347633 13f79535-47bb-0310-9956-ffa450edef68"
804c22acbdd2e0471cda36bbd6c7daf1af6ab2c6,"Fix XALANJ-2546 xsl:sort lang attribute ignores parameter value, only hard-coding works.

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1348522 13f79535-47bb-0310-9956-ffa450edef68"
bd00f70a9e9fe4609a8d7ef8de95976e2e764803,"Update version and path in documentation source

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1383083 13f79535-47bb-0310-9956-ffa450edef68"
73899a63d39feb1c18086fdbf943947d66fe5093,"Current V2.7.2 edits merged from maintenance branch back to trunk

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1587983 13f79535-47bb-0310-9956-ffa450edef68"
1710f6ae5ba25d78d345b27585cc6433951daf6a,"Removing jar files from /lib when presence is relocated to /lib/endorsed

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1587985 13f79535-47bb-0310-9956-ffa450edef68"
79ba96172cc9beaaf799d8f33db4c536619f00ba,"Repair eclipse build / classpath / project

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1588514 13f79535-47bb-0310-9956-ffa450edef68"
92062c0a47749a129b99516804122c359a9898e9,"Fix typo reported here https://github.com/apache/xalan-j/pull/1.patch

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1594575 13f79535-47bb-0310-9956-ffa450edef68"
cba6d7fe7e93defecb98d155e2a780f8a3f1fbaa,"Xalan-J 2.7.2 Updated Website Sources

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1595232 13f79535-47bb-0310-9956-ffa450edef68"
660e12dca29e28df9f3f9ebb7c19435bb16362f3,"minor correction to XalanJ docs

git-svn-id: https://svn.apache.org/repos/asf/xalan/java/trunk@1859835 13f79535-47bb-0310-9956-ffa450edef68"
